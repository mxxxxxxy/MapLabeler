(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function g3(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const it={},Hu=[],Mr=()=>{},iR=()=>!1,Bp=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),m3=e=>e.startsWith("onUpdate:"),Dn=Object.assign,y3=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},rR=Object.prototype.hasOwnProperty,qe=(e,t)=>rR.call(e,t),Ae=Array.isArray,qu=e=>Up(e)==="[object Map]",Kw=e=>Up(e)==="[object Set]",$e=e=>typeof e=="function",Mt=e=>typeof e=="string",Po=e=>typeof e=="symbol",bt=e=>e!==null&&typeof e=="object",Jw=e=>(bt(e)||$e(e))&&$e(e.then)&&$e(e.catch),Qw=Object.prototype.toString,Up=e=>Qw.call(e),sR=e=>Up(e).slice(8,-1),eE=e=>Up(e)==="[object Object]",v3=e=>Mt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Yc=g3(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),jp=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},oR=/-(\w)/g,Co=jp(e=>e.replace(oR,(t,n)=>n?n.toUpperCase():"")),aR=/\B([A-Z])/g,lu=jp(e=>e.replace(aR,"-$1").toLowerCase()),tE=jp(e=>e.charAt(0).toUpperCase()+e.slice(1)),V1=jp(e=>e?`on${tE(e)}`:""),vo=(e,t)=>!Object.is(e,t),W1=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},nE=(e,t,n,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:n})},uR=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let m9;const Hp=()=>m9||(m9=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Kf(e){if(Ae(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],r=Mt(i)?dR(i):Kf(i);if(r)for(const s in r)t[s]=r[s]}return t}else if(Mt(e)||bt(e))return e}const lR=/;(?![^(]*\))/g,cR=/:([^]+)/,fR=/\/\*[^]*?\*\//g;function dR(e){const t={};return e.replace(fR,"").split(lR).forEach(n=>{if(n){const i=n.split(cR);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function xi(e){let t="";if(Mt(e))t=e;else if(Ae(e))for(let n=0;n<e.length;n++){const i=xi(e[n]);i&&(t+=i+" ")}else if(bt(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const hR="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",pR=g3(hR);function iE(e){return!!e||e===""}const rE=e=>!!(e&&e.__v_isRef===!0),qy=e=>Mt(e)?e:e==null?"":Ae(e)||bt(e)&&(e.toString===Qw||!$e(e.toString))?rE(e)?qy(e.value):JSON.stringify(e,sE,2):String(e),sE=(e,t)=>rE(t)?sE(e,t.value):qu(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[i,r],s)=>(n[G1(i,s)+" =>"]=r,n),{})}:Kw(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>G1(n))}:Po(t)?G1(t):bt(t)&&!Ae(t)&&!eE(t)?String(t):t,G1=(e,t="")=>{var n;return Po(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let bn;class oE{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=bn,!t&&bn&&(this.index=(bn.scopes||(bn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=bn;try{return bn=this,t()}finally{bn=n}}}on(){bn=this}off(){bn=this.parent}stop(t){if(this._active){this._active=!1;let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(this.effects.length=0,n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function aE(e){return new oE(e)}function uE(){return bn}function gR(e,t=!1){bn&&bn.cleanups.push(e)}let ot;const Y1=new WeakSet;class lE{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,bn&&bn.active&&bn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Y1.has(this)&&(Y1.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||fE(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,y9(this),dE(this);const t=ot,n=Zi;ot=this,Zi=!0;try{return this.fn()}finally{hE(this),ot=t,Zi=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)_3(t);this.deps=this.depsTail=void 0,y9(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Y1.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Vy(this)&&this.run()}get dirty(){return Vy(this)}}let cE=0,Zc,Xc;function fE(e,t=!1){if(e.flags|=8,t){e.next=Xc,Xc=e;return}e.next=Zc,Zc=e}function b3(){cE++}function x3(){if(--cE>0)return;if(Xc){let t=Xc;for(Xc=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;Zc;){let t=Zc;for(Zc=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){e||(e=i)}t=n}}if(e)throw e}function dE(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function hE(e){let t,n=e.depsTail,i=n;for(;i;){const r=i.prevDep;i.version===-1?(i===n&&(n=r),_3(i),mR(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=r}e.deps=t,e.depsTail=n}function Vy(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(pE(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function pE(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===bf))return;e.globalVersion=bf;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!Vy(e)){e.flags&=-3;return}const n=ot,i=Zi;ot=e,Zi=!0;try{dE(e);const r=e.fn(e._value);(t.version===0||vo(r,e._value))&&(e._value=r,t.version++)}catch(r){throw t.version++,r}finally{ot=n,Zi=i,hE(e),e.flags&=-3}}function _3(e,t=!1){const{dep:n,prevSub:i,nextSub:r}=e;if(i&&(i.nextSub=r,e.prevSub=void 0),r&&(r.prevSub=i,e.nextSub=void 0),n.subs===e&&(n.subs=i,!i&&n.computed)){n.computed.flags&=-5;for(let s=n.computed.deps;s;s=s.nextDep)_3(s,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function mR(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let Zi=!0;const gE=[];function zo(){gE.push(Zi),Zi=!1}function Bo(){const e=gE.pop();Zi=e===void 0?!0:e}function y9(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=ot;ot=void 0;try{t()}finally{ot=n}}}let bf=0;class yR{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class w3{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!ot||!Zi||ot===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==ot)n=this.activeLink=new yR(ot,this),ot.deps?(n.prevDep=ot.depsTail,ot.depsTail.nextDep=n,ot.depsTail=n):ot.deps=ot.depsTail=n,mE(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const i=n.nextDep;i.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=i),n.prevDep=ot.depsTail,n.nextDep=void 0,ot.depsTail.nextDep=n,ot.depsTail=n,ot.deps===n&&(ot.deps=i)}return n}trigger(t){this.version++,bf++,this.notify(t)}notify(t){b3();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{x3()}}}function mE(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)mE(i)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const i0=new WeakMap,ka=Symbol(""),Wy=Symbol(""),xf=Symbol("");function an(e,t,n){if(Zi&&ot){let i=i0.get(e);i||i0.set(e,i=new Map);let r=i.get(n);r||(i.set(n,r=new w3),r.map=i,r.key=n),r.track()}}function gs(e,t,n,i,r,s){const o=i0.get(e);if(!o){bf++;return}const a=u=>{u&&u.trigger()};if(b3(),t==="clear")o.forEach(a);else{const u=Ae(e),l=u&&v3(n);if(u&&n==="length"){const c=Number(i);o.forEach((f,d)=>{(d==="length"||d===xf||!Po(d)&&d>=c)&&a(f)})}else switch((n!==void 0||o.has(void 0))&&a(o.get(n)),l&&a(o.get(xf)),t){case"add":u?l&&a(o.get("length")):(a(o.get(ka)),qu(e)&&a(o.get(Wy)));break;case"delete":u||(a(o.get(ka)),qu(e)&&a(o.get(Wy)));break;case"set":qu(e)&&a(o.get(ka));break}}x3()}function vR(e,t){const n=i0.get(e);return n&&n.get(t)}function Cu(e){const t=ze(e);return t===e?t:(an(t,"iterate",xf),ki(e)?t:t.map(un))}function qp(e){return an(e=ze(e),"iterate",xf),e}const bR={__proto__:null,[Symbol.iterator](){return Z1(this,Symbol.iterator,un)},concat(...e){return Cu(this).concat(...e.map(t=>Ae(t)?Cu(t):t))},entries(){return Z1(this,"entries",e=>(e[1]=un(e[1]),e))},every(e,t){return ss(this,"every",e,t,void 0,arguments)},filter(e,t){return ss(this,"filter",e,t,n=>n.map(un),arguments)},find(e,t){return ss(this,"find",e,t,un,arguments)},findIndex(e,t){return ss(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return ss(this,"findLast",e,t,un,arguments)},findLastIndex(e,t){return ss(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return ss(this,"forEach",e,t,void 0,arguments)},includes(...e){return X1(this,"includes",e)},indexOf(...e){return X1(this,"indexOf",e)},join(e){return Cu(this).join(e)},lastIndexOf(...e){return X1(this,"lastIndexOf",e)},map(e,t){return ss(this,"map",e,t,void 0,arguments)},pop(){return nc(this,"pop")},push(...e){return nc(this,"push",e)},reduce(e,...t){return v9(this,"reduce",e,t)},reduceRight(e,...t){return v9(this,"reduceRight",e,t)},shift(){return nc(this,"shift")},some(e,t){return ss(this,"some",e,t,void 0,arguments)},splice(...e){return nc(this,"splice",e)},toReversed(){return Cu(this).toReversed()},toSorted(e){return Cu(this).toSorted(e)},toSpliced(...e){return Cu(this).toSpliced(...e)},unshift(...e){return nc(this,"unshift",e)},values(){return Z1(this,"values",un)}};function Z1(e,t,n){const i=qp(e),r=i[t]();return i!==e&&!ki(e)&&(r._next=r.next,r.next=()=>{const s=r._next();return s.value&&(s.value=n(s.value)),s}),r}const xR=Array.prototype;function ss(e,t,n,i,r,s){const o=qp(e),a=o!==e&&!ki(e),u=o[t];if(u!==xR[t]){const f=u.apply(e,s);return a?un(f):f}let l=n;o!==e&&(a?l=function(f,d){return n.call(this,un(f),d,e)}:n.length>2&&(l=function(f,d){return n.call(this,f,d,e)}));const c=u.call(o,l,i);return a&&r?r(c):c}function v9(e,t,n,i){const r=qp(e);let s=n;return r!==e&&(ki(e)?n.length>3&&(s=function(o,a,u){return n.call(this,o,a,u,e)}):s=function(o,a,u){return n.call(this,o,un(a),u,e)}),r[t](s,...i)}function X1(e,t,n){const i=ze(e);an(i,"iterate",xf);const r=i[t](...n);return(r===-1||r===!1)&&S3(n[0])?(n[0]=ze(n[0]),i[t](...n)):r}function nc(e,t,n=[]){zo(),b3();const i=ze(e)[t].apply(e,n);return x3(),Bo(),i}const _R=g3("__proto__,__v_isRef,__isVue"),yE=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Po));function wR(e){Po(e)||(e=String(e));const t=ze(this);return an(t,"has",e),t.hasOwnProperty(e)}class vE{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,i){if(n==="__v_skip")return t.__v_skip;const r=this._isReadonly,s=this._isShallow;if(n==="__v_isReactive")return!r;if(n==="__v_isReadonly")return r;if(n==="__v_isShallow")return s;if(n==="__v_raw")return i===(r?s?LR:wE:s?_E:xE).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const o=Ae(t);if(!r){let u;if(o&&(u=bR[n]))return u;if(n==="hasOwnProperty")return wR}const a=Reflect.get(t,n,St(t)?t:i);return(Po(n)?yE.has(n):_R(n))||(r||an(t,"get",n),s)?a:St(a)?o&&v3(n)?a:a.value:bt(a)?r?EE(a):Vp(a):a}}class bE extends vE{constructor(t=!1){super(!1,t)}set(t,n,i,r){let s=t[n];if(!this._isShallow){const u=za(s);if(!ki(i)&&!za(i)&&(s=ze(s),i=ze(i)),!Ae(t)&&St(s)&&!St(i))return u?!1:(s.value=i,!0)}const o=Ae(t)&&v3(n)?Number(n)<t.length:qe(t,n),a=Reflect.set(t,n,i,St(t)?t:r);return t===ze(r)&&(o?vo(i,s)&&gs(t,"set",n,i):gs(t,"add",n,i)),a}deleteProperty(t,n){const i=qe(t,n);t[n];const r=Reflect.deleteProperty(t,n);return r&&i&&gs(t,"delete",n,void 0),r}has(t,n){const i=Reflect.has(t,n);return(!Po(n)||!yE.has(n))&&an(t,"has",n),i}ownKeys(t){return an(t,"iterate",Ae(t)?"length":ka),Reflect.ownKeys(t)}}class ER extends vE{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const CR=new bE,SR=new ER,kR=new bE(!0);const Gy=e=>e,Hd=e=>Reflect.getPrototypeOf(e);function AR(e,t,n){return function(...i){const r=this.__v_raw,s=ze(r),o=qu(s),a=e==="entries"||e===Symbol.iterator&&o,u=e==="keys"&&o,l=r[e](...i),c=n?Gy:t?Yy:un;return!t&&an(s,"iterate",u?Wy:ka),{next(){const{value:f,done:d}=l.next();return d?{value:f,done:d}:{value:a?[c(f[0]),c(f[1])]:c(f),done:d}},[Symbol.iterator](){return this}}}}function qd(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function $R(e,t){const n={get(r){const s=this.__v_raw,o=ze(s),a=ze(r);e||(vo(r,a)&&an(o,"get",r),an(o,"get",a));const{has:u}=Hd(o),l=t?Gy:e?Yy:un;if(u.call(o,r))return l(s.get(r));if(u.call(o,a))return l(s.get(a));s!==o&&s.get(r)},get size(){const r=this.__v_raw;return!e&&an(ze(r),"iterate",ka),Reflect.get(r,"size",r)},has(r){const s=this.__v_raw,o=ze(s),a=ze(r);return e||(vo(r,a)&&an(o,"has",r),an(o,"has",a)),r===a?s.has(r):s.has(r)||s.has(a)},forEach(r,s){const o=this,a=o.__v_raw,u=ze(a),l=t?Gy:e?Yy:un;return!e&&an(u,"iterate",ka),a.forEach((c,f)=>r.call(s,l(c),l(f),o))}};return Dn(n,e?{add:qd("add"),set:qd("set"),delete:qd("delete"),clear:qd("clear")}:{add(r){!t&&!ki(r)&&!za(r)&&(r=ze(r));const s=ze(this);return Hd(s).has.call(s,r)||(s.add(r),gs(s,"add",r,r)),this},set(r,s){!t&&!ki(s)&&!za(s)&&(s=ze(s));const o=ze(this),{has:a,get:u}=Hd(o);let l=a.call(o,r);l||(r=ze(r),l=a.call(o,r));const c=u.call(o,r);return o.set(r,s),l?vo(s,c)&&gs(o,"set",r,s):gs(o,"add",r,s),this},delete(r){const s=ze(this),{has:o,get:a}=Hd(s);let u=o.call(s,r);u||(r=ze(r),u=o.call(s,r)),a&&a.call(s,r);const l=s.delete(r);return u&&gs(s,"delete",r,void 0),l},clear(){const r=ze(this),s=r.size!==0,o=r.clear();return s&&gs(r,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(r=>{n[r]=AR(r,e,t)}),n}function E3(e,t){const n=$R(e,t);return(i,r,s)=>r==="__v_isReactive"?!e:r==="__v_isReadonly"?e:r==="__v_raw"?i:Reflect.get(qe(n,r)&&r in i?n:i,r,s)}const MR={get:E3(!1,!1)},TR={get:E3(!1,!0)},FR={get:E3(!0,!1)};const xE=new WeakMap,_E=new WeakMap,wE=new WeakMap,LR=new WeakMap;function NR(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function DR(e){return e.__v_skip||!Object.isExtensible(e)?0:NR(sR(e))}function Vp(e){return za(e)?e:C3(e,!1,CR,MR,xE)}function RR(e){return C3(e,!1,kR,TR,_E)}function EE(e){return C3(e,!0,SR,FR,wE)}function C3(e,t,n,i,r){if(!bt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const s=r.get(e);if(s)return s;const o=DR(e);if(o===0)return e;const a=new Proxy(e,o===2?i:n);return r.set(e,a),a}function bo(e){return za(e)?bo(e.__v_raw):!!(e&&e.__v_isReactive)}function za(e){return!!(e&&e.__v_isReadonly)}function ki(e){return!!(e&&e.__v_isShallow)}function S3(e){return e?!!e.__v_raw:!1}function ze(e){const t=e&&e.__v_raw;return t?ze(t):e}function k3(e){return!qe(e,"__v_skip")&&Object.isExtensible(e)&&nE(e,"__v_skip",!0),e}const un=e=>bt(e)?Vp(e):e,Yy=e=>bt(e)?EE(e):e;function St(e){return e?e.__v_isRef===!0:!1}function je(e){return OR(e,!1)}function OR(e,t){return St(e)?e:new IR(e,t)}class IR{constructor(t,n){this.dep=new w3,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:ze(t),this._value=n?t:un(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,i=this.__v_isShallow||ki(t)||za(t);t=i?t:ze(t),vo(t,n)&&(this._rawValue=t,this._value=i?t:un(t),this.dep.trigger())}}function Ie(e){return St(e)?e.value:e}const PR={get:(e,t,n)=>t==="__v_raw"?e:Ie(Reflect.get(e,t,n)),set:(e,t,n,i)=>{const r=e[t];return St(r)&&!St(n)?(r.value=n,!0):Reflect.set(e,t,n,i)}};function CE(e){return bo(e)?e:new Proxy(e,PR)}function zR(e){const t=Ae(e)?new Array(e.length):{};for(const n in e)t[n]=UR(e,n);return t}class BR{constructor(t,n,i){this._object=t,this._key=n,this._defaultValue=i,this.__v_isRef=!0,this._value=void 0}get value(){const t=this._object[this._key];return this._value=t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return vR(ze(this._object),this._key)}}function UR(e,t,n){const i=e[t];return St(i)?i:new BR(e,t,n)}class jR{constructor(t,n,i){this.fn=t,this.setter=n,this._value=void 0,this.dep=new w3(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=bf-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&ot!==this)return fE(this,!0),!0}get value(){const t=this.dep.track();return pE(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function HR(e,t,n=!1){let i,r;return $e(e)?i=e:(i=e.get,r=e.set),new jR(i,r,n)}const Vd={},r0=new WeakMap;let ua;function qR(e,t=!1,n=ua){if(n){let i=r0.get(n);i||r0.set(n,i=[]),i.push(e)}}function VR(e,t,n=it){const{immediate:i,deep:r,once:s,scheduler:o,augmentJob:a,call:u}=n,l=x=>r?x:ki(x)||r===!1||r===0?ms(x,1):ms(x);let c,f,d,h,p=!1,g=!1;if(St(e)?(f=()=>e.value,p=ki(e)):bo(e)?(f=()=>l(e),p=!0):Ae(e)?(g=!0,p=e.some(x=>bo(x)||ki(x)),f=()=>e.map(x=>{if(St(x))return x.value;if(bo(x))return l(x);if($e(x))return u?u(x,2):x()})):$e(e)?t?f=u?()=>u(e,2):e:f=()=>{if(d){zo();try{d()}finally{Bo()}}const x=ua;ua=c;try{return u?u(e,3,[h]):e(h)}finally{ua=x}}:f=Mr,t&&r){const x=f,_=r===!0?1/0:r;f=()=>ms(x(),_)}const m=uE(),y=()=>{c.stop(),m&&m.active&&y3(m.effects,c)};if(s&&t){const x=t;t=(..._)=>{x(..._),y()}}let v=g?new Array(e.length).fill(Vd):Vd;const b=x=>{if(!(!(c.flags&1)||!c.dirty&&!x))if(t){const _=c.run();if(r||p||(g?_.some((E,w)=>vo(E,v[w])):vo(_,v))){d&&d();const E=ua;ua=c;try{const w=[_,v===Vd?void 0:g&&v[0]===Vd?[]:v,h];u?u(t,3,w):t(...w),v=_}finally{ua=E}}}else c.run()};return a&&a(b),c=new lE(f),c.scheduler=o?()=>o(b,!1):b,h=x=>qR(x,!1,c),d=c.onStop=()=>{const x=r0.get(c);if(x){if(u)u(x,4);else for(const _ of x)_();r0.delete(c)}},t?i?b(!0):v=c.run():o?o(b.bind(null,!0),!0):c.run(),y.pause=c.pause.bind(c),y.resume=c.resume.bind(c),y.stop=y,y}function ms(e,t=1/0,n){if(t<=0||!bt(e)||e.__v_skip||(n=n||new Set,n.has(e)))return e;if(n.add(e),t--,St(e))ms(e.value,t,n);else if(Ae(e))for(let i=0;i<e.length;i++)ms(e[i],t,n);else if(Kw(e)||qu(e))e.forEach(i=>{ms(i,t,n)});else if(eE(e)){for(const i in e)ms(e[i],t,n);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&ms(e[i],t,n)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Jf(e,t,n,i){try{return i?e(...i):e()}catch(r){Wp(r,t,n)}}function Or(e,t,n,i){if($e(e)){const r=Jf(e,t,n,i);return r&&Jw(r)&&r.catch(s=>{Wp(s,t,n)}),r}if(Ae(e)){const r=[];for(let s=0;s<e.length;s++)r.push(Or(e[s],t,n,i));return r}}function Wp(e,t,n,i=!0){const r=t?t.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||it;if(t){let a=t.parent;const u=t.proxy,l=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const c=a.ec;if(c){for(let f=0;f<c.length;f++)if(c[f](e,u,l)===!1)return}a=a.parent}if(s){zo(),Jf(s,null,10,[e,u,l]),Bo();return}}WR(e,n,r,i,o)}function WR(e,t,n,i=!0,r=!1){if(r)throw e;console.error(e)}const _n=[];let br=-1;const Vu=[];let io=null,Ou=0;const SE=Promise.resolve();let s0=null;function A3(e){const t=s0||SE;return e?t.then(this?e.bind(this):e):t}function GR(e){let t=br+1,n=_n.length;for(;t<n;){const i=t+n>>>1,r=_n[i],s=_f(r);s<e||s===e&&r.flags&2?t=i+1:n=i}return t}function $3(e){if(!(e.flags&1)){const t=_f(e),n=_n[_n.length-1];!n||!(e.flags&2)&&t>=_f(n)?_n.push(e):_n.splice(GR(t),0,e),e.flags|=1,kE()}}function kE(){s0||(s0=SE.then($E))}function YR(e){Ae(e)?Vu.push(...e):io&&e.id===-1?io.splice(Ou+1,0,e):e.flags&1||(Vu.push(e),e.flags|=1),kE()}function b9(e,t,n=br+1){for(;n<_n.length;n++){const i=_n[n];if(i&&i.flags&2){if(e&&i.id!==e.uid)continue;_n.splice(n,1),n--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function AE(e){if(Vu.length){const t=[...new Set(Vu)].sort((n,i)=>_f(n)-_f(i));if(Vu.length=0,io){io.push(...t);return}for(io=t,Ou=0;Ou<io.length;Ou++){const n=io[Ou];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}io=null,Ou=0}}const _f=e=>e.id==null?e.flags&2?-1:1/0:e.id;function $E(e){try{for(br=0;br<_n.length;br++){const t=_n[br];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Jf(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;br<_n.length;br++){const t=_n[br];t&&(t.flags&=-2)}br=-1,_n.length=0,AE(),s0=null,(_n.length||Vu.length)&&$E()}}let ai=null,ME=null;function o0(e){const t=ai;return ai=e,ME=e&&e.type.__scopeId||null,t}function ZR(e,t=ai,n){if(!t||e._n)return e;const i=(...r)=>{i._d&&$9(-1);const s=o0(t);let o;try{o=e(...r)}finally{o0(s),i._d&&$9(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function XR(e,t){if(ai===null)return e;const n=Xp(ai),i=e.dirs||(e.dirs=[]);for(let r=0;r<t.length;r++){let[s,o,a,u=it]=t[r];s&&($e(s)&&(s={mounted:s,updated:s}),s.deep&&ms(o),i.push({dir:s,instance:n,value:o,oldValue:void 0,arg:a,modifiers:u}))}return e}function na(e,t,n,i){const r=e.dirs,s=t&&t.dirs;for(let o=0;o<r.length;o++){const a=r[o];s&&(a.oldValue=s[o].value);let u=a.dir[i];u&&(zo(),Or(u,n,8,[e.el,a,e,t]),Bo())}}const KR=Symbol("_vte"),JR=e=>e.__isTeleport;function M3(e,t){e.shapeFlag&6&&e.component?(e.transition=t,M3(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function TE(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function a0(e,t,n,i,r=!1){if(Ae(e)){e.forEach((p,g)=>a0(p,t&&(Ae(t)?t[g]:t),n,i,r));return}if(Kc(i)&&!r){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&a0(e,t,n,i.component.subTree);return}const s=i.shapeFlag&4?Xp(i.component):i.el,o=r?null:s,{i:a,r:u}=e,l=t&&t.r,c=a.refs===it?a.refs={}:a.refs,f=a.setupState,d=ze(f),h=f===it?()=>!1:p=>qe(d,p);if(l!=null&&l!==u&&(Mt(l)?(c[l]=null,h(l)&&(f[l]=null)):St(l)&&(l.value=null)),$e(u))Jf(u,a,12,[o,c]);else{const p=Mt(u),g=St(u);if(p||g){const m=()=>{if(e.f){const y=p?h(u)?f[u]:c[u]:u.value;r?Ae(y)&&y3(y,s):Ae(y)?y.includes(s)||y.push(s):p?(c[u]=[s],h(u)&&(f[u]=c[u])):(u.value=[s],e.k&&(c[e.k]=u.value))}else p?(c[u]=o,h(u)&&(f[u]=o)):g&&(u.value=o,e.k&&(c[e.k]=o))};o?(m.id=-1,ni(m,n)):m()}}}Hp().requestIdleCallback;Hp().cancelIdleCallback;const Kc=e=>!!e.type.__asyncLoader,FE=e=>e.type.__isKeepAlive;function QR(e,t){LE(e,"a",t)}function eO(e,t){LE(e,"da",t)}function LE(e,t,n=cn){const i=e.__wdc||(e.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return e()});if(Gp(t,i,n),n){let r=n.parent;for(;r&&r.parent;)FE(r.parent.vnode)&&tO(i,t,n,r),r=r.parent}}function tO(e,t,n,i){const r=Gp(t,e,i,!0);T3(()=>{y3(i[t],r)},n)}function Gp(e,t,n=cn,i=!1){if(n){const r=n[e]||(n[e]=[]),s=t.__weh||(t.__weh=(...o)=>{zo();const a=Qf(n),u=Or(t,n,e,o);return a(),Bo(),u});return i?r.unshift(s):r.push(s),s}}const Hs=e=>(t,n=cn)=>{(!Ef||e==="sp")&&Gp(e,(...i)=>t(...i),n)},nO=Hs("bm"),NE=Hs("m"),iO=Hs("bu"),rO=Hs("u"),sO=Hs("bum"),T3=Hs("um"),oO=Hs("sp"),aO=Hs("rtg"),uO=Hs("rtc");function lO(e,t=cn){Gp("ec",e,t)}const cO=Symbol.for("v-ndc");function ha(e,t,n,i){let r;const s=n,o=Ae(e);if(o||Mt(e)){const a=o&&bo(e);let u=!1;a&&(u=!ki(e),e=qp(e)),r=new Array(e.length);for(let l=0,c=e.length;l<c;l++)r[l]=t(u?un(e[l]):e[l],l,void 0,s)}else if(typeof e=="number"){r=new Array(e);for(let a=0;a<e;a++)r[a]=t(a+1,a,void 0,s)}else if(bt(e))if(e[Symbol.iterator])r=Array.from(e,(a,u)=>t(a,u,void 0,s));else{const a=Object.keys(e);r=new Array(a.length);for(let u=0,l=a.length;u<l;u++){const c=a[u];r[u]=t(e[c],c,u,s)}}else r=[];return r}const Zy=e=>e?nC(e)?Xp(e):Zy(e.parent):null,Jc=Dn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Zy(e.parent),$root:e=>Zy(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>RE(e),$forceUpdate:e=>e.f||(e.f=()=>{$3(e.update)}),$nextTick:e=>e.n||(e.n=A3.bind(e.proxy)),$watch:e=>NO.bind(e)}),K1=(e,t)=>e!==it&&!e.__isScriptSetup&&qe(e,t),fO={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:i,data:r,props:s,accessCache:o,type:a,appContext:u}=e;let l;if(t[0]!=="$"){const h=o[t];if(h!==void 0)switch(h){case 1:return i[t];case 2:return r[t];case 4:return n[t];case 3:return s[t]}else{if(K1(i,t))return o[t]=1,i[t];if(r!==it&&qe(r,t))return o[t]=2,r[t];if((l=e.propsOptions[0])&&qe(l,t))return o[t]=3,s[t];if(n!==it&&qe(n,t))return o[t]=4,n[t];Xy&&(o[t]=0)}}const c=Jc[t];let f,d;if(c)return t==="$attrs"&&an(e.attrs,"get",""),c(e);if((f=a.__cssModules)&&(f=f[t]))return f;if(n!==it&&qe(n,t))return o[t]=4,n[t];if(d=u.config.globalProperties,qe(d,t))return d[t]},set({_:e},t,n){const{data:i,setupState:r,ctx:s}=e;return K1(r,t)?(r[t]=n,!0):i!==it&&qe(i,t)?(i[t]=n,!0):qe(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(s[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:i,appContext:r,propsOptions:s}},o){let a;return!!n[o]||e!==it&&qe(e,o)||K1(t,o)||(a=s[0])&&qe(a,o)||qe(i,o)||qe(Jc,o)||qe(r.config.globalProperties,o)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:qe(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function x9(e){return Ae(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let Xy=!0;function dO(e){const t=RE(e),n=e.proxy,i=e.ctx;Xy=!1,t.beforeCreate&&_9(t.beforeCreate,e,"bc");const{data:r,computed:s,methods:o,watch:a,provide:u,inject:l,created:c,beforeMount:f,mounted:d,beforeUpdate:h,updated:p,activated:g,deactivated:m,beforeDestroy:y,beforeUnmount:v,destroyed:b,unmounted:x,render:_,renderTracked:E,renderTriggered:w,errorCaptured:S,serverPrefetch:$,expose:F,inheritAttrs:T,components:P,directives:R,filters:C}=t;if(l&&hO(l,i,null),o)for(const L in o){const D=o[L];$e(D)&&(i[L]=D.bind(n))}if(r){const L=r.call(n,n);bt(L)&&(e.data=Vp(L))}if(Xy=!0,s)for(const L in s){const D=s[L],O=$e(D)?D.bind(n,n):$e(D.get)?D.get.bind(n,n):Mr,j=!$e(D)&&$e(D.set)?D.set.bind(n):Mr,J=_i({get:O,set:j});Object.defineProperty(i,L,{enumerable:!0,configurable:!0,get:()=>J.value,set:K=>J.value=K})}if(a)for(const L in a)DE(a[L],i,n,L);if(u){const L=$e(u)?u.call(n):u;Reflect.ownKeys(L).forEach(D=>{bO(D,L[D])})}c&&_9(c,e,"c");function M(L,D){Ae(D)?D.forEach(O=>L(O.bind(n))):D&&L(D.bind(n))}if(M(nO,f),M(NE,d),M(iO,h),M(rO,p),M(QR,g),M(eO,m),M(lO,S),M(uO,E),M(aO,w),M(sO,v),M(T3,x),M(oO,$),Ae(F))if(F.length){const L=e.exposed||(e.exposed={});F.forEach(D=>{Object.defineProperty(L,D,{get:()=>n[D],set:O=>n[D]=O})})}else e.exposed||(e.exposed={});_&&e.render===Mr&&(e.render=_),T!=null&&(e.inheritAttrs=T),P&&(e.components=P),R&&(e.directives=R),$&&TE(e)}function hO(e,t,n=Mr){Ae(e)&&(e=Ky(e));for(const i in e){const r=e[i];let s;bt(r)?"default"in r?s=Qc(r.from||i,r.default,!0):s=Qc(r.from||i):s=Qc(r),St(s)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):t[i]=s}}function _9(e,t,n){Or(Ae(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,n)}function DE(e,t,n,i){let r=i.includes(".")?ZE(n,i):()=>n[i];if(Mt(e)){const s=t[e];$e(s)&&ef(r,s)}else if($e(e))ef(r,e.bind(n));else if(bt(e))if(Ae(e))e.forEach(s=>DE(s,t,n,i));else{const s=$e(e.handler)?e.handler.bind(n):t[e.handler];$e(s)&&ef(r,s,e)}}function RE(e){const t=e.type,{mixins:n,extends:i}=t,{mixins:r,optionsCache:s,config:{optionMergeStrategies:o}}=e.appContext,a=s.get(t);let u;return a?u=a:!r.length&&!n&&!i?u=t:(u={},r.length&&r.forEach(l=>u0(u,l,o,!0)),u0(u,t,o)),bt(t)&&s.set(t,u),u}function u0(e,t,n,i=!1){const{mixins:r,extends:s}=t;s&&u0(e,s,n,!0),r&&r.forEach(o=>u0(e,o,n,!0));for(const o in t)if(!(i&&o==="expose")){const a=pO[o]||n&&n[o];e[o]=a?a(e[o],t[o]):t[o]}return e}const pO={data:w9,props:E9,emits:E9,methods:Cc,computed:Cc,beforeCreate:yn,created:yn,beforeMount:yn,mounted:yn,beforeUpdate:yn,updated:yn,beforeDestroy:yn,beforeUnmount:yn,destroyed:yn,unmounted:yn,activated:yn,deactivated:yn,errorCaptured:yn,serverPrefetch:yn,components:Cc,directives:Cc,watch:mO,provide:w9,inject:gO};function w9(e,t){return t?e?function(){return Dn($e(e)?e.call(this,this):e,$e(t)?t.call(this,this):t)}:t:e}function gO(e,t){return Cc(Ky(e),Ky(t))}function Ky(e){if(Ae(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function yn(e,t){return e?[...new Set([].concat(e,t))]:t}function Cc(e,t){return e?Dn(Object.create(null),e,t):t}function E9(e,t){return e?Ae(e)&&Ae(t)?[...new Set([...e,...t])]:Dn(Object.create(null),x9(e),x9(t??{})):t}function mO(e,t){if(!e)return t;if(!t)return e;const n=Dn(Object.create(null),e);for(const i in t)n[i]=yn(e[i],t[i]);return n}function OE(){return{app:null,config:{isNativeTag:iR,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let yO=0;function vO(e,t){return function(i,r=null){$e(i)||(i=Dn({},i)),r!=null&&!bt(r)&&(r=null);const s=OE(),o=new WeakSet,a=[];let u=!1;const l=s.app={_uid:yO++,_component:i,_props:r,_container:null,_context:s,_instance:null,version:eI,get config(){return s.config},set config(c){},use(c,...f){return o.has(c)||(c&&$e(c.install)?(o.add(c),c.install(l,...f)):$e(c)&&(o.add(c),c(l,...f))),l},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),l},component(c,f){return f?(s.components[c]=f,l):s.components[c]},directive(c,f){return f?(s.directives[c]=f,l):s.directives[c]},mount(c,f,d){if(!u){const h=l._ceVNode||Xi(i,r);return h.appContext=s,d===!0?d="svg":d===!1&&(d=void 0),e(h,c,d),u=!0,l._container=c,c.__vue_app__=l,Xp(h.component)}},onUnmount(c){a.push(c)},unmount(){u&&(Or(a,l._instance,16),e(null,l._container),delete l._container.__vue_app__)},provide(c,f){return s.provides[c]=f,l},runWithContext(c){const f=Aa;Aa=l;try{return c()}finally{Aa=f}}};return l}}let Aa=null;function bO(e,t){if(cn){let n=cn.provides;const i=cn.parent&&cn.parent.provides;i===n&&(n=cn.provides=Object.create(i)),n[e]=t}}function Qc(e,t,n=!1){const i=cn||ai;if(i||Aa){const r=Aa?Aa._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(r&&e in r)return r[e];if(arguments.length>1)return n&&$e(t)?t.call(i&&i.proxy):t}}function xO(){return!!(cn||ai||Aa)}const IE={},PE=()=>Object.create(IE),zE=e=>Object.getPrototypeOf(e)===IE;function _O(e,t,n,i=!1){const r={},s=PE();e.propsDefaults=Object.create(null),BE(e,t,r,s);for(const o in e.propsOptions[0])o in r||(r[o]=void 0);n?e.props=i?r:RR(r):e.type.props?e.props=r:e.props=s,e.attrs=s}function wO(e,t,n,i){const{props:r,attrs:s,vnode:{patchFlag:o}}=e,a=ze(r),[u]=e.propsOptions;let l=!1;if((i||o>0)&&!(o&16)){if(o&8){const c=e.vnode.dynamicProps;for(let f=0;f<c.length;f++){let d=c[f];if(Yp(e.emitsOptions,d))continue;const h=t[d];if(u)if(qe(s,d))h!==s[d]&&(s[d]=h,l=!0);else{const p=Co(d);r[p]=Jy(u,a,p,h,e,!1)}else h!==s[d]&&(s[d]=h,l=!0)}}}else{BE(e,t,r,s)&&(l=!0);let c;for(const f in a)(!t||!qe(t,f)&&((c=lu(f))===f||!qe(t,c)))&&(u?n&&(n[f]!==void 0||n[c]!==void 0)&&(r[f]=Jy(u,a,f,void 0,e,!0)):delete r[f]);if(s!==a)for(const f in s)(!t||!qe(t,f))&&(delete s[f],l=!0)}l&&gs(e.attrs,"set","")}function BE(e,t,n,i){const[r,s]=e.propsOptions;let o=!1,a;if(t)for(let u in t){if(Yc(u))continue;const l=t[u];let c;r&&qe(r,c=Co(u))?!s||!s.includes(c)?n[c]=l:(a||(a={}))[c]=l:Yp(e.emitsOptions,u)||(!(u in i)||l!==i[u])&&(i[u]=l,o=!0)}if(s){const u=ze(n),l=a||it;for(let c=0;c<s.length;c++){const f=s[c];n[f]=Jy(r,u,f,l[f],e,!qe(l,f))}}return o}function Jy(e,t,n,i,r,s){const o=e[n];if(o!=null){const a=qe(o,"default");if(a&&i===void 0){const u=o.default;if(o.type!==Function&&!o.skipFactory&&$e(u)){const{propsDefaults:l}=r;if(n in l)i=l[n];else{const c=Qf(r);i=l[n]=u.call(null,t),c()}}else i=u;r.ce&&r.ce._setProp(n,i)}o[0]&&(s&&!a?i=!1:o[1]&&(i===""||i===lu(n))&&(i=!0))}return i}const EO=new WeakMap;function UE(e,t,n=!1){const i=n?EO:t.propsCache,r=i.get(e);if(r)return r;const s=e.props,o={},a=[];let u=!1;if(!$e(e)){const c=f=>{u=!0;const[d,h]=UE(f,t,!0);Dn(o,d),h&&a.push(...h)};!n&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}if(!s&&!u)return bt(e)&&i.set(e,Hu),Hu;if(Ae(s))for(let c=0;c<s.length;c++){const f=Co(s[c]);C9(f)&&(o[f]=it)}else if(s)for(const c in s){const f=Co(c);if(C9(f)){const d=s[c],h=o[f]=Ae(d)||$e(d)?{type:d}:Dn({},d),p=h.type;let g=!1,m=!0;if(Ae(p))for(let y=0;y<p.length;++y){const v=p[y],b=$e(v)&&v.name;if(b==="Boolean"){g=!0;break}else b==="String"&&(m=!1)}else g=$e(p)&&p.name==="Boolean";h[0]=g,h[1]=m,(g||qe(h,"default"))&&a.push(f)}}const l=[o,a];return bt(e)&&i.set(e,l),l}function C9(e){return e[0]!=="$"&&!Yc(e)}const jE=e=>e[0]==="_"||e==="$stable",F3=e=>Ae(e)?e.map(wr):[wr(e)],CO=(e,t,n)=>{if(t._n)return t;const i=ZR((...r)=>F3(t(...r)),n);return i._c=!1,i},HE=(e,t,n)=>{const i=e._ctx;for(const r in e){if(jE(r))continue;const s=e[r];if($e(s))t[r]=CO(r,s,i);else if(s!=null){const o=F3(s);t[r]=()=>o}}},qE=(e,t)=>{const n=F3(t);e.slots.default=()=>n},VE=(e,t,n)=>{for(const i in t)(n||i!=="_")&&(e[i]=t[i])},SO=(e,t,n)=>{const i=e.slots=PE();if(e.vnode.shapeFlag&32){const r=t._;r?(VE(i,t,n),n&&nE(i,"_",r,!0)):HE(t,i)}else t&&qE(e,t)},kO=(e,t,n)=>{const{vnode:i,slots:r}=e;let s=!0,o=it;if(i.shapeFlag&32){const a=t._;a?n&&a===1?s=!1:VE(r,t,n):(s=!t.$stable,HE(t,r)),o=t}else t&&(qE(e,t),o={default:1});if(s)for(const a in r)!jE(a)&&o[a]==null&&delete r[a]},ni=BO;function AO(e){return $O(e)}function $O(e,t){const n=Hp();n.__VUE__=!0;const{insert:i,remove:r,patchProp:s,createElement:o,createText:a,createComment:u,setText:l,setElementText:c,parentNode:f,nextSibling:d,setScopeId:h=Mr,insertStaticContent:p}=e,g=(k,N,I,H=null,U=null,q=null,ie=void 0,re=null,ne=!!N.dynamicChildren)=>{if(k===N)return;k&&!ic(k,N)&&(H=dt(k),K(k,U,q,!0),k=null),N.patchFlag===-2&&(ne=!1,N.dynamicChildren=null);const{type:X,ref:be,shapeFlag:oe}=N;switch(X){case Zp:m(k,N,I,H);break;case Ba:y(k,N,I,H);break;case Q1:k==null&&v(N,I,H,ie);break;case ln:P(k,N,I,H,U,q,ie,re,ne);break;default:oe&1?_(k,N,I,H,U,q,ie,re,ne):oe&6?R(k,N,I,H,U,q,ie,re,ne):(oe&64||oe&128)&&X.process(k,N,I,H,U,q,ie,re,ne,Ee)}be!=null&&U&&a0(be,k&&k.ref,q,N||k,!N)},m=(k,N,I,H)=>{if(k==null)i(N.el=a(N.children),I,H);else{const U=N.el=k.el;N.children!==k.children&&l(U,N.children)}},y=(k,N,I,H)=>{k==null?i(N.el=u(N.children||""),I,H):N.el=k.el},v=(k,N,I,H)=>{[k.el,k.anchor]=p(k.children,N,I,H,k.el,k.anchor)},b=({el:k,anchor:N},I,H)=>{let U;for(;k&&k!==N;)U=d(k),i(k,I,H),k=U;i(N,I,H)},x=({el:k,anchor:N})=>{let I;for(;k&&k!==N;)I=d(k),r(k),k=I;r(N)},_=(k,N,I,H,U,q,ie,re,ne)=>{N.type==="svg"?ie="svg":N.type==="math"&&(ie="mathml"),k==null?E(N,I,H,U,q,ie,re,ne):$(k,N,U,q,ie,re,ne)},E=(k,N,I,H,U,q,ie,re)=>{let ne,X;const{props:be,shapeFlag:oe,transition:ye,dirs:Se}=k;if(ne=k.el=o(k.type,q,be&&be.is,be),oe&8?c(ne,k.children):oe&16&&S(k.children,ne,null,H,U,J1(k,q),ie,re),Se&&na(k,null,H,"created"),w(ne,k,k.scopeId,ie,H),be){for(const rt in be)rt!=="value"&&!Yc(rt)&&s(ne,rt,null,be[rt],q,H);"value"in be&&s(ne,"value",null,be.value,q),(X=be.onVnodeBeforeMount)&&gr(X,H,k)}Se&&na(k,null,H,"beforeMount");const Oe=MO(U,ye);Oe&&ye.beforeEnter(ne),i(ne,N,I),((X=be&&be.onVnodeMounted)||Oe||Se)&&ni(()=>{X&&gr(X,H,k),Oe&&ye.enter(ne),Se&&na(k,null,H,"mounted")},U)},w=(k,N,I,H,U)=>{if(I&&h(k,I),H)for(let q=0;q<H.length;q++)h(k,H[q]);if(U){let q=U.subTree;if(N===q||KE(q.type)&&(q.ssContent===N||q.ssFallback===N)){const ie=U.vnode;w(k,ie,ie.scopeId,ie.slotScopeIds,U.parent)}}},S=(k,N,I,H,U,q,ie,re,ne=0)=>{for(let X=ne;X<k.length;X++){const be=k[X]=re?so(k[X]):wr(k[X]);g(null,be,N,I,H,U,q,ie,re)}},$=(k,N,I,H,U,q,ie)=>{const re=N.el=k.el;let{patchFlag:ne,dynamicChildren:X,dirs:be}=N;ne|=k.patchFlag&16;const oe=k.props||it,ye=N.props||it;let Se;if(I&&ia(I,!1),(Se=ye.onVnodeBeforeUpdate)&&gr(Se,I,N,k),be&&na(N,k,I,"beforeUpdate"),I&&ia(I,!0),(oe.innerHTML&&ye.innerHTML==null||oe.textContent&&ye.textContent==null)&&c(re,""),X?F(k.dynamicChildren,X,re,I,H,J1(N,U),q):ie||D(k,N,re,null,I,H,J1(N,U),q,!1),ne>0){if(ne&16)T(re,oe,ye,I,U);else if(ne&2&&oe.class!==ye.class&&s(re,"class",null,ye.class,U),ne&4&&s(re,"style",oe.style,ye.style,U),ne&8){const Oe=N.dynamicProps;for(let rt=0;rt<Oe.length;rt++){const Ge=Oe[rt],ei=oe[Ge],jn=ye[Ge];(jn!==ei||Ge==="value")&&s(re,Ge,ei,jn,U,I)}}ne&1&&k.children!==N.children&&c(re,N.children)}else!ie&&X==null&&T(re,oe,ye,I,U);((Se=ye.onVnodeUpdated)||be)&&ni(()=>{Se&&gr(Se,I,N,k),be&&na(N,k,I,"updated")},H)},F=(k,N,I,H,U,q,ie)=>{for(let re=0;re<N.length;re++){const ne=k[re],X=N[re],be=ne.el&&(ne.type===ln||!ic(ne,X)||ne.shapeFlag&70)?f(ne.el):I;g(ne,X,be,null,H,U,q,ie,!0)}},T=(k,N,I,H,U)=>{if(N!==I){if(N!==it)for(const q in N)!Yc(q)&&!(q in I)&&s(k,q,N[q],null,U,H);for(const q in I){if(Yc(q))continue;const ie=I[q],re=N[q];ie!==re&&q!=="value"&&s(k,q,re,ie,U,H)}"value"in I&&s(k,"value",N.value,I.value,U)}},P=(k,N,I,H,U,q,ie,re,ne)=>{const X=N.el=k?k.el:a(""),be=N.anchor=k?k.anchor:a("");let{patchFlag:oe,dynamicChildren:ye,slotScopeIds:Se}=N;Se&&(re=re?re.concat(Se):Se),k==null?(i(X,I,H),i(be,I,H),S(N.children||[],I,be,U,q,ie,re,ne)):oe>0&&oe&64&&ye&&k.dynamicChildren?(F(k.dynamicChildren,ye,I,U,q,ie,re),(N.key!=null||U&&N===U.subTree)&&WE(k,N,!0)):D(k,N,I,be,U,q,ie,re,ne)},R=(k,N,I,H,U,q,ie,re,ne)=>{N.slotScopeIds=re,k==null?N.shapeFlag&512?U.ctx.activate(N,I,H,ie,ne):C(N,I,H,U,q,ie,ne):A(k,N,ne)},C=(k,N,I,H,U,q,ie)=>{const re=k.component=YO(k,H,U);if(FE(k)&&(re.ctx.renderer=Ee),ZO(re,!1,ie),re.asyncDep){if(U&&U.registerDep(re,M,ie),!k.el){const ne=re.subTree=Xi(Ba);y(null,ne,N,I)}}else M(re,k,N,I,U,q,ie)},A=(k,N,I)=>{const H=N.component=k.component;if(PO(k,N,I))if(H.asyncDep&&!H.asyncResolved){L(H,N,I);return}else H.next=N,H.update();else N.el=k.el,H.vnode=N},M=(k,N,I,H,U,q,ie)=>{const re=()=>{if(k.isMounted){let{next:oe,bu:ye,u:Se,parent:Oe,vnode:rt}=k;{const hr=GE(k);if(hr){oe&&(oe.el=rt.el,L(k,oe,ie)),hr.asyncDep.then(()=>{k.isUnmounted||re()});return}}let Ge=oe,ei;ia(k,!1),oe?(oe.el=rt.el,L(k,oe,ie)):oe=rt,ye&&W1(ye),(ei=oe.props&&oe.props.onVnodeBeforeUpdate)&&gr(ei,Oe,oe,rt),ia(k,!0);const jn=k9(k),dr=k.subTree;k.subTree=jn,g(dr,jn,f(dr.el),dt(dr),k,U,q),oe.el=jn.el,Ge===null&&zO(k,jn.el),Se&&ni(Se,U),(ei=oe.props&&oe.props.onVnodeUpdated)&&ni(()=>gr(ei,Oe,oe,rt),U)}else{let oe;const{el:ye,props:Se}=N,{bm:Oe,m:rt,parent:Ge,root:ei,type:jn}=k,dr=Kc(N);ia(k,!1),Oe&&W1(Oe),!dr&&(oe=Se&&Se.onVnodeBeforeMount)&&gr(oe,Ge,N),ia(k,!0);{ei.ce&&ei.ce._injectChildStyle(jn);const hr=k.subTree=k9(k);g(null,hr,I,H,k,U,q),N.el=hr.el}if(rt&&ni(rt,U),!dr&&(oe=Se&&Se.onVnodeMounted)){const hr=N;ni(()=>gr(oe,Ge,hr),U)}(N.shapeFlag&256||Ge&&Kc(Ge.vnode)&&Ge.vnode.shapeFlag&256)&&k.a&&ni(k.a,U),k.isMounted=!0,N=I=H=null}};k.scope.on();const ne=k.effect=new lE(re);k.scope.off();const X=k.update=ne.run.bind(ne),be=k.job=ne.runIfDirty.bind(ne);be.i=k,be.id=k.uid,ne.scheduler=()=>$3(be),ia(k,!0),X()},L=(k,N,I)=>{N.component=k;const H=k.vnode.props;k.vnode=N,k.next=null,wO(k,N.props,H,I),kO(k,N.children,I),zo(),b9(k),Bo()},D=(k,N,I,H,U,q,ie,re,ne=!1)=>{const X=k&&k.children,be=k?k.shapeFlag:0,oe=N.children,{patchFlag:ye,shapeFlag:Se}=N;if(ye>0){if(ye&128){j(X,oe,I,H,U,q,ie,re,ne);return}else if(ye&256){O(X,oe,I,H,U,q,ie,re,ne);return}}Se&8?(be&16&&Pe(X,U,q),oe!==X&&c(I,oe)):be&16?Se&16?j(X,oe,I,H,U,q,ie,re,ne):Pe(X,U,q,!0):(be&8&&c(I,""),Se&16&&S(oe,I,H,U,q,ie,re,ne))},O=(k,N,I,H,U,q,ie,re,ne)=>{k=k||Hu,N=N||Hu;const X=k.length,be=N.length,oe=Math.min(X,be);let ye;for(ye=0;ye<oe;ye++){const Se=N[ye]=ne?so(N[ye]):wr(N[ye]);g(k[ye],Se,I,null,U,q,ie,re,ne)}X>be?Pe(k,U,q,!0,!1,oe):S(N,I,H,U,q,ie,re,ne,oe)},j=(k,N,I,H,U,q,ie,re,ne)=>{let X=0;const be=N.length;let oe=k.length-1,ye=be-1;for(;X<=oe&&X<=ye;){const Se=k[X],Oe=N[X]=ne?so(N[X]):wr(N[X]);if(ic(Se,Oe))g(Se,Oe,I,null,U,q,ie,re,ne);else break;X++}for(;X<=oe&&X<=ye;){const Se=k[oe],Oe=N[ye]=ne?so(N[ye]):wr(N[ye]);if(ic(Se,Oe))g(Se,Oe,I,null,U,q,ie,re,ne);else break;oe--,ye--}if(X>oe){if(X<=ye){const Se=ye+1,Oe=Se<be?N[Se].el:H;for(;X<=ye;)g(null,N[X]=ne?so(N[X]):wr(N[X]),I,Oe,U,q,ie,re,ne),X++}}else if(X>ye)for(;X<=oe;)K(k[X],U,q,!0),X++;else{const Se=X,Oe=X,rt=new Map;for(X=Oe;X<=ye;X++){const ti=N[X]=ne?so(N[X]):wr(N[X]);ti.key!=null&&rt.set(ti.key,X)}let Ge,ei=0;const jn=ye-Oe+1;let dr=!1,hr=0;const tc=new Array(jn);for(X=0;X<jn;X++)tc[X]=0;for(X=Se;X<=oe;X++){const ti=k[X];if(ei>=jn){K(ti,U,q,!0);continue}let pr;if(ti.key!=null)pr=rt.get(ti.key);else for(Ge=Oe;Ge<=ye;Ge++)if(tc[Ge-Oe]===0&&ic(ti,N[Ge])){pr=Ge;break}pr===void 0?K(ti,U,q,!0):(tc[pr-Oe]=X+1,pr>=hr?hr=pr:dr=!0,g(ti,N[pr],I,null,U,q,ie,re,ne),ei++)}const p9=dr?TO(tc):Hu;for(Ge=p9.length-1,X=jn-1;X>=0;X--){const ti=Oe+X,pr=N[ti],g9=ti+1<be?N[ti+1].el:H;tc[X]===0?g(null,pr,I,g9,U,q,ie,re,ne):dr&&(Ge<0||X!==p9[Ge]?J(pr,I,g9,2):Ge--)}}},J=(k,N,I,H,U=null)=>{const{el:q,type:ie,transition:re,children:ne,shapeFlag:X}=k;if(X&6){J(k.component.subTree,N,I,H);return}if(X&128){k.suspense.move(N,I,H);return}if(X&64){ie.move(k,N,I,Ee);return}if(ie===ln){i(q,N,I);for(let oe=0;oe<ne.length;oe++)J(ne[oe],N,I,H);i(k.anchor,N,I);return}if(ie===Q1){b(k,N,I);return}if(H!==2&&X&1&&re)if(H===0)re.beforeEnter(q),i(q,N,I),ni(()=>re.enter(q),U);else{const{leave:oe,delayLeave:ye,afterLeave:Se}=re,Oe=()=>i(q,N,I),rt=()=>{oe(q,()=>{Oe(),Se&&Se()})};ye?ye(q,Oe,rt):rt()}else i(q,N,I)},K=(k,N,I,H=!1,U=!1)=>{const{type:q,props:ie,ref:re,children:ne,dynamicChildren:X,shapeFlag:be,patchFlag:oe,dirs:ye,cacheIndex:Se}=k;if(oe===-2&&(U=!1),re!=null&&a0(re,null,I,k,!0),Se!=null&&(N.renderCache[Se]=void 0),be&256){N.ctx.deactivate(k);return}const Oe=be&1&&ye,rt=!Kc(k);let Ge;if(rt&&(Ge=ie&&ie.onVnodeBeforeUnmount)&&gr(Ge,N,k),be&6)de(k.component,I,H);else{if(be&128){k.suspense.unmount(I,H);return}Oe&&na(k,null,N,"beforeUnmount"),be&64?k.type.remove(k,N,I,Ee,H):X&&!X.hasOnce&&(q!==ln||oe>0&&oe&64)?Pe(X,N,I,!1,!0):(q===ln&&oe&384||!U&&be&16)&&Pe(ne,N,I),H&&fe(k)}(rt&&(Ge=ie&&ie.onVnodeUnmounted)||Oe)&&ni(()=>{Ge&&gr(Ge,N,k),Oe&&na(k,null,N,"unmounted")},I)},fe=k=>{const{type:N,el:I,anchor:H,transition:U}=k;if(N===ln){we(I,H);return}if(N===Q1){x(k);return}const q=()=>{r(I),U&&!U.persisted&&U.afterLeave&&U.afterLeave()};if(k.shapeFlag&1&&U&&!U.persisted){const{leave:ie,delayLeave:re}=U,ne=()=>ie(I,q);re?re(k.el,q,ne):ne()}else q()},we=(k,N)=>{let I;for(;k!==N;)I=d(k),r(k),k=I;r(N)},de=(k,N,I)=>{const{bum:H,scope:U,job:q,subTree:ie,um:re,m:ne,a:X}=k;S9(ne),S9(X),H&&W1(H),U.stop(),q&&(q.flags|=8,K(ie,k,N,I)),re&&ni(re,N),ni(()=>{k.isUnmounted=!0},N),N&&N.pendingBranch&&!N.isUnmounted&&k.asyncDep&&!k.asyncResolved&&k.suspenseId===N.pendingId&&(N.deps--,N.deps===0&&N.resolve())},Pe=(k,N,I,H=!1,U=!1,q=0)=>{for(let ie=q;ie<k.length;ie++)K(k[ie],N,I,H,U)},dt=k=>{if(k.shapeFlag&6)return dt(k.component.subTree);if(k.shapeFlag&128)return k.suspense.next();const N=d(k.anchor||k.el),I=N&&N[KR];return I?d(I):N};let xt=!1;const se=(k,N,I)=>{k==null?N._vnode&&K(N._vnode,null,null,!0):g(N._vnode||null,k,N,null,null,null,I),N._vnode=k,xt||(xt=!0,b9(),AE(),xt=!1)},Ee={p:g,um:K,m:J,r:fe,mt:C,mc:S,pc:D,pbc:F,n:dt,o:e};return{render:se,hydrate:void 0,createApp:vO(se)}}function J1({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function ia({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function MO(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function WE(e,t,n=!1){const i=e.children,r=t.children;if(Ae(i)&&Ae(r))for(let s=0;s<i.length;s++){const o=i[s];let a=r[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[s]=so(r[s]),a.el=o.el),!n&&a.patchFlag!==-2&&WE(o,a)),a.type===Zp&&(a.el=o.el)}}function TO(e){const t=e.slice(),n=[0];let i,r,s,o,a;const u=e.length;for(i=0;i<u;i++){const l=e[i];if(l!==0){if(r=n[n.length-1],e[r]<l){t[i]=r,n.push(i);continue}for(s=0,o=n.length-1;s<o;)a=s+o>>1,e[n[a]]<l?s=a+1:o=a;l<e[n[s]]&&(s>0&&(t[i]=n[s-1]),n[s]=i)}}for(s=n.length,o=n[s-1];s-- >0;)n[s]=o,o=t[o];return n}function GE(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:GE(t)}function S9(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const FO=Symbol.for("v-scx"),LO=()=>Qc(FO);function ef(e,t,n){return YE(e,t,n)}function YE(e,t,n=it){const{immediate:i,deep:r,flush:s,once:o}=n,a=Dn({},n),u=t&&i||!t&&s!=="post";let l;if(Ef){if(s==="sync"){const h=LO();l=h.__watcherHandles||(h.__watcherHandles=[])}else if(!u){const h=()=>{};return h.stop=Mr,h.resume=Mr,h.pause=Mr,h}}const c=cn;a.call=(h,p,g)=>Or(h,c,p,g);let f=!1;s==="post"?a.scheduler=h=>{ni(h,c&&c.suspense)}:s!=="sync"&&(f=!0,a.scheduler=(h,p)=>{p?h():$3(h)}),a.augmentJob=h=>{t&&(h.flags|=4),f&&(h.flags|=2,c&&(h.id=c.uid,h.i=c))};const d=VR(e,t,a);return Ef&&(l?l.push(d):u&&d()),d}function NO(e,t,n){const i=this.proxy,r=Mt(e)?e.includes(".")?ZE(i,e):()=>i[e]:e.bind(i,i);let s;$e(t)?s=t:(s=t.handler,n=t);const o=Qf(this),a=YE(r,s.bind(i),n);return o(),a}function ZE(e,t){const n=t.split(".");return()=>{let i=e;for(let r=0;r<n.length&&i;r++)i=i[n[r]];return i}}const DO=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Co(t)}Modifiers`]||e[`${lu(t)}Modifiers`];function RO(e,t,...n){if(e.isUnmounted)return;const i=e.vnode.props||it;let r=n;const s=t.startsWith("update:"),o=s&&DO(i,t.slice(7));o&&(o.trim&&(r=n.map(c=>Mt(c)?c.trim():c)),o.number&&(r=n.map(uR)));let a,u=i[a=V1(t)]||i[a=V1(Co(t))];!u&&s&&(u=i[a=V1(lu(t))]),u&&Or(u,e,6,r);const l=i[a+"Once"];if(l){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,Or(l,e,6,r)}}function XE(e,t,n=!1){const i=t.emitsCache,r=i.get(e);if(r!==void 0)return r;const s=e.emits;let o={},a=!1;if(!$e(e)){const u=l=>{const c=XE(l,t,!0);c&&(a=!0,Dn(o,c))};!n&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}return!s&&!a?(bt(e)&&i.set(e,null),null):(Ae(s)?s.forEach(u=>o[u]=null):Dn(o,s),bt(e)&&i.set(e,o),o)}function Yp(e,t){return!e||!Bp(t)?!1:(t=t.slice(2).replace(/Once$/,""),qe(e,t[0].toLowerCase()+t.slice(1))||qe(e,lu(t))||qe(e,t))}function k9(e){const{type:t,vnode:n,proxy:i,withProxy:r,propsOptions:[s],slots:o,attrs:a,emit:u,render:l,renderCache:c,props:f,data:d,setupState:h,ctx:p,inheritAttrs:g}=e,m=o0(e);let y,v;try{if(n.shapeFlag&4){const x=r||i,_=x;y=wr(l.call(_,x,c,f,h,d,p)),v=a}else{const x=t;y=wr(x.length>1?x(f,{attrs:a,slots:o,emit:u}):x(f,null)),v=t.props?a:OO(a)}}catch(x){tf.length=0,Wp(x,e,1),y=Xi(Ba)}let b=y;if(v&&g!==!1){const x=Object.keys(v),{shapeFlag:_}=b;x.length&&_&7&&(s&&x.some(m3)&&(v=IO(v,s)),b=el(b,v,!1,!0))}return n.dirs&&(b=el(b,null,!1,!0),b.dirs=b.dirs?b.dirs.concat(n.dirs):n.dirs),n.transition&&M3(b,n.transition),y=b,o0(m),y}const OO=e=>{let t;for(const n in e)(n==="class"||n==="style"||Bp(n))&&((t||(t={}))[n]=e[n]);return t},IO=(e,t)=>{const n={};for(const i in e)(!m3(i)||!(i.slice(9)in t))&&(n[i]=e[i]);return n};function PO(e,t,n){const{props:i,children:r,component:s}=e,{props:o,children:a,patchFlag:u}=t,l=s.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&u>=0){if(u&1024)return!0;if(u&16)return i?A9(i,o,l):!!o;if(u&8){const c=t.dynamicProps;for(let f=0;f<c.length;f++){const d=c[f];if(o[d]!==i[d]&&!Yp(l,d))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?A9(i,o,l):!0:!!o;return!1}function A9(e,t,n){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(t[s]!==e[s]&&!Yp(n,s))return!0}return!1}function zO({vnode:e,parent:t},n){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=n,t=t.parent;else break}}const KE=e=>e.__isSuspense;function BO(e,t){t&&t.pendingBranch?Ae(e)?t.effects.push(...e):t.effects.push(e):YR(e)}const ln=Symbol.for("v-fgt"),Zp=Symbol.for("v-txt"),Ba=Symbol.for("v-cmt"),Q1=Symbol.for("v-stc"),tf=[];let ui=null;function nt(e=!1){tf.push(ui=e?null:[])}function UO(){tf.pop(),ui=tf[tf.length-1]||null}let wf=1;function $9(e,t=!1){wf+=e,e<0&&ui&&t&&(ui.hasOnce=!0)}function JE(e){return e.dynamicChildren=wf>0?ui||Hu:null,UO(),wf>0&&ui&&ui.push(e),e}function st(e,t,n,i,r,s){return JE(at(e,t,n,i,r,s,!0))}function jO(e,t,n,i,r){return JE(Xi(e,t,n,i,r,!0))}function QE(e){return e?e.__v_isVNode===!0:!1}function ic(e,t){return e.type===t.type&&e.key===t.key}const eC=({key:e})=>e??null,Lh=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?Mt(e)||St(e)||$e(e)?{i:ai,r:e,k:t,f:!!n}:e:null);function at(e,t=null,n=null,i=0,r=null,s=e===ln?0:1,o=!1,a=!1){const u={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&eC(t),ref:t&&Lh(t),scopeId:ME,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:ai};return a?(L3(u,n),s&128&&e.normalize(u)):n&&(u.shapeFlag|=Mt(n)?8:16),wf>0&&!o&&ui&&(u.patchFlag>0||s&6)&&u.patchFlag!==32&&ui.push(u),u}const Xi=HO;function HO(e,t=null,n=null,i=0,r=null,s=!1){if((!e||e===cO)&&(e=Ba),QE(e)){const a=el(e,t,!0);return n&&L3(a,n),wf>0&&!s&&ui&&(a.shapeFlag&6?ui[ui.indexOf(e)]=a:ui.push(a)),a.patchFlag=-2,a}if(QO(e)&&(e=e.__vccOpts),t){t=qO(t);let{class:a,style:u}=t;a&&!Mt(a)&&(t.class=xi(a)),bt(u)&&(S3(u)&&!Ae(u)&&(u=Dn({},u)),t.style=Kf(u))}const o=Mt(e)?1:KE(e)?128:JR(e)?64:bt(e)?4:$e(e)?2:0;return at(e,t,n,i,r,o,s,!0)}function qO(e){return e?S3(e)||zE(e)?Dn({},e):e:null}function el(e,t,n=!1,i=!1){const{props:r,ref:s,patchFlag:o,children:a,transition:u}=e,l=t?VO(r||{},t):r,c={__v_isVNode:!0,__v_skip:!0,type:e.type,props:l,key:l&&eC(l),ref:t&&t.ref?n&&s?Ae(s)?s.concat(Lh(t)):[s,Lh(t)]:Lh(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:a,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==ln?o===-1?16:o|16:o,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:u,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&el(e.ssContent),ssFallback:e.ssFallback&&el(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return u&&i&&M3(c,u.clone(c)),c}function tC(e=" ",t=0){return Xi(Zp,null,e,t)}function ro(e="",t=!1){return t?(nt(),jO(Ba,null,e)):Xi(Ba,null,e)}function wr(e){return e==null||typeof e=="boolean"?Xi(Ba):Ae(e)?Xi(ln,null,e.slice()):QE(e)?so(e):Xi(Zp,null,String(e))}function so(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:el(e)}function L3(e,t){let n=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(Ae(t))n=16;else if(typeof t=="object")if(i&65){const r=t.default;r&&(r._c&&(r._d=!1),L3(e,r()),r._c&&(r._d=!0));return}else{n=32;const r=t._;!r&&!zE(t)?t._ctx=ai:r===3&&ai&&(ai.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else $e(t)?(t={default:t,_ctx:ai},n=32):(t=String(t),i&64?(n=16,t=[tC(t)]):n=8);e.children=t,e.shapeFlag|=n}function VO(...e){const t={};for(let n=0;n<e.length;n++){const i=e[n];for(const r in i)if(r==="class")t.class!==i.class&&(t.class=xi([t.class,i.class]));else if(r==="style")t.style=Kf([t.style,i.style]);else if(Bp(r)){const s=t[r],o=i[r];o&&s!==o&&!(Ae(s)&&s.includes(o))&&(t[r]=s?[].concat(s,o):o)}else r!==""&&(t[r]=i[r])}return t}function gr(e,t,n,i=null){Or(e,t,7,[n,i])}const WO=OE();let GO=0;function YO(e,t,n){const i=e.type,r=(t?t.appContext:e.appContext)||WO,s={uid:GO++,vnode:e,type:i,parent:t,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new oE(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(r.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:UE(i,r),emitsOptions:XE(i,r),emit:null,emitted:null,propsDefaults:it,inheritAttrs:i.inheritAttrs,ctx:it,data:it,props:it,attrs:it,slots:it,refs:it,setupState:it,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=t?t.root:s,s.emit=RO.bind(null,s),e.ce&&e.ce(s),s}let cn=null,l0,Qy;{const e=Hp(),t=(n,i)=>{let r;return(r=e[n])||(r=e[n]=[]),r.push(i),s=>{r.length>1?r.forEach(o=>o(s)):r[0](s)}};l0=t("__VUE_INSTANCE_SETTERS__",n=>cn=n),Qy=t("__VUE_SSR_SETTERS__",n=>Ef=n)}const Qf=e=>{const t=cn;return l0(e),e.scope.on(),()=>{e.scope.off(),l0(t)}},M9=()=>{cn&&cn.scope.off(),l0(null)};function nC(e){return e.vnode.shapeFlag&4}let Ef=!1;function ZO(e,t=!1,n=!1){t&&Qy(t);const{props:i,children:r}=e.vnode,s=nC(e);_O(e,i,s,t),SO(e,r,n);const o=s?XO(e,t):void 0;return t&&Qy(!1),o}function XO(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,fO);const{setup:i}=n;if(i){zo();const r=e.setupContext=i.length>1?JO(e):null,s=Qf(e),o=Jf(i,e,0,[e.props,r]),a=Jw(o);if(Bo(),s(),(a||e.sp)&&!Kc(e)&&TE(e),a){if(o.then(M9,M9),t)return o.then(u=>{T9(e,u)}).catch(u=>{Wp(u,e,0)});e.asyncDep=o}else T9(e,o)}else iC(e)}function T9(e,t,n){$e(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:bt(t)&&(e.setupState=CE(t)),iC(e)}function iC(e,t,n){const i=e.type;e.render||(e.render=i.render||Mr);{const r=Qf(e);zo();try{dO(e)}finally{Bo(),r()}}}const KO={get(e,t){return an(e,"get",""),e[t]}};function JO(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,KO),slots:e.slots,emit:e.emit,expose:t}}function Xp(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(CE(k3(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Jc)return Jc[n](e)},has(t,n){return n in t||n in Jc}})):e.proxy}function QO(e){return $e(e)&&"__vccOpts"in e}const _i=(e,t)=>HR(e,t,Ef),eI="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let e2;const F9=typeof window<"u"&&window.trustedTypes;if(F9)try{e2=F9.createPolicy("vue",{createHTML:e=>e})}catch{}const rC=e2?e=>e2.createHTML(e):e=>e,tI="http://www.w3.org/2000/svg",nI="http://www.w3.org/1998/Math/MathML",fs=typeof document<"u"?document:null,L9=fs&&fs.createElement("template"),iI={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,i)=>{const r=t==="svg"?fs.createElementNS(tI,e):t==="mathml"?fs.createElementNS(nI,e):n?fs.createElement(e,{is:n}):fs.createElement(e);return e==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:e=>fs.createTextNode(e),createComment:e=>fs.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>fs.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,i,r,s){const o=n?n.previousSibling:t.lastChild;if(r&&(r===s||r.nextSibling))for(;t.insertBefore(r.cloneNode(!0),n),!(r===s||!(r=r.nextSibling)););else{L9.innerHTML=rC(i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e);const a=L9.content;if(i==="svg"||i==="mathml"){const u=a.firstChild;for(;u.firstChild;)a.appendChild(u.firstChild);a.removeChild(u)}t.insertBefore(a,n)}return[o?o.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},rI=Symbol("_vtc");function sI(e,t,n){const i=e[rI];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const c0=Symbol("_vod"),sC=Symbol("_vsh"),oI={beforeMount(e,{value:t},{transition:n}){e[c0]=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):rc(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:i}){!t!=!n&&(i?t?(i.beforeEnter(e),rc(e,!0),i.enter(e)):i.leave(e,()=>{rc(e,!1)}):rc(e,t))},beforeUnmount(e,{value:t}){rc(e,t)}};function rc(e,t){e.style.display=t?e[c0]:"none",e[sC]=!t}const aI=Symbol(""),uI=/(^|;)\s*display\s*:/;function lI(e,t,n){const i=e.style,r=Mt(n);let s=!1;if(n&&!r){if(t)if(Mt(t))for(const o of t.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&Nh(i,a,"")}else for(const o in t)n[o]==null&&Nh(i,o,"");for(const o in n)o==="display"&&(s=!0),Nh(i,o,n[o])}else if(r){if(t!==n){const o=i[aI];o&&(n+=";"+o),i.cssText=n,s=uI.test(n)}}else t&&e.removeAttribute("style");c0 in e&&(e[c0]=s?i.display:"",e[sC]&&(i.display="none"))}const N9=/\s*!important$/;function Nh(e,t,n){if(Ae(n))n.forEach(i=>Nh(e,t,i));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const i=cI(e,t);N9.test(n)?e.setProperty(lu(i),n.replace(N9,""),"important"):e[i]=n}}const D9=["Webkit","Moz","ms"],em={};function cI(e,t){const n=em[t];if(n)return n;let i=Co(t);if(i!=="filter"&&i in e)return em[t]=i;i=tE(i);for(let r=0;r<D9.length;r++){const s=D9[r]+i;if(s in e)return em[t]=s}return t}const R9="http://www.w3.org/1999/xlink";function O9(e,t,n,i,r,s=pR(t)){i&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(R9,t.slice(6,t.length)):e.setAttributeNS(R9,t,n):n==null||s&&!iE(n)?e.removeAttribute(t):e.setAttribute(t,s?"":Po(n)?String(n):n)}function I9(e,t,n,i,r){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?rC(n):n);return}const s=e.tagName;if(t==="value"&&s!=="PROGRESS"&&!s.includes("-")){const a=s==="OPTION"?e.getAttribute("value")||"":e.value,u=n==null?e.type==="checkbox"?"on":"":String(n);(a!==u||!("_value"in e))&&(e.value=u),n==null&&e.removeAttribute(t),e._value=n;return}let o=!1;if(n===""||n==null){const a=typeof e[t];a==="boolean"?n=iE(n):n==null&&a==="string"?(n="",o=!0):a==="number"&&(n=0,o=!0)}try{e[t]=n}catch{}o&&e.removeAttribute(r||t)}function fI(e,t,n,i){e.addEventListener(t,n,i)}function dI(e,t,n,i){e.removeEventListener(t,n,i)}const P9=Symbol("_vei");function hI(e,t,n,i,r=null){const s=e[P9]||(e[P9]={}),o=s[t];if(i&&o)o.value=i;else{const[a,u]=pI(t);if(i){const l=s[t]=yI(i,r);fI(e,a,l,u)}else o&&(dI(e,a,o,u),s[t]=void 0)}}const z9=/(?:Once|Passive|Capture)$/;function pI(e){let t;if(z9.test(e)){t={};let i;for(;i=e.match(z9);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):lu(e.slice(2)),t]}let tm=0;const gI=Promise.resolve(),mI=()=>tm||(gI.then(()=>tm=0),tm=Date.now());function yI(e,t){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;Or(vI(i,n.value),t,5,[i])};return n.value=e,n.attached=mI(),n}function vI(e,t){if(Ae(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(i=>r=>!r._stopped&&i&&i(r))}else return t}const B9=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,bI=(e,t,n,i,r,s)=>{const o=r==="svg";t==="class"?sI(e,i,o):t==="style"?lI(e,n,i):Bp(t)?m3(t)||hI(e,t,n,i,s):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):xI(e,t,i,o))?(I9(e,t,i),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&O9(e,t,i,o,s,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Mt(i))?I9(e,Co(t),i,s,t):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),O9(e,t,i,o))};function xI(e,t,n,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&B9(t)&&$e(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const r=e.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return B9(t)&&Mt(n)?!1:t in e}const _I=Dn({patchProp:bI},iI);let U9;function wI(){return U9||(U9=AO(_I))}const EI=(...e)=>{const t=wI().createApp(...e),{mount:n}=t;return t.mount=i=>{const r=SI(i);if(!r)return;const s=t._component;!$e(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=n(r,!1,CI(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},t};function CI(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function SI(e){return Mt(e)?document.querySelector(e):e}const kI={东南门:[1183.7055921052631,680.2209429824561],智能学院:[964.0520833333333,543.3876096491229],健身中心:[654.3766447368421,494.7757675438596]},AI={中关村北大街:[[1169.3020833333335,392.60087719298247],[1227.3662280701756,1205.9490131578946]],教学楼南侧道路:[[581.4588815789474,1001.5992324561404],[896.0855263157895,982.2445175438596]],教学楼东侧道路:[[874.030153508772,680.2209429824561],[887.0833333333333,869.2669956140351],[895.6354166666667,982.6946271929825],[904.1875,1052.4616228070176],[919.9413377192982,1180.7428728070176]],理科二号楼东侧道路:[[1078.3799342105262,679.3207236842105],[1072.9786184210525,594.7001096491229],[1063.5263157894738,434.9111842105263],[1061.2757675438597,390.35032894736844]],理科二号楼门前道路:[[993.7593201754386,676.6200657894738],[988.8081140350878,602.3519736842105],[1072.9786184210525,594.7001096491229]],英杰交流中心门前道路:[[771.8552631578948,686.0723684210527],[767.8042763157895,578.9462719298245],[771.8552631578948,573.9950657894736],[858.7264254385965,572.1946271929825],[874.030153508772,679.3207236842105]],东南门里侧道路:[[1190.4572368421054,683.3717105263158],[1078.3799342105262,679.7708333333333],[993.7593201754386,676.6200657894738],[874.030153508772,679.3207236842105],[771.8552631578948,686.0723684210527],[619.718201754386,695.9747807017544]].reverse(),教学楼西侧道路:[[602.1639254385965,398.90241228070175],[608.4654605263158,499.7269736842105],[613.4166666666666,593.7998903508771],[620.1683114035088,696.4248903508771],[624.6694078947369,815.2538377192982],[627.8201754385965,916.5285087719299],[619.2680921052631,925.0805921052631],[577.8580043859649,926.8810307017544],[581.4588815789474,1001.5992324561404]].reverse(),邱德拔体育馆东侧道路:[[1103.1359649122805,680.671052631579],[1110.3377192982457,846.7615131578948],[1118.889802631579,862.0652412280701],[1119.7900219298244,903.4753289473684],[1139.594846491228,1149.235197368421],[1126.9917763157896,1158.6875]],邱德拔体育馆南侧道路:[[919.9413377192982,1179.842653508772],[1127.4418859649122,1158.6875]],邱德拔体育馆北侧道路:[[904.6376096491229,1051.561403508772],[963.1518640350878,1046.1600877192982],[970.3536184210527,1031.7565789473683],[981.6063596491229,911.577302631579],[986.1074561403509,913.3777412280701],[1119.7900219298244,903.0252192982456]],理科五号楼南侧道路:[[887.0833333333333,867.4665570175439],[975.7549342105262,863.4155701754386],[1073.8788377192982,853.5131578947369],[1110.3377192982457,846.7615131578948]]},$I={邱德拔体育馆:[[924.4424342105262,1154.186403508772],[921.7417763157895,1064.1644736842104],[982.0564692982456,1061.4638157894738],[978.4555921052631,961.0893640350877],[991.5087719298245,954.3377192982456],[991.5087719298245,922.3799342105264],[1109.8876096491229,917.8788377192982],[1112.1381578947369,948.936403508772],[1127.4418859649122,957.4884868421053],[1133.7434210526317,1158.6875],[932.9945175438597,1167.2395833333335],[932.9945175438597,1154.186403508772],[924.4424342105262,1154.186403508772]],治贝子园:[[953.249451754386,894.9232456140351],[909.5888157894738,898.0740131578948],[915.890350877193,984.9451754385965],[956.4002192982456,982.6946271929825],[953.249451754386,894.9232456140351]],理科五号楼:[[914.5400219298245,734.6842105263158],[914.5400219298245,722.53125],[1009.5131578947369,717.1299342105262],[1010.4133771929825,729.7330043859649],[1023.016447368421,729.2828947368421],[1026.1672149122808,825.15625],[1013.5641447368421,825.15625],[1013.5641447368421,836.859100877193],[919.0411184210527,840.4599780701755],[919.0411184210527,829.2072368421052],[905.0877192982456,830.1074561403509],[901.936951754386,736.484649122807],[914.5400219298245,734.6842105263158]],理科一号楼:[[722.7933114035088,421.4078947368421],[722.7933114035088,410.15515350877195],[631.421052631579,414.2061403508772],[631.421052631579,429.0597587719298],[622.8689692982456,430.41008771929825],[626.9199561403509,525.8333333333334],[620.1683114035088,527.6337719298245],[623.7691885964912,619.4561403508771],[631.421052631579,618.1058114035088],[632.3212719298245,636.5603070175439],[732.2456140350878,631.609100877193],[732.2456140350878,622.156798245614],[738.547149122807,622.156798245614],[734.4961622807018,532.5849780701755],[742.1480263157895,532.5849780701755],[736.7467105263158,419.6074561403509],[722.7933114035088,421.4078947368421]],理科二号楼:[[875.3804824561403,550.1392543859649],[875.3804824561403,449.3146929824561],[897.8859649122808,447.9643640350877],[897.8859649122808,438.51206140350877],[984.3070175438597,437.6118421052632],[984.3070175438597,452.9155701754386],[997.360197368421,452.9155701754386],[998.7105263157895,552.389802631579],[982.5065789473684,553.2900219298245],[982.5065789473684,564.5427631578948],[891.5844298245614,563.6425438596491],[890.6842105263158,548.7889254385965],[875.3804824561403,550.1392543859649]],英杰交流中心:[[875.3804824561403,553.2900219298245],[735.8464912280701,562.7423245614035],[734.046052631579,532.5849780701755],[742.5981359649122,532.5849780701755],[735.8464912280701,416.00657894736844],[876.7308114035088,411.5054824561403],[875.3804824561403,553.2900219298245]],第二教学楼:[[638.172697368421,932.7324561403509],[631.421052631579,731.983552631579],[855.125548245614,724.781798245614],[857.8262061403509,785.9967105263158],[707.4895833333334,790.4978070175439],[711.5405701754386,930.9320175438596],[638.172697368421,932.7324561403509]],第四教学楼:[[832.6200657894738,849.4621710526316],[871.3294956140351,848.1118421052631],[873.1299342105262,910.6770833333334],[834.8706140350878,912.9276315789474],[832.6200657894738,849.4621710526316]],第三教学楼:[[755.2012061403509,966.4906798245614],[753.4007675438596,917.4287280701755],[873.1299342105262,910.6770833333334],[876.280701754386,961.0893640350877],[755.2012061403509,966.4906798245614]]},nm={pointCoordinates:kI,pathCoordinates:AI,areaCoordinates:$I},sc={城墙:[{id:"Vector_280",d:"M96 1031C95.9889 1018.11 96 304.658 96 296H926L926 1076H872.5V1137.5H783V1031H96Z",stroke:"black","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",tag:"path"},{id:"大明宫",d:"M641 53H750.5M641 53V296H808V187.554H775L750.5 53M641 53V38.5H750.5V53",stroke:"black","stroke-width":"2",tag:"path"},{id:"西内苑",d:"M394 226H641V296H394V226Z",stroke:"black","stroke-width":"2",tag:"path"},{id:"太极宫",stroke:"black","stroke-width":"2",d:"M 394,296 L 630,296 L 630,418 L 394,418 Z",tag:"path"},{id:"东宫",stroke:"black","stroke-width":"2",d:"M 578,310 L 624,310 L 624,403 L 578,403 Z",tag:"path"},{id:"掖庭宫",stroke:"black","stroke-width":"2",d:"M 401,310 L 454,310 L 454,403 L 401,403 Z",tag:"path"},{id:"Vector_281",d:"M519 150V226H641V150H519Z",stroke:"black","stroke-width":"2",tag:"path"},{id:"监作将",stroke:"black","stroke-width":"2",d:"M 402,464 L 448,464 L 448,503 L 402,503 Z",tag:"path"},{id:"Rectangle 58",stroke:"black","stroke-width":"2",d:"M 459,464 L 505,464 L 505,503 L 459,503 Z",tag:"path"},{id:"尚书省",stroke:"black","stroke-width":"2",d:"M 515,465 L 564,465 L 564,503 L 515,503 Z",tag:"path"},{id:"Rectangle 60",stroke:"black","stroke-width":"2",d:"M 573,465 L 619,465 L 619,503 L 573,503 Z",tag:"path"},{id:"太廊",stroke:"black","stroke-width":"2",d:"M 573,512 L 619,512 L 619,573 L 573,573 Z",tag:"path"},{id:"太常寺",stroke:"black","stroke-width":"2",d:"M 515,512 L 564,512 L 564,573 L 515,573 Z",tag:"path"},{id:"Rectangle 63",stroke:"black","stroke-width":"2",d:"M 459,512 L 505,512 L 505,573 L 459,573 Z",tag:"path"},{id:"大社",stroke:"black","stroke-width":"2",d:"M 402,512 L 448,512 L 448,573 L 402,573 Z",tag:"path"},{id:"皇城",stroke:"black","stroke-width":"2",d:"M 394,418 L 630,418 L 630,579 L 394,579 Z",tag:"path"}],道路:[{id:"Rectangle 78",fill:"#D9D9D9",d:"M 195,299 L 207,299 L 207,1025 L 195,1025 Z",tag:"path"},{id:"Rectangle 109",fill:"#D9D9D9",d:"M 97,297 L 111,297 L 111,1030 L 97,1030 Z",tag:"path"},{id:"Rectangle 79",fill:"#D9D9D9",d:"M 111,363 L 381,363 L 381,370 L 111,370 Z",tag:"path"},{id:"Rectangle 110",fill:"#D9D9D9",d:"M 97,297 L 393,297 L 393,307 L 97,307 Z",tag:"path"},{id:"Rectangle 111",fill:"#D9D9D9",d:"M 97,1025 L 805,1025 L 805,1030 L 97,1030 Z",tag:"path"},{id:"Rectangle 81",fill:"#D9D9D9",d:"M 100,419 L 393,419 L 393,429 L 100,429 Z",tag:"path"},{id:"Rectangle 82",fill:"#D9D9D9",d:"M 111,504 L 393,504 L 393,511 L 111,511 Z",tag:"path"},{id:"Rectangle 83",fill:"#D9D9D9",d:"M 100,580 L 921,580 L 921,590 L 100,590 Z",tag:"path"},{id:"Rectangle 103",fill:"#D9D9D9",d:"M 631,419 L 921,419 L 921,429 L 631,429 Z",tag:"path"},{id:"Rectangle 104",fill:"#D9D9D9",d:"M 631,504 L 817,504 L 817,511 L 631,511 Z",tag:"path"},{id:"Rectangle 105",fill:"#D9D9D9",d:"M 631,360 L 917,360 L 917,367 L 631,367 Z",tag:"path"},{id:"Rectangle 113",fill:"#D9D9D9",d:"M 631,297 L 925,297 L 925,307 L 631,307 Z",tag:"path"},{id:"Rectangle 106",fill:"#D9D9D9",d:"M 826,482 L 917,482 L 917,489 L 826,489 Z",tag:"path"},{id:"Rectangle 107",fill:"#D9D9D9",d:"M 826,635 L 917,635 L 917,642 L 826,642 Z",tag:"path"},{id:"Rectangle 84",fill:"#D9D9D9",d:"M 111,681 L 917,681 L 917,688 L 111,688 Z",tag:"path"},{id:"Rectangle 87",fill:"#D9D9D9",d:"M 111,733 L 917,733 L 917,740 L 111,740 Z",tag:"path"},{id:"Rectangle 88",fill:"#D9D9D9",d:"M 100,781 L 920,781 L 920,791 L 100,791 Z",tag:"path"},{id:"Rectangle 89",fill:"#D9D9D9",d:"M 111,833 L 917,833 L 917,840 L 111,840 Z",tag:"path"},{id:"Rectangle 90",fill:"#D9D9D9",d:"M 111,877 L 917,877 L 917,883 L 111,883 Z",tag:"path"},{id:"Rectangle 91",fill:"#D9D9D9",d:"M 111,928 L 917,928 L 917,935 L 111,935 Z",tag:"path"},{id:"Rectangle 92",fill:"#D9D9D9",d:"M 111,972 L 917,972 L 917,979 L 111,979 Z",tag:"path"},{id:"Rectangle 85",fill:"#D9D9D9",d:"M 111,636 L 195,636 L 195,640.06137 L 111,640.06137 Z",tag:"path"},{id:"Rectangle 86",fill:"#D9D9D9",d:"M 298,635 L 381,635 L 381,640.07671 L 298,640.07671 Z",tag:"path"},{id:"Rectangle 100",fill:"#D9D9D9",d:"M 393,635 L 722,635 L 722,639 L 393,639 Z",tag:"path"},{id:"Rectangle 80",fill:"#D9D9D9",d:"M 291,299 L 298,299 L 298,1025 L 291,1025 Z",tag:"path"},{id:"Rectangle 93",fill:"#D9D9D9",d:"M 381,299 L 393,299 L 393,1027 L 381,1027 Z",tag:"path"},{id:"Rectangle 94",fill:"#D9D9D9",d:"M 450,590 L 457,590 L 457,1025 L 450,1025 Z",tag:"path"},{id:"Rectangle 95",fill:"#D9D9D9",d:"M 506,590 L 516,590 L 516,1025 L 506,1025 Z",tag:"path"},{id:"Rectangle 96",fill:"#D9D9D9",d:"M 565,589 L 572,589 L 572,1025 L 565,1025 Z",tag:"path"},{id:"Rectangle 101",fill:"#D9D9D9",d:"M 817,307 L 826,307 L 826,979 L 817,979 Z",tag:"path"},{id:"Rectangle 112",fill:"#D9D9D9",d:"M 917,297 L 925,297 L 925,1075 L 917,1075 Z",tag:"path"},{id:"Rectangle 97",fill:"#D9D9D9",d:"M 631,307 L 638,307 L 638,1027 L 631,1027 Z",tag:"path"},{id:"Rectangle 98",fill:"#D9D9D9",d:"M 722,307 L 733,307 L 733,1025 L 722,1025 Z",tag:"path"},{id:"Rectangle 114",fill:"#D9D9D9",d:"M 794,979 L 805,979 L 805,1030 L 794,1030 Z",tag:"path"},{id:"Rectangle 108",fill:"#D9D9D9",d:"M 690,307 L 701,307 L 701,419 L 690,419 Z",tag:"path"},{id:"Rectangle 101_2",fill:"#D9D9D9",d:"M 450,589 L 457,589 L 457,1025 L 450,1025 Z",tag:"path"},{id:"朱雀大街",fill:"#D9D9D9",d:"M 506,580 L 516,580 L 516,1030 L 506,1030 Z",tag:"path"}],城门:[{id:"开远门",fill:"black",d:"M 91,415 L 100,415 L 100,434 L 91,434 Z",tag:"path"},{id:"广连门",transform:"rotate(-90 443 421)",fill:"black",d:"M 443,421 L 443,414 L 460,414 L 460,421 Z",tag:"path"},{id:"含光门",transform:"rotate(90 457 576)",fill:"black",d:"M 457,576 L 457,582 L 450,582 L 450,576 Z",tag:"path"},{id:"朱雀门",transform:"rotate(-90 507 582)",fill:"black",d:"M 507,582 L 507,576 L 514,576 L 514,582 Z",tag:"path"},{id:"安上门",d:"M565 582V576H572V582H565Z",fill:"black",tag:"path"},{id:"嘉𨠫门",d:"M450.5 347H457.5V361H450.5V347Z",fill:"black",tag:"path"},{id:"玄武门",transform:"rotate(-90 458 299)",fill:"black",d:"M 458,299 L 458,292 L 475,292 L 475,299 Z",tag:"path"},{id:"玄武门",transform:"rotate(-90 687 57)",fill:"black",d:"M 687,57 L 687,50 L 704,50 L 704,57 Z",tag:"path"},{id:"银汉门",transform:"rotate(-90 720 57)",fill:"black",d:"M 720,57 L 720,50 L 737,50 L 737,57 Z",tag:"path"},{id:"青霄门",transform:"rotate(-90 656 57)",fill:"black",d:"M 656,57 L 656,50 L 673,50 L 673,57 Z",tag:"path"},{id:"重玄门",transform:"rotate(-90 687 42)",fill:"black",d:"M 687,42 L 687,35 L 704,35 L 704,42 Z",tag:"path"},{id:"玄福门",transform:"rotate(-90 598 299)",fill:"black",d:"M 598,299 L 598,292 L 615,292 L 615,299 Z",tag:"path"},{id:"建福门",transform:"rotate(-90 653 299)",fill:"black",d:"M 653,299 L 653,292 L 670,292 L 670,299 Z",tag:"path"},{id:"丹凤门",transform:"rotate(-90 691 299)",fill:"black",d:"M 691,299 L 691,292 L 699,292 L 699,299 Z",tag:"path"},{id:"兴安门",transform:"rotate(-90 632.5 299)",fill:"black",d:"M 632.5,299 L 632.5,292 L 636.5,292 L 636.5,299 Z",tag:"path"},{id:"芳林门",transform:"rotate(-90 383 299)",fill:"black",d:"M 383,299 L 383,292 L 391,292 L 391,299 Z",tag:"path"},{id:"景曜门",transform:"rotate(-90 286 299)",fill:"black",d:"M 286,299 L 286,292 L 303,292 L 303,299 Z",tag:"path"},{id:"光化门",transform:"rotate(-90 193 299)",fill:"black",d:"M 193,299 L 193,292 L 210,292 L 210,299 Z",tag:"path"},{id:"长乐门",transform:"rotate(-90 555 421)",fill:"black",d:"M 555,421 L 555,414 L 572,414 L 572,421 Z",tag:"path"},{id:"嘉福门",transform:"rotate(-90 594 421)",fill:"black",d:"M 594,421 L 594,414 L 611,414 L 611,421 Z",tag:"path"},{id:"承天门",transform:"rotate(-90 502 421)",fill:"black",d:"M 502,421 L 502,414 L 519,414 L 519,421 Z",tag:"path"},{id:"顺义门",fill:"black",d:"M 390.5,504 L 397.5,504 L 397.5,511 L 390.5,511 Z",tag:"path"},{id:"景风门",fill:"black",d:"M 626.5,504 L 633.5,504 L 633.5,511 L 626.5,511 Z",tag:"path"},{id:"延禧门",fill:"black",d:"M 626.5,421 L 633.5,421 L 633.5,428 L 626.5,428 Z",tag:"path"},{id:"开远门",fill:"black",d:"M 390.5,421 L 397.5,421 L 397.5,428 L 390.5,428 Z",tag:"path"},{id:"金光门",fill:"black",d:"M 91,575 L 100,575 L 100,594 L 91,594 Z",tag:"path"},{id:"延平门",fill:"black",d:"M 91,777 L 100,777 L 100,796 L 91,796 Z",tag:"path"},{id:"明德门",transform:"rotate(90 521.007 1027.01)",fill:"black",d:"M 521.007,1027.01 L 521.007,1036.01 L 502.007,1036.01 L 502.007,1027.01 Z",tag:"path"},{id:"咎夏门",transform:"rotate(90 644 1027)",fill:"black",d:"M 644,1027 L 644,1036 L 625,1036 L 625,1027 Z",tag:"path"},{id:"延兴门",fill:"black",d:"M 920,773 L 929,773 L 929,792 L 920,792 Z",tag:"path"},{id:"春明门",fill:"black",d:"M 921,576 L 930,576 L 930,595 L 921,595 Z",tag:"path"},{id:"通化门",fill:"black",d:"M 921,415 L 930,415 L 930,434 L 921,434 Z",tag:"path"},{id:"九仙门",fill:"black",d:"M 637.5,87 L 644.5,87 L 644.5,101 L 637.5,101 Z",tag:"path"},{id:"右银台门",fill:"black",d:"M 637,140 L 644,140 L 644,149 L 637,149 Z",tag:"path"},{id:"左银台门",fill:"black",d:"M 761,124 L 768,124 L 768,133 L 761,133 Z",tag:"path"},{id:"安化门",transform:"rotate(90 397 1027)",fill:"black",d:"M 397,1027 L 397,1036 L 378,1036 L 378,1027 Z",tag:"path"}],城坊:JSON.parse('[{"id":"普宁","d":"M194 371H112V418H194V371Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"修德","d":"M380 308H299V362H380V308Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"安定","d":"M290 308H208V362H290V308Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"修真","d":"M194 308H112V362H194V308Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"休祥","d":"M290 371H208V418H290V371Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"义宁","d":"M194 430H112V503H194V430Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"金城","d":"M290 430H208V503H290V430Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"颁政","d":"M380 430H299V503H380V430Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"醴泉","d":"M290 512H208V579H290V512Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"居德","d":"M194 512H112V579H194V512Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"崇化","d":"M194 689H112V732H194V689Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"怀远","d":"M290 689H208V732H290V689Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"延康","d":"M380 689H299V732H380V689Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"豐邑","d":"M194 741H112V780H194V741Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"长寿","d":"M290 741H208V780H290V741Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"崇贤","d":"M380 741H299V780H380V741Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"待贤","d":"M194 792H112V832H194V792Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"嘉会","d":"M290 792H208V832H290V792Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"延福","d":"M380 792H299V832H380V792Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"延寿","d":"M380 591H299V634H380V591Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"光德","d":"M380 641H299V680H380V641Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"群贤","d":"M194 591H112V635H194V591Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"怀德","d":"M194 641H112V680H194V641Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"西市","d":"M290 591H208V680H290V591Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"辅兴","d":"M380 371H299V418H380V371Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"布政","d":"M380 512H299V579H380V512Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"和平","d":"M194 936H112V971H194V936Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"永阳","d":"M194 980H112V1024H194V980Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"歸義","d":"M290 936H208V971H290V936Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"大通","d":"M380 936H299V971H380V936Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"大安","d":"M380 980H299V1024H380V980Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"太平","d":"M394 634V591H449V634H394Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"通义","d":"M449 640H394V680H449V640Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"兴化","d":"M449 689H394V732H449V689Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"崇德","d":"M449 741H394V780H449V741Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"怀贞","d":"M449 792H394V832H449V792Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"宣义","d":"M449 841H394V876H449V841Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"兴安","d":"M449 884H394V927H449V884Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"昌明","d":"M449 936H394V971H449V936Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"安乐","d":"M449 980H394V1024H449V980Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"兴禄","d":"M505 591H458V634H505V591Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"殖业","d":"M505 640H458V680H505V640Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"兴乐","d":"M505 689H458V732H505V689Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"安业","d":"M505 741H458V780H505V741Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"崇业","d":"M505 792H458V832H505V792Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"永达","d":"M505 841H458V876H505V841Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"道德","d":"M505 884H458V927H505V884Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"光行","d":"M505 936H458V971H505V936Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"延祚","d":"M505 980H458V1024H505V980Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"兴道","d":"M564 591H517V634H564V591Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"开化","d":"M564 640H517V680H564V640Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"安仁","stroke":"black","stroke-width":"2","d":"M 517,689 L 564,689 L 564,732 L 517,732 Z","tag":"path"},{"id":"光福","stroke":"black","stroke-width":"2","d":"M 517,741 L 564,741 L 564,780 L 517,780 Z","tag":"path"},{"id":"靖善","stroke":"black","stroke-width":"2","d":"M 517,792 L 564,792 L 564,832 L 517,832 Z","tag":"path"},{"id":"蘭陵","stroke":"black","stroke-width":"2","d":"M 517,841 L 564,841 L 564,876 L 517,876 Z","tag":"path"},{"id":"开明","stroke":"black","stroke-width":"2","d":"M 517,884 L 564,884 L 564,927 L 517,927 Z","tag":"path"},{"id":"保宁","stroke":"black","stroke-width":"2","d":"M 517,936 L 564,936 L 564,971 L 517,971 Z","tag":"path"},{"id":"安仪","stroke":"black","stroke-width":"2","d":"M 517,980 L 564,980 L 564,1024 L 517,1024 Z","tag":"path"},{"id":"安德","stroke":"black","stroke-width":"2","d":"M 573,980 L 630,980 L 630,1024 L 573,1024 Z","tag":"path"},{"id":"昌乐","stroke":"black","stroke-width":"2","d":"M 573,936 L 630,936 L 630,971 L 573,971 Z","tag":"path"},{"id":"大业","stroke":"black","stroke-width":"2","d":"M 573,884 L 630,884 L 630,927 L 573,927 Z","tag":"path"},{"id":"安善","stroke":"black","stroke-width":"2","d":"M 573,841 L 630,841 L 630,876 L 573,876 Z","tag":"path"},{"id":"靖安","stroke":"black","stroke-width":"2","d":"M 573,792 L 630,792 L 630,832 L 573,832 Z","tag":"path"},{"id":"永乐","stroke":"black","stroke-width":"2","d":"M 573,741 L 630,741 L 630,780 L 573,780 Z","tag":"path"},{"id":"长乐","stroke":"black","stroke-width":"2","d":"M 573,689 L 630,689 L 630,732 L 573,732 Z","tag":"path"},{"id":"崇义","stroke":"black","stroke-width":"2","d":"M 573,640 L 630,640 L 630,680 L 573,680 Z","tag":"path"},{"id":"务本","stroke":"black","stroke-width":"2","d":"M 573,591 L 630,591 L 630,634 L 573,634 Z","tag":"path"},{"id":"平康","stroke":"black","stroke-width":"2","d":"M 639,591 L 721,591 L 721,634 L 639,634 Z","tag":"path"},{"id":"宣阳","stroke":"black","stroke-width":"2","d":"M 639,640 L 721,640 L 721,680 L 639,680 Z","tag":"path"},{"id":"亲仁","stroke":"black","stroke-width":"2","d":"M 639,689 L 721,689 L 721,732 L 639,732 Z","tag":"path"},{"id":"永宁","stroke":"black","stroke-width":"2","d":"M 639,741 L 721,741 L 721,780 L 639,780 Z","tag":"path"},{"id":"永崇","stroke":"black","stroke-width":"2","d":"M 639,792 L 721,792 L 721,832 L 639,832 Z","tag":"path"},{"id":"昭国","stroke":"black","stroke-width":"2","d":"M 639,841 L 721,841 L 721,876 L 639,876 Z","tag":"path"},{"id":"昌","stroke":"black","stroke-width":"2","d":"M 639,884 L 721,884 L 721,927 L 639,927 Z","tag":"path"},{"id":"通善","stroke":"black","stroke-width":"2","d":"M 639,936 L 721,936 L 721,971 L 639,971 Z","tag":"path"},{"id":"通济","stroke":"black","stroke-width":"2","d":"M 639,980 L 721,980 L 721,1024 L 639,1024 Z","tag":"path"},{"id":"曲池","stroke":"black","stroke-width":"2","d":"M 734,980 L 793,980 L 793,1024 L 734,1024 Z","tag":"path"},{"id":"青龙","stroke":"black","stroke-width":"2","d":"M 734,936 L 816,936 L 816,971 L 734,971 Z","tag":"path"},{"id":"未知","stroke":"black","stroke-width":"2","d":"M 827,936 L 916,936 L 916,971 L 827,971 Z","tag":"path"},{"id":"修政","stroke":"black","stroke-width":"2","d":"M 734,884 L 816,884 L 816,927 L 734,927 Z","tag":"path"},{"id":"修行","stroke":"black","stroke-width":"2","d":"M 734,841 L 816,841 L 816,876 L 734,876 Z","tag":"path"},{"id":"昇升","stroke":"black","stroke-width":"2","d":"M 734,792 L 816,792 L 816,832 L 734,832 Z","tag":"path"},{"id":"宣平","stroke":"black","stroke-width":"2","d":"M 734,741 L 816,741 L 816,780 L 734,780 Z","tag":"path"},{"id":"安邑","stroke":"black","stroke-width":"2","d":"M 734,689 L 816,689 L 816,732 L 734,732 Z","tag":"path"},{"id":"东市","stroke":"black","stroke-width":"2","d":"M 734,591 L 816,591 L 816,680 L 734,680 Z","tag":"path"},{"id":"崇仁","stroke":"black","stroke-width":"2","d":"M 639,512 L 721,512 L 721,579 L 639,579 Z","tag":"path"},{"id":"永兴","stroke":"black","stroke-width":"2","d":"M 639,430 L 721,430 L 721,503 L 639,503 Z","tag":"path"},{"id":"光宅","stroke":"black","stroke-width":"2","d":"M 639,308 L 689,308 L 689,359 L 639,359 Z","tag":"path"},{"id":"永昌","stroke":"black","stroke-width":"2","d":"M 639,368 L 689,368 L 689,418 L 639,418 Z","tag":"path"},{"id":"来庭","stroke":"black","stroke-width":"2","d":"M 702,368 L 721,368 L 721,418 L 702,418 Z","tag":"path"},{"id":"翊善","stroke":"black","stroke-width":"2","d":"M 702,308 L 721,308 L 721,359 L 702,359 Z","tag":"path"},{"id":"长乐","stroke":"black","stroke-width":"2","d":"M 734,308 L 816,308 L 816,359 L 734,359 Z","tag":"path"},{"id":"大宁","stroke":"black","stroke-width":"2","d":"M 734,368 L 816,368 L 816,418 L 734,418 Z","tag":"path"},{"id":"兴宁","stroke":"black","stroke-width":"2","d":"M 827,368 L 916,368 L 916,418 L 827,418 Z","tag":"path"},{"id":"入苑","stroke":"black","stroke-width":"2","d":"M 827,308 L 916,308 L 916,359 L 827,359 Z","tag":"path"},{"id":"安兴","stroke":"black","stroke-width":"2","d":"M 734,430 L 816,430 L 816,503 L 734,503 Z","tag":"path"},{"id":"永嘉","stroke":"black","stroke-width":"2","d":"M 827,430 L 916,430 L 916,481 L 827,481 Z","tag":"path"},{"id":"胜业","stroke":"black","stroke-width":"2","d":"M 734,512 L 816,512 L 816,579 L 734,579 Z","tag":"path"},{"id":"兴庆宫","stroke":"black","stroke-width":"2","d":"M 827,490 L 916,490 L 916,579 L 827,579 Z","tag":"path"},{"id":"芙蓉园","d":"M806 1031V980H916V1076H872.5V1138H783V1031H806Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"道政","stroke":"black","stroke-width":"2","d":"M 827,591 L 916,591 L 916,634 L 827,634 Z","tag":"path"},{"id":"常乐","stroke":"black","stroke-width":"2","d":"M 827,643 L 916,643 L 916,680 L 827,680 Z","tag":"path"},{"id":"靖恭","stroke":"black","stroke-width":"2","d":"M 827,689 L 916,689 L 916,732 L 827,732 Z","tag":"path"},{"id":"新昌","stroke":"black","stroke-width":"2","d":"M 827,741 L 916,741 L 916,780 L 827,780 Z","tag":"path"},{"id":"昇道","stroke":"black","stroke-width":"2","d":"M 827,792 L 916,792 L 916,832 L 827,832 Z","tag":"path"},{"id":"立政","stroke":"black","stroke-width":"2","d":"M 827,841 L 916,841 L 916,876 L 827,876 Z","tag":"path"},{"id":"敦化","stroke":"black","stroke-width":"2","d":"M 827,884 L 916,884 L 916,927 L 827,927 Z","tag":"path"},{"id":"昭行","d":"M290 980H208V1024H290V980Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"敦義","d":"M380 884H299V927H380V884Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"永和","d":"M194 841H112V876H194V841Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"永平","d":"M290 841H208V876H290V841Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"永安","d":"M380 841H299V876H380V841Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"常安","d":"M194 884H112V927H194V884Z","stroke":"black","stroke-width":"2","tag":"path"},{"id":"通轨","d":"M290 884H208V927H290V884Z","stroke":"black","stroke-width":"2","tag":"path"}]'),水系:JSON.parse('[{"id":"曲江池","d":"M810.369 1031.29C811.567 1035.74 811.876 1040.33 811.487 1044.86C811.141 1048.89 811.471 1052.92 810.795 1056.96C810.291 1059.98 809.626 1062.97 809.099 1065.98C807.995 1072.29 806.602 1078.58 807.107 1085C807.757 1093.27 812.625 1099.27 818.507 1104.63C822.839 1108.57 826.725 1112.88 829.398 1118.19C831.116 1121.6 833.988 1123.07 837.829 1123.06C841.171 1123.05 844.495 1122.94 847.784 1122.4C852.527 1121.62 854.195 1117.78 855.572 1113.95C856.478 1111.42 857.138 1108.86 859.57 1107.35C860.602 1106.72 860.495 1105.82 860.452 1104.92C860.028 1096.02 859.65 1087.17 857.885 1078.34C855.478 1066.29 851.417 1055.01 845.025 1044.59C842.102 1039.83 839.737 1034.79 838.572 1029.45C837.263 1023.44 836.799 1017.22 836.39 1011.07C836.053 1005.99 835.009 1001.03 833.432 996.343C831.999 992.08 828.528 988.856 823.938 987.569C818.547 986.057 815.408 987.524 813.101 992.37C811.201 996.361 810.492 1000.62 810.334 1005.03C810.078 1012.19 809.825 1019.33 810.644 1026.46C810.816 1027.96 810.792 1029.52 810.218 1030.99","stroke":"#3E76F1","stroke-width":"3.01758","stroke-linecap":"round","stroke-linejoin":"round","tag":"path"},{"id":"永安渠","d":"M310.244 308.134C310.253 312.781 309.469 317.43 309.518 322.013C309.58 327.789 308.901 333.48 308.736 339.215C308.535 346.256 307.772 353.281 308.132 360.338M305.114 428.837C305.114 434.671 304.821 440.523 305.174 446.335C305.965 459.406 305.511 472.522 306.871 485.573C307.487 491.475 307.528 497.437 307.83 503.371M305 633C305.722 630 305.977 628.011 306.222 625.509C307.103 616.519 308.438 607.585 309.199 598.572C310 589.087 309.611 579.557 310.863 570.104C311.471 565.514 309.845 560.954 310.263 556.331C310.307 555.844 310.244 555.196 309.946 554.858C308.301 552.995 309.136 551.042 309.706 549.157C309.985 548.235 310.063 547.409 310.015 546.448C309.633 538.665 309.548 530.863 308.972 523.096C308.654 518.803 308.768 513.696 308.121 510.213C307.475 506.729 307.833 506.977 307.833 504M307.83 360.941C307.167 366.858 307.063 372.799 306.881 378.744C306.667 385.69 306.003 392.622 305.755 399.568C305.565 404.892 305.729 410.229 305.714 415.56C305.704 418.889 305.876 422.223 305.157 425.527C304.973 426.37 305.315 427.328 305.416 428.233M316.883 268C315.887 270.3 313.891 271.925 312.703 274.06C311.322 276.542 311.319 279.364 311.033 282.171C310.602 286.396 310.203 290.618 309.942 294.856M310.546 295.762C310.445 299.685 310.345 303.607 310.244 307.53M302.974 779.432C302.985 779.36 302.999 779.227 303.018 779C303.274 775.948 302.5 774 303.018 770.975C303.018 770.975 303.336 769.799 303.341 769.195C303.458 755.817 303.594 742.439 303.636 729.061C303.653 723.73 303.09 718.374 303.462 713.076C303.795 708.328 303.543 703.604 303.556 698.885C303.584 689.23 303.068 679.572 302.743 669.917C302.581 665.087 302.521 660.244 302.057 655.441C301.883 653.643 302 652.256 302 650C302.003 649.044 302.019 648.362 302.057 647C302.093 644.77 302.308 644.076 302.743 643L305 632M302.974 779.432C302.933 779.713 302.95 779.063 302.974 779.432ZM302.974 779.432C302.994 779.735 303.018 780.729 303.018 783.5M303 783.5C302.74 788.854 303.012 794.051 303 799.5C302.979 809.258 302.747 816.253 303 826C303.104 829.999 302.229 834 302.229 840.299C302.229 851 302 885.5 304 901C306 916.5 307 951 313 975M313.5 976C314.305 979.822 314.5 985 316 988.5C317.5 991 320.5 1004.8 320.5 1014C320.5 1020.5 322.206 1022.5 322.206 1025","stroke":"#3E76F1","stroke-width":"3.01758","stroke-linecap":"round","stroke-linejoin":"round","tag":"path"},{"id":"龙首渠","d":"M548.75 378.191C552.779 377.388 554.849 375.32 555.69 371.25C557.511 362.426 555.214 354.398 550.845 346.818C548.711 343.116 546.478 339.492 543.672 336.202C541.147 333.243 538.183 331.316 534.599 329.833C527.631 326.949 519.416 331.86 518.568 339.867C518.408 341.38 517.848 342.927 518.039 344.385C518.41 347.217 519.696 349.303 521.964 351.566C525.243 354.839 528.775 358.101 531.49 361.938C533.313 364.515 534.98 366.97 538.49 367.001C539.445 367.01 539.56 367.825 539.647 368.243C540.676 373.227 544.393 375.701 548.448 377.889M808 288.958C820.712 289.422 833.356 288.345 846.027 287.541C856.724 286.863 867.266 288.567 877.737 290.932C881.161 291.706 884.964 291.047 888.566 290.733C897.51 289.953 906.282 287.963 915.146 286.698C921.785 285.751 928.615 285.657 935.349 287.112C944.235 289.032 947.614 295.739 949.113 303.463C951.24 314.424 952.966 325.457 955.51 336.345C956.994 342.701 958.476 349.047 959.05 355.631C959.417 359.835 959.132 363.894 958.878 368.018C958.307 377.282 960.278 386.142 963.097 394.877C965.393 401.992 967.708 409.135 969.573 416.343C971.621 424.259 973.369 432.303 974.618 440.433C976.005 449.464 977.081 458.476 975.763 467.596C975.012 472.799 974.366 478.092 971.465 482.63C970.801 483.67 971.137 484.363 971.293 485.091C973.577 495.766 974.594 506.64 976.438 517.378C977.535 523.769 979.012 530.111 980.658 536.385C982.274 542.547 982.801 548.836 983.727 555.093C984.946 563.327 984.354 571.635 985.383 579.858C985.706 582.433 985.528 585.087 985.415 587.697C985.13 594.267 986.532 600.751 986.336 607.312C986.305 608.323 986.521 609.362 986.037 610.33M905.623 605.407C903.08 605.261 900.522 605.731 898.101 606.141C889.575 607.586 880.937 608.154 872.436 609.667C864.338 611.109 856.261 612.617 848.257 614.635C840.569 616.573 833.031 619.074 826.074 622.536C819.407 625.854 813.13 624.096 806.649 623.768C803.006 623.583 799.335 623.322 795.776 622.332C795.428 622.235 794.911 622.406 794.586 622.623C791.418 624.743 787.964 624.516 784.638 623.45C781.184 622.343 777.879 620.682 775.303 618.042C773.835 616.539 773.076 614.462 773.801 612.363C774.644 609.921 776.858 608.767 779.194 608.486C784.026 607.906 788.517 609.105 792.461 612.05C795.323 614.187 796.491 616.949 795.499 620.5C795.369 620.966 795.481 621.5 795.481 622.003M905.321 440.647C908.141 440.365 910.585 441.732 913.16 442.48C916.306 443.392 919.742 443.928 922.434 445.615C925.645 447.626 929.341 449.32 931.299 453.005C932.357 454.995 933.55 456.948 934.935 458.72C936.121 460.236 937.493 461.686 939.419 462.374C948.931 465.775 956.918 471.419 963.533 478.994C965.358 481.084 967.6 482.093 970.199 482.591M554 457C555.507 459.047 556.205 464.479 558.5 466C558.966 471.256 564.763 472.415 566.602 476.582C566.904 477.266 568.108 477.186 568.573 477.436C575.689 481.264 580.244 486.324 588.5 487C590.195 487.139 593.31 487.656 595 488C596.072 488.218 599.3 488.772 600 490C602.605 494.57 607.239 493.433 611.5 494M669 508.5C672.011 508.435 672.997 508.286 676.054 509.512C677.781 510.205 679.536 510.619 680.361 512.798C681.182 514.965 683.459 516.101 685.137 517.624C688.235 520.434 691.073 523.348 693.32 526.971C698.338 535.062 705.665 540.547 714.392 544.178C715.687 544.717 717.128 545.08 718.603 544.815M986.494 613.252C986.555 611.223 985.996 610.098 983.884 608.849C980.076 606.598 976.509 603.832 972.291 602.45C964.581 599.923 956.58 598.97 948.474 599.398C940.082 599.841 931.75 600.953 923.427 602.087M732 386.003C734.788 385.913 736.896 387.781 739.183 388.846C744.052 391.111 749.17 391.649 754.327 392.359C759.739 393.105 765.187 393.224 770.62 393.615C772.968 393.784 775.126 394.932 776.972 396.553C780.369 399.536 783.514 402.715 786.046 406.502C787.347 408.446 789.046 410.05 791.747 409.535C792.677 409.357 793.3 409.975 793.834 410.474C795.026 411.59 796.041 412.891 797.185 414.061C803.682 420.713 810.974 426.365 819.238 430.605C824.391 433.249 830.185 434.603 835.39 436.949C842.562 440.181 849.117 438.247 856.032 437.38C860.204 436.857 864.483 436.863 868.694 437.057C874.84 437.34 881 437.771 887.092 438.597C890.785 439.098 894.541 439.418 898.061 441.356C899.84 442.335 902.602 441.527 905.325 441.527M823.109 445C819.351 446.473 815.905 448.451 812.399 450.475C806.906 453.646 801.957 457.323 797.522 461.66C792.344 466.724 788.032 472.566 784.799 479.105C781.74 485.293 778.916 491.553 777.462 498.394C776.787 501.565 775.486 504.705 772.122 506.278C771.351 506.638 770.704 507.263 770 507.766M769.53 508.543C767.147 506.695 764.509 507.537 761.998 508.004C760.796 508.228 759.664 508.755 758.373 508.91C756.188 509.173 754.599 509.963 754.028 512.744C752.811 518.674 752.569 524.605 752.977 530.568C753.355 536.103 748.876 543.947 743 545.029C737.976 545.953 733.074 546.816 728 546.5C725.677 546.355 721.314 545.33 719 545.029M548.643 377.278C547.533 379.136 548.158 381.085 548.342 383.011C549.635 396.582 548.333 410.17 548.577 423.75C548.644 427.518 549.494 436.284 549.5 440M549.5 440.5C549.57 442.103 550 451 554 457.5M645 483.5C647.012 483.5 650.051 483.152 652 483.5C656.565 484.317 659.355 486.057 661 490.5C663.211 496.471 665.535 501.861 668.5 507.5M847 439C844 439.5 834.655 440.914 832.497 441.691C829.173 442.887 825.625 443.466 823 444.909M644.288 484C638.704 484.405 634.169 487.433 629.525 490.075C625.696 492.254 621.94 494.475 617.431 494.858C615.587 495.015 613.878 493.853 612 494.26M922.219 602.691C916.888 603.496 911.557 604.3 906.226 605.105M898.714 442C896.045 444.982 892.322 446.644 889.837 450.056C885.993 455.334 884.118 461.203 882.784 467.361C882.478 468.77 882.319 469.876 880.934 470.706C878.149 472.372 876.896 475.056 876.354 478.206C875.899 480.847 875.177 483.441 874.573 486.057M874.272 486.66C873.699 493.476 871.449 499.954 869.854 506.529C868.603 511.691 866.007 516.659 863.302 521.3C860.507 526.094 857.977 531.019 855.242 535.836C854.46 537.214 853.45 538.462 852.545 539.77M854.356 546.71C854.342 548.821 853.332 550.418 851.631 551.525C846.359 554.956 840.693 555.495 834.742 553.65C832.507 552.957 830.98 551.496 829.898 549.434C828.231 546.258 828.851 543.296 832.045 541.617C838.155 538.406 844.671 537.65 851.32 539.533C853.567 540.169 853.802 542.623 854.353 544.598C854.518 545.189 854.028 545.893 854.658 546.408","stroke":"#3E76F1","stroke-width":"3.01758","stroke-linecap":"round","stroke-linejoin":"round","tag":"path"},{"id":"清明渠","d":"M458.085 512C455.235 513.086 453.293 515.504 450.593 516.927C444.617 520.074 438.134 521.748 431.791 523.63C422.538 526.375 413.621 529.925 404.697 533.483C401.036 534.942 397.554 536.916 394.172 538.956M410.311 739.769C412.232 746.634 410.13 753.335 408 759.5C405.356 767.15 402.956 774.342 402.5 782.5M402 783.5C401.497 789.334 400.889 795.161 400.517 801.004C400.011 808.943 399.894 821.404 398 830.5C397.584 832.5 397.5 835.5 397.5 837.5M409.5 738.5C409.5 738.5 408.5 736.455 407 735.5C401.5 732 400.9 732.5 399.5 729C397.5 724 398.651 717.439 398.5 712C398.299 704.763 398.5 697.742 398.5 690.5C398.798 688.488 399.321 687.276 399 681.5C398.5 672.5 400.149 667.857 399.5 661C399.105 653.757 398.657 644.219 398 637C398.279 636.008 396.667 627.891 396.5 627C395 619 394.5 617.5 390.5 611.5M396.5 884C396.5 888 397.411 890 397.411 892.734C400.151 905.5 401.003 918.043 401.5 931.5M401.491 932.29C401.491 936.112 401.446 939.935 401.5 943.757C401.615 951.921 401.583 960.87 401 969C400.704 973.125 399.539 977.34 399.5 981.5M479 465.5C476.976 469.647 473.953 473.186 473.5 478C472.888 484.505 470.5 491 467.5 496.5C466.5 498 466.5 499 465.5 501M479 465C479.993 461.949 480.309 457.613 480.5 454.5C480.942 447.273 480.765 440.741 481 433.5C481.154 428.771 481.299 422.728 481.5 418C482.109 412.167 480.241 404.107 482.096 398.292C482.271 397.744 482.301 397.018 482.09 396.501C480.849 393.474 481.28 390.252 480.96 387.13C480.477 382.421 480.879 377.552 479.862 372.984C478.597 367.3 479.603 362.214 482.511 357.619C485.847 352.345 489.862 347.502 493.587 342.475C495.883 339.376 498.443 336.521 499.376 332.529C501.123 325.064 501.892 317.503 502.464 309.994C498.189 308.073 493.884 309.58 489.663 309.291C488.853 309.235 488.307 310.037 488.217 310.5C487.773 312.794 486.361 313.973 484.235 314.574C483.12 314.889 482.714 315.492 482.959 316.837C483.31 318.765 482.46 320.548 481.54 322.269C480.771 323.708 479.88 324.623 478.204 323.752C476.841 323.044 475.772 323.681 475.222 324.694C472.794 329.156 468.817 329.715 464.314 329.539C459.798 329.362 457.306 332.158 457.029 336.738C456.756 341.267 458.421 344.918 461.293 348.212C463.984 351.297 464.223 353.444 462.184 356.947C461.387 358.318 460.586 359.645 460.057 361.171C458.945 364.379 459.21 364.983 462.171 366.671C463.189 367.252 464.195 367.278 465.219 367.53C467.568 368.11 470.224 367.897 472.136 369.66C474.172 371.537 476.414 371.393 478.8 370.839M394 539C392.37 539.499 391.82 541.002 390.19 542C389.647 542.333 387.091 544.277 386.066 545.359C383.823 547.723 381.398 549.5 378.911 552C376 556 374.544 558.93 373 562.5C370.2 568.972 370.444 572.733 371 579.5C371.166 581.527 371.631 585.481 372 587.5C371.667 590.713 375.5 594.512 378.911 598C382 601.159 383.188 602.459 384.5 603.5C388 607.5 387.665 607.333 390.19 610.79M392 1014.5C391 1017 387.18 1022.27 385.5 1023.91C381.758 1027.56 379.907 1030.57 376.5 1034.5C369.96 1042.04 362.787 1049.74 358.5 1059M399.5 981C398.457 988.29 397.678 997.956 395 1005C393.609 1008.66 393.056 1011.14 392 1015M397.5 838C396.848 846.336 395.5 852.5 395.228 865C395.544 867.422 395.077 872.546 395.5 875C396.09 878.423 397.039 879.593 396.5 883.5M465.127 502C463.411 505.227 461.411 508.727 459 511.16","stroke":"#3E76F1","stroke-width":"3.01758","stroke-linecap":"round","stroke-linejoin":"round","tag":"path"},{"id":"大液池","d":"M743.309 124.248C747.555 125.435 751.223 127.656 754.466 130.593C756.084 132.059 757.599 131.778 758.337 129.957C759.813 126.315 762.059 122.671 760.755 118.532C759.596 114.852 756.869 112.158 753.51 110.484C752.099 109.78 750.298 110.999 749.367 112.494C748.13 114.482 746.923 116.459 746.246 118.793C745.645 120.864 744.421 122.776 742.625 124.514C741.008 124.195 739.435 123.378 737.936 122.868C735.586 122.068 734.621 119.862 734.773 117.001C735.063 111.533 731.54 107.134 726.404 106.176C722.373 105.424 718.809 107.2 715.614 109.263C713.905 110.366 712.031 111.577 710.978 113.665C708.705 118.172 704.342 119.327 699.851 119.662C694.194 120.084 689.996 123.579 685.437 126.175C682.481 127.858 683.016 131.577 683.074 134.505C683.111 136.392 682.974 139.246 685.4 139.816C688.056 140.439 690.114 142.96 693.226 142.084C695.44 141.461 697.195 142.95 698.597 144.22C703.254 148.439 708.606 149.557 714.648 148.736C716.502 148.484 717.807 147.835 718.895 146.297C721.008 143.309 723.499 140.574 725.458 137.495C728.708 132.39 733.184 129.003 738.785 126.972C740.141 126.481 741.52 126.076 742.102 124.549","stroke":"#3E76F1","stroke-width":"3.01758","stroke-linecap":"round","stroke-linejoin":"round","tag":"path"},{"id":"漕渠","d":"M160 600.466C168.16 600.422 184 599 200.5 600.466C218.5 600.466 241.5 610.569 250.5 610.069C254.472 609.848 263.018 603.555 268 605.069C276.187 607.556 279.202 618.284 282 621.5C284.674 624.574 298.844 639.292 302.18 641.919C322.795 665.776 335.44 661.75 358.781 641.919C359.699 643.996 376.016 630.372 375.263 652.118C374.509 673.865 380.986 677.463 388.747 679.762C396.509 682.061 440.19 667.322 456.672 652.118C473.154 636.914 491.133 648.6 505.118 648.6C519.102 648.6 517.105 641.919 531.588 641.919C546.072 641.919 557.56 667.916 575.04 663.176C592.521 658.436 609.502 652.118 611 634.024M163 600C156.5 600 145 597.5 123 584.5C112.5 580 108.5 575.07 98.3477 576.674C76.2349 580.166 71.1459 586.875 65 591M260 608C260.646 613.213 260.947 614.143 265 616C267.951 617.352 271.507 618.734 274.5 620C276.009 620.638 281.952 623.991 283.5 623.5M324.5 1025C324.634 1032.46 325.244 1041.29 324.587 1048.73C324.386 1051 324.5 1055.5 322.5 1060M578.148 218C577.784 219.584 578.133 221.068 578.748 222.528C579.996 225.493 581.378 228.365 582.202 231.545C582.875 234.143 584.717 236.275 587.14 238.002C590.744 240.572 594.219 243.38 595.45 248.149C595.977 250.188 597.722 251.892 599.881 252.686C607.081 255.337 609.436 261.068 609.842 268.091C609.877 268.699 610.034 269.299 610.135 269.902M645.742 366.767C645.087 371.882 644.718 377.035 644.108 382.141C643.428 387.84 643.473 393.557 643.523 399.204C643.572 404.88 643.366 410.57 643.504 416.258C643.879 431.781 644.781 447.259 646.036 462.726C646.527 468.773 647.201 474.813 647.665 480.846C647.979 484.936 648.326 489.076 648.462 493.203C648.536 495.417 648.659 497.629 648.759 499.842M646.044 366.163C645.351 362.262 646.705 358.518 647.049 354.705C647.785 346.54 648.586 338.338 647.093 330.283C646.237 325.663 645.643 320.48 641.216 317.278C639.389 310.365 632.647 307.509 628.712 302.29C625.641 298.218 621.849 294.418 619.16 290.245C615.464 284.508 612.308 278.094 611.04 271.109M638.5 601.5C636.5 603.5 633.548 605.098 631.5 606.5M649 500C649.796 513.468 650.887 535.24 651.164 548.727C651.228 551.844 651.101 554.965 651.197 558.08C651.272 560.501 651.197 562.5 651.197 565C651.197 567.5 651.164 568 651.5 571.5C651.5 575.5 651.157 579.298 650.5 583C649.492 588.678 646.876 593.919 643 598C641.674 599.396 639.5 600.5 638 602M631 607C629 608.5 627.064 609.783 625.329 610.907C621.403 613.453 617.986 616.553 615.026 620.218C611.904 624.083 611.731 628.639 611.436 633.219","stroke":"#3E76F1","stroke-width":"3.01758","stroke-linecap":"round","stroke-linejoin":"round","tag":"path"}]')};/*!
 * pinia v3.0.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let oC;const Kp=e=>oC=e,aC=Symbol();function t2(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var nf;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(nf||(nf={}));function MI(){const e=aE(!0),t=e.run(()=>je({}));let n=[],i=[];const r=k3({install(s){Kp(r),r._a=s,s.provide(aC,r),s.config.globalProperties.$pinia=r,i.forEach(o=>n.push(o)),i=[]},use(s){return this._a?n.push(s):i.push(s),this},_p:n,_a:null,_e:e,_s:new Map,state:t});return r}const uC=()=>{};function j9(e,t,n,i=uC){e.push(t);const r=()=>{const s=e.indexOf(t);s>-1&&(e.splice(s,1),i())};return!n&&uE()&&gR(r),r}function Su(e,...t){e.slice().forEach(n=>{n(...t)})}const TI=e=>e(),H9=Symbol(),im=Symbol();function n2(e,t){e instanceof Map&&t instanceof Map?t.forEach((n,i)=>e.set(i,n)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const n in t){if(!t.hasOwnProperty(n))continue;const i=t[n],r=e[n];t2(r)&&t2(i)&&e.hasOwnProperty(n)&&!St(i)&&!bo(i)?e[n]=n2(r,i):e[n]=i}return e}const FI=Symbol();function LI(e){return!t2(e)||!e.hasOwnProperty(FI)}const{assign:eo}=Object;function NI(e){return!!(St(e)&&e.effect)}function DI(e,t,n,i){const{state:r,actions:s,getters:o}=t,a=n.state.value[e];let u;function l(){a||(n.state.value[e]=r?r():{});const c=zR(n.state.value[e]);return eo(c,s,Object.keys(o||{}).reduce((f,d)=>(f[d]=k3(_i(()=>{Kp(n);const h=n._s.get(e);return o[d].call(h,h)})),f),{}))}return u=lC(e,l,t,n,i,!0),u}function lC(e,t,n={},i,r,s){let o;const a=eo({actions:{}},n),u={deep:!0};let l,c,f=[],d=[],h;const p=i.state.value[e];!s&&!p&&(i.state.value[e]={}),je({});let g;function m(S){let $;l=c=!1,typeof S=="function"?(S(i.state.value[e]),$={type:nf.patchFunction,storeId:e,events:h}):(n2(i.state.value[e],S),$={type:nf.patchObject,payload:S,storeId:e,events:h});const F=g=Symbol();A3().then(()=>{g===F&&(l=!0)}),c=!0,Su(f,$,i.state.value[e])}const y=s?function(){const{state:$}=n,F=$?$():{};this.$patch(T=>{eo(T,F)})}:uC;function v(){o.stop(),f=[],d=[],i._s.delete(e)}const b=(S,$="")=>{if(H9 in S)return S[im]=$,S;const F=function(){Kp(i);const T=Array.from(arguments),P=[],R=[];function C(L){P.push(L)}function A(L){R.push(L)}Su(d,{args:T,name:F[im],store:_,after:C,onError:A});let M;try{M=S.apply(this&&this.$id===e?this:_,T)}catch(L){throw Su(R,L),L}return M instanceof Promise?M.then(L=>(Su(P,L),L)).catch(L=>(Su(R,L),Promise.reject(L))):(Su(P,M),M)};return F[H9]=!0,F[im]=$,F},x={_p:i,$id:e,$onAction:j9.bind(null,d),$patch:m,$reset:y,$subscribe(S,$={}){const F=j9(f,S,$.detached,()=>T()),T=o.run(()=>ef(()=>i.state.value[e],P=>{($.flush==="sync"?c:l)&&S({storeId:e,type:nf.direct,events:h},P)},eo({},u,$)));return F},$dispose:v},_=Vp(x);i._s.set(e,_);const w=(i._a&&i._a.runWithContext||TI)(()=>i._e.run(()=>(o=aE()).run(()=>t({action:b}))));for(const S in w){const $=w[S];if(St($)&&!NI($)||bo($))s||(p&&LI($)&&(St($)?$.value=p[S]:n2($,p[S])),i.state.value[e][S]=$);else if(typeof $=="function"){const F=b($,S);w[S]=F,a.actions[S]=$}}return eo(_,w),eo(ze(_),w),Object.defineProperty(_,"$state",{get:()=>i.state.value[e],set:S=>{m($=>{eo($,S)})}}),i._p.forEach(S=>{eo(_,o.run(()=>S({store:_,app:i._a,pinia:i,options:a})))}),p&&s&&n.hydrate&&n.hydrate(_.$state,p),l=!0,c=!0,_}/*! #__NO_SIDE_EFFECTS__ */function cC(e,t,n){let i;const r=typeof t=="function";i=r?n:t;function s(o,a){const u=xO();return o=o||(u?Qc(aC,null):null),o&&Kp(o),o=oC,o._s.has(e)||(r?lC(e,t,i,o):DI(e,i,o)),o._s.get(e)}return s.$id=e,s}const fC=cC("state",()=>{const e=je(!0),t=je(!0),n=je(!0),i=je(!0),r=je(null),s=je(null),o=je(null);return{baseMapVisible:e,areasVisible:t,pathsVisible:n,pointsVisible:i,hoveredElement:r,focusedElementId:s,hoveredAnnotationId:o}}),N3=cC("data",()=>{const e=je([]),t=je([]),n=je([]);je([]),je([]),je([]),je([]),je([]);const i=je([]),r=_i(()=>{const o=new Map;return i.value.forEach((a,u)=>{o.set(a.id,u)}),o});return{pointCoordinates:e,pathData:t,areaCoordinates:n,annotationList:i,annotationId2index:r,getAnno:o=>{const a=r.value.get(o);return a!==void 0?i.value[a]:null}}});function Ss(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function RI(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Nl(e){let t,n,i;e.length!==2?(t=Ss,n=(a,u)=>Ss(e(a),u),i=(a,u)=>e(a)-u):(t=e===Ss||e===RI?e:OI,n=e,i=e);function r(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<0?l=f+1:c=f}while(l<c)}return l}function s(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<=0?l=f+1:c=f}while(l<c)}return l}function o(a,u,l=0,c=a.length){const f=r(a,u,l,c-1);return f>l&&i(a[f-1],u)>-i(a[f],u)?f-1:f}return{left:r,center:o,right:s}}function OI(){return 0}function dC(e){return e===null?NaN:+e}function*II(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(i=+i)>=i&&(yield i)}}const hC=Nl(Ss),So=hC.right,PI=hC.left;Nl(dC).center;function zI(e,t){let n=0,i,r=0,s=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(i=o-r,r+=i/++n,s+=i*(o-r));else{let o=-1;for(let a of e)(a=t(a,++o,e))!=null&&(a=+a)>=a&&(i=a-r,r+=i/++n,s+=i*(a-r))}if(n>1)return s/(n-1)}function BI(e,t){const n=zI(e,t);return n&&Math.sqrt(n)}class Tn{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const s=n[r],o=t+s,a=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);a&&(n[i++]=a),t=o}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,s,o=0;if(n>0){for(o=t[--n];n>0&&(i=o,r=t[--n],o=i+r,s=r-(o-i),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(r=s*2,i=o+r,r==i-o&&(o=i))}return o}}class q9 extends Map{constructor(t,n=mC){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[i,r]of t)this.set(i,r)}get(t){return super.get(i2(this,t))}has(t){return super.has(i2(this,t))}set(t,n){return super.set(pC(this,t),n)}delete(t){return super.delete(gC(this,t))}}class f0 extends Set{constructor(t,n=mC){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const i of t)this.add(i)}has(t){return super.has(i2(this,t))}add(t){return super.add(pC(this,t))}delete(t){return super.delete(gC(this,t))}}function i2({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function pC({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function gC({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}function mC(e){return e!==null&&typeof e=="object"?e.valueOf():e}function UI(e,t){return Array.from(t,n=>e[n])}function jI(e=Ss){if(e===Ss)return yC;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const i=e(t,n);return i||i===0?i:(e(n,n)===0)-(e(t,t)===0)}}function yC(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const HI=Math.sqrt(50),qI=Math.sqrt(10),VI=Math.sqrt(2);function d0(e,t,n){const i=(t-e)/Math.max(0,n),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),o=s>=HI?10:s>=qI?5:s>=VI?2:1;let a,u,l;return r<0?(l=Math.pow(10,-r)/o,a=Math.round(e*l),u=Math.round(t*l),a/l<e&&++a,u/l>t&&--u,l=-l):(l=Math.pow(10,r)*o,a=Math.round(e/l),u=Math.round(t/l),a*l<e&&++a,u*l>t&&--u),u<a&&.5<=n&&n<2?d0(e,t,n*2):[a,u,l]}function r2(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const i=t<e,[r,s,o]=i?d0(t,e,n):d0(e,t,n);if(!(s>=r))return[];const a=s-r+1,u=new Array(a);if(i)if(o<0)for(let l=0;l<a;++l)u[l]=(s-l)/-o;else for(let l=0;l<a;++l)u[l]=(s-l)*o;else if(o<0)for(let l=0;l<a;++l)u[l]=(r+l)/-o;else for(let l=0;l<a;++l)u[l]=(r+l)*o;return u}function s2(e,t,n){return t=+t,e=+e,n=+n,d0(e,t,n)[2]}function ko(e,t,n){t=+t,e=+e,n=+n;const i=t<e,r=i?s2(t,e,n):s2(e,t,n);return(i?-1:1)*(r<0?1/-r:r)}function $a(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function o2(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function vC(e,t,n=0,i=1/0,r){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(e.length-1,i)),!(n<=t&&t<=i))return e;for(r=r===void 0?yC:jI(r);i>n;){if(i-n>600){const u=i-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),p=Math.min(i,Math.floor(t+(u-l)*f/u+d));vC(e,t,h,p,r)}const s=e[t];let o=n,a=i;for(oc(e,n,t),r(e[i],s)>0&&oc(e,n,i);o<a;){for(oc(e,o,a),++o,--a;r(e[o],s)<0;)++o;for(;r(e[a],s)>0;)--a}r(e[n],s)===0?oc(e,n,a):(++a,oc(e,a,i)),a<=t&&(n=a+1),t<=a&&(i=a-1)}return e}function oc(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function a2(e,t,n){if(e=Float64Array.from(II(e,n)),!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return o2(e);if(t>=1)return $a(e);var i,r=(i-1)*t,s=Math.floor(r),o=$a(vC(e,s).subarray(0,s+1)),a=o2(e.subarray(s+1));return o+(a-o)*(r-s)}}function bC(e,t,n=dC){if(!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,s=Math.floor(r),o=+n(e[s],s,e),a=+n(e[s+1],s+1,e);return o+(a-o)*(r-s)}}function WI(e,t){let n=0,i=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let s of e)(s=t(s,++r,e))!=null&&(s=+s)>=s&&(++n,i+=s)}if(n)return i/n}function xC(e,t){return a2(e,.5,t)}function*GI(e){for(const t of e)yield*t}function _C(e){return Array.from(GI(e))}function li(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(r);++i<r;)s[i]=e+i*n;return s}function wC(e,t){let n=0;for(let i of e)(i=+i)&&(n+=i);return n}function YI(e,...t){e=new f0(e),t=t.map(ZI);e:for(const n of e)for(const i of t)if(!i.has(n)){e.delete(n);continue e}return e}function ZI(e){return e instanceof f0?e:new f0(e)}function XI(...e){const t=new f0;for(const n of e)for(const i of n)t.add(i);return t}var KI={value:()=>{}};function Jp(){for(var e=0,t=arguments.length,n={},i;e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Dh(n)}function Dh(e){this._=e}function JI(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Dh.prototype=Jp.prototype={constructor:Dh,on:function(e,t){var n=this._,i=JI(e+"",n),r,s=-1,o=i.length;if(arguments.length<2){for(;++s<o;)if((r=(e=i[s]).type)&&(r=QI(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(r=(e=i[s]).type)n[r]=V9(n[r],e.name,t);else if(t==null)for(r in n)n[r]=V9(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Dh(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],i=0,r=s.length;i<r;++i)s[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)}};function QI(e,t){for(var n=0,i=e.length,r;n<i;++n)if((r=e[n]).name===t)return r.value}function V9(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=KI,e=e.slice(0,i).concat(e.slice(i+1));break}return n!=null&&e.push({name:t,value:n}),e}var u2="http://www.w3.org/1999/xhtml";const W9={svg:"http://www.w3.org/2000/svg",xhtml:u2,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Qp(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),W9.hasOwnProperty(t)?{space:W9[t],local:e}:e}function eP(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===u2&&t.documentElement.namespaceURI===u2?t.createElement(e):t.createElementNS(n,e)}}function tP(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function EC(e){var t=Qp(e);return(t.local?tP:eP)(t)}function nP(){}function D3(e){return e==null?nP:function(){return this.querySelector(e)}}function iP(e){typeof e!="function"&&(e=D3(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var s=t[r],o=s.length,a=i[r]=new Array(o),u,l,c=0;c<o;++c)(u=s[c])&&(l=e.call(u,u.__data__,c,s))&&("__data__"in u&&(l.__data__=u.__data__),a[c]=l);return new pi(i,this._parents)}function rP(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function sP(){return[]}function CC(e){return e==null?sP:function(){return this.querySelectorAll(e)}}function oP(e){return function(){return rP(e.apply(this,arguments))}}function aP(e){typeof e=="function"?e=oP(e):e=CC(e);for(var t=this._groups,n=t.length,i=[],r=[],s=0;s<n;++s)for(var o=t[s],a=o.length,u,l=0;l<a;++l)(u=o[l])&&(i.push(e.call(u,u.__data__,l,o)),r.push(u));return new pi(i,r)}function SC(e){return function(){return this.matches(e)}}function kC(e){return function(t){return t.matches(e)}}var uP=Array.prototype.find;function lP(e){return function(){return uP.call(this.children,e)}}function cP(){return this.firstElementChild}function fP(e){return this.select(e==null?cP:lP(typeof e=="function"?e:kC(e)))}var dP=Array.prototype.filter;function hP(){return Array.from(this.children)}function pP(e){return function(){return dP.call(this.children,e)}}function gP(e){return this.selectAll(e==null?hP:pP(typeof e=="function"?e:kC(e)))}function mP(e){typeof e!="function"&&(e=SC(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var s=t[r],o=s.length,a=i[r]=[],u,l=0;l<o;++l)(u=s[l])&&e.call(u,u.__data__,l,s)&&a.push(u);return new pi(i,this._parents)}function AC(e){return new Array(e.length)}function yP(){return new pi(this._enter||this._groups.map(AC),this._parents)}function h0(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}h0.prototype={constructor:h0,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function vP(e){return function(){return e}}function bP(e,t,n,i,r,s){for(var o=0,a,u=t.length,l=s.length;o<l;++o)(a=t[o])?(a.__data__=s[o],i[o]=a):n[o]=new h0(e,s[o]);for(;o<u;++o)(a=t[o])&&(r[o]=a)}function xP(e,t,n,i,r,s,o){var a,u,l=new Map,c=t.length,f=s.length,d=new Array(c),h;for(a=0;a<c;++a)(u=t[a])&&(d[a]=h=o.call(u,u.__data__,a,t)+"",l.has(h)?r[a]=u:l.set(h,u));for(a=0;a<f;++a)h=o.call(e,s[a],a,s)+"",(u=l.get(h))?(i[a]=u,u.__data__=s[a],l.delete(h)):n[a]=new h0(e,s[a]);for(a=0;a<c;++a)(u=t[a])&&l.get(d[a])===u&&(r[a]=u)}function _P(e){return e.__data__}function wP(e,t){if(!arguments.length)return Array.from(this,_P);var n=t?xP:bP,i=this._parents,r=this._groups;typeof e!="function"&&(e=vP(e));for(var s=r.length,o=new Array(s),a=new Array(s),u=new Array(s),l=0;l<s;++l){var c=i[l],f=r[l],d=f.length,h=EP(e.call(c,c&&c.__data__,l,i)),p=h.length,g=a[l]=new Array(p),m=o[l]=new Array(p),y=u[l]=new Array(d);n(c,f,g,m,y,h,t);for(var v=0,b=0,x,_;v<p;++v)if(x=g[v]){for(v>=b&&(b=v+1);!(_=m[b])&&++b<p;);x._next=_||null}}return o=new pi(o,i),o._enter=a,o._exit=u,o}function EP(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function CP(){return new pi(this._exit||this._groups.map(AC),this._parents)}function SP(e,t,n){var i=this.enter(),r=this,s=this.exit();return typeof e=="function"?(i=e(i),i&&(i=i.selection())):i=i.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),n==null?s.remove():n(s),i&&r?i.merge(r).order():r}function kP(e){for(var t=e.selection?e.selection():e,n=this._groups,i=t._groups,r=n.length,s=i.length,o=Math.min(r,s),a=new Array(r),u=0;u<o;++u)for(var l=n[u],c=i[u],f=l.length,d=a[u]=new Array(f),h,p=0;p<f;++p)(h=l[p]||c[p])&&(d[p]=h);for(;u<r;++u)a[u]=n[u];return new pi(a,this._parents)}function AP(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var i=e[t],r=i.length-1,s=i[r],o;--r>=0;)(o=i[r])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function $P(e){e||(e=MP);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var o=n[s],a=o.length,u=r[s]=new Array(a),l,c=0;c<a;++c)(l=o[c])&&(u[c]=l);u.sort(t)}return new pi(r,this._parents).order()}function MP(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function TP(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function FP(){return Array.from(this)}function LP(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],r=0,s=i.length;r<s;++r){var o=i[r];if(o)return o}return null}function NP(){let e=0;for(const t of this)++e;return e}function DP(){return!this.node()}function RP(e){for(var t=this._groups,n=0,i=t.length;n<i;++n)for(var r=t[n],s=0,o=r.length,a;s<o;++s)(a=r[s])&&e.call(a,a.__data__,s,r);return this}function OP(e){return function(){this.removeAttribute(e)}}function IP(e){return function(){this.removeAttributeNS(e.space,e.local)}}function PP(e,t){return function(){this.setAttribute(e,t)}}function zP(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function BP(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function UP(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function jP(e,t){var n=Qp(e);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((t==null?n.local?IP:OP:typeof t=="function"?n.local?UP:BP:n.local?zP:PP)(n,t))}function $C(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function HP(e){return function(){this.style.removeProperty(e)}}function qP(e,t,n){return function(){this.style.setProperty(e,t,n)}}function VP(e,t,n){return function(){var i=t.apply(this,arguments);i==null?this.style.removeProperty(e):this.style.setProperty(e,i,n)}}function WP(e,t,n){return arguments.length>1?this.each((t==null?HP:typeof t=="function"?VP:qP)(e,t,n??"")):tl(this.node(),e)}function tl(e,t){return e.style.getPropertyValue(t)||$C(e).getComputedStyle(e,null).getPropertyValue(t)}function GP(e){return function(){delete this[e]}}function YP(e,t){return function(){this[e]=t}}function ZP(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function XP(e,t){return arguments.length>1?this.each((t==null?GP:typeof t=="function"?ZP:YP)(e,t)):this.node()[e]}function MC(e){return e.trim().split(/^|\s+/)}function R3(e){return e.classList||new TC(e)}function TC(e){this._node=e,this._names=MC(e.getAttribute("class")||"")}TC.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function FC(e,t){for(var n=R3(e),i=-1,r=t.length;++i<r;)n.add(t[i])}function LC(e,t){for(var n=R3(e),i=-1,r=t.length;++i<r;)n.remove(t[i])}function KP(e){return function(){FC(this,e)}}function JP(e){return function(){LC(this,e)}}function QP(e,t){return function(){(t.apply(this,arguments)?FC:LC)(this,e)}}function ez(e,t){var n=MC(e+"");if(arguments.length<2){for(var i=R3(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof t=="function"?QP:t?KP:JP)(n,t))}function tz(){this.textContent=""}function nz(e){return function(){this.textContent=e}}function iz(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function rz(e){return arguments.length?this.each(e==null?tz:(typeof e=="function"?iz:nz)(e)):this.node().textContent}function sz(){this.innerHTML=""}function oz(e){return function(){this.innerHTML=e}}function az(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function uz(e){return arguments.length?this.each(e==null?sz:(typeof e=="function"?az:oz)(e)):this.node().innerHTML}function lz(){this.nextSibling&&this.parentNode.appendChild(this)}function cz(){return this.each(lz)}function fz(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function dz(){return this.each(fz)}function hz(e){var t=typeof e=="function"?e:EC(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function pz(){return null}function gz(e,t){var n=typeof e=="function"?e:EC(e),i=t==null?pz:typeof t=="function"?t:D3(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function mz(){var e=this.parentNode;e&&e.removeChild(this)}function yz(){return this.each(mz)}function vz(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function bz(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function xz(e){return this.select(e?bz:vz)}function _z(e){return arguments.length?this.property("__data__",e):this.node().__data__}function wz(e){return function(t){e.call(this,t,this.__data__)}}function Ez(e){return e.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");return i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),{type:t,name:n}})}function Cz(e){return function(){var t=this.__on;if(t){for(var n=0,i=-1,r=t.length,s;n<r;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++i]=s;++i?t.length=i:delete this.__on}}}function Sz(e,t,n){return function(){var i=this.__on,r,s=wz(t);if(i){for(var o=0,a=i.length;o<a;++o)if((r=i[o]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),r.value=t;return}}this.addEventListener(e.type,s,n),r={type:e.type,name:e.name,value:t,listener:s,options:n},i?i.push(r):this.__on=[r]}}function kz(e,t,n){var i=Ez(e+""),r,s=i.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var u=0,l=a.length,c;u<l;++u)for(r=0,c=a[u];r<s;++r)if((o=i[r]).type===c.type&&o.name===c.name)return c.value}return}for(a=t?Sz:Cz,r=0;r<s;++r)this.each(a(i[r],t,n));return this}function NC(e,t,n){var i=$C(e),r=i.CustomEvent;typeof r=="function"?r=new r(t,n):(r=i.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function Az(e,t){return function(){return NC(this,e,t)}}function $z(e,t){return function(){return NC(this,e,t.apply(this,arguments))}}function Mz(e,t){return this.each((typeof t=="function"?$z:Az)(e,t))}function*Tz(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],r=0,s=i.length,o;r<s;++r)(o=i[r])&&(yield o)}var DC=[null];function pi(e,t){this._groups=e,this._parents=t}function ed(){return new pi([[document.documentElement]],DC)}function Fz(){return this}pi.prototype=ed.prototype={constructor:pi,select:iP,selectAll:aP,selectChild:fP,selectChildren:gP,filter:mP,data:wP,enter:yP,exit:CP,join:SP,merge:kP,selection:Fz,order:AP,sort:$P,call:TP,nodes:FP,node:LP,size:NP,empty:DP,each:RP,attr:jP,style:WP,property:XP,classed:ez,text:rz,html:uz,raise:cz,lower:dz,append:hz,insert:gz,remove:yz,clone:xz,datum:_z,on:kz,dispatch:Mz,[Symbol.iterator]:Tz};function Ui(e){return typeof e=="string"?new pi([[document.querySelector(e)]],[document.documentElement]):new pi([[e]],DC)}function Lz(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ra(e,t){if(e=Lz(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const l2={capture:!0,passive:!1};function c2(e){e.preventDefault(),e.stopImmediatePropagation()}function Nz(e){var t=e.document.documentElement,n=Ui(e).on("dragstart.drag",c2,l2);"onselectstart"in t?n.on("selectstart.drag",c2,l2):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Dz(e,t){var n=e.document.documentElement,i=Ui(e).on("dragstart.drag",null);t&&(i.on("click.drag",c2,l2),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function Dl(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function td(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function Uo(){}var Ua=.7,nl=1/Ua,Wu="\\s*([+-]?\\d+)\\s*",Cf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Tr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Rz=/^#([0-9a-f]{3,8})$/,Oz=new RegExp(`^rgb\\(${Wu},${Wu},${Wu}\\)$`),Iz=new RegExp(`^rgb\\(${Tr},${Tr},${Tr}\\)$`),Pz=new RegExp(`^rgba\\(${Wu},${Wu},${Wu},${Cf}\\)$`),zz=new RegExp(`^rgba\\(${Tr},${Tr},${Tr},${Cf}\\)$`),Bz=new RegExp(`^hsl\\(${Cf},${Tr},${Tr}\\)$`),Uz=new RegExp(`^hsla\\(${Cf},${Tr},${Tr},${Cf}\\)$`),G9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Dl(Uo,ja,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Y9,formatHex:Y9,formatHex8:jz,formatHsl:Hz,formatRgb:Z9,toString:Z9});function Y9(){return this.rgb().formatHex()}function jz(){return this.rgb().formatHex8()}function Hz(){return RC(this).formatHsl()}function Z9(){return this.rgb().formatRgb()}function ja(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Rz.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?X9(t):n===3?new Pt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Wd(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Wd(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Oz.exec(e))?new Pt(t[1],t[2],t[3],1):(t=Iz.exec(e))?new Pt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Pz.exec(e))?Wd(t[1],t[2],t[3],t[4]):(t=zz.exec(e))?Wd(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Bz.exec(e))?Q9(t[1],t[2]/100,t[3]/100,1):(t=Uz.exec(e))?Q9(t[1],t[2]/100,t[3]/100,t[4]):G9.hasOwnProperty(e)?X9(G9[e]):e==="transparent"?new Pt(NaN,NaN,NaN,0):null}function X9(e){return new Pt(e>>16&255,e>>8&255,e&255,1)}function Wd(e,t,n,i){return i<=0&&(e=t=n=NaN),new Pt(e,t,n,i)}function O3(e){return e instanceof Uo||(e=ja(e)),e?(e=e.rgb(),new Pt(e.r,e.g,e.b,e.opacity)):new Pt}function Ao(e,t,n,i){return arguments.length===1?O3(e):new Pt(e,t,n,i??1)}function Pt(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}Dl(Pt,Ao,td(Uo,{brighter(e){return e=e==null?nl:Math.pow(nl,e),new Pt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ua:Math.pow(Ua,e),new Pt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Pt(Ma(this.r),Ma(this.g),Ma(this.b),p0(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:K9,formatHex:K9,formatHex8:qz,formatRgb:J9,toString:J9}));function K9(){return`#${xa(this.r)}${xa(this.g)}${xa(this.b)}`}function qz(){return`#${xa(this.r)}${xa(this.g)}${xa(this.b)}${xa((isNaN(this.opacity)?1:this.opacity)*255)}`}function J9(){const e=p0(this.opacity);return`${e===1?"rgb(":"rgba("}${Ma(this.r)}, ${Ma(this.g)}, ${Ma(this.b)}${e===1?")":`, ${e})`}`}function p0(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ma(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function xa(e){return e=Ma(e),(e<16?"0":"")+e.toString(16)}function Q9(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ji(e,t,n,i)}function RC(e){if(e instanceof ji)return new ji(e.h,e.s,e.l,e.opacity);if(e instanceof Uo||(e=ja(e)),!e)return new ji;if(e instanceof ji)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),s=Math.max(t,n,i),o=NaN,a=s-r,u=(s+r)/2;return a?(t===s?o=(n-i)/a+(n<i)*6:n===s?o=(i-t)/a+2:o=(t-n)/a+4,a/=u<.5?s+r:2-s-r,o*=60):a=u>0&&u<1?0:o,new ji(o,a,u,e.opacity)}function g0(e,t,n,i){return arguments.length===1?RC(e):new ji(e,t,n,i??1)}function ji(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}Dl(ji,g0,td(Uo,{brighter(e){return e=e==null?nl:Math.pow(nl,e),new ji(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ua:Math.pow(Ua,e),new ji(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new Pt(rm(e>=240?e-240:e+120,r,i),rm(e,r,i),rm(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new ji(e6(this.h),Gd(this.s),Gd(this.l),p0(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=p0(this.opacity);return`${e===1?"hsl(":"hsla("}${e6(this.h)}, ${Gd(this.s)*100}%, ${Gd(this.l)*100}%${e===1?")":`, ${e})`}`}}));function e6(e){return e=(e||0)%360,e<0?e+360:e}function Gd(e){return Math.max(0,Math.min(1,e||0))}function rm(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const OC=Math.PI/180,IC=180/Math.PI,m0=18,PC=.96422,zC=1,BC=.82521,UC=4/29,Gu=6/29,jC=3*Gu*Gu,Vz=Gu*Gu*Gu;function HC(e){if(e instanceof Fr)return new Fr(e.l,e.a,e.b,e.opacity);if(e instanceof bs)return qC(e);e instanceof Pt||(e=O3(e));var t=um(e.r),n=um(e.g),i=um(e.b),r=sm((.2225045*t+.7168786*n+.0606169*i)/zC),s,o;return t===n&&n===i?s=o=r:(s=sm((.4360747*t+.3850649*n+.1430804*i)/PC),o=sm((.0139322*t+.0971045*n+.7141733*i)/BC)),new Fr(116*r-16,500*(s-r),200*(r-o),e.opacity)}function y0(e,t,n,i){return arguments.length===1?HC(e):new Fr(e,t,n,i??1)}function Fr(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}Dl(Fr,y0,td(Uo,{brighter(e){return new Fr(this.l+m0*(e??1),this.a,this.b,this.opacity)},darker(e){return new Fr(this.l-m0*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=PC*om(t),e=zC*om(e),n=BC*om(n),new Pt(am(3.1338561*t-1.6168667*e-.4906146*n),am(-.9787684*t+1.9161415*e+.033454*n),am(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function sm(e){return e>Vz?Math.pow(e,1/3):e/jC+UC}function om(e){return e>Gu?e*e*e:jC*(e-UC)}function am(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function um(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Wz(e){if(e instanceof bs)return new bs(e.h,e.c,e.l,e.opacity);if(e instanceof Fr||(e=HC(e)),e.a===0&&e.b===0)return new bs(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*IC;return new bs(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function v0(e,t,n,i){return arguments.length===1?Wz(e):new bs(e,t,n,i??1)}function bs(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function qC(e){if(isNaN(e.h))return new Fr(e.l,0,0,e.opacity);var t=e.h*OC;return new Fr(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Dl(bs,v0,td(Uo,{brighter(e){return new bs(this.h,this.c,this.l+m0*(e??1),this.opacity)},darker(e){return new bs(this.h,this.c,this.l-m0*(e??1),this.opacity)},rgb(){return qC(this).rgb()}}));var VC=-.14861,I3=1.78277,P3=-.29227,eg=-.90649,Sf=1.97294,t6=Sf*eg,n6=Sf*I3,i6=I3*P3-eg*VC;function Gz(e){if(e instanceof Ta)return new Ta(e.h,e.s,e.l,e.opacity);e instanceof Pt||(e=O3(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(i6*i+t6*t-n6*n)/(i6+t6-n6),s=i-r,o=(Sf*(n-r)-P3*s)/eg,a=Math.sqrt(o*o+s*s)/(Sf*r*(1-r)),u=a?Math.atan2(o,s)*IC-120:NaN;return new Ta(u<0?u+360:u,a,r,e.opacity)}function f2(e,t,n,i){return arguments.length===1?Gz(e):new Ta(e,t,n,i??1)}function Ta(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}Dl(Ta,f2,td(Uo,{brighter(e){return e=e==null?nl:Math.pow(nl,e),new Ta(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ua:Math.pow(Ua,e),new Ta(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*OC,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new Pt(255*(t+n*(VC*i+I3*r)),255*(t+n*(P3*i+eg*r)),255*(t+n*(Sf*i)),this.opacity)}}));function WC(e,t,n,i,r){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*i+o*r)/6}function GC(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],s=e[i+1],o=i>0?e[i-1]:2*r-s,a=i<t-1?e[i+2]:2*s-r;return WC((n-i/t)*t,o,r,s,a)}}function YC(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],s=e[i%t],o=e[(i+1)%t],a=e[(i+2)%t];return WC((n-i/t)*t,r,s,o,a)}}const tg=e=>()=>e;function ZC(e,t){return function(n){return e+n*t}}function Yz(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function ng(e,t){var n=t-e;return n?ZC(e,n>180||n<-180?n-360*Math.round(n/360):n):tg(isNaN(e)?t:e)}function Zz(e){return(e=+e)==1?zt:function(t,n){return n-t?Yz(t,n,e):tg(isNaN(t)?n:t)}}function zt(e,t){var n=t-e;return n?ZC(e,n):tg(isNaN(e)?t:e)}const kf=function e(t){var n=Zz(t);function i(r,s){var o=n((r=Ao(r)).r,(s=Ao(s)).r),a=n(r.g,s.g),u=n(r.b,s.b),l=zt(r.opacity,s.opacity);return function(c){return r.r=o(c),r.g=a(c),r.b=u(c),r.opacity=l(c),r+""}}return i.gamma=e,i}(1);function XC(e){return function(t){var n=t.length,i=new Array(n),r=new Array(n),s=new Array(n),o,a;for(o=0;o<n;++o)a=Ao(t[o]),i[o]=a.r||0,r[o]=a.g||0,s[o]=a.b||0;return i=e(i),r=e(r),s=e(s),a.opacity=1,function(u){return a.r=i(u),a.g=r(u),a.b=s(u),a+""}}}var Xz=XC(GC),Kz=XC(YC);function z3(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=e[r]*(1-s)+t[r]*s;return i}}function KC(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Jz(e,t){return(KC(t)?z3:JC)(e,t)}function JC(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),s=new Array(n),o;for(o=0;o<i;++o)r[o]=jo(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(a){for(o=0;o<i;++o)s[o]=r[o](a);return s}}function QC(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function bi(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function eS(e,t){var n={},i={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=jo(e[r],t[r]):i[r]=t[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var d2=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,lm=new RegExp(d2.source,"g");function Qz(e){return function(){return e}}function eB(e){return function(t){return e(t)+""}}function B3(e,t){var n=d2.lastIndex=lm.lastIndex=0,i,r,s,o=-1,a=[],u=[];for(e=e+"",t=t+"";(i=d2.exec(e))&&(r=lm.exec(t));)(s=r.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,u.push({i:o,x:bi(i,r)})),n=lm.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?u[0]?eB(u[0].x):Qz(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)a[(f=u[c]).i]=f.x(l);return a.join("")})}function jo(e,t){var n=typeof t,i;return t==null||n==="boolean"?tg(t):(n==="number"?bi:n==="string"?(i=ja(t))?(t=i,kf):B3:t instanceof ja?kf:t instanceof Date?QC:KC(t)?z3:Array.isArray(t)?JC:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?eS:bi)(e,t)}function tB(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function nB(e,t){var n=ng(+e,+t);return function(i){var r=n(i);return r-360*Math.floor(r/360)}}function nd(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var r6=180/Math.PI,h2={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function tS(e,t,n,i,r,s){var o,a,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*i)&&(n-=e*u,i-=t*u),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,u/=a),e*i<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(t,e)*r6,skewX:Math.atan(u)*r6,scaleX:o,scaleY:a}}var Yd;function iB(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?h2:tS(t.a,t.b,t.c,t.d,t.e,t.f)}function rB(e){return e==null||(Yd||(Yd=document.createElementNS("http://www.w3.org/2000/svg","g")),Yd.setAttribute("transform",e),!(e=Yd.transform.baseVal.consolidate()))?h2:(e=e.matrix,tS(e.a,e.b,e.c,e.d,e.e,e.f))}function nS(e,t,n,i){function r(l){return l.length?l.pop()+" ":""}function s(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:bi(l,f)},{i:g-2,x:bi(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function o(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(r(f)+"rotate(",null,i)-2,x:bi(l,c)})):c&&f.push(r(f)+"rotate("+c+i)}function a(l,c,f,d){l!==c?d.push({i:f.push(r(f)+"skewX(",null,i)-2,x:bi(l,c)}):c&&f.push(r(f)+"skewX("+c+i)}function u(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push(r(h)+"scale(",null,",",null,")");p.push({i:g-4,x:bi(l,f)},{i:g-2,x:bi(c,d)})}else(f!==1||d!==1)&&h.push(r(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),s(l.translateX,l.translateY,c.translateX,c.translateY,f,d),o(l.rotate,c.rotate,f,d),a(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var p=-1,g=d.length,m;++p<g;)f[(m=d[p]).i]=m.x(h);return f.join("")}}}var iS=nS(iB,"px, ","px)","deg)"),rS=nS(rB,", ",")",")"),sB=1e-12;function s6(e){return((e=Math.exp(e))+1/e)/2}function oB(e){return((e=Math.exp(e))-1/e)/2}function aB(e){return((e=Math.exp(2*e))-1)/(e+1)}const sS=function e(t,n,i){function r(s,o){var a=s[0],u=s[1],l=s[2],c=o[0],f=o[1],d=o[2],h=c-a,p=f-u,g=h*h+p*p,m,y;if(g<sB)y=Math.log(d/l)/t,m=function(w){return[a+w*h,u+w*p,l*Math.exp(t*w*y)]};else{var v=Math.sqrt(g),b=(d*d-l*l+i*g)/(2*l*n*v),x=(d*d-l*l-i*g)/(2*d*n*v),_=Math.log(Math.sqrt(b*b+1)-b),E=Math.log(Math.sqrt(x*x+1)-x);y=(E-_)/t,m=function(w){var S=w*y,$=s6(_),F=l/(n*v)*($*aB(t*S+_)-oB(_));return[a+F*h,u+F*p,l*$/s6(t*S+_)]}}return m.duration=y*1e3*t/Math.SQRT2,m}return r.rho=function(s){var o=Math.max(.001,+s),a=o*o,u=a*a;return e(o,a,u)},r}(Math.SQRT2,2,4);function oS(e){return function(t,n){var i=e((t=g0(t)).h,(n=g0(n)).h),r=zt(t.s,n.s),s=zt(t.l,n.l),o=zt(t.opacity,n.opacity);return function(a){return t.h=i(a),t.s=r(a),t.l=s(a),t.opacity=o(a),t+""}}}const uB=oS(ng);var lB=oS(zt);function cB(e,t){var n=zt((e=y0(e)).l,(t=y0(t)).l),i=zt(e.a,t.a),r=zt(e.b,t.b),s=zt(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=i(o),e.b=r(o),e.opacity=s(o),e+""}}function aS(e){return function(t,n){var i=e((t=v0(t)).h,(n=v0(n)).h),r=zt(t.c,n.c),s=zt(t.l,n.l),o=zt(t.opacity,n.opacity);return function(a){return t.h=i(a),t.c=r(a),t.l=s(a),t.opacity=o(a),t+""}}}const fB=aS(ng);var dB=aS(zt);function uS(e){return function t(n){n=+n;function i(r,s){var o=e((r=f2(r)).h,(s=f2(s)).h),a=zt(r.s,s.s),u=zt(r.l,s.l),l=zt(r.opacity,s.opacity);return function(c){return r.h=o(c),r.s=a(c),r.l=u(Math.pow(c,n)),r.opacity=l(c),r+""}}return i.gamma=t,i}(1)}const hB=uS(ng);var pB=uS(zt);function U3(e,t){t===void 0&&(t=e,e=jo);for(var n=0,i=t.length-1,r=t[0],s=new Array(i<0?0:i);n<i;)s[n]=e(r,r=t[++n]);return function(o){var a=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return s[a](o-a)}}function gB(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}const mB=Object.freeze(Object.defineProperty({__proto__:null,interpolate:jo,interpolateArray:Jz,interpolateBasis:GC,interpolateBasisClosed:YC,interpolateCubehelix:hB,interpolateCubehelixLong:pB,interpolateDate:QC,interpolateDiscrete:tB,interpolateHcl:fB,interpolateHclLong:dB,interpolateHsl:uB,interpolateHslLong:lB,interpolateHue:nB,interpolateLab:cB,interpolateNumber:bi,interpolateNumberArray:z3,interpolateObject:eS,interpolateRgb:kf,interpolateRgbBasis:Xz,interpolateRgbBasisClosed:Kz,interpolateRound:nd,interpolateString:B3,interpolateTransformCss:iS,interpolateTransformSvg:rS,interpolateZoom:sS,piecewise:U3,quantize:gB},Symbol.toStringTag,{value:"Module"}));var il=0,Sc=0,ac=0,lS=1e3,b0,kc,x0=0,Ha=0,ig=0,Af=typeof performance=="object"&&performance.now?performance:Date,cS=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function rg(){return Ha||(cS(yB),Ha=Af.now()+ig)}function yB(){Ha=0}function $f(){this._call=this._time=this._next=null}$f.prototype=j3.prototype={constructor:$f,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?rg():+n)+(t==null?0:+t),!this._next&&kc!==this&&(kc?kc._next=this:b0=this,kc=this),this._call=e,this._time=n,p2()},stop:function(){this._call&&(this._call=null,this._time=1/0,p2())}};function j3(e,t,n){var i=new $f;return i.restart(e,t,n),i}function vB(){rg(),++il;for(var e=b0,t;e;)(t=Ha-e._time)>=0&&e._call.call(void 0,t),e=e._next;--il}function o6(){Ha=(x0=Af.now())+ig,il=Sc=0;try{vB()}finally{il=0,xB(),Ha=0}}function bB(){var e=Af.now(),t=e-x0;t>lS&&(ig-=t,x0=e)}function xB(){for(var e,t=b0,n,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:b0=n);kc=e,p2(i)}function p2(e){if(!il){Sc&&(Sc=clearTimeout(Sc));var t=e-Ha;t>24?(e<1/0&&(Sc=setTimeout(o6,e-Af.now()-ig)),ac&&(ac=clearInterval(ac))):(ac||(x0=Af.now(),ac=setInterval(bB,lS)),il=1,cS(o6))}}function a6(e,t,n){var i=new $f;return t=t==null?0:+t,i.restart(r=>{i.stop(),e(r+t)},t,n),i}function _B(e,t,n){var i=new $f,r=t;return t==null?(i.restart(e,t,n),i):(i._restart=i.restart,i.restart=function(s,o,a){o=+o,a=a==null?rg():+a,i._restart(function u(l){l+=r,i._restart(u,r+=o,a),s(l)},o,a)},i.restart(e,t,n),i)}var wB=Jp("start","end","cancel","interrupt"),EB=[],fS=0,u6=1,g2=2,Rh=3,l6=4,m2=5,Oh=6;function sg(e,t,n,i,r,s){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;CB(e,n,{name:t,index:i,group:r,on:wB,tween:EB,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:fS})}function H3(e,t){var n=sr(e,t);if(n.state>fS)throw new Error("too late; already scheduled");return n}function Wr(e,t){var n=sr(e,t);if(n.state>Rh)throw new Error("too late; already running");return n}function sr(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function CB(e,t,n){var i=e.__transition,r;i[t]=n,n.timer=j3(s,0,n.time);function s(l){n.state=u6,n.timer.restart(o,n.delay,n.time),n.delay<=l&&o(l-n.delay)}function o(l){var c,f,d,h;if(n.state!==u6)return u();for(c in i)if(h=i[c],h.name===n.name){if(h.state===Rh)return a6(o);h.state===l6?(h.state=Oh,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete i[c]):+c<t&&(h.state=Oh,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete i[c])}if(a6(function(){n.state===Rh&&(n.state=l6,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=g2,n.on.call("start",e,e.__data__,n.index,n.group),n.state===g2){for(n.state=Rh,r=new Array(d=n.tween.length),c=0,f=-1;c<d;++c)(h=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(r[++f]=h);r.length=f+1}}function a(l){for(var c=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(u),n.state=m2,1),f=-1,d=r.length;++f<d;)r[f].call(e,c);n.state===m2&&(n.on.call("end",e,e.__data__,n.index,n.group),u())}function u(){n.state=Oh,n.timer.stop(),delete i[t];for(var l in i)return;delete e.__transition}}function Ih(e,t){var n=e.__transition,i,r,s=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((i=n[o]).name!==t){s=!1;continue}r=i.state>g2&&i.state<m2,i.state=Oh,i.timer.stop(),i.on.call(r?"interrupt":"cancel",e,e.__data__,i.index,i.group),delete n[o]}s&&delete e.__transition}}function SB(e){return this.each(function(){Ih(this,e)})}function kB(e,t){var n,i;return function(){var r=Wr(this,e),s=r.tween;if(s!==n){i=n=s;for(var o=0,a=i.length;o<a;++o)if(i[o].name===t){i=i.slice(),i.splice(o,1);break}}r.tween=i}}function AB(e,t,n){var i,r;if(typeof n!="function")throw new Error;return function(){var s=Wr(this,e),o=s.tween;if(o!==i){r=(i=o).slice();for(var a={name:t,value:n},u=0,l=r.length;u<l;++u)if(r[u].name===t){r[u]=a;break}u===l&&r.push(a)}s.tween=r}}function $B(e,t){var n=this._id;if(e+="",arguments.length<2){for(var i=sr(this.node(),n).tween,r=0,s=i.length,o;r<s;++r)if((o=i[r]).name===e)return o.value;return null}return this.each((t==null?kB:AB)(n,e,t))}function q3(e,t,n){var i=e._id;return e.each(function(){var r=Wr(this,i);(r.value||(r.value={}))[t]=n.apply(this,arguments)}),function(r){return sr(r,i).value[t]}}function dS(e,t){var n;return(typeof t=="number"?bi:t instanceof ja?kf:(n=ja(t))?(t=n,kf):B3)(e,t)}function MB(e){return function(){this.removeAttribute(e)}}function TB(e){return function(){this.removeAttributeNS(e.space,e.local)}}function FB(e,t,n){var i,r=n+"",s;return function(){var o=this.getAttribute(e);return o===r?null:o===i?s:s=t(i=o,n)}}function LB(e,t,n){var i,r=n+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===r?null:o===i?s:s=t(i=o,n)}}function NB(e,t,n){var i,r,s;return function(){var o,a=n(this),u;return a==null?void this.removeAttribute(e):(o=this.getAttribute(e),u=a+"",o===u?null:o===i&&u===r?s:(r=u,s=t(i=o,a)))}}function DB(e,t,n){var i,r,s;return function(){var o,a=n(this),u;return a==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),u=a+"",o===u?null:o===i&&u===r?s:(r=u,s=t(i=o,a)))}}function RB(e,t){var n=Qp(e),i=n==="transform"?rS:dS;return this.attrTween(e,typeof t=="function"?(n.local?DB:NB)(n,i,q3(this,"attr."+e,t)):t==null?(n.local?TB:MB)(n):(n.local?LB:FB)(n,i,t))}function OB(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function IB(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function PB(e,t){var n,i;function r(){var s=t.apply(this,arguments);return s!==i&&(n=(i=s)&&IB(e,s)),n}return r._value=t,r}function zB(e,t){var n,i;function r(){var s=t.apply(this,arguments);return s!==i&&(n=(i=s)&&OB(e,s)),n}return r._value=t,r}function BB(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var i=Qp(e);return this.tween(n,(i.local?PB:zB)(i,t))}function UB(e,t){return function(){H3(this,e).delay=+t.apply(this,arguments)}}function jB(e,t){return t=+t,function(){H3(this,e).delay=t}}function HB(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?UB:jB)(t,e)):sr(this.node(),t).delay}function qB(e,t){return function(){Wr(this,e).duration=+t.apply(this,arguments)}}function VB(e,t){return t=+t,function(){Wr(this,e).duration=t}}function WB(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?qB:VB)(t,e)):sr(this.node(),t).duration}function GB(e,t){if(typeof t!="function")throw new Error;return function(){Wr(this,e).ease=t}}function YB(e){var t=this._id;return arguments.length?this.each(GB(t,e)):sr(this.node(),t).ease}function ZB(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Wr(this,e).ease=n}}function XB(e){if(typeof e!="function")throw new Error;return this.each(ZB(this._id,e))}function KB(e){typeof e!="function"&&(e=SC(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var s=t[r],o=s.length,a=i[r]=[],u,l=0;l<o;++l)(u=s[l])&&e.call(u,u.__data__,l,s)&&a.push(u);return new Ns(i,this._parents,this._name,this._id)}function JB(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,i=t.length,r=n.length,s=Math.min(i,r),o=new Array(i),a=0;a<s;++a)for(var u=t[a],l=n[a],c=u.length,f=o[a]=new Array(c),d,h=0;h<c;++h)(d=u[h]||l[h])&&(f[h]=d);for(;a<i;++a)o[a]=t[a];return new Ns(o,this._parents,this._name,this._id)}function QB(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function eU(e,t,n){var i,r,s=QB(t)?H3:Wr;return function(){var o=s(this,e),a=o.on;a!==i&&(r=(i=a).copy()).on(t,n),o.on=r}}function tU(e,t){var n=this._id;return arguments.length<2?sr(this.node(),n).on.on(e):this.each(eU(n,e,t))}function nU(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function iU(){return this.on("end.remove",nU(this._id))}function rU(e){var t=this._name,n=this._id;typeof e!="function"&&(e=D3(e));for(var i=this._groups,r=i.length,s=new Array(r),o=0;o<r;++o)for(var a=i[o],u=a.length,l=s[o]=new Array(u),c,f,d=0;d<u;++d)(c=a[d])&&(f=e.call(c,c.__data__,d,a))&&("__data__"in c&&(f.__data__=c.__data__),l[d]=f,sg(l[d],t,n,d,l,sr(c,n)));return new Ns(s,this._parents,t,n)}function sU(e){var t=this._name,n=this._id;typeof e!="function"&&(e=CC(e));for(var i=this._groups,r=i.length,s=[],o=[],a=0;a<r;++a)for(var u=i[a],l=u.length,c,f=0;f<l;++f)if(c=u[f]){for(var d=e.call(c,c.__data__,f,u),h,p=sr(c,n),g=0,m=d.length;g<m;++g)(h=d[g])&&sg(h,t,n,g,d,p);s.push(d),o.push(c)}return new Ns(s,o,t,n)}var oU=ed.prototype.constructor;function aU(){return new oU(this._groups,this._parents)}function uU(e,t){var n,i,r;return function(){var s=tl(this,e),o=(this.style.removeProperty(e),tl(this,e));return s===o?null:s===n&&o===i?r:r=t(n=s,i=o)}}function hS(e){return function(){this.style.removeProperty(e)}}function lU(e,t,n){var i,r=n+"",s;return function(){var o=tl(this,e);return o===r?null:o===i?s:s=t(i=o,n)}}function cU(e,t,n){var i,r,s;return function(){var o=tl(this,e),a=n(this),u=a+"";return a==null&&(u=a=(this.style.removeProperty(e),tl(this,e))),o===u?null:o===i&&u===r?s:(r=u,s=t(i=o,a))}}function fU(e,t){var n,i,r,s="style."+t,o="end."+s,a;return function(){var u=Wr(this,e),l=u.on,c=u.value[s]==null?a||(a=hS(t)):void 0;(l!==n||r!==c)&&(i=(n=l).copy()).on(o,r=c),u.on=i}}function dU(e,t,n){var i=(e+="")=="transform"?iS:dS;return t==null?this.styleTween(e,uU(e,i)).on("end.style."+e,hS(e)):typeof t=="function"?this.styleTween(e,cU(e,i,q3(this,"style."+e,t))).each(fU(this._id,e)):this.styleTween(e,lU(e,i,t),n).on("end.style."+e,null)}function hU(e,t,n){return function(i){this.style.setProperty(e,t.call(this,i),n)}}function pU(e,t,n){var i,r;function s(){var o=t.apply(this,arguments);return o!==r&&(i=(r=o)&&hU(e,o,n)),i}return s._value=t,s}function gU(e,t,n){var i="style."+(e+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(t==null)return this.tween(i,null);if(typeof t!="function")throw new Error;return this.tween(i,pU(e,t,n??""))}function mU(e){return function(){this.textContent=e}}function yU(e){return function(){var t=e(this);this.textContent=t??""}}function vU(e){return this.tween("text",typeof e=="function"?yU(q3(this,"text",e)):mU(e==null?"":e+""))}function bU(e){return function(t){this.textContent=e.call(this,t)}}function xU(e){var t,n;function i(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&bU(r)),t}return i._value=e,i}function _U(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,xU(e))}function wU(){for(var e=this._name,t=this._id,n=pS(),i=this._groups,r=i.length,s=0;s<r;++s)for(var o=i[s],a=o.length,u,l=0;l<a;++l)if(u=o[l]){var c=sr(u,t);sg(u,e,n,l,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Ns(i,this._parents,e,n)}function EU(){var e,t,n=this,i=n._id,r=n.size();return new Promise(function(s,o){var a={value:o},u={value:function(){--r===0&&s()}};n.each(function(){var l=Wr(this,i),c=l.on;c!==e&&(t=(e=c).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(u)),l.on=t}),r===0&&s()})}var CU=0;function Ns(e,t,n,i){this._groups=e,this._parents=t,this._name=n,this._id=i}function pS(){return++CU}var os=ed.prototype;Ns.prototype={constructor:Ns,select:rU,selectAll:sU,selectChild:os.selectChild,selectChildren:os.selectChildren,filter:KB,merge:JB,selection:aU,transition:wU,call:os.call,nodes:os.nodes,node:os.node,size:os.size,empty:os.empty,each:os.each,on:tU,attr:RB,attrTween:BB,style:dU,styleTween:gU,text:vU,textTween:_U,remove:iU,tween:$B,delay:HB,duration:WB,ease:YB,easeVarying:XB,end:EU,[Symbol.iterator]:os[Symbol.iterator]};function SU(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var kU={time:null,delay:0,duration:250,ease:SU};function AU(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function $U(e){var t,n;e instanceof Ns?(t=e._id,e=e._name):(t=pS(),(n=kU).time=rg(),e=e==null?null:e+"");for(var i=this._groups,r=i.length,s=0;s<r;++s)for(var o=i[s],a=o.length,u,l=0;l<a;++l)(u=o[l])&&sg(u,e,t,l,o,n||AU(u,t));return new Ns(i,this._parents,e,t)}ed.prototype.interrupt=SB;ed.prototype.transition=$U;const y2=Math.PI,v2=2*y2,la=1e-6,MU=v2-la;function gS(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function TU(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return gS;const n=10**t;return function(i){this._+=i[0];for(let r=1,s=i.length;r<s;++r)this._+=Math.round(arguments[r]*n)/n+i[r]}}let V3=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?gS:TU(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,i,r){this._append`Q${+t},${+n},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(t,n,i,r,s,o){this._append`C${+t},${+n},${+i},${+r},${this._x1=+s},${this._y1=+o}`}arcTo(t,n,i,r,s){if(t=+t,n=+n,i=+i,r=+r,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,a=this._y1,u=i-t,l=r-n,c=o-t,f=a-n,d=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(d>la)if(!(Math.abs(f*u-l*c)>la)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let h=i-o,p=r-a,g=u*u+l*l,m=h*h+p*p,y=Math.sqrt(g),v=Math.sqrt(d),b=s*Math.tan((y2-Math.acos((g+d-m)/(2*y*v)))/2),x=b/v,_=b/y;Math.abs(x-1)>la&&this._append`L${t+x*c},${n+x*f}`,this._append`A${s},${s},0,0,${+(f*h>c*p)},${this._x1=t+_*u},${this._y1=n+_*l}`}}arc(t,n,i,r,s,o){if(t=+t,n=+n,i=+i,o=!!o,i<0)throw new Error(`negative radius: ${i}`);let a=i*Math.cos(r),u=i*Math.sin(r),l=t+a,c=n+u,f=1^o,d=o?r-s:s-r;this._x1===null?this._append`M${l},${c}`:(Math.abs(this._x1-l)>la||Math.abs(this._y1-c)>la)&&this._append`L${l},${c}`,i&&(d<0&&(d=d%v2+v2),d>MU?this._append`A${i},${i},0,1,${f},${t-a},${n-u}A${i},${i},0,1,${f},${this._x1=l},${this._y1=c}`:d>la&&this._append`A${i},${i},0,${+(d>=y2)},${f},${this._x1=t+i*Math.cos(s)},${this._y1=n+i*Math.sin(s)}`)}rect(t,n,i,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}};function W3(){return new V3}W3.prototype=V3.prototype;const ks=11102230246251565e-32,tn=134217729,FU=(3+8*ks)*ks;function cm(e,t,n,i,r){let s,o,a,u,l=t[0],c=i[0],f=0,d=0;c>l==c>-l?(s=l,l=t[++f]):(s=c,c=i[++d]);let h=0;if(f<e&&d<n)for(c>l==c>-l?(o=l+s,a=s-(o-l),l=t[++f]):(o=c+s,a=s-(o-c),c=i[++d]),s=o,a!==0&&(r[h++]=a);f<e&&d<n;)c>l==c>-l?(o=s+l,u=o-s,a=s-(o-u)+(l-u),l=t[++f]):(o=s+c,u=o-s,a=s-(o-u)+(c-u),c=i[++d]),s=o,a!==0&&(r[h++]=a);for(;f<e;)o=s+l,u=o-s,a=s-(o-u)+(l-u),l=t[++f],s=o,a!==0&&(r[h++]=a);for(;d<n;)o=s+c,u=o-s,a=s-(o-u)+(c-u),c=i[++d],s=o,a!==0&&(r[h++]=a);return(s!==0||h===0)&&(r[h++]=s),h}function LU(e,t){let n=t[0];for(let i=1;i<e;i++)n+=t[i];return n}function id(e){return new Float64Array(e)}const NU=(3+16*ks)*ks,DU=(2+12*ks)*ks,RU=(9+64*ks)*ks*ks,ku=id(4),c6=id(8),f6=id(12),d6=id(16),gn=id(4);function OU(e,t,n,i,r,s,o){let a,u,l,c,f,d,h,p,g,m,y,v,b,x,_,E,w,S;const $=e-r,F=n-r,T=t-s,P=i-s;x=$*P,d=tn*$,h=d-(d-$),p=$-h,d=tn*P,g=d-(d-P),m=P-g,_=p*m-(x-h*g-p*g-h*m),E=T*F,d=tn*T,h=d-(d-T),p=T-h,d=tn*F,g=d-(d-F),m=F-g,w=p*m-(E-h*g-p*g-h*m),y=_-w,f=_-y,ku[0]=_-(y+f)+(f-w),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-E,f=b-y,ku[1]=b-(y+f)+(f-E),S=v+y,f=S-v,ku[2]=v-(S-f)+(y-f),ku[3]=S;let R=LU(4,ku),C=DU*o;if(R>=C||-R>=C||(f=e-$,a=e-($+f)+(f-r),f=n-F,l=n-(F+f)+(f-r),f=t-T,u=t-(T+f)+(f-s),f=i-P,c=i-(P+f)+(f-s),a===0&&u===0&&l===0&&c===0)||(C=RU*o+FU*Math.abs(R),R+=$*c+P*a-(T*l+F*u),R>=C||-R>=C))return R;x=a*P,d=tn*a,h=d-(d-a),p=a-h,d=tn*P,g=d-(d-P),m=P-g,_=p*m-(x-h*g-p*g-h*m),E=u*F,d=tn*u,h=d-(d-u),p=u-h,d=tn*F,g=d-(d-F),m=F-g,w=p*m-(E-h*g-p*g-h*m),y=_-w,f=_-y,gn[0]=_-(y+f)+(f-w),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-E,f=b-y,gn[1]=b-(y+f)+(f-E),S=v+y,f=S-v,gn[2]=v-(S-f)+(y-f),gn[3]=S;const A=cm(4,ku,4,gn,c6);x=$*c,d=tn*$,h=d-(d-$),p=$-h,d=tn*c,g=d-(d-c),m=c-g,_=p*m-(x-h*g-p*g-h*m),E=T*l,d=tn*T,h=d-(d-T),p=T-h,d=tn*l,g=d-(d-l),m=l-g,w=p*m-(E-h*g-p*g-h*m),y=_-w,f=_-y,gn[0]=_-(y+f)+(f-w),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-E,f=b-y,gn[1]=b-(y+f)+(f-E),S=v+y,f=S-v,gn[2]=v-(S-f)+(y-f),gn[3]=S;const M=cm(A,c6,4,gn,f6);x=a*c,d=tn*a,h=d-(d-a),p=a-h,d=tn*c,g=d-(d-c),m=c-g,_=p*m-(x-h*g-p*g-h*m),E=u*l,d=tn*u,h=d-(d-u),p=u-h,d=tn*l,g=d-(d-l),m=l-g,w=p*m-(E-h*g-p*g-h*m),y=_-w,f=_-y,gn[0]=_-(y+f)+(f-w),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-E,f=b-y,gn[1]=b-(y+f)+(f-E),S=v+y,f=S-v,gn[2]=v-(S-f)+(y-f),gn[3]=S;const L=cm(M,f6,4,gn,d6);return d6[L-1]}function Zd(e,t,n,i,r,s){const o=(t-s)*(n-r),a=(e-r)*(i-s),u=o-a,l=Math.abs(o+a);return Math.abs(u)>=NU*l?u:-OU(e,t,n,i,r,s,l)}const h6=Math.pow(2,-52),Xd=new Uint32Array(512);class _0{static from(t,n=UU,i=jU){const r=t.length,s=new Float64Array(r*2);for(let o=0;o<r;o++){const a=t[o];s[2*o]=n(a),s[2*o+1]=i(a)}return new _0(s)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:s}=this,o=t.length>>1;let a=1/0,u=1/0,l=-1/0,c=-1/0;for(let $=0;$<o;$++){const F=t[2*$],T=t[2*$+1];F<a&&(a=F),T<u&&(u=T),F>l&&(l=F),T>c&&(c=T),this._ids[$]=$}const f=(a+l)/2,d=(u+c)/2;let h,p,g;for(let $=0,F=1/0;$<o;$++){const T=fm(f,d,t[2*$],t[2*$+1]);T<F&&(h=$,F=T)}const m=t[2*h],y=t[2*h+1];for(let $=0,F=1/0;$<o;$++){if($===h)continue;const T=fm(m,y,t[2*$],t[2*$+1]);T<F&&T>0&&(p=$,F=T)}let v=t[2*p],b=t[2*p+1],x=1/0;for(let $=0;$<o;$++){if($===h||$===p)continue;const F=zU(m,y,v,b,t[2*$],t[2*$+1]);F<x&&(g=$,x=F)}let _=t[2*g],E=t[2*g+1];if(x===1/0){for(let T=0;T<o;T++)this._dists[T]=t[2*T]-t[0]||t[2*T+1]-t[1];zu(this._ids,this._dists,0,o-1);const $=new Uint32Array(o);let F=0;for(let T=0,P=-1/0;T<o;T++){const R=this._ids[T],C=this._dists[R];C>P&&($[F++]=R,P=C)}this.hull=$.subarray(0,F),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Zd(m,y,v,b,_,E)<0){const $=p,F=v,T=b;p=g,v=_,b=E,g=$,_=F,E=T}const w=BU(m,y,v,b,_,E);this._cx=w.x,this._cy=w.y;for(let $=0;$<o;$++)this._dists[$]=fm(t[2*$],t[2*$+1],w.x,w.y);zu(this._ids,this._dists,0,o-1),this._hullStart=h;let S=3;i[h]=n[g]=p,i[p]=n[h]=g,i[g]=n[p]=h,r[h]=0,r[p]=1,r[g]=2,s.fill(-1),s[this._hashKey(m,y)]=h,s[this._hashKey(v,b)]=p,s[this._hashKey(_,E)]=g,this.trianglesLen=0,this._addTriangle(h,p,g,-1,-1,-1);for(let $=0,F,T;$<this._ids.length;$++){const P=this._ids[$],R=t[2*P],C=t[2*P+1];if($>0&&Math.abs(R-F)<=h6&&Math.abs(C-T)<=h6||(F=R,T=C,P===h||P===p||P===g))continue;let A=0;for(let j=0,J=this._hashKey(R,C);j<this._hashSize&&(A=s[(J+j)%this._hashSize],!(A!==-1&&A!==i[A]));j++);A=n[A];let M=A,L;for(;L=i[M],Zd(R,C,t[2*M],t[2*M+1],t[2*L],t[2*L+1])>=0;)if(M=L,M===A){M=-1;break}if(M===-1)continue;let D=this._addTriangle(M,P,i[M],-1,-1,r[M]);r[P]=this._legalize(D+2),r[M]=D,S++;let O=i[M];for(;L=i[O],Zd(R,C,t[2*O],t[2*O+1],t[2*L],t[2*L+1])<0;)D=this._addTriangle(O,P,L,r[P],-1,r[O]),r[P]=this._legalize(D+2),i[O]=O,S--,O=L;if(M===A)for(;L=n[M],Zd(R,C,t[2*L],t[2*L+1],t[2*M],t[2*M+1])<0;)D=this._addTriangle(L,P,M,-1,r[M],r[L]),this._legalize(D+2),r[L]=D,i[M]=M,S--,M=L;this._hullStart=n[P]=M,i[M]=n[O]=P,i[P]=O,s[this._hashKey(R,C)]=P,s[this._hashKey(t[2*M],t[2*M+1])]=M}this.hull=new Uint32Array(S);for(let $=0,F=this._hullStart;$<S;$++)this.hull[$]=F,F=i[F];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(IU(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let s=0,o=0;for(;;){const a=i[t],u=t-t%3;if(o=u+(t+2)%3,a===-1){if(s===0)break;t=Xd[--s];continue}const l=a-a%3,c=u+(t+1)%3,f=l+(a+2)%3,d=n[o],h=n[t],p=n[c],g=n[f];if(PU(r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*p],r[2*p+1],r[2*g],r[2*g+1])){n[t]=g,n[a]=d;const y=i[f];if(y===-1){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=t;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(t,y),this._link(a,i[o]),this._link(o,f);const v=l+(a+1)%3;s<Xd.length&&(Xd[s++]=v)}else{if(s===0)break;t=Xd[--s]}}return o}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,s,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=i,this._link(a,r),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function IU(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function fm(e,t,n,i){const r=e-n,s=t-i;return r*r+s*s}function PU(e,t,n,i,r,s,o,a){const u=e-o,l=t-a,c=n-o,f=i-a,d=r-o,h=s-a,p=u*u+l*l,g=c*c+f*f,m=d*d+h*h;return u*(f*m-g*h)-l*(c*m-g*d)+p*(c*h-f*d)<0}function zU(e,t,n,i,r,s){const o=n-e,a=i-t,u=r-e,l=s-t,c=o*o+a*a,f=u*u+l*l,d=.5/(o*l-a*u),h=(l*c-a*f)*d,p=(o*f-u*c)*d;return h*h+p*p}function BU(e,t,n,i,r,s){const o=n-e,a=i-t,u=r-e,l=s-t,c=o*o+a*a,f=u*u+l*l,d=.5/(o*l-a*u),h=e+(l*c-a*f)*d,p=t+(o*f-u*c)*d;return{x:h,y:p}}function zu(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const s=e[r],o=t[s];let a=r-1;for(;a>=n&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=s}else{const r=n+i>>1;let s=n+1,o=i;uc(e,r,s),t[e[n]]>t[e[i]]&&uc(e,n,i),t[e[s]]>t[e[i]]&&uc(e,s,i),t[e[n]]>t[e[s]]&&uc(e,n,s);const a=e[s],u=t[a];for(;;){do s++;while(t[e[s]]<u);do o--;while(t[e[o]]>u);if(o<s)break;uc(e,s,o)}e[n+1]=e[o],e[o]=a,i-s+1>=o-n?(zu(e,t,s,i),zu(e,t,n,o-1)):(zu(e,t,n,o-1),zu(e,t,s,i))}}function uc(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function UU(e){return e[0]}function jU(e){return e[1]}const p6=1e-6;class _a{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,i){t=+t,n=+n,i=+i;const r=t+i,s=n;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${s}`:(Math.abs(this._x1-r)>p6||Math.abs(this._y1-s)>p6)&&(this._+="L"+r+","+s),i&&(this._+=`A${i},${i},0,1,1,${t-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=s}`)}rect(t,n,i,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class b2{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}let HU=class{constructor(t,[n,i,r,s]=[0,0,960,500]){if(!((r=+r)>=(n=+n))||!((s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=r,this.xmin=n,this.ymax=s,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:i},vectors:r}=this;let s,o;const a=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let g=0,m=0,y=i.length,v,b;g<y;g+=3,m+=2){const x=i[g]*2,_=i[g+1]*2,E=i[g+2]*2,w=t[x],S=t[x+1],$=t[_],F=t[_+1],T=t[E],P=t[E+1],R=$-w,C=F-S,A=T-w,M=P-S,L=(R*M-C*A)*2;if(Math.abs(L)<1e-9){if(s===void 0){s=o=0;for(const O of n)s+=t[O*2],o+=t[O*2+1];s/=n.length,o/=n.length}const D=1e9*Math.sign((s-w)*M-(o-S)*A);v=(w+T)/2-D*M,b=(S+P)/2+D*A}else{const D=1/L,O=R*R+C*C,j=A*A+M*M;v=w+(M*O-C*j)*D,b=S+(R*j-A*O)*D}a[m]=v,a[m+1]=b}let u=n[n.length-1],l,c=u*4,f,d=t[2*u],h,p=t[2*u+1];r.fill(0);for(let g=0;g<n.length;++g)u=n[g],l=c,f=d,h=p,c=u*4,d=t[2*u],p=t[2*u+1],r[l+2]=r[c]=h-p,r[l+3]=r[c+1]=d-f}render(t){const n=t==null?t=new _a:void 0,{delaunay:{halfedges:i,inedges:r,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let c=0,f=i.length;c<f;++c){const d=i[c];if(d<c)continue;const h=Math.floor(c/3)*2,p=Math.floor(d/3)*2,g=o[h],m=o[h+1],y=o[p],v=o[p+1];this._renderSegment(g,m,y,v,t)}let u,l=s[s.length-1];for(let c=0;c<s.length;++c){u=l,l=s[c];const f=Math.floor(r[l]/3)*2,d=o[f],h=o[f+1],p=u*4,g=this._project(d,h,a[p+2],a[p+3]);g&&this._renderSegment(d,h,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new _a:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const i=n==null?n=new _a:void 0,r=this._clip(t);if(r===null||!r.length)return;n.moveTo(r[0],r[1]);let s=r.length;for(;r[0]===r[s-2]&&r[1]===r[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(r[o]!==r[o-2]||r[o+1]!==r[o-1])&&n.lineTo(r[o],r[o+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,i=t.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(t){const n=new b2;return this.renderCell(t,n),n.value()}_renderSegment(t,n,i,r,s){let o;const a=this._regioncode(t,n),u=this._regioncode(i,r);a===0&&u===0?(s.moveTo(t,n),s.lineTo(i,r)):(o=this._clipSegment(t,n,i,r,a,u))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(t,n,i){return n=+n,n!==n||(i=+i,i!==i)?!1:this.delaunay._step(t,n,i)===t}*neighbors(t){const n=this._clip(t);if(n)for(const i of this.delaunay.neighbors(t)){const r=this._clip(i);if(r){e:for(let s=0,o=n.length;s<o;s+=2)for(let a=0,u=r.length;a<u;a+=2)if(n[s]===r[a]&&n[s+1]===r[a+1]&&n[(s+2)%o]===r[(a+u-2)%u]&&n[(s+3)%o]===r[(a+u-1)%u]){yield i;break e}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:s}}=this,o=i[t];if(o===-1)return null;const a=[];let u=o;do{const l=Math.floor(u/3);if(a.push(n[l*2],n[l*2+1]),u=u%3===2?u-2:u+1,s[u]!==t)break;u=r[u]}while(u!==o&&u!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:i}=this,r=t*4;return this._simplify(i[r]||i[r+1]?this._clipInfinite(t,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(t,n))}_clipFinite(t,n){const i=n.length;let r=null,s,o,a=n[i-2],u=n[i-1],l,c=this._regioncode(a,u),f,d=0;for(let h=0;h<i;h+=2)if(s=a,o=u,a=n[h],u=n[h+1],l=c,c=this._regioncode(a,u),l===0&&c===0)f=d,d=0,r?r.push(a,u):r=[a,u];else{let p,g,m,y,v;if(l===0){if((p=this._clipSegment(s,o,a,u,l,c))===null)continue;[g,m,y,v]=p}else{if((p=this._clipSegment(a,u,s,o,c,l))===null)continue;[y,v,g,m]=p,f=d,d=this._edgecode(g,m),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(g,m):r=[g,m]}f=d,d=this._edgecode(y,v),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(y,v):r=[y,v]}if(r)f=d,d=this._edgecode(r[0],r[1]),f&&d&&this._edge(t,f,d,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(t,n,i,r,s,o){const a=s<o;for(a&&([t,n,i,r,s,o]=[i,r,t,n,o,s]);;){if(s===0&&o===0)return a?[i,r,t,n]:[t,n,i,r];if(s&o)return null;let u,l,c=s||o;c&8?(u=t+(i-t)*(this.ymax-n)/(r-n),l=this.ymax):c&4?(u=t+(i-t)*(this.ymin-n)/(r-n),l=this.ymin):c&2?(l=n+(r-n)*(this.xmax-t)/(i-t),u=this.xmax):(l=n+(r-n)*(this.xmin-t)/(i-t),u=this.xmin),s?(t=u,n=l,s=this._regioncode(t,n)):(i=u,r=l,o=this._regioncode(i,r))}}_clipInfinite(t,n,i,r,s,o){let a=Array.from(n),u;if((u=this._project(a[0],a[1],i,r))&&a.unshift(u[0],u[1]),(u=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(u[0],u[1]),a=this._clipFinite(t,a))for(let l=0,c=a.length,f,d=this._edgecode(a[c-2],a[c-1]);l<c;l+=2)f=d,d=this._edgecode(a[l],a[l+1]),f&&d&&(l=this._edge(t,f,d,a,l),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,i,r,s){for(;n!==i;){let o,a;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,a=this.ymin;break}(r[s]!==o||r[s+1]!==a)&&this.contains(t,o,a)&&(r.splice(s,0,o,a),s+=2)}return s}_project(t,n,i,r){let s=1/0,o,a,u;if(r<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/r)<s&&(u=this.ymin,a=t+(s=o)*i)}else if(r>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/r)<s&&(u=this.ymax,a=t+(s=o)*i)}if(i>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/i)<s&&(a=this.xmax,u=n+(s=o)*r)}else if(i<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/i)<s&&(a=this.xmin,u=n+(s=o)*r)}return[a,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let n=0;n<t.length;n+=2){const i=(n+2)%t.length,r=(n+4)%t.length;(t[n]===t[i]&&t[i]===t[r]||t[n+1]===t[i+1]&&t[i+1]===t[r+1])&&(t.splice(i,2),n-=2)}t.length||(t=null)}return t}};const qU=2*Math.PI,Au=Math.pow;function VU(e){return e[0]}function WU(e){return e[1]}function GU(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const r=2*t[i],s=2*t[i+1],o=2*t[i+2];if((n[o]-n[r])*(n[s+1]-n[r+1])-(n[s]-n[r])*(n[o+1]-n[r+1])>1e-10)return!1}return!0}function YU(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class G3{static from(t,n=VU,i=WU,r){return new G3("length"in t?ZU(t,n,i,r):Float64Array.from(XU(t,n,i,r)))}constructor(t){this._delaunator=new _0(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&GU(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const p=YU(n[2*d],n[2*d+1],f);n[2*d]=p[0],n[2*d+1]=p[1]}this._delaunator=new _0(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let u=0,l=i.length;u<l;++u){const c=s[u%3===2?u-2:u+1];(i[u]===-1||o[c]===-1)&&(o[c]=u)}for(let u=0,l=r.length;u<l;++u)a[r[u]]=u;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,r.length===2&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(t){return new HU(this,t)}*neighbors(t){const{inedges:n,hull:i,_hullIndex:r,halfedges:s,triangles:o,collinear:a}=this;if(a){const f=a.indexOf(t);f>0&&(yield a[f-1]),f<a.length-1&&(yield a[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=o[l],l=l%3===2?l-2:l+1,o[l]!==t)return;if(l=s[l],l===-1){const f=i[(r[t]+1)%i.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,i=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const r=i;let s;for(;(s=this._step(i,t,n))>=0&&s!==i&&s!==r;)i=s;return s}_step(t,n,i){const{inedges:r,hull:s,_hullIndex:o,halfedges:a,triangles:u,points:l}=this;if(r[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=Au(n-l[t*2],2)+Au(i-l[t*2+1],2);const d=r[t];let h=d;do{let p=u[h];const g=Au(n-l[p*2],2)+Au(i-l[p*2+1],2);if(g<f&&(f=g,c=p),h=h%3===2?h-2:h+1,u[h]!==t)break;if(h=a[h],h===-1){if(h=s[(o[t]+1)%s.length],h!==p&&Au(n-l[h*2],2)+Au(i-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new _a:void 0,{points:i,halfedges:r,triangles:s}=this;for(let o=0,a=r.length;o<a;++o){const u=r[o];if(u<o)continue;const l=s[o]*2,c=s[u]*2;t.moveTo(i[l],i[l+1]),t.lineTo(i[c],i[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){n===void 0&&(!t||typeof t.moveTo!="function")&&(n=t,t=null),n=n==null?2:+n;const i=t==null?t=new _a:void 0,{points:r}=this;for(let s=0,o=r.length;s<o;s+=2){const a=r[s],u=r[s+1];t.moveTo(a+n,u),t.arc(a,u,n,0,qU)}return i&&i.value()}renderHull(t){const n=t==null?t=new _a:void 0,{hull:i,points:r}=this,s=i[0]*2,o=i.length;t.moveTo(r[s],r[s+1]);for(let a=1;a<o;++a){const u=2*i[a];t.lineTo(r[u],r[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new b2;return this.renderHull(t),t.value()}renderTriangle(t,n){const i=n==null?n=new _a:void 0,{points:r,triangles:s}=this,o=s[t*=3]*2,a=s[t+1]*2,u=s[t+2]*2;return n.moveTo(r[o],r[o+1]),n.lineTo(r[a],r[a+1]),n.lineTo(r[u],r[u+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,i=t.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new b2;return this.renderTriangle(t,n),n.value()}}function ZU(e,t,n,i){const r=e.length,s=new Float64Array(r*2);for(let o=0;o<r;++o){const a=e[o];s[o*2]=t.call(i,a,o,e),s[o*2+1]=n.call(i,a,o,e)}return s}function*XU(e,t,n,i){let r=0;for(const s of e)yield t.call(i,s,r,e),yield n.call(i,s,r,e),++r}var g6={},dm={},hm=34,lc=10,pm=13;function mS(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function KU(e,t){var n=mS(e);return function(i,r){return t(n(i),r,e)}}function m6(e){var t=Object.create(null),n=[];return e.forEach(function(i){for(var r in i)r in t||n.push(t[r]=r)}),n}function Hn(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function JU(e){return e<0?"-"+Hn(-e,6):e>9999?"+"+Hn(e,6):Hn(e,4)}function QU(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":JU(e.getUTCFullYear())+"-"+Hn(e.getUTCMonth()+1,2)+"-"+Hn(e.getUTCDate(),2)+(r?"T"+Hn(t,2)+":"+Hn(n,2)+":"+Hn(i,2)+"."+Hn(r,3)+"Z":i?"T"+Hn(t,2)+":"+Hn(n,2)+":"+Hn(i,2)+"Z":n||t?"T"+Hn(t,2)+":"+Hn(n,2)+"Z":"")}function ej(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function i(f,d){var h,p,g=r(f,function(m,y){if(h)return h(m,y-1);p=m,h=d?KU(m,d):mS(m)});return g.columns=p||[],g}function r(f,d){var h=[],p=f.length,g=0,m=0,y,v=p<=0,b=!1;f.charCodeAt(p-1)===lc&&--p,f.charCodeAt(p-1)===pm&&--p;function x(){if(v)return dm;if(b)return b=!1,g6;var E,w=g,S;if(f.charCodeAt(w)===hm){for(;g++<p&&f.charCodeAt(g)!==hm||f.charCodeAt(++g)===hm;);return(E=g)>=p?v=!0:(S=f.charCodeAt(g++))===lc?b=!0:S===pm&&(b=!0,f.charCodeAt(g)===lc&&++g),f.slice(w+1,E-1).replace(/""/g,'"')}for(;g<p;){if((S=f.charCodeAt(E=g++))===lc)b=!0;else if(S===pm)b=!0,f.charCodeAt(g)===lc&&++g;else if(S!==n)continue;return f.slice(w,E)}return v=!0,f.slice(w,p)}for(;(y=x())!==dm;){for(var _=[];y!==g6&&y!==dm;)_.push(y),y=x();d&&(_=d(_,m++))==null||h.push(_)}return h}function s(f,d){return f.map(function(h){return d.map(function(p){return c(h[p])}).join(e)})}function o(f,d){return d==null&&(d=m6(f)),[d.map(c).join(e)].concat(s(f,d)).join(`
`)}function a(f,d){return d==null&&(d=m6(f)),s(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?QU(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:i,parseRows:r,format:o,formatBody:a,formatRows:u,formatRow:l,formatValue:c}}function tj(e,t){var n,i=1;e==null&&(e=0),t==null&&(t=0);function r(){var s,o=n.length,a,u=0,l=0;for(s=0;s<o;++s)a=n[s],u+=a.x,l+=a.y;for(u=(u/o-e)*i,l=(l/o-t)*i,s=0;s<o;++s)a=n[s],a.x-=u,a.y-=l}return r.initialize=function(s){n=s},r.x=function(s){return arguments.length?(e=+s,r):e},r.y=function(s){return arguments.length?(t=+s,r):t},r.strength=function(s){return arguments.length?(i=+s,r):i},r}function nj(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return yS(this.cover(t,n),t,n,e)}function yS(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,s=e._root,o={data:i},a=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,p,g,m,y,v;if(!s)return e._root=o,e;for(;s.length;)if((g=t>=(f=(a+l)/2))?a=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d,r=s,!(s=s[y=m<<1|g]))return r[y]=o,e;if(h=+e._x.call(null,s.data),p=+e._y.call(null,s.data),t===h&&n===p)return o.next=s,r?r[y]=o:e._root=o,e;do r=r?r[y]=new Array(4):e._root=new Array(4),(g=t>=(f=(a+l)/2))?a=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d;while((y=m<<1|g)===(v=(p>=d)<<1|h>=f));return r[v]=s,r[y]=o,e}function ij(e){var t,n,i=e.length,r,s,o=new Array(i),a=new Array(i),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(o[n]=r,a[n]=s,r<u&&(u=r),r>c&&(c=r),s<l&&(l=s),s>f&&(f=s));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<i;++n)yS(this,o[n],a[n],e[n]);return this}function rj(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,s=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,s=(i=Math.floor(t))+1;else{for(var o=r-n||1,a=this._root,u,l;n>e||e>=r||i>t||t>=s;)switch(l=(t<i)<<1|e<n,u=new Array(4),u[l]=a,a=u,o*=2,l){case 0:r=n+o,s=i+o;break;case 1:n=r-o,s=i+o;break;case 2:r=n+o,i=s-o;break;case 3:n=r-o,i=s-o;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=i,this._x1=r,this._y1=s,this}function sj(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function oj(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Sn(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function aj(e,t,n){var i,r=this._x0,s=this._y0,o,a,u,l,c=this._x1,f=this._y1,d=[],h=this._root,p,g;for(h&&d.push(new Sn(h,r,s,c,f)),n==null?n=1/0:(r=e-n,s=t-n,c=e+n,f=t+n,n*=n);p=d.pop();)if(!(!(h=p.node)||(o=p.x0)>c||(a=p.y0)>f||(u=p.x1)<r||(l=p.y1)<s))if(h.length){var m=(o+u)/2,y=(a+l)/2;d.push(new Sn(h[3],m,y,u,l),new Sn(h[2],o,y,m,l),new Sn(h[1],m,a,u,y),new Sn(h[0],o,a,m,y)),(g=(t>=y)<<1|e>=m)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-g],d[d.length-1-g]=p)}else{var v=e-+this._x.call(null,h.data),b=t-+this._y.call(null,h.data),x=v*v+b*b;if(x<n){var _=Math.sqrt(n=x);r=e-_,s=t-_,c=e+_,f=t+_,i=h.data}}return i}function uj(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,i,r,s,o=this._x0,a=this._y0,u=this._x1,l=this._y1,c,f,d,h,p,g,m,y;if(!n)return this;if(n.length)for(;;){if((p=c>=(d=(o+u)/2))?o=d:u=d,(g=f>=(h=(a+l)/2))?a=h:l=h,t=n,!(n=n[m=g<<1|p]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(i=t,y=m)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,r?(s?r.next=s:delete r.next,this):t?(s?t[m]=s:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(i?i[y]=n:this._root=n),this):(this._root=s,this)}function lj(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function cj(){return this._root}function fj(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function dj(e){var t=[],n,i=this._root,r,s,o,a,u;for(i&&t.push(new Sn(i,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(i=n.node,s=n.x0,o=n.y0,a=n.x1,u=n.y1)&&i.length){var l=(s+a)/2,c=(o+u)/2;(r=i[3])&&t.push(new Sn(r,l,c,a,u)),(r=i[2])&&t.push(new Sn(r,s,c,l,u)),(r=i[1])&&t.push(new Sn(r,l,o,a,c)),(r=i[0])&&t.push(new Sn(r,s,o,l,c))}return this}function hj(e){var t=[],n=[],i;for(this._root&&t.push(new Sn(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var s,o=i.x0,a=i.y0,u=i.x1,l=i.y1,c=(o+u)/2,f=(a+l)/2;(s=r[0])&&t.push(new Sn(s,o,a,c,f)),(s=r[1])&&t.push(new Sn(s,c,a,u,f)),(s=r[2])&&t.push(new Sn(s,o,f,c,l)),(s=r[3])&&t.push(new Sn(s,c,f,u,l))}n.push(i)}for(;i=n.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function pj(e){return e[0]}function gj(e){return arguments.length?(this._x=e,this):this._x}function mj(e){return e[1]}function yj(e){return arguments.length?(this._y=e,this):this._y}function Y3(e,t,n){var i=new Z3(t??pj,n??mj,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function Z3(e,t,n,i,r,s){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=s,this._root=void 0}function y6(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Bn=Y3.prototype=Z3.prototype;Bn.copy=function(){var e=new Z3(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,i;if(!t)return e;if(!t.length)return e._root=y6(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?n.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=y6(i));return e};Bn.add=nj;Bn.addAll=ij;Bn.cover=rj;Bn.data=sj;Bn.extent=oj;Bn.find=aj;Bn.remove=uj;Bn.removeAll=lj;Bn.root=cj;Bn.size=fj;Bn.visit=dj;Bn.visitAfter=hj;Bn.x=gj;Bn.y=yj;function An(e){return function(){return e}}function co(e){return(e()-.5)*1e-6}function vj(e){return e.x+e.vx}function bj(e){return e.y+e.vy}function xj(e){var t,n,i,r=1,s=1;typeof e!="function"&&(e=An(e==null?1:+e));function o(){for(var l,c=t.length,f,d,h,p,g,m,y=0;y<s;++y)for(f=Y3(t,vj,bj).visitAfter(a),l=0;l<c;++l)d=t[l],g=n[d.index],m=g*g,h=d.x+d.vx,p=d.y+d.vy,f.visit(v);function v(b,x,_,E,w){var S=b.data,$=b.r,F=g+$;if(S){if(S.index>d.index){var T=h-S.x-S.vx,P=p-S.y-S.vy,R=T*T+P*P;R<F*F&&(T===0&&(T=co(i),R+=T*T),P===0&&(P=co(i),R+=P*P),R=(F-(R=Math.sqrt(R)))/R*r,d.vx+=(T*=R)*(F=($*=$)/(m+$)),d.vy+=(P*=R)*F,S.vx-=T*(F=1-F),S.vy-=P*F)}return}return x>h+F||E<h-F||_>p+F||w<p-F}}function a(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return o.initialize=function(l,c){t=l,i=c,u()},o.iterations=function(l){return arguments.length?(s=+l,o):s},o.strength=function(l){return arguments.length?(r=+l,o):r},o.radius=function(l){return arguments.length?(e=typeof l=="function"?l:An(+l),u(),o):e},o}function _j(e){return e.index}function v6(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function wj(e){var t=_j,n=f,i,r=An(30),s,o,a,u,l,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(a[m.source.index],a[m.target.index])}function d(m){for(var y=0,v=e.length;y<c;++y)for(var b=0,x,_,E,w,S,$,F;b<v;++b)x=e[b],_=x.source,E=x.target,w=E.x+E.vx-_.x-_.vx||co(l),S=E.y+E.vy-_.y-_.vy||co(l),$=Math.sqrt(w*w+S*S),$=($-s[b])/$*m*i[b],w*=$,S*=$,E.vx-=w*(F=u[b]),E.vy-=S*F,_.vx+=w*(F=1-F),_.vy+=S*F}function h(){if(o){var m,y=o.length,v=e.length,b=new Map(o.map((_,E)=>[t(_,E,o),_])),x;for(m=0,a=new Array(y);m<v;++m)x=e[m],x.index=m,typeof x.source!="object"&&(x.source=v6(b,x.source)),typeof x.target!="object"&&(x.target=v6(b,x.target)),a[x.source.index]=(a[x.source.index]||0)+1,a[x.target.index]=(a[x.target.index]||0)+1;for(m=0,u=new Array(v);m<v;++m)x=e[m],u[m]=a[x.source.index]/(a[x.source.index]+a[x.target.index]);i=new Array(v),p(),s=new Array(v),g()}}function p(){if(o)for(var m=0,y=e.length;m<y;++m)i[m]=+n(e[m],m,e)}function g(){if(o)for(var m=0,y=e.length;m<y;++m)s[m]=+r(e[m],m,e)}return d.initialize=function(m,y){o=m,l=y,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n=typeof m=="function"?m:An(+m),p(),d):n},d.distance=function(m){return arguments.length?(r=typeof m=="function"?m:An(+m),g(),d):r},d}const Ej=1664525,Cj=1013904223,b6=4294967296;function Sj(){let e=1;return()=>(e=(Ej*e+Cj)%b6)/b6}function kj(e){return e.x}function Aj(e){return e.y}var $j=10,Mj=Math.PI*(3-Math.sqrt(5));function Tj(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),s=0,o=.6,a=new Map,u=j3(f),l=Jp("tick","end"),c=Sj();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<i&&(u.stop(),l.call("end",t))}function d(g){var m,y=e.length,v;g===void 0&&(g=1);for(var b=0;b<g;++b)for(n+=(s-n)*r,a.forEach(function(x){x(n)}),m=0;m<y;++m)v=e[m],v.fx==null?v.x+=v.vx*=o:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=o:(v.y=v.fy,v.vy=0);return t}function h(){for(var g=0,m=e.length,y;g<m;++g){if(y=e[g],y.index=g,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var v=$j*Math.sqrt(.5+g),b=g*Mj;y.x=v*Math.cos(b),y.y=v*Math.sin(b)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(g){return arguments.length?(e=g,h(),a.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(i=+g,t):i},alphaDecay:function(g){return arguments.length?(r=+g,t):+r},alphaTarget:function(g){return arguments.length?(s=+g,t):s},velocityDecay:function(g){return arguments.length?(o=1-g,t):1-o},randomSource:function(g){return arguments.length?(c=g,a.forEach(p),t):c},force:function(g,m){return arguments.length>1?(m==null?a.delete(g):a.set(g,p(m)),t):a.get(g)},find:function(g,m,y){var v=0,b=e.length,x,_,E,w,S;for(y==null?y=1/0:y*=y,v=0;v<b;++v)w=e[v],x=g-w.x,_=m-w.y,E=x*x+_*_,E<y&&(S=w,y=E);return S},on:function(g,m){return arguments.length>1?(l.on(g,m),t):l.on(g)}}}function Fj(){var e,t,n,i,r=An(-30),s,o=1,a=1/0,u=.81;function l(h){var p,g=e.length,m=Y3(e,kj,Aj).visitAfter(f);for(i=h,p=0;p<g;++p)t=e[p],m.visit(d)}function c(){if(e){var h,p=e.length,g;for(s=new Array(p),h=0;h<p;++h)g=e[h],s[g.index]=+r(g,h,e)}}function f(h){var p=0,g,m,y=0,v,b,x;if(h.length){for(v=b=x=0;x<4;++x)(g=h[x])&&(m=Math.abs(g.value))&&(p+=g.value,y+=m,v+=m*g.x,b+=m*g.y);h.x=v/y,h.y=b/y}else{g=h,g.x=g.data.x,g.y=g.data.y;do p+=s[g.data.index];while(g=g.next)}h.value=p}function d(h,p,g,m){if(!h.value)return!0;var y=h.x-t.x,v=h.y-t.y,b=m-p,x=y*y+v*v;if(b*b/u<x)return x<a&&(y===0&&(y=co(n),x+=y*y),v===0&&(v=co(n),x+=v*v),x<o&&(x=Math.sqrt(o*x)),t.vx+=y*h.value*i/x,t.vy+=v*h.value*i/x),!0;if(h.length||x>=a)return;(h.data!==t||h.next)&&(y===0&&(y=co(n),x+=y*y),v===0&&(v=co(n),x+=v*v),x<o&&(x=Math.sqrt(o*x)));do h.data!==t&&(b=s[h.data.index]*i/x,t.vx+=y*b,t.vy+=v*b);while(h=h.next)}return l.initialize=function(h,p){e=h,n=p,c()},l.strength=function(h){return arguments.length?(r=typeof h=="function"?h:An(+h),c(),l):r},l.distanceMin=function(h){return arguments.length?(o=h*h,l):Math.sqrt(o)},l.distanceMax=function(h){return arguments.length?(a=h*h,l):Math.sqrt(a)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function Lj(e){var t=An(.1),n,i,r;typeof e!="function"&&(e=An(e==null?0:+e));function s(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(r[u]-c.x)*i[u]*a}function o(){if(n){var a,u=n.length;for(i=new Array(u),r=new Array(u),a=0;a<u;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t=typeof a=="function"?a:An(+a),o(),s):t},s.x=function(a){return arguments.length?(e=typeof a=="function"?a:An(+a),o(),s):e},s}function Nj(e){var t=An(.1),n,i,r;typeof e!="function"&&(e=An(e==null?0:+e));function s(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(r[u]-c.y)*i[u]*a}function o(){if(n){var a,u=n.length;for(i=new Array(u),r=new Array(u),a=0;a<u;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t=typeof a=="function"?a:An(+a),o(),s):t},s.y=function(a){return arguments.length?(e=typeof a=="function"?a:An(+a),o(),s):e},s}function Dj(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function w0(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function rl(e){return e=w0(Math.abs(e)),e?e[1]:NaN}function Rj(e,t){return function(n,i){for(var r=n.length,s=[],o=0,a=e[0],u=0;r>0&&a>0&&(u+a+1>i&&(a=Math.max(1,i-u)),s.push(n.substring(r-=a,r+a)),!((u+=a+1)>i));)a=e[o=(o+1)%e.length];return s.reverse().join(t)}}function Oj(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Ij=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function qa(e){if(!(t=Ij.exec(e)))throw new Error("invalid format: "+e);var t;return new X3({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}qa.prototype=X3.prototype;function X3(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}X3.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Pj(e){e:for(var t=e.length,n=1,i=-1,r;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(r+1):e}var vS;function zj(e,t){var n=w0(e,t);if(!n)return e+"";var i=n[0],r=n[1],s=r-(vS=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+w0(e,Math.max(0,t+s-1))[0]}function x6(e,t){var n=w0(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const _6={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Dj,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>x6(e*100,t),r:x6,s:zj,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function w6(e){return e}var E6=Array.prototype.map,C6=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function bS(e){var t=e.grouping===void 0||e.thousands===void 0?w6:Rj(E6.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?w6:Oj(E6.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"−":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=qa(f);var d=f.fill,h=f.align,p=f.sign,g=f.symbol,m=f.zero,y=f.width,v=f.comma,b=f.precision,x=f.trim,_=f.type;_==="n"?(v=!0,_="g"):_6[_]||(b===void 0&&(b=12),x=!0,_="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var E=g==="$"?n:g==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",w=g==="$"?i:/[%p]/.test(_)?o:"",S=_6[_],$=/[defgprs%]/.test(_);b=b===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function F(T){var P=E,R=w,C,A,M;if(_==="c")R=S(T)+R,T="";else{T=+T;var L=T<0||1/T<0;if(T=isNaN(T)?u:S(Math.abs(T),b),x&&(T=Pj(T)),L&&+T==0&&p!=="+"&&(L=!1),P=(L?p==="("?p:a:p==="-"||p==="("?"":p)+P,R=(_==="s"?C6[8+vS/3]:"")+R+(L&&p==="("?")":""),$){for(C=-1,A=T.length;++C<A;)if(M=T.charCodeAt(C),48>M||M>57){R=(M===46?r+T.slice(C+1):T.slice(C))+R,T=T.slice(0,C);break}}}v&&!m&&(T=t(T,1/0));var D=P.length+T.length+R.length,O=D<y?new Array(y-D+1).join(d):"";switch(v&&m&&(T=t(O+T,O.length?y-R.length:1/0),O=""),h){case"<":T=P+T+R+O;break;case"=":T=P+O+T+R;break;case"^":T=O.slice(0,D=O.length>>1)+P+T+R+O.slice(D);break;default:T=O+P+T+R;break}return s(T)}return F.toString=function(){return f+""},F}function c(f,d){var h=l((f=qa(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(rl(d)/3)))*3,g=Math.pow(10,-p),m=C6[8+p/3];return function(y){return h(g*y)+m}}return{format:l,formatPrefix:c}}var Kd,og,K3;Bj({thousands:",",grouping:[3],currency:["$",""]});function Bj(e){return Kd=bS(e),og=Kd.format,K3=Kd.formatPrefix,Kd}function xS(e){return Math.max(0,-rl(Math.abs(e)))}function _S(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(rl(t)/3)))*3-rl(Math.abs(e)))}function wS(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,rl(t)-rl(e))+1}var ve=1e-6,x2=1e-12,Le=Math.PI,Et=Le/2,E0=Le/4,Rn=Le*2,Ct=180/Le,Fe=Le/180,Re=Math.abs,Rl=Math.atan,$i=Math.atan2,me=Math.cos,Jd=Math.ceil,ES=Math.exp,_2=Math.hypot,C0=Math.log,gm=Math.pow,he=Math.sin,Ei=Math.sign||function(e){return e>0?1:e<0?-1:0},On=Math.sqrt,J3=Math.tan;function CS(e){return e>1?0:e<-1?Le:Math.acos(e)}function Xn(e){return e>1?Et:e<-1?-Et:Math.asin(e)}function Kt(){}function S0(e,t){e&&k6.hasOwnProperty(e.type)&&k6[e.type](e,t)}var S6={Feature:function(e,t){S0(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)S0(n[i].geometry,t)}},k6={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){w2(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)w2(n[i],t,0)},Polygon:function(e,t){A6(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)A6(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)S0(n[i],t)}};function w2(e,t,n){var i=-1,r=e.length-n,s;for(t.lineStart();++i<r;)s=e[i],t.point(s[0],s[1],s[2]);t.lineEnd()}function A6(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)w2(e[n],t,1);t.polygonEnd()}function ys(e,t){e&&S6.hasOwnProperty(e.type)?S6[e.type](e,t):S0(e,t)}var k0=new Tn,A0=new Tn,SS,kS,E2,C2,S2,Ir={point:Kt,lineStart:Kt,lineEnd:Kt,polygonStart:function(){k0=new Tn,Ir.lineStart=Uj,Ir.lineEnd=jj},polygonEnd:function(){var e=+k0;A0.add(e<0?Rn+e:e),this.lineStart=this.lineEnd=this.point=Kt},sphere:function(){A0.add(Rn)}};function Uj(){Ir.point=Hj}function jj(){AS(SS,kS)}function Hj(e,t){Ir.point=AS,SS=e,kS=t,e*=Fe,t*=Fe,E2=e,C2=me(t=t/2+E0),S2=he(t)}function AS(e,t){e*=Fe,t*=Fe,t=t/2+E0;var n=e-E2,i=n>=0?1:-1,r=i*n,s=me(t),o=he(t),a=S2*o,u=C2*s+a*me(r),l=a*i*he(r);k0.add($i(l,u)),E2=e,C2=s,S2=o}function qj(e){return A0=new Tn,ys(e,Ir),A0*2}function $0(e){return[$i(e[1],e[0]),Xn(e[2])]}function Va(e){var t=e[0],n=e[1],i=me(n);return[i*me(t),i*he(t),he(n)]}function Qd(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function sl(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function mm(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function eh(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function M0(e){var t=On(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var mt,Vn,_t,si,ca,$S,MS,Yu,rf,oo,Ds,hs={point:k2,lineStart:$6,lineEnd:M6,polygonStart:function(){hs.point=FS,hs.lineStart=Vj,hs.lineEnd=Wj,rf=new Tn,Ir.polygonStart()},polygonEnd:function(){Ir.polygonEnd(),hs.point=k2,hs.lineStart=$6,hs.lineEnd=M6,k0<0?(mt=-(_t=180),Vn=-(si=90)):rf>ve?si=90:rf<-1e-6&&(Vn=-90),Ds[0]=mt,Ds[1]=_t},sphere:function(){mt=-(_t=180),Vn=-(si=90)}};function k2(e,t){oo.push(Ds=[mt=e,_t=e]),t<Vn&&(Vn=t),t>si&&(si=t)}function TS(e,t){var n=Va([e*Fe,t*Fe]);if(Yu){var i=sl(Yu,n),r=[i[1],-i[0],0],s=sl(r,i);M0(s),s=$0(s);var o=e-ca,a=o>0?1:-1,u=s[0]*Ct*a,l,c=Re(o)>180;c^(a*ca<u&&u<a*e)?(l=s[1]*Ct,l>si&&(si=l)):(u=(u+360)%360-180,c^(a*ca<u&&u<a*e)?(l=-s[1]*Ct,l<Vn&&(Vn=l)):(t<Vn&&(Vn=t),t>si&&(si=t))),c?e<ca?ri(mt,e)>ri(mt,_t)&&(_t=e):ri(e,_t)>ri(mt,_t)&&(mt=e):_t>=mt?(e<mt&&(mt=e),e>_t&&(_t=e)):e>ca?ri(mt,e)>ri(mt,_t)&&(_t=e):ri(e,_t)>ri(mt,_t)&&(mt=e)}else oo.push(Ds=[mt=e,_t=e]);t<Vn&&(Vn=t),t>si&&(si=t),Yu=n,ca=e}function $6(){hs.point=TS}function M6(){Ds[0]=mt,Ds[1]=_t,hs.point=k2,Yu=null}function FS(e,t){if(Yu){var n=e-ca;rf.add(Re(n)>180?n+(n>0?360:-360):n)}else $S=e,MS=t;Ir.point(e,t),TS(e,t)}function Vj(){Ir.lineStart()}function Wj(){FS($S,MS),Ir.lineEnd(),Re(rf)>ve&&(mt=-(_t=180)),Ds[0]=mt,Ds[1]=_t,Yu=null}function ri(e,t){return(t-=e)<0?t+360:t}function Gj(e,t){return e[0]-t[0]}function T6(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function Yj(e){var t,n,i,r,s,o,a;if(si=_t=-(mt=Vn=1/0),oo=[],ys(e,hs),n=oo.length){for(oo.sort(Gj),t=1,i=oo[0],s=[i];t<n;++t)r=oo[t],T6(i,r[0])||T6(i,r[1])?(ri(i[0],r[1])>ri(i[0],i[1])&&(i[1]=r[1]),ri(r[0],i[1])>ri(i[0],i[1])&&(i[0]=r[0])):s.push(i=r);for(o=-1/0,n=s.length-1,t=0,i=s[n];t<=n;i=r,++t)r=s[t],(a=ri(i[1],r[0]))>o&&(o=a,mt=r[0],_t=i[1])}return oo=Ds=null,mt===1/0||Vn===1/0?[[NaN,NaN],[NaN,NaN]]:[[mt,Vn],[_t,si]]}var Ac,T0,F0,L0,N0,D0,R0,O0,A2,$2,M2,LS,NS,wn,En,Cn,qi={sphere:Kt,point:Q3,lineStart:F6,lineEnd:L6,polygonStart:function(){qi.lineStart=Kj,qi.lineEnd=Jj},polygonEnd:function(){qi.lineStart=F6,qi.lineEnd=L6}};function Q3(e,t){e*=Fe,t*=Fe;var n=me(t);rd(n*me(e),n*he(e),he(t))}function rd(e,t,n){++Ac,F0+=(e-F0)/Ac,L0+=(t-L0)/Ac,N0+=(n-N0)/Ac}function F6(){qi.point=Zj}function Zj(e,t){e*=Fe,t*=Fe;var n=me(t);wn=n*me(e),En=n*he(e),Cn=he(t),qi.point=Xj,rd(wn,En,Cn)}function Xj(e,t){e*=Fe,t*=Fe;var n=me(t),i=n*me(e),r=n*he(e),s=he(t),o=$i(On((o=En*s-Cn*r)*o+(o=Cn*i-wn*s)*o+(o=wn*r-En*i)*o),wn*i+En*r+Cn*s);T0+=o,D0+=o*(wn+(wn=i)),R0+=o*(En+(En=r)),O0+=o*(Cn+(Cn=s)),rd(wn,En,Cn)}function L6(){qi.point=Q3}function Kj(){qi.point=Qj}function Jj(){DS(LS,NS),qi.point=Q3}function Qj(e,t){LS=e,NS=t,e*=Fe,t*=Fe,qi.point=DS;var n=me(t);wn=n*me(e),En=n*he(e),Cn=he(t),rd(wn,En,Cn)}function DS(e,t){e*=Fe,t*=Fe;var n=me(t),i=n*me(e),r=n*he(e),s=he(t),o=En*s-Cn*r,a=Cn*i-wn*s,u=wn*r-En*i,l=_2(o,a,u),c=Xn(l),f=l&&-c/l;A2.add(f*o),$2.add(f*a),M2.add(f*u),T0+=c,D0+=c*(wn+(wn=i)),R0+=c*(En+(En=r)),O0+=c*(Cn+(Cn=s)),rd(wn,En,Cn)}function eH(e){Ac=T0=F0=L0=N0=D0=R0=O0=0,A2=new Tn,$2=new Tn,M2=new Tn,ys(e,qi);var t=+A2,n=+$2,i=+M2,r=_2(t,n,i);return r<x2&&(t=D0,n=R0,i=O0,T0<ve&&(t=F0,n=L0,i=N0),r=_2(t,n,i),r<x2)?[NaN,NaN]:[$i(n,t)*Ct,Xn(i/r)*Ct]}function T2(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return i=t.invert(i,r),i&&e.invert(i[0],i[1])}),n}function F2(e,t){return Re(e)>Le&&(e-=Math.round(e/Rn)*Rn),[e,t]}F2.invert=F2;function RS(e,t,n){return(e%=Rn)?t||n?T2(D6(e),R6(t,n)):D6(e):t||n?R6(t,n):F2}function N6(e){return function(t,n){return t+=e,Re(t)>Le&&(t-=Math.round(t/Rn)*Rn),[t,n]}}function D6(e){var t=N6(e);return t.invert=N6(-e),t}function R6(e,t){var n=me(e),i=he(e),r=me(t),s=he(t);function o(a,u){var l=me(u),c=me(a)*l,f=he(a)*l,d=he(u),h=d*n+c*i;return[$i(f*r-h*s,c*n-d*i),Xn(h*r+f*s)]}return o.invert=function(a,u){var l=me(u),c=me(a)*l,f=he(a)*l,d=he(u),h=d*r-f*s;return[$i(f*r+d*s,c*n+h*i),Xn(h*n-c*i)]},o}function tH(e){e=RS(e[0]*Fe,e[1]*Fe,e.length>2?e[2]*Fe:0);function t(n){return n=e(n[0]*Fe,n[1]*Fe),n[0]*=Ct,n[1]*=Ct,n}return t.invert=function(n){return n=e.invert(n[0]*Fe,n[1]*Fe),n[0]*=Ct,n[1]*=Ct,n},t}function nH(e,t,n,i,r,s){if(n){var o=me(t),a=he(t),u=i*n;r==null?(r=t+i*Rn,s=t-u/2):(r=O6(o,r),s=O6(o,s),(i>0?r<s:r>s)&&(r+=i*Rn));for(var l,c=r;i>0?c>s:c<s;c-=u)l=$0([o,-a*me(c),-a*he(c)]),e.point(l[0],l[1])}}function O6(e,t){t=Va(t),t[0]-=e,M0(t);var n=CS(-t[1]);return((-t[2]<0?-n:n)+Rn-ve)%Rn}function OS(){var e=[],t;return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:Kt,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Ph(e,t){return Re(e[0]-t[0])<ve&&Re(e[1]-t[1])<ve}function th(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function IS(e,t,n,i,r){var s=[],o=[],a,u;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,m=p[0],y=p[g],v;if(Ph(m,y)){if(!m[2]&&!y[2]){for(r.lineStart(),a=0;a<g;++a)r.point((m=p[a])[0],m[1]);r.lineEnd();return}y[0]+=2*ve}s.push(v=new th(m,p,null,!0)),o.push(v.o=new th(m,null,v,!1)),s.push(v=new th(y,p,null,!1)),o.push(v.o=new th(y,null,v,!0))}}),!!s.length){for(o.sort(t),I6(s),I6(o),a=0,u=o.length;a<u;++a)o[a].e=n=!n;for(var l=s[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(a=0,u=c.length;a<u;++a)r.point((f=c[a])[0],f[1]);else i(d.x,d.n.x,1,r);d=d.n}else{if(h)for(c=d.p.z,a=c.length-1;a>=0;--a)r.point((f=c[a])[0],f[1]);else i(d.x,d.p.x,-1,r);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);r.lineEnd()}}}function I6(e){if(t=e.length){for(var t,n=0,i=e[0],r;++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function ym(e){return Re(e[0])<=Le?e[0]:Ei(e[0])*((Re(e[0])+Le)%Rn-Le)}function iH(e,t){var n=ym(t),i=t[1],r=he(i),s=[he(n),-me(n),0],o=0,a=0,u=new Tn;r===1?i=Et+ve:r===-1&&(i=-Et-ve);for(var l=0,c=e.length;l<c;++l)if(d=(f=e[l]).length)for(var f,d,h=f[d-1],p=ym(h),g=h[1]/2+E0,m=he(g),y=me(g),v=0;v<d;++v,p=x,m=E,y=w,h=b){var b=f[v],x=ym(b),_=b[1]/2+E0,E=he(_),w=me(_),S=x-p,$=S>=0?1:-1,F=$*S,T=F>Le,P=m*E;if(u.add($i(P*$*he(F),y*w+P*me(F))),o+=T?S+$*Rn:S,T^p>=n^x>=n){var R=sl(Va(h),Va(b));M0(R);var C=sl(s,R);M0(C);var A=(T^S>=0?-1:1)*Xn(C[2]);(i>A||i===A&&(R[0]||R[1]))&&(a+=T^S>=0?1:-1)}}return(o<-1e-6||o<ve&&u<-1e-12)^a&1}function PS(e,t,n,i){return function(r){var s=t(r),o=OS(),a=t(o),u=!1,l,c,f,d={point:h,lineStart:g,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=m,c=_C(c);var x=iH(l,i);c.length?(u||(r.polygonStart(),u=!0),IS(c,sH,x,n,r)):x&&(u||(r.polygonStart(),u=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),c=l=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function h(x,_){e(x,_)&&r.point(x,_)}function p(x,_){s.point(x,_)}function g(){d.point=p,s.lineStart()}function m(){d.point=h,s.lineEnd()}function y(x,_){f.push([x,_]),a.point(x,_)}function v(){a.lineStart(),f=[]}function b(){y(f[0][0],f[0][1]),a.lineEnd();var x=a.clean(),_=o.result(),E,w=_.length,S,$,F;if(f.pop(),l.push(f),f=null,!!w){if(x&1){if($=_[0],(S=$.length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),E=0;E<S;++E)r.point((F=$[E])[0],F[1]);r.lineEnd()}return}w>1&&x&2&&_.push(_.pop().concat(_.shift())),c.push(_.filter(rH))}}return d}}function rH(e){return e.length>1}function sH(e,t){return((e=e.x)[0]<0?e[1]-Et-ve:Et-e[1])-((t=t.x)[0]<0?t[1]-Et-ve:Et-t[1])}const P6=PS(function(){return!0},oH,uH,[-Le,-Et]);function oH(e){var t=NaN,n=NaN,i=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(s,o){var a=s>0?Le:-Le,u=Re(s-t);Re(u-Le)<ve?(e.point(t,n=(n+o)/2>0?Et:-Et),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(s,n),r=0):i!==a&&u>=Le&&(Re(t-i)<ve&&(t-=i*ve),Re(s-a)<ve&&(s-=a*ve),n=aH(t,n,s,o),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),r=0),e.point(t=s,n=o),i=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}}function aH(e,t,n,i){var r,s,o=he(e-n);return Re(o)>ve?Rl((he(t)*(s=me(i))*he(n)-he(i)*(r=me(t))*he(e))/(r*s*o)):(t+i)/2}function uH(e,t,n,i){var r;if(e==null)r=n*Et,i.point(-Le,r),i.point(0,r),i.point(Le,r),i.point(Le,0),i.point(Le,-r),i.point(0,-r),i.point(-Le,-r),i.point(-Le,0),i.point(-Le,r);else if(Re(e[0]-t[0])>ve){var s=e[0]<t[0]?Le:-Le;r=n*s/2,i.point(-s,r),i.point(0,r),i.point(s,r)}else i.point(t[0],t[1])}function lH(e){var t=me(e),n=2*Fe,i=t>0,r=Re(t)>ve;function s(c,f,d,h){nH(h,e,n,d,c,f)}function o(c,f){return me(c)*me(f)>t}function a(c){var f,d,h,p,g;return{lineStart:function(){p=h=!1,g=1},point:function(m,y){var v=[m,y],b,x=o(m,y),_=i?x?0:l(m,y):x?l(m+(m<0?Le:-Le),y):0;if(!f&&(p=h=x)&&c.lineStart(),x!==h&&(b=u(f,v),(!b||Ph(f,b)||Ph(v,b))&&(v[2]=1)),x!==h)g=0,x?(c.lineStart(),b=u(v,f),c.point(b[0],b[1])):(b=u(f,v),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(r&&f&&i^x){var E;!(_&d)&&(E=u(v,f,!0))&&(g=0,i?(c.lineStart(),c.point(E[0][0],E[0][1]),c.point(E[1][0],E[1][1]),c.lineEnd()):(c.point(E[1][0],E[1][1]),c.lineEnd(),c.lineStart(),c.point(E[0][0],E[0][1],3)))}x&&(!f||!Ph(f,v))&&c.point(v[0],v[1]),f=v,h=x,d=_},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return g|(p&&h)<<1}}}function u(c,f,d){var h=Va(c),p=Va(f),g=[1,0,0],m=sl(h,p),y=Qd(m,m),v=m[0],b=y-v*v;if(!b)return!d&&c;var x=t*y/b,_=-t*v/b,E=sl(g,m),w=eh(g,x),S=eh(m,_);mm(w,S);var $=E,F=Qd(w,$),T=Qd($,$),P=F*F-T*(Qd(w,w)-1);if(!(P<0)){var R=On(P),C=eh($,(-F-R)/T);if(mm(C,w),C=$0(C),!d)return C;var A=c[0],M=f[0],L=c[1],D=f[1],O;M<A&&(O=A,A=M,M=O);var j=M-A,J=Re(j-Le)<ve,K=J||j<ve;if(!J&&D<L&&(O=L,L=D,D=O),K?J?L+D>0^C[1]<(Re(C[0]-A)<ve?L:D):L<=C[1]&&C[1]<=D:j>Le^(A<=C[0]&&C[0]<=M)){var fe=eh($,(-F+R)/T);return mm(fe,w),[C,$0(fe)]}}}function l(c,f){var d=i?e:Le-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return PS(o,a,s,i?[0,-e]:[-Le,e-Le])}function cH(e,t,n,i,r,s){var o=e[0],a=e[1],u=t[0],l=t[1],c=0,f=1,d=u-o,h=l-a,p;if(p=n-o,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=r-o,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}if(p=i-a,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=s-a,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=o+c*d,e[1]=a+c*h),f<1&&(t[0]=o+f*d,t[1]=a+f*h),!0}}}}}var nh=1e9,ih=-1e9;function zS(e,t,n,i){function r(l,c){return e<=l&&l<=n&&t<=c&&c<=i}function s(l,c,f,d){var h=0,p=0;if(l==null||(h=o(l,f))!==(p=o(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?i:t);while((h=(h+f+4)%4)!==p);else d.point(c[0],c[1])}function o(l,c){return Re(l[0]-e)<ve?c>0?0:3:Re(l[0]-n)<ve?c>0?2:1:Re(l[1]-t)<ve?c>0?1:0:c>0?3:2}function a(l,c){return u(l.x,c.x)}function u(l,c){var f=o(l,1),d=o(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=OS(),d,h,p,g,m,y,v,b,x,_,E,w={point:S,lineStart:P,lineEnd:R,polygonStart:F,polygonEnd:T};function S(A,M){r(A,M)&&c.point(A,M)}function $(){for(var A=0,M=0,L=h.length;M<L;++M)for(var D=h[M],O=1,j=D.length,J=D[0],K,fe,we=J[0],de=J[1];O<j;++O)K=we,fe=de,J=D[O],we=J[0],de=J[1],fe<=i?de>i&&(we-K)*(i-fe)>(de-fe)*(e-K)&&++A:de<=i&&(we-K)*(i-fe)<(de-fe)*(e-K)&&--A;return A}function F(){c=f,d=[],h=[],E=!0}function T(){var A=$(),M=E&&A,L=(d=_C(d)).length;(M||L)&&(l.polygonStart(),M&&(l.lineStart(),s(null,null,1,l),l.lineEnd()),L&&IS(d,a,A,s,l),l.polygonEnd()),c=l,d=h=p=null}function P(){w.point=C,h&&h.push(p=[]),_=!0,x=!1,v=b=NaN}function R(){d&&(C(g,m),y&&x&&f.rejoin(),d.push(f.result())),w.point=S,x&&c.lineEnd()}function C(A,M){var L=r(A,M);if(h&&p.push([A,M]),_)g=A,m=M,y=L,_=!1,L&&(c.lineStart(),c.point(A,M));else if(L&&x)c.point(A,M);else{var D=[v=Math.max(ih,Math.min(nh,v)),b=Math.max(ih,Math.min(nh,b))],O=[A=Math.max(ih,Math.min(nh,A)),M=Math.max(ih,Math.min(nh,M))];cH(D,O,e,t,n,i)?(x||(c.lineStart(),c.point(D[0],D[1])),c.point(O[0],O[1]),L||c.lineEnd(),E=!1):L&&(c.lineStart(),c.point(A,M),E=!1)}v=A,b=M,x=L}return w}}function z6(e,t,n){var i=li(e,t-ve,n).concat(t);return function(r){return i.map(function(s){return[r,s]})}}function B6(e,t,n){var i=li(e,t-ve,n).concat(t);return function(r){return i.map(function(s){return[s,r]})}}function fH(){var e,t,n,i,r,s,o,a,u=10,l=u,c=90,f=360,d,h,p,g,m=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return li(Jd(i/c)*c,n,c).map(p).concat(li(Jd(a/f)*f,o,f).map(g)).concat(li(Jd(t/u)*u,e,u).filter(function(b){return Re(b%c)>ve}).map(d)).concat(li(Jd(s/l)*l,r,l).filter(function(b){return Re(b%f)>ve}).map(h))}return y.lines=function(){return v().map(function(b){return{type:"LineString",coordinates:b}})},y.outline=function(){return{type:"Polygon",coordinates:[p(i).concat(g(o).slice(1),p(n).reverse().slice(1),g(a).reverse().slice(1))]}},y.extent=function(b){return arguments.length?y.extentMajor(b).extentMinor(b):y.extentMinor()},y.extentMajor=function(b){return arguments.length?(i=+b[0][0],n=+b[1][0],a=+b[0][1],o=+b[1][1],i>n&&(b=i,i=n,n=b),a>o&&(b=a,a=o,o=b),y.precision(m)):[[i,a],[n,o]]},y.extentMinor=function(b){return arguments.length?(t=+b[0][0],e=+b[1][0],s=+b[0][1],r=+b[1][1],t>e&&(b=t,t=e,e=b),s>r&&(b=s,s=r,r=b),y.precision(m)):[[t,s],[e,r]]},y.step=function(b){return arguments.length?y.stepMajor(b).stepMinor(b):y.stepMinor()},y.stepMajor=function(b){return arguments.length?(c=+b[0],f=+b[1],y):[c,f]},y.stepMinor=function(b){return arguments.length?(u=+b[0],l=+b[1],y):[u,l]},y.precision=function(b){return arguments.length?(m=+b,d=z6(s,r,90),h=B6(t,e,m),p=z6(a,o,90),g=B6(i,n,m),y):m},y.extentMajor([[-180,-90+ve],[180,90-ve]]).extentMinor([[-180,-80-ve],[180,80+ve]])}const Mf=e=>e;var vm=new Tn,L2=new Tn,BS,US,N2,D2,vs={point:Kt,lineStart:Kt,lineEnd:Kt,polygonStart:function(){vs.lineStart=dH,vs.lineEnd=pH},polygonEnd:function(){vs.lineStart=vs.lineEnd=vs.point=Kt,vm.add(Re(L2)),L2=new Tn},result:function(){var e=vm/2;return vm=new Tn,e}};function dH(){vs.point=hH}function hH(e,t){vs.point=jS,BS=N2=e,US=D2=t}function jS(e,t){L2.add(D2*e-N2*t),N2=e,D2=t}function pH(){jS(BS,US)}var ol=1/0,I0=ol,Tf=-ol,P0=Tf,z0={point:gH,lineStart:Kt,lineEnd:Kt,polygonStart:Kt,polygonEnd:Kt,result:function(){var e=[[ol,I0],[Tf,P0]];return Tf=P0=-(I0=ol=1/0),e}};function gH(e,t){e<ol&&(ol=e),e>Tf&&(Tf=e),t<I0&&(I0=t),t>P0&&(P0=t)}var R2=0,O2=0,$c=0,B0=0,U0=0,Bu=0,I2=0,P2=0,Mc=0,HS,qS,Cr,Sr,wi={point:Wa,lineStart:U6,lineEnd:j6,polygonStart:function(){wi.lineStart=vH,wi.lineEnd=bH},polygonEnd:function(){wi.point=Wa,wi.lineStart=U6,wi.lineEnd=j6},result:function(){var e=Mc?[I2/Mc,P2/Mc]:Bu?[B0/Bu,U0/Bu]:$c?[R2/$c,O2/$c]:[NaN,NaN];return R2=O2=$c=B0=U0=Bu=I2=P2=Mc=0,e}};function Wa(e,t){R2+=e,O2+=t,++$c}function U6(){wi.point=mH}function mH(e,t){wi.point=yH,Wa(Cr=e,Sr=t)}function yH(e,t){var n=e-Cr,i=t-Sr,r=On(n*n+i*i);B0+=r*(Cr+e)/2,U0+=r*(Sr+t)/2,Bu+=r,Wa(Cr=e,Sr=t)}function j6(){wi.point=Wa}function vH(){wi.point=xH}function bH(){VS(HS,qS)}function xH(e,t){wi.point=VS,Wa(HS=Cr=e,qS=Sr=t)}function VS(e,t){var n=e-Cr,i=t-Sr,r=On(n*n+i*i);B0+=r*(Cr+e)/2,U0+=r*(Sr+t)/2,Bu+=r,r=Sr*e-Cr*t,I2+=r*(Cr+e),P2+=r*(Sr+t),Mc+=r*3,Wa(Cr=e,Sr=t)}function WS(e){this._context=e}WS.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Rn);break}}},result:Kt};var z2=new Tn,bm,GS,YS,Tc,Fc,Ff={point:Kt,lineStart:function(){Ff.point=_H},lineEnd:function(){bm&&ZS(GS,YS),Ff.point=Kt},polygonStart:function(){bm=!0},polygonEnd:function(){bm=null},result:function(){var e=+z2;return z2=new Tn,e}};function _H(e,t){Ff.point=ZS,GS=Tc=e,YS=Fc=t}function ZS(e,t){Tc-=e,Fc-=t,z2.add(On(Tc*Tc+Fc*Fc)),Tc=e,Fc=t}let H6,j0,q6,V6;class W6{constructor(t){this._append=t==null?XS:wH(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==q6||this._append!==j0){const i=this._radius,r=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,q6=i,j0=this._append,V6=this._,this._=r}this._+=V6;break}}}result(){const t=this._;return this._="",t.length?t:null}}function XS(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function wH(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return XS;if(t!==H6){const n=10**t;H6=t,j0=function(r){let s=1;this._+=r[0];for(const o=r.length;s<o;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}return j0}function KS(e,t){let n=3,i=4.5,r,s;function o(a){return a&&(typeof i=="function"&&s.pointRadius(+i.apply(this,arguments)),ys(a,r(s))),s.result()}return o.area=function(a){return ys(a,r(vs)),vs.result()},o.measure=function(a){return ys(a,r(Ff)),Ff.result()},o.bounds=function(a){return ys(a,r(z0)),z0.result()},o.centroid=function(a){return ys(a,r(wi)),wi.result()},o.projection=function(a){return arguments.length?(r=a==null?(e=null,Mf):(e=a).stream,o):e},o.context=function(a){return arguments.length?(s=a==null?(t=null,new W6(n)):new WS(t=a),typeof i!="function"&&s.pointRadius(i),o):t},o.pointRadius=function(a){return arguments.length?(i=typeof a=="function"?a:(s.pointRadius(+a),+a),o):i},o.digits=function(a){if(!arguments.length)return n;if(a==null)n=null;else{const u=Math.floor(a);if(!(u>=0))throw new RangeError(`invalid digits: ${a}`);n=u}return t===null&&(s=new W6(n)),o},o.projection(e).digits(n).context(t)}function ag(e){return function(t){var n=new B2;for(var i in e)n[i]=e[i];return n.stream=t,n}}function B2(){}B2.prototype={constructor:B2,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function e5(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),ys(n,e.stream(z0)),t(z0.result()),i!=null&&e.clipExtent(i),e}function ug(e,t,n){return e5(e,function(i){var r=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(r/(i[1][0]-i[0][0]),s/(i[1][1]-i[0][1])),a=+t[0][0]+(r-o*(i[1][0]+i[0][0]))/2,u=+t[0][1]+(s-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([a,u])},n)}function t5(e,t,n){return ug(e,[[0,0],t],n)}function n5(e,t,n){return e5(e,function(i){var r=+t,s=r/(i[1][0]-i[0][0]),o=(r-s*(i[1][0]+i[0][0]))/2,a=-s*i[0][1];e.scale(150*s).translate([o,a])},n)}function i5(e,t,n){return e5(e,function(i){var r=+t,s=r/(i[1][1]-i[0][1]),o=-s*i[0][0],a=(r-s*(i[1][1]+i[0][1]))/2;e.scale(150*s).translate([o,a])},n)}var G6=16,EH=me(30*Fe);function Y6(e,t){return+t?SH(e,t):CH(e)}function CH(e){return ag({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function SH(e,t){function n(i,r,s,o,a,u,l,c,f,d,h,p,g,m){var y=l-i,v=c-r,b=y*y+v*v;if(b>4*t&&g--){var x=o+d,_=a+h,E=u+p,w=On(x*x+_*_+E*E),S=Xn(E/=w),$=Re(Re(E)-1)<ve||Re(s-f)<ve?(s+f)/2:$i(_,x),F=e($,S),T=F[0],P=F[1],R=T-i,C=P-r,A=v*R-y*C;(A*A/b>t||Re((y*R+v*C)/b-.5)>.3||o*d+a*h+u*p<EH)&&(n(i,r,s,o,a,u,T,P,$,x/=w,_/=w,E,g,m),m.point(T,P),n(T,P,$,x,_,E,l,c,f,d,h,p,g,m))}}return function(i){var r,s,o,a,u,l,c,f,d,h,p,g,m={point:y,lineStart:v,lineEnd:x,polygonStart:function(){i.polygonStart(),m.lineStart=_},polygonEnd:function(){i.polygonEnd(),m.lineStart=v}};function y(S,$){S=e(S,$),i.point(S[0],S[1])}function v(){f=NaN,m.point=b,i.lineStart()}function b(S,$){var F=Va([S,$]),T=e(S,$);n(f,d,c,h,p,g,f=T[0],d=T[1],c=S,h=F[0],p=F[1],g=F[2],G6,i),i.point(f,d)}function x(){m.point=y,i.lineEnd()}function _(){v(),m.point=E,m.lineEnd=w}function E(S,$){b(r=S,$),s=f,o=d,a=h,u=p,l=g,m.point=b}function w(){n(f,d,c,h,p,g,s,o,r,a,u,l,G6,i),m.lineEnd=x,x()}return m}}var kH=ag({point:function(e,t){this.stream.point(e*Fe,t*Fe)}});function AH(e){return ag({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function $H(e,t,n,i,r){function s(o,a){return o*=i,a*=r,[t+e*o,n-e*a]}return s.invert=function(o,a){return[(o-t)/e*i,(n-a)/e*r]},s}function Z6(e,t,n,i,r,s){if(!s)return $H(e,t,n,i,r);var o=me(s),a=he(s),u=o*e,l=a*e,c=o/e,f=a/e,d=(a*n-o*t)/e,h=(a*t+o*n)/e;function p(g,m){return g*=i,m*=r,[u*g-l*m+t,n-l*g-u*m]}return p.invert=function(g,m){return[i*(c*g-f*m+d),r*(h-f*g-c*m)]},p}function Gr(e){return JS(function(){return e})()}function JS(e){var t,n=150,i=480,r=250,s=0,o=0,a=0,u=0,l=0,c,f=0,d=1,h=1,p=null,g=P6,m=null,y,v,b,x=Mf,_=.5,E,w,S,$,F;function T(A){return S(A[0]*Fe,A[1]*Fe)}function P(A){return A=S.invert(A[0],A[1]),A&&[A[0]*Ct,A[1]*Ct]}T.stream=function(A){return $&&F===A?$:$=kH(AH(c)(g(E(x(F=A)))))},T.preclip=function(A){return arguments.length?(g=A,p=void 0,C()):g},T.postclip=function(A){return arguments.length?(x=A,m=y=v=b=null,C()):x},T.clipAngle=function(A){return arguments.length?(g=+A?lH(p=A*Fe):(p=null,P6),C()):p*Ct},T.clipExtent=function(A){return arguments.length?(x=A==null?(m=y=v=b=null,Mf):zS(m=+A[0][0],y=+A[0][1],v=+A[1][0],b=+A[1][1]),C()):m==null?null:[[m,y],[v,b]]},T.scale=function(A){return arguments.length?(n=+A,R()):n},T.translate=function(A){return arguments.length?(i=+A[0],r=+A[1],R()):[i,r]},T.center=function(A){return arguments.length?(s=A[0]%360*Fe,o=A[1]%360*Fe,R()):[s*Ct,o*Ct]},T.rotate=function(A){return arguments.length?(a=A[0]%360*Fe,u=A[1]%360*Fe,l=A.length>2?A[2]%360*Fe:0,R()):[a*Ct,u*Ct,l*Ct]},T.angle=function(A){return arguments.length?(f=A%360*Fe,R()):f*Ct},T.reflectX=function(A){return arguments.length?(d=A?-1:1,R()):d<0},T.reflectY=function(A){return arguments.length?(h=A?-1:1,R()):h<0},T.precision=function(A){return arguments.length?(E=Y6(w,_=A*A),C()):On(_)},T.fitExtent=function(A,M){return ug(T,A,M)},T.fitSize=function(A,M){return t5(T,A,M)},T.fitWidth=function(A,M){return n5(T,A,M)},T.fitHeight=function(A,M){return i5(T,A,M)};function R(){var A=Z6(n,0,0,d,h,f).apply(null,t(s,o)),M=Z6(n,i-A[0],r-A[1],d,h,f);return c=RS(a,u,l),w=T2(t,M),S=T2(c,w),E=Y6(w,_),C()}function C(){return $=F=null,T}return function(){return t=e.apply(this,arguments),T.invert=t.invert&&P,R()}}function r5(e){var t=0,n=Le/3,i=JS(e),r=i(t,n);return r.parallels=function(s){return arguments.length?i(t=s[0]*Fe,n=s[1]*Fe):[t*Ct,n*Ct]},r}function MH(e){var t=me(e);function n(i,r){return[i*t,he(r)/t]}return n.invert=function(i,r){return[i/t,Xn(r*t)]},n}function TH(e,t){var n=he(e),i=(n+he(t))/2;if(Re(i)<ve)return MH(e);var r=1+n*(2*i-n),s=On(r)/i;function o(a,u){var l=On(r-2*i*he(u))/i;return[l*he(a*=i),s-l*me(a)]}return o.invert=function(a,u){var l=s-u,c=$i(a,Re(l))*Ei(l);return l*i<0&&(c-=Le*Ei(a)*Ei(l)),[c/i,Xn((r-(a*a+l*l)*i*i)/(2*i))]},o}function H0(){return r5(TH).scale(155.424).center([0,33.6442])}function QS(){return H0().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function FH(e){var t=e.length;return{point:function(n,i){for(var r=-1;++r<t;)e[r].point(n,i)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function LH(){var e,t,n=QS(),i,r=H0().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,o=H0().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],p=d[1];return u=null,i.point(h,p),u||(s.point(h,p),u)||(a.point(h,p),u)}c.invert=function(d){var h=n.scale(),p=n.translate(),g=(d[0]-p[0])/h,m=(d[1]-p[1])/h;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?r:m>=.166&&m<.234&&g>=-.214&&g<-.115?o:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=FH([n.stream(t=d),r.stream(d),o.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),r.precision(d),o.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),r.scale(d*.35),o.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),p=+d[0],g=+d[1];return i=n.translate(d).clipExtent([[p-.455*h,g-.238*h],[p+.455*h,g+.238*h]]).stream(l),s=r.translate([p-.307*h,g+.201*h]).clipExtent([[p-.425*h+ve,g+.12*h+ve],[p-.214*h-ve,g+.234*h-ve]]).stream(l),a=o.translate([p-.205*h,g+.212*h]).clipExtent([[p-.214*h+ve,g+.166*h+ve],[p-.115*h-ve,g+.234*h-ve]]).stream(l),f()},c.fitExtent=function(d,h){return ug(c,d,h)},c.fitSize=function(d,h){return t5(c,d,h)},c.fitWidth=function(d,h){return n5(c,d,h)},c.fitHeight=function(d,h){return i5(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function ek(e){return function(t,n){var i=me(t),r=me(n),s=e(i*r);return s===1/0?[2,0]:[s*r*he(t),s*he(n)]}}function sd(e){return function(t,n){var i=On(t*t+n*n),r=e(i),s=he(r),o=me(r);return[$i(t*s,i*o),Xn(i&&n*s/i)]}}var tk=ek(function(e){return On(2/(1+e))});tk.invert=sd(function(e){return 2*Xn(e/2)});function NH(){return Gr(tk).scale(124.75).clipAngle(180-.001)}var nk=ek(function(e){return(e=CS(e))&&e/he(e)});nk.invert=sd(function(e){return e});function DH(){return Gr(nk).scale(79.4188).clipAngle(180-.001)}function lg(e,t){return[e,C0(J3((Et+t)/2))]}lg.invert=function(e,t){return[e,2*Rl(ES(t))-Et]};function RH(){return ik(lg).scale(961/Rn)}function ik(e){var t=Gr(e),n=t.center,i=t.scale,r=t.translate,s=t.clipExtent,o=null,a,u,l;t.scale=function(f){return arguments.length?(i(f),c()):i()},t.translate=function(f){return arguments.length?(r(f),c()):r()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?o=a=u=l=null:(o=+f[0][0],a=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):o==null?null:[[o,a],[u,l]]};function c(){var f=Le*i(),d=t(tH(t.rotate()).invert([0,0]));return s(o==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===lg?[[Math.max(d[0]-f,o),a],[Math.min(d[0]+f,u),l]]:[[o,Math.max(d[1]-f,a)],[u,Math.min(d[1]+f,l)]])}return c()}function rh(e){return J3((Et+e)/2)}function OH(e,t){var n=me(e),i=e===t?he(e):C0(n/me(t))/C0(rh(t)/rh(e)),r=n*gm(rh(e),i)/i;if(!i)return lg;function s(o,a){r>0?a<-Et+ve&&(a=-Et+ve):a>Et-ve&&(a=Et-ve);var u=r/gm(rh(a),i);return[u*he(i*o),r-u*me(i*o)]}return s.invert=function(o,a){var u=r-a,l=Ei(i)*On(o*o+u*u),c=$i(o,Re(u))*Ei(u);return u*i<0&&(c-=Le*Ei(o)*Ei(u)),[c/i,2*Rl(gm(r/l,1/i))-Et]},s}function IH(){return r5(OH).scale(109.5).parallels([30,30])}function q0(e,t){return[e,t]}q0.invert=q0;function PH(){return Gr(q0).scale(152.63)}function zH(e,t){var n=me(e),i=e===t?he(e):(n-me(t))/(t-e),r=n/i+e;if(Re(i)<ve)return q0;function s(o,a){var u=r-a,l=i*o;return[u*he(l),r-u*me(l)]}return s.invert=function(o,a){var u=r-a,l=$i(o,Re(u))*Ei(u);return u*i<0&&(l-=Le*Ei(o)*Ei(u)),[l/i,r-Ei(i)*On(o*o+u*u)]},s}function BH(){return r5(zH).scale(131.154).center([0,13.9389])}var sf=1.340264,of=-.081106,af=893e-6,uf=.003796,V0=On(3)/2,UH=12;function rk(e,t){var n=Xn(V0*he(t)),i=n*n,r=i*i*i;return[e*me(n)/(V0*(sf+3*of*i+r*(7*af+9*uf*i))),n*(sf+of*i+r*(af+uf*i))]}rk.invert=function(e,t){for(var n=t,i=n*n,r=i*i*i,s=0,o,a,u;s<UH&&(a=n*(sf+of*i+r*(af+uf*i))-t,u=sf+3*of*i+r*(7*af+9*uf*i),n-=o=a/u,i=n*n,r=i*i*i,!(Re(o)<x2));++s);return[V0*e*(sf+3*of*i+r*(7*af+9*uf*i))/me(n),Xn(he(n)/V0)]};function jH(){return Gr(rk).scale(177.158)}function sk(e,t){var n=me(t),i=me(e)*n;return[n*he(e)/i,he(t)/i]}sk.invert=sd(Rl);function HH(){return Gr(sk).scale(144.049).clipAngle(60)}function qH(){var e=1,t=0,n=0,i=1,r=1,s=0,o,a,u=null,l,c,f,d=1,h=1,p=ag({point:function(x,_){var E=b([x,_]);this.stream.point(E[0],E[1])}}),g=Mf,m,y;function v(){return d=e*i,h=e*r,m=y=null,b}function b(x){var _=x[0]*d,E=x[1]*h;if(s){var w=E*o-_*a;_=_*o+E*a,E=w}return[_+t,E+n]}return b.invert=function(x){var _=x[0]-t,E=x[1]-n;if(s){var w=E*o+_*a;_=_*o-E*a,E=w}return[_/d,E/h]},b.stream=function(x){return m&&y===x?m:m=p(g(y=x))},b.postclip=function(x){return arguments.length?(g=x,u=l=c=f=null,v()):g},b.clipExtent=function(x){return arguments.length?(g=x==null?(u=l=c=f=null,Mf):zS(u=+x[0][0],l=+x[0][1],c=+x[1][0],f=+x[1][1]),v()):u==null?null:[[u,l],[c,f]]},b.scale=function(x){return arguments.length?(e=+x,v()):e},b.translate=function(x){return arguments.length?(t=+x[0],n=+x[1],v()):[t,n]},b.angle=function(x){return arguments.length?(s=x%360*Fe,a=he(s),o=me(s),v()):s*Ct},b.reflectX=function(x){return arguments.length?(i=x?-1:1,v()):i<0},b.reflectY=function(x){return arguments.length?(r=x?-1:1,v()):r<0},b.fitExtent=function(x,_){return ug(b,x,_)},b.fitSize=function(x,_){return t5(b,x,_)},b.fitWidth=function(x,_){return n5(b,x,_)},b.fitHeight=function(x,_){return i5(b,x,_)},b}function ok(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(-.013791+i*(.003971*n-.001529*i))),t*(1.007226+n*(.015085+i*(-.044475+.028874*n-.005916*i)))]}ok.invert=function(e,t){var n=t,i=25,r;do{var s=n*n,o=s*s;n-=r=(n*(1.007226+s*(.015085+o*(-.044475+.028874*s-.005916*o)))-t)/(1.007226+s*(.015085*3+o*(-.044475*7+.028874*9*s-.005916*11*o)))}while(Re(r)>ve&&--i>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function VH(){return Gr(ok).scale(175.295)}function ak(e,t){return[me(t)*he(e),he(t)]}ak.invert=sd(Xn);function WH(){return Gr(ak).scale(249.5).clipAngle(90+ve)}function uk(e,t){var n=me(t),i=1+me(e)*n;return[n*he(e)/i,he(t)/i]}uk.invert=sd(function(e){return 2*Rl(e)});function GH(){return Gr(uk).scale(250).clipAngle(142)}function lk(e,t){return[C0(J3((Et+t)/2)),-e]}lk.invert=function(e,t){return[-t,2*Rl(ES(e))-Et]};function YH(){var e=ik(lk),t=e.center,n=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):(i=t(),[i[1],-i[0]])},e.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):(i=n(),[i[0],i[1],i[2]-90])},n([0,0,90]).scale(159.155)}function ZH(e,t){return e.parent===t.parent?1:2}function XH(e){return e.reduce(KH,0)/e.length}function KH(e,t){return e+t.x}function JH(e){return 1+e.reduce(QH,0)}function QH(e,t){return Math.max(e,t.y)}function eq(e){for(var t;t=e.children;)e=t[0];return e}function tq(e){for(var t;t=e.children;)e=t[t.length-1];return e}function nq(){var e=ZH,t=1,n=1,i=!1;function r(s){var o,a=0;s.eachAfter(function(d){var h=d.children;h?(d.x=XH(h),d.y=JH(h)):(d.x=o?a+=e(d,o):0,d.y=0,o=d)});var u=eq(s),l=tq(s),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return s.eachAfter(i?function(d){d.x=(d.x-s.x)*t,d.y=(s.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(s.y?d.y/s.y:1))*n})}return r.separation=function(s){return arguments.length?(e=s,r):e},r.size=function(s){return arguments.length?(i=!1,t=+s[0],n=+s[1],r):i?null:[t,n]},r.nodeSize=function(s){return arguments.length?(i=!0,t=+s[0],n=+s[1],r):i?[t,n]:null},r}function iq(e){var t=0,n=e.children,i=n&&n.length;if(!i)t=1;else for(;--i>=0;)t+=n[i].value;e.value=t}function rq(){return this.eachAfter(iq)}function sq(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this}function oq(e,t){for(var n=this,i=[n],r,s,o=-1;n=i.pop();)if(e.call(t,n,++o,this),r=n.children)for(s=r.length-1;s>=0;--s)i.push(r[s]);return this}function aq(e,t){for(var n=this,i=[n],r=[],s,o,a,u=-1;n=i.pop();)if(r.push(n),s=n.children)for(o=0,a=s.length;o<a;++o)i.push(s[o]);for(;n=r.pop();)e.call(t,n,++u,this);return this}function uq(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i}function lq(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})}function cq(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function fq(e){for(var t=this,n=dq(t,e),i=[t];t!==n;)t=t.parent,i.push(t);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i}function dq(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}function hq(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function pq(){return Array.from(this)}function gq(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function mq(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*yq(){var e=this,t,n=[e],i,r,s;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,i=e.children)for(r=0,s=i.length;r<s;++r)n.push(i[r]);while(n.length)}function s5(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=xq)):t===void 0&&(t=bq);for(var n=new al(e),i,r=[n],s,o,a,u;i=r.pop();)if((o=t(i.data))&&(u=(o=Array.from(o)).length))for(i.children=o,a=u-1;a>=0;--a)r.push(s=o[a]=new al(o[a])),s.parent=i,s.depth=i.depth+1;return n.eachBefore(ck)}function vq(){return s5(this).eachBefore(_q)}function bq(e){return e.children}function xq(e){return Array.isArray(e)?e[1]:null}function _q(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function ck(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function al(e){this.data=e,this.depth=this.height=0,this.parent=null}al.prototype=s5.prototype={constructor:al,count:rq,each:sq,eachAfter:aq,eachBefore:oq,find:uq,sum:lq,sort:cq,path:fq,ancestors:hq,descendants:pq,leaves:gq,links:mq,copy:vq,[Symbol.iterator]:yq};function zh(e){return e==null?null:fk(e)}function fk(e){if(typeof e!="function")throw new Error;return e}function pa(){return 0}function Iu(e){return function(){return e}}const wq=1664525,Eq=1013904223,X6=4294967296;function Cq(){let e=1;return()=>(e=(wq*e+Eq)%X6)/X6}function Sq(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function kq(e,t){let n=e.length,i,r;for(;n;)r=t()*n--|0,i=e[n],e[n]=e[r],e[r]=i;return e}function Aq(e,t){for(var n=0,i=(e=kq(Array.from(e),t)).length,r=[],s,o;n<i;)s=e[n],o&&dk(o,s)?++n:(o=Mq(r=$q(r,s)),n=0);return o}function $q(e,t){var n,i;if(xm(t,e))return[t];for(n=0;n<e.length;++n)if(sh(t,e[n])&&xm(Lc(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(sh(Lc(e[n],e[i]),t)&&sh(Lc(e[n],t),e[i])&&sh(Lc(e[i],t),e[n])&&xm(hk(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function sh(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function dk(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function xm(e,t){for(var n=0;n<t.length;++n)if(!dk(e,t[n]))return!1;return!0}function Mq(e){switch(e.length){case 1:return Tq(e[0]);case 2:return Lc(e[0],e[1]);case 3:return hk(e[0],e[1],e[2])}}function Tq(e){return{x:e.x,y:e.y,r:e.r}}function Lc(e,t){var n=e.x,i=e.y,r=e.r,s=t.x,o=t.y,a=t.r,u=s-n,l=o-i,c=a-r,f=Math.sqrt(u*u+l*l);return{x:(n+s+u/f*c)/2,y:(i+o+l/f*c)/2,r:(f+r+a)/2}}function hk(e,t,n){var i=e.x,r=e.y,s=e.r,o=t.x,a=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=i-o,h=i-l,p=r-a,g=r-c,m=u-s,y=f-s,v=i*i+r*r-s*s,b=v-o*o-a*a+u*u,x=v-l*l-c*c+f*f,_=h*p-d*g,E=(p*x-g*b)/(_*2)-i,w=(g*m-p*y)/_,S=(h*b-d*x)/(_*2)-r,$=(d*y-h*m)/_,F=w*w+$*$-1,T=2*(s+E*w+S*$),P=E*E+S*S-s*s,R=-(Math.abs(F)>1e-6?(T+Math.sqrt(T*T-4*F*P))/(2*F):P/T);return{x:i+E+w*R,y:r+S+$*R,r:R}}function K6(e,t,n){var i=e.x-t.x,r,s,o=e.y-t.y,a,u,l=i*i+o*o;l?(s=t.r+n.r,s*=s,u=e.r+n.r,u*=u,s>u?(r=(l+u-s)/(2*l),a=Math.sqrt(Math.max(0,u/l-r*r)),n.x=e.x-r*i-a*o,n.y=e.y-r*o+a*i):(r=(l+s-u)/(2*l),a=Math.sqrt(Math.max(0,s/l-r*r)),n.x=t.x+r*i-a*o,n.y=t.y+r*o+a*i)):(n.x=t.x+n.r,n.y=t.y)}function J6(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function Q6(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,s=(t.y*n.r+n.y*t.r)/i;return r*r+s*s}function oh(e){this._=e,this.next=null,this.previous=null}function Fq(e,t){if(!(s=(e=Sq(e)).length))return 0;var n,i,r,s,o,a,u,l,c,f,d;if(n=e[0],n.x=0,n.y=0,!(s>1))return n.r;if(i=e[1],n.x=-i.r,i.x=n.r,i.y=0,!(s>2))return n.r+i.r;K6(i,n,r=e[2]),n=new oh(n),i=new oh(i),r=new oh(r),n.next=r.previous=i,i.next=n.previous=r,r.next=i.previous=n;e:for(u=3;u<s;++u){K6(n._,i._,r=e[u]),r=new oh(r),l=i.next,c=n.previous,f=i._.r,d=n._.r;do if(f<=d){if(J6(l._,r._)){i=l,n.next=i,i.previous=n,--u;continue e}f+=l._.r,l=l.next}else{if(J6(c._,r._)){n=c,n.next=i,i.previous=n,--u;continue e}d+=c._.r,c=c.previous}while(l!==c.next);for(r.previous=n,r.next=i,n.next=i.previous=i=r,o=Q6(n);(r=r.next)!==i;)(a=Q6(r))<o&&(n=r,o=a);i=n.next}for(n=[i._],r=i;(r=r.next)!==i;)n.push(r._);for(r=Aq(n,t),u=0;u<s;++u)n=e[u],n.x-=r.x,n.y-=r.y;return r.r}function Lq(e){return Math.sqrt(e.value)}function Nq(){var e=null,t=1,n=1,i=pa;function r(s){const o=Cq();return s.x=t/2,s.y=n/2,e?s.eachBefore(e8(e)).eachAfter(_m(i,.5,o)).eachBefore(t8(1)):s.eachBefore(e8(Lq)).eachAfter(_m(pa,1,o)).eachAfter(_m(i,s.r/Math.min(t,n),o)).eachBefore(t8(Math.min(t,n)/(2*s.r))),s}return r.radius=function(s){return arguments.length?(e=zh(s),r):e},r.size=function(s){return arguments.length?(t=+s[0],n=+s[1],r):[t,n]},r.padding=function(s){return arguments.length?(i=typeof s=="function"?s:Iu(+s),r):i},r}function e8(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function _m(e,t,n){return function(i){if(r=i.children){var r,s,o=r.length,a=e(i)*t||0,u;if(a)for(s=0;s<o;++s)r[s].r+=a;if(u=Fq(r,n),a)for(s=0;s<o;++s)r[s].r-=a;i.r=u+a}}}function t8(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function pk(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function od(e,t,n,i,r){for(var s=e.children,o,a=-1,u=s.length,l=e.value&&(i-t)/e.value;++a<u;)o=s[a],o.y0=n,o.y1=r,o.x0=t,o.x1=t+=o.value*l}function Dq(){var e=1,t=1,n=0,i=!1;function r(o){var a=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/a,o.eachBefore(s(t,a)),i&&o.eachBefore(pk),o}function s(o,a){return function(u){u.children&&od(u,u.x0,o*(u.depth+1)/a,u.x1,o*(u.depth+2)/a);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return r.round=function(o){return arguments.length?(i=!!o,r):i},r.size=function(o){return arguments.length?(e=+o[0],t=+o[1],r):[e,t]},r.padding=function(o){return arguments.length?(n=+o,r):n},r}var Rq={depth:-1},n8={},wm={};function Oq(e){return e.id}function Iq(e){return e.parentId}function i8(){var e=Oq,t=Iq,n;function i(r){var s=Array.from(r),o=e,a=t,u,l,c,f,d,h,p,g,m=new Map;if(n!=null){const y=s.map((x,_)=>Pq(n(x,_,r))),v=y.map(r8),b=new Set(y).add("");for(const x of v)b.has(x)||(b.add(x),y.push(x),v.push(r8(x)),s.push(wm));o=(x,_)=>y[_],a=(x,_)=>v[_]}for(c=0,u=s.length;c<u;++c)l=s[c],h=s[c]=new al(l),(p=o(l,c,r))!=null&&(p+="")&&(g=h.id=p,m.set(g,m.has(g)?n8:h)),(p=a(l,c,r))!=null&&(p+="")&&(h.parent=p);for(c=0;c<u;++c)if(h=s[c],p=h.parent){if(d=m.get(p),!d)throw new Error("missing: "+p);if(d===n8)throw new Error("ambiguous: "+p);d.children?d.children.push(h):d.children=[h],h.parent=d}else{if(f)throw new Error("multiple roots");f=h}if(!f)throw new Error("no root");if(n!=null){for(;f.data===wm&&f.children.length===1;)f=f.children[0],--u;for(let y=s.length-1;y>=0&&(h=s[y],h.data===wm);--y)h.data=null}if(f.parent=Rq,f.eachBefore(function(y){y.depth=y.parent.depth+1,--u}).eachBefore(ck),f.parent=null,u>0)throw new Error("cycle");return f}return i.id=function(r){return arguments.length?(e=zh(r),i):e},i.parentId=function(r){return arguments.length?(t=zh(r),i):t},i.path=function(r){return arguments.length?(n=zh(r),i):n},i}function Pq(e){e=`${e}`;let t=e.length;return U2(e,t-1)&&!U2(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function r8(e){let t=e.length;if(t<2)return"";for(;--t>1&&!U2(e,t););return e.slice(0,t)}function U2(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if((n&1)===0)return!0}return!1}function zq(e,t){return e.parent===t.parent?1:2}function Em(e){var t=e.children;return t?t[0]:e.t}function Cm(e){var t=e.children;return t?t[t.length-1]:e.t}function Bq(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function Uq(e){for(var t=0,n=0,i=e.children,r=i.length,s;--r>=0;)s=i[r],s.z+=t,s.m+=t,t+=s.s+(n+=s.c)}function jq(e,t,n){return e.a.parent===t.parent?e.a:n}function Bh(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}Bh.prototype=Object.create(al.prototype);function Hq(e){for(var t=new Bh(e,0),n,i=[t],r,s,o,a;n=i.pop();)if(s=n._.children)for(n.children=new Array(a=s.length),o=a-1;o>=0;--o)i.push(r=n.children[o]=new Bh(s[o],o)),r.parent=n;return(t.parent=new Bh(null,0)).children=[t],t}function qq(){var e=zq,t=1,n=1,i=null;function r(l){var c=Hq(l);if(c.eachAfter(s),c.parent.m=-c.z,c.eachBefore(o),i)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(v){v.x<f.x&&(f=v),v.x>d.x&&(d=v),v.depth>h.depth&&(h=v)});var p=f===d?1:e(f,d)/2,g=p-f.x,m=t/(d.x+p+g),y=n/(h.depth||1);l.eachBefore(function(v){v.x=(v.x+g)*m,v.y=v.depth*y})}return l}function s(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){Uq(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=a(l,d,l.parent.A||f[0])}function o(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function a(l,c,f){if(c){for(var d=l,h=l,p=c,g=d.parent.children[0],m=d.m,y=h.m,v=p.m,b=g.m,x;p=Cm(p),d=Em(d),p&&d;)g=Em(g),h=Cm(h),h.a=l,x=p.z+v-d.z-m+e(p._,d._),x>0&&(Bq(jq(p,l,f),l,x),m+=x,y+=x),v+=p.m,m+=d.m,b+=g.m,y+=h.m;p&&!Cm(h)&&(h.t=p,h.m+=v-y),d&&!Em(g)&&(g.t=d,g.m+=m-b,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return r.separation=function(l){return arguments.length?(e=l,r):e},r.size=function(l){return arguments.length?(i=!1,t=+l[0],n=+l[1],r):i?null:[t,n]},r.nodeSize=function(l){return arguments.length?(i=!0,t=+l[0],n=+l[1],r):i?[t,n]:null},r}function cg(e,t,n,i,r){for(var s=e.children,o,a=-1,u=s.length,l=e.value&&(r-n)/e.value;++a<u;)o=s[a],o.x0=t,o.x1=i,o.y0=n,o.y1=n+=o.value*l}var gk=(1+Math.sqrt(5))/2;function mk(e,t,n,i,r,s){for(var o=[],a=t.children,u,l,c=0,f=0,d=a.length,h,p,g=t.value,m,y,v,b,x,_,E;c<d;){h=r-n,p=s-i;do m=a[f++].value;while(!m&&f<d);for(y=v=m,_=Math.max(p/h,h/p)/(g*e),E=m*m*_,x=Math.max(v/E,E/y);f<d;++f){if(m+=l=a[f].value,l<y&&(y=l),l>v&&(v=l),E=m*m*_,b=Math.max(v/E,E/y),b>x){m-=l;break}x=b}o.push(u={value:m,dice:h<p,children:a.slice(c,f)}),u.dice?od(u,n,i,r,g?i+=p*m/g:s):cg(u,n,i,g?n+=h*m/g:r,s),g-=m,c=f}return o}const yk=function e(t){function n(i,r,s,o,a){mk(t,i,r,s,o,a)}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(gk);function Vq(){var e=yk,t=!1,n=1,i=1,r=[0],s=pa,o=pa,a=pa,u=pa,l=pa;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=i,d.eachBefore(f),r=[0],t&&d.eachBefore(pk),d}function f(d){var h=r[d.depth],p=d.x0+h,g=d.y0+h,m=d.x1-h,y=d.y1-h;m<p&&(p=m=(p+m)/2),y<g&&(g=y=(g+y)/2),d.x0=p,d.y0=g,d.x1=m,d.y1=y,d.children&&(h=r[d.depth+1]=s(d)/2,p+=l(d)-h,g+=o(d)-h,m-=a(d)-h,y-=u(d)-h,m<p&&(p=m=(p+m)/2),y<g&&(g=y=(g+y)/2),e(d,p,g,m,y))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],i=+d[1],c):[n,i]},c.tile=function(d){return arguments.length?(e=fk(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(s=typeof d=="function"?d:Iu(+d),c):s},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(o=typeof d=="function"?d:Iu(+d),c):o},c.paddingRight=function(d){return arguments.length?(a=typeof d=="function"?d:Iu(+d),c):a},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:Iu(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:Iu(+d),c):l},c}function Wq(e,t,n,i,r){var s=e.children,o,a=s.length,u,l=new Array(a+1);for(l[0]=u=o=0;o<a;++o)l[o+1]=u+=s[o].value;c(0,a,e.value,t,n,i,r);function c(f,d,h,p,g,m,y){if(f>=d-1){var v=s[f];v.x0=p,v.y0=g,v.x1=m,v.y1=y;return}for(var b=l[f],x=h/2+b,_=f+1,E=d-1;_<E;){var w=_+E>>>1;l[w]<x?_=w+1:E=w}x-l[_-1]<l[_]-x&&f+1<_&&--_;var S=l[_]-b,$=h-S;if(m-p>y-g){var F=h?(p*$+m*S)/h:m;c(f,_,S,p,g,F,y),c(_,d,$,F,g,m,y)}else{var T=h?(g*$+y*S)/h:y;c(f,_,S,p,g,m,T),c(_,d,$,p,T,m,y)}}}function Gq(e,t,n,i,r){(e.depth&1?cg:od)(e,t,n,i,r)}const Yq=function e(t){function n(i,r,s,o,a){if((u=i._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,p=u.length,g=i.value;++d<p;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?od(l,r,s,o,g?s+=(a-s)*l.value/g:a):cg(l,r,s,g?r+=(o-r)*l.value/g:o,a),g-=l.value}else i._squarify=u=mk(t,i,r,s,o,a),u.ratio=t}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(gk);function Yr(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ho(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const j2=Symbol("implicit");function o5(){var e=new q9,t=[],n=[],i=j2;function r(s){let o=e.get(s);if(o===void 0){if(i!==j2)return i;e.set(s,o=t.push(s)-1)}return n[o%n.length]}return r.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new q9;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return r},r.range=function(s){return arguments.length?(n=Array.from(s),r):n.slice()},r.unknown=function(s){return arguments.length?(i=s,r):i},r.copy=function(){return o5(t,n).unknown(i)},Yr.apply(r,arguments),r}function Zq(e){return function(){return e}}function H2(e){return+e}var s8=[0,1];function Gn(e){return e}function q2(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Zq(isNaN(t)?NaN:.5)}function Xq(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function Kq(e,t,n){var i=e[0],r=e[1],s=t[0],o=t[1];return r<i?(i=q2(r,i),s=n(o,s)):(i=q2(i,r),s=n(s,o)),function(a){return s(i(a))}}function Jq(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),s=new Array(i),o=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<i;)r[o]=q2(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(a){var u=So(e,a,1,i)-1;return s[u](r[u](a))}}function ad(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function fg(){var e=s8,t=s8,n=jo,i,r,s,o=Gn,a,u,l;function c(){var d=Math.min(e.length,t.length);return o!==Gn&&(o=Xq(e[0],e[d-1])),a=d>2?Jq:Kq,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?s:(u||(u=a(e.map(i),t,n)))(i(o(d)))}return f.invert=function(d){return o(r((l||(l=a(t,e.map(i),bi)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,H2),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=nd,c()},f.clamp=function(d){return arguments.length?(o=d?!0:Gn,c()):o!==Gn},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(s=d,f):s},function(d,h){return i=d,r=h,c()}}function vk(){return fg()(Gn,Gn)}function bk(e,t,n,i){var r=ko(e,t,n),s;switch(i=qa(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(s=_S(r,o))&&(i.precision=s),K3(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=wS(r,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=xS(r))&&(i.precision=s-(i.type==="%")*2);break}}return og(i)}function cu(e){var t=e.domain;return e.ticks=function(n){var i=t();return r2(i[0],i[i.length-1],n??10)},e.tickFormat=function(n,i){var r=t();return bk(r[0],r[r.length-1],n??10,i)},e.nice=function(n){n==null&&(n=10);var i=t(),r=0,s=i.length-1,o=i[r],a=i[s],u,l,c=10;for(a<o&&(l=o,o=a,a=l,l=r,r=s,s=l);c-- >0;){if(l=s2(o,a,n),l===u)return i[r]=o,i[s]=a,t(i);if(l>0)o=Math.floor(o/l)*l,a=Math.ceil(a/l)*l;else if(l<0)o=Math.ceil(o*l)/l,a=Math.floor(a*l)/l;else break;u=l}return e},e}function xk(){var e=vk();return e.copy=function(){return ad(e,xk())},Yr.apply(e,arguments),cu(e)}function _k(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,H2),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return _k(e).unknown(t)},e=arguments.length?Array.from(e,H2):[0,1],cu(n)}function wk(e,t){e=e.slice();var n=0,i=e.length-1,r=e[n],s=e[i],o;return s<r&&(o=n,n=i,i=o,o=r,r=s,s=o),e[n]=t.floor(r),e[i]=t.ceil(s),e}function o8(e){return Math.log(e)}function a8(e){return Math.exp(e)}function Qq(e){return-Math.log(-e)}function eV(e){return-Math.exp(-e)}function tV(e){return isFinite(e)?+("1e"+e):e<0?0:e}function nV(e){return e===10?tV:e===Math.E?Math.exp:t=>Math.pow(e,t)}function iV(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function u8(e){return(t,n)=>-e(-t,n)}function a5(e){const t=e(o8,a8),n=t.domain;let i=10,r,s;function o(){return r=iV(i),s=nV(i),n()[0]<0?(r=u8(r),s=u8(s),e(Qq,eV)):e(o8,a8),t}return t.base=function(a){return arguments.length?(i=+a,o()):i},t.domain=function(a){return arguments.length?(n(a),o()):n()},t.ticks=a=>{const u=n();let l=u[0],c=u[u.length-1];const f=c<l;f&&([l,c]=[c,l]);let d=r(l),h=r(c),p,g;const m=a==null?10:+a;let y=[];if(!(i%1)&&h-d<m){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(p=1;p<i;++p)if(g=d<0?p/s(-d):p*s(d),!(g<l)){if(g>c)break;y.push(g)}}else for(;d<=h;++d)for(p=i-1;p>=1;--p)if(g=d>0?p/s(-d):p*s(d),!(g<l)){if(g>c)break;y.push(g)}y.length*2<m&&(y=r2(l,c,m))}else y=r2(d,h,Math.min(h-d,m)).map(s);return f?y.reverse():y},t.tickFormat=(a,u)=>{if(a==null&&(a=10),u==null&&(u=i===10?"s":","),typeof u!="function"&&(!(i%1)&&(u=qa(u)).precision==null&&(u.trim=!0),u=og(u)),a===1/0)return u;const l=Math.max(1,i*a/t.ticks().length);return c=>{let f=c/s(Math.round(r(c)));return f*i<i-.5&&(f*=i),f<=l?u(c):""}},t.nice=()=>n(wk(n(),{floor:a=>s(Math.floor(r(a))),ceil:a=>s(Math.ceil(r(a)))})),t}function Ek(){const e=a5(fg()).domain([1,10]);return e.copy=()=>ad(e,Ek()).base(e.base()),Yr.apply(e,arguments),e}function l8(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function c8(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function u5(e){var t=1,n=e(l8(t),c8(t));return n.constant=function(i){return arguments.length?e(l8(t=+i),c8(t)):t},cu(n)}function Ck(){var e=u5(fg());return e.copy=function(){return ad(e,Ck()).constant(e.constant())},Yr.apply(e,arguments)}function f8(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function rV(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function sV(e){return e<0?-e*e:e*e}function l5(e){var t=e(Gn,Gn),n=1;function i(){return n===1?e(Gn,Gn):n===.5?e(rV,sV):e(f8(n),f8(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,i()):n},cu(t)}function c5(){var e=l5(fg());return e.copy=function(){return ad(e,c5()).exponent(e.exponent())},Yr.apply(e,arguments),e}function oV(){return c5.apply(null,arguments).exponent(.5)}function Sk(){var e=[],t=[],n=[],i;function r(){var o=0,a=Math.max(1,t.length);for(n=new Array(a-1);++o<a;)n[o-1]=bC(e,o/a);return s}function s(o){return o==null||isNaN(o=+o)?i:t[So(n,o)]}return s.invertExtent=function(o){var a=t.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let a of o)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Ss),r()},s.range=function(o){return arguments.length?(t=Array.from(o),r()):t.slice()},s.unknown=function(o){return arguments.length?(i=o,s):i},s.quantiles=function(){return n.slice()},s.copy=function(){return Sk().domain(e).range(t).unknown(i)},Yr.apply(s,arguments)}function kk(){var e=0,t=1,n=1,i=[.5],r=[0,1],s;function o(u){return u!=null&&u<=u?r[So(i,u,0,n)]:s}function a(){var u=-1;for(i=new Array(n);++u<n;)i[u]=((u+1)*t-(u-n)*e)/(n+1);return o}return o.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,a()):[e,t]},o.range=function(u){return arguments.length?(n=(r=Array.from(u)).length-1,a()):r.slice()},o.invertExtent=function(u){var l=r.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,i[0]]:l>=n?[i[n-1],t]:[i[l-1],i[l]]},o.unknown=function(u){return arguments.length&&(s=u),o},o.thresholds=function(){return i.slice()},o.copy=function(){return kk().domain([e,t]).range(r).unknown(s)},Yr.apply(cu(o),arguments)}function Ak(){var e=[.5],t=[0,1],n,i=1;function r(s){return s!=null&&s<=s?t[So(e,s,0,i)]:n}return r.domain=function(s){return arguments.length?(e=Array.from(s),i=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(s){return arguments.length?(t=Array.from(s),i=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},r.unknown=function(s){return arguments.length?(n=s,r):n},r.copy=function(){return Ak().domain(e).range(t).unknown(n)},Yr.apply(r,arguments)}const Sm=new Date,km=new Date;function Dt(e,t,n,i){function r(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return r.floor=s=>(e(s=new Date(+s)),s),r.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),r.round=s=>{const o=r(s),a=r.ceil(s);return s-o<a-s?o:a},r.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),r.range=(s,o,a)=>{const u=[];if(s=r.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return u;let l;do u.push(l=new Date(+s)),t(s,a),e(s);while(l<s&&s<o);return u},r.filter=s=>Dt(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););}),n&&(r.count=(s,o)=>(Sm.setTime(+s),km.setTime(+o),e(Sm),e(km),Math.floor(n(Sm,km))),r.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?r.filter(i?o=>i(o)%s===0:o=>r.count(0,o)%s===0):r)),r}const ul=Dt(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);ul.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Dt(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):ul);ul.range;const xs=1e3,Ci=xs*60,_s=Ci*60,Rs=_s*24,f5=Rs*7,d8=Rs*30,Am=Rs*365,ws=Dt(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*xs)},(e,t)=>(t-e)/xs,e=>e.getUTCSeconds());ws.range;const dg=Dt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*xs)},(e,t)=>{e.setTime(+e+t*Ci)},(e,t)=>(t-e)/Ci,e=>e.getMinutes());dg.range;const hg=Dt(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ci)},(e,t)=>(t-e)/Ci,e=>e.getUTCMinutes());hg.range;const pg=Dt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*xs-e.getMinutes()*Ci)},(e,t)=>{e.setTime(+e+t*_s)},(e,t)=>(t-e)/_s,e=>e.getHours());pg.range;const gg=Dt(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*_s)},(e,t)=>(t-e)/_s,e=>e.getUTCHours());gg.range;const As=Dt(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ci)/Rs,e=>e.getDate()-1);As.range;const xo=Dt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Rs,e=>e.getUTCDate()-1);xo.range;const $k=Dt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Rs,e=>Math.floor(e/Rs));$k.range;function fu(e){return Dt(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Ci)/f5)}const Ol=fu(0),W0=fu(1),aV=fu(2),uV=fu(3),ll=fu(4),lV=fu(5),cV=fu(6);Ol.range;W0.range;aV.range;uV.range;ll.range;lV.range;cV.range;function du(e){return Dt(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/f5)}const Il=du(0),G0=du(1),fV=du(2),dV=du(3),cl=du(4),hV=du(5),pV=du(6);Il.range;G0.range;fV.range;dV.range;cl.range;hV.range;pV.range;const Lf=Dt(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Lf.range;const Nf=Dt(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Nf.range;const Pr=Dt(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Pr.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Dt(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Pr.range;const zr=Dt(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());zr.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Dt(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});zr.range;function Mk(e,t,n,i,r,s){const o=[[ws,1,xs],[ws,5,5*xs],[ws,15,15*xs],[ws,30,30*xs],[s,1,Ci],[s,5,5*Ci],[s,15,15*Ci],[s,30,30*Ci],[r,1,_s],[r,3,3*_s],[r,6,6*_s],[r,12,12*_s],[i,1,Rs],[i,2,2*Rs],[n,1,f5],[t,1,d8],[t,3,3*d8],[e,1,Am]];function a(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),p=h?h.range(l,+c+1):[];return d?p.reverse():p}function u(l,c,f){const d=Math.abs(c-l)/f,h=Nl(([,,m])=>m).right(o,d);if(h===o.length)return e.every(ko(l/Am,c/Am,f));if(h===0)return ul.every(Math.max(ko(l,c,f),1));const[p,g]=o[d/o[h-1][2]<o[h][2]/d?h-1:h];return p.every(g)}return[a,u]}const[gV,mV]=Mk(zr,Nf,Il,$k,gg,hg),[yV,vV]=Mk(Pr,Lf,Ol,As,pg,dg);function $m(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Mm(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function cc(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Tk(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,s=e.days,o=e.shortDays,a=e.months,u=e.shortMonths,l=fc(r),c=dc(r),f=fc(s),d=dc(s),h=fc(o),p=dc(o),g=fc(a),m=dc(a),y=fc(u),v=dc(u),b={a:L,A:D,b:O,B:j,c:null,d:v8,e:v8,f:UV,g:KV,G:QV,H:PV,I:zV,j:BV,L:Fk,m:jV,M:HV,p:J,q:K,Q:_8,s:w8,S:qV,u:VV,U:WV,V:GV,w:YV,W:ZV,x:null,X:null,y:XV,Y:JV,Z:eW,"%":x8},x={a:fe,A:we,b:de,B:Pe,c:null,d:b8,e:b8,f:rW,g:pW,G:mW,H:tW,I:nW,j:iW,L:Nk,m:sW,M:oW,p:dt,q:xt,Q:_8,s:w8,S:aW,u:uW,U:lW,V:cW,w:fW,W:dW,x:null,X:null,y:hW,Y:gW,Z:yW,"%":x8},_={a:F,A:T,b:P,B:R,c:C,d:m8,e:m8,f:DV,g:g8,G:p8,H:y8,I:y8,j:TV,L:NV,m:MV,M:FV,p:$,q:$V,Q:OV,s:IV,S:LV,u:EV,U:CV,V:SV,w:wV,W:kV,x:A,X:M,y:g8,Y:p8,Z:AV,"%":RV};b.x=E(n,b),b.X=E(i,b),b.c=E(t,b),x.x=E(n,x),x.X=E(i,x),x.c=E(t,x);function E(se,Ee){return function(Te){var k=[],N=-1,I=0,H=se.length,U,q,ie;for(Te instanceof Date||(Te=new Date(+Te));++N<H;)se.charCodeAt(N)===37&&(k.push(se.slice(I,N)),(q=h8[U=se.charAt(++N)])!=null?U=se.charAt(++N):q=U==="e"?" ":"0",(ie=Ee[U])&&(U=ie(Te,q)),k.push(U),I=N+1);return k.push(se.slice(I,N)),k.join("")}}function w(se,Ee){return function(Te){var k=cc(1900,void 0,1),N=S(k,se,Te+="",0),I,H;if(N!=Te.length)return null;if("Q"in k)return new Date(k.Q);if("s"in k)return new Date(k.s*1e3+("L"in k?k.L:0));if(Ee&&!("Z"in k)&&(k.Z=0),"p"in k&&(k.H=k.H%12+k.p*12),k.m===void 0&&(k.m="q"in k?k.q:0),"V"in k){if(k.V<1||k.V>53)return null;"w"in k||(k.w=1),"Z"in k?(I=Mm(cc(k.y,0,1)),H=I.getUTCDay(),I=H>4||H===0?G0.ceil(I):G0(I),I=xo.offset(I,(k.V-1)*7),k.y=I.getUTCFullYear(),k.m=I.getUTCMonth(),k.d=I.getUTCDate()+(k.w+6)%7):(I=$m(cc(k.y,0,1)),H=I.getDay(),I=H>4||H===0?W0.ceil(I):W0(I),I=As.offset(I,(k.V-1)*7),k.y=I.getFullYear(),k.m=I.getMonth(),k.d=I.getDate()+(k.w+6)%7)}else("W"in k||"U"in k)&&("w"in k||(k.w="u"in k?k.u%7:"W"in k?1:0),H="Z"in k?Mm(cc(k.y,0,1)).getUTCDay():$m(cc(k.y,0,1)).getDay(),k.m=0,k.d="W"in k?(k.w+6)%7+k.W*7-(H+5)%7:k.w+k.U*7-(H+6)%7);return"Z"in k?(k.H+=k.Z/100|0,k.M+=k.Z%100,Mm(k)):$m(k)}}function S(se,Ee,Te,k){for(var N=0,I=Ee.length,H=Te.length,U,q;N<I;){if(k>=H)return-1;if(U=Ee.charCodeAt(N++),U===37){if(U=Ee.charAt(N++),q=_[U in h8?Ee.charAt(N++):U],!q||(k=q(se,Te,k))<0)return-1}else if(U!=Te.charCodeAt(k++))return-1}return k}function $(se,Ee,Te){var k=l.exec(Ee.slice(Te));return k?(se.p=c.get(k[0].toLowerCase()),Te+k[0].length):-1}function F(se,Ee,Te){var k=h.exec(Ee.slice(Te));return k?(se.w=p.get(k[0].toLowerCase()),Te+k[0].length):-1}function T(se,Ee,Te){var k=f.exec(Ee.slice(Te));return k?(se.w=d.get(k[0].toLowerCase()),Te+k[0].length):-1}function P(se,Ee,Te){var k=y.exec(Ee.slice(Te));return k?(se.m=v.get(k[0].toLowerCase()),Te+k[0].length):-1}function R(se,Ee,Te){var k=g.exec(Ee.slice(Te));return k?(se.m=m.get(k[0].toLowerCase()),Te+k[0].length):-1}function C(se,Ee,Te){return S(se,t,Ee,Te)}function A(se,Ee,Te){return S(se,n,Ee,Te)}function M(se,Ee,Te){return S(se,i,Ee,Te)}function L(se){return o[se.getDay()]}function D(se){return s[se.getDay()]}function O(se){return u[se.getMonth()]}function j(se){return a[se.getMonth()]}function J(se){return r[+(se.getHours()>=12)]}function K(se){return 1+~~(se.getMonth()/3)}function fe(se){return o[se.getUTCDay()]}function we(se){return s[se.getUTCDay()]}function de(se){return u[se.getUTCMonth()]}function Pe(se){return a[se.getUTCMonth()]}function dt(se){return r[+(se.getUTCHours()>=12)]}function xt(se){return 1+~~(se.getUTCMonth()/3)}return{format:function(se){var Ee=E(se+="",b);return Ee.toString=function(){return se},Ee},parse:function(se){var Ee=w(se+="",!1);return Ee.toString=function(){return se},Ee},utcFormat:function(se){var Ee=E(se+="",x);return Ee.toString=function(){return se},Ee},utcParse:function(se){var Ee=w(se+="",!0);return Ee.toString=function(){return se},Ee}}}var h8={"-":"",_:" ",0:"0"},Vt=/^\s*\d+/,bV=/^%/,xV=/[\\^$*+?|[\]().{}]/g;function Ue(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(t)+r:r)}function _V(e){return e.replace(xV,"\\$&")}function fc(e){return new RegExp("^(?:"+e.map(_V).join("|")+")","i")}function dc(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function wV(e,t,n){var i=Vt.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function EV(e,t,n){var i=Vt.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function CV(e,t,n){var i=Vt.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function SV(e,t,n){var i=Vt.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function kV(e,t,n){var i=Vt.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function p8(e,t,n){var i=Vt.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function g8(e,t,n){var i=Vt.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function AV(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function $V(e,t,n){var i=Vt.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function MV(e,t,n){var i=Vt.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function m8(e,t,n){var i=Vt.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function TV(e,t,n){var i=Vt.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function y8(e,t,n){var i=Vt.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function FV(e,t,n){var i=Vt.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function LV(e,t,n){var i=Vt.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function NV(e,t,n){var i=Vt.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function DV(e,t,n){var i=Vt.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function RV(e,t,n){var i=bV.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function OV(e,t,n){var i=Vt.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function IV(e,t,n){var i=Vt.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function v8(e,t){return Ue(e.getDate(),t,2)}function PV(e,t){return Ue(e.getHours(),t,2)}function zV(e,t){return Ue(e.getHours()%12||12,t,2)}function BV(e,t){return Ue(1+As.count(Pr(e),e),t,3)}function Fk(e,t){return Ue(e.getMilliseconds(),t,3)}function UV(e,t){return Fk(e,t)+"000"}function jV(e,t){return Ue(e.getMonth()+1,t,2)}function HV(e,t){return Ue(e.getMinutes(),t,2)}function qV(e,t){return Ue(e.getSeconds(),t,2)}function VV(e){var t=e.getDay();return t===0?7:t}function WV(e,t){return Ue(Ol.count(Pr(e)-1,e),t,2)}function Lk(e){var t=e.getDay();return t>=4||t===0?ll(e):ll.ceil(e)}function GV(e,t){return e=Lk(e),Ue(ll.count(Pr(e),e)+(Pr(e).getDay()===4),t,2)}function YV(e){return e.getDay()}function ZV(e,t){return Ue(W0.count(Pr(e)-1,e),t,2)}function XV(e,t){return Ue(e.getFullYear()%100,t,2)}function KV(e,t){return e=Lk(e),Ue(e.getFullYear()%100,t,2)}function JV(e,t){return Ue(e.getFullYear()%1e4,t,4)}function QV(e,t){var n=e.getDay();return e=n>=4||n===0?ll(e):ll.ceil(e),Ue(e.getFullYear()%1e4,t,4)}function eW(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ue(t/60|0,"0",2)+Ue(t%60,"0",2)}function b8(e,t){return Ue(e.getUTCDate(),t,2)}function tW(e,t){return Ue(e.getUTCHours(),t,2)}function nW(e,t){return Ue(e.getUTCHours()%12||12,t,2)}function iW(e,t){return Ue(1+xo.count(zr(e),e),t,3)}function Nk(e,t){return Ue(e.getUTCMilliseconds(),t,3)}function rW(e,t){return Nk(e,t)+"000"}function sW(e,t){return Ue(e.getUTCMonth()+1,t,2)}function oW(e,t){return Ue(e.getUTCMinutes(),t,2)}function aW(e,t){return Ue(e.getUTCSeconds(),t,2)}function uW(e){var t=e.getUTCDay();return t===0?7:t}function lW(e,t){return Ue(Il.count(zr(e)-1,e),t,2)}function Dk(e){var t=e.getUTCDay();return t>=4||t===0?cl(e):cl.ceil(e)}function cW(e,t){return e=Dk(e),Ue(cl.count(zr(e),e)+(zr(e).getUTCDay()===4),t,2)}function fW(e){return e.getUTCDay()}function dW(e,t){return Ue(G0.count(zr(e)-1,e),t,2)}function hW(e,t){return Ue(e.getUTCFullYear()%100,t,2)}function pW(e,t){return e=Dk(e),Ue(e.getUTCFullYear()%100,t,2)}function gW(e,t){return Ue(e.getUTCFullYear()%1e4,t,4)}function mW(e,t){var n=e.getUTCDay();return e=n>=4||n===0?cl(e):cl.ceil(e),Ue(e.getUTCFullYear()%1e4,t,4)}function yW(){return"+0000"}function x8(){return"%"}function _8(e){return+e}function w8(e){return Math.floor(+e/1e3)}var $u,d5,Rk,h5,Ok;vW({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function vW(e){return $u=Tk(e),d5=$u.format,Rk=$u.parse,h5=$u.utcFormat,Ok=$u.utcParse,$u}function bW(e){return new Date(e)}function xW(e){return e instanceof Date?+e:+new Date(+e)}function p5(e,t,n,i,r,s,o,a,u,l){var c=vk(),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),g=l("%I:%M"),m=l("%I %p"),y=l("%a %d"),v=l("%b %d"),b=l("%B"),x=l("%Y");function _(E){return(u(E)<E?h:a(E)<E?p:o(E)<E?g:s(E)<E?m:i(E)<E?r(E)<E?y:v:n(E)<E?b:x)(E)}return c.invert=function(E){return new Date(f(E))},c.domain=function(E){return arguments.length?d(Array.from(E,xW)):d().map(bW)},c.ticks=function(E){var w=d();return e(w[0],w[w.length-1],E??10)},c.tickFormat=function(E,w){return w==null?_:l(w)},c.nice=function(E){var w=d();return(!E||typeof E.range!="function")&&(E=t(w[0],w[w.length-1],E??10)),E?d(wk(w,E)):c},c.copy=function(){return ad(c,p5(e,t,n,i,r,s,o,a,u,l))},c}function _W(){return Yr.apply(p5(yV,vV,Pr,Lf,Ol,As,pg,dg,ws,d5).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function wW(){return Yr.apply(p5(gV,mV,zr,Nf,Il,xo,gg,hg,ws,h5).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function mg(){var e=0,t=1,n,i,r,s,o=Gn,a=!1,u;function l(f){return f==null||isNaN(f=+f)?u:o(r===0?.5:(f=(s(f)-n)*r,a?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),i=s(t=+t),r=n===i?0:1/(i-n),l):[e,t]},l.clamp=function(f){return arguments.length?(a=!!f,l):a},l.interpolator=function(f){return arguments.length?(o=f,l):o};function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,o=f(h,p),l):[o(0),o(1)]}}return l.range=c(jo),l.rangeRound=c(nd),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return s=f,n=f(e),i=f(t),r=n===i?0:1/(i-n),l}}function qo(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function g5(){var e=cu(mg()(Gn));return e.copy=function(){return qo(e,g5())},Ho.apply(e,arguments)}function Ik(){var e=a5(mg()).domain([1,10]);return e.copy=function(){return qo(e,Ik()).base(e.base())},Ho.apply(e,arguments)}function Pk(){var e=u5(mg());return e.copy=function(){return qo(e,Pk()).constant(e.constant())},Ho.apply(e,arguments)}function m5(){var e=l5(mg());return e.copy=function(){return qo(e,m5()).exponent(e.exponent())},Ho.apply(e,arguments)}function EW(){return m5.apply(null,arguments).exponent(.5)}function yg(){var e=0,t=.5,n=1,i=1,r,s,o,a,u,l=Gn,c,f=!1,d;function h(g){return isNaN(g=+g)?d:(g=.5+((g=+c(g))-s)*(i*g<i*s?a:u),l(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,n]=g,r=c(e=+e),s=c(t=+t),o=c(n=+n),a=r===s?0:.5/(s-r),u=s===o?0:.5/(o-s),i=s<r?-1:1,h):[e,t,n]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(l=g,h):l};function p(g){return function(m){var y,v,b;return arguments.length?([y,v,b]=m,l=U3(g,[y,v,b]),h):[l(0),l(.5),l(1)]}}return h.range=p(jo),h.rangeRound=p(nd),h.unknown=function(g){return arguments.length?(d=g,h):d},function(g){return c=g,r=g(e),s=g(t),o=g(n),a=r===s?0:.5/(s-r),u=s===o?0:.5/(o-s),i=s<r?-1:1,h}}function zk(){var e=cu(yg()(Gn));return e.copy=function(){return qo(e,zk())},Ho.apply(e,arguments)}function Bk(){var e=a5(yg()).domain([.1,1,10]);return e.copy=function(){return qo(e,Bk()).base(e.base())},Ho.apply(e,arguments)}function Uk(){var e=u5(yg());return e.copy=function(){return qo(e,Uk()).constant(e.constant())},Ho.apply(e,arguments)}function y5(){var e=l5(yg());return e.copy=function(){return qo(e,y5()).exponent(e.exponent())},Ho.apply(e,arguments)}function CW(){return y5.apply(null,arguments).exponent(.5)}function Zr(e){for(var t=e.length/6|0,n=new Array(t),i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}const SW=Zr("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),kW=Zr("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),AW=Zr("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),$W=Zr("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),MW=Zr("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),TW=Zr("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),FW=Zr("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),LW=Zr("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),NW=Zr("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),DW=Zr("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");function Ve(e){return function(){return e}}const E8=Math.abs,nn=Math.atan2,sa=Math.cos,RW=Math.max,Tm=Math.min,mr=Math.sin,wa=Math.sqrt,rn=1e-12,fl=Math.PI,Y0=fl/2,jk=2*fl;function OW(e){return e>1?0:e<-1?fl:Math.acos(e)}function C8(e){return e>=1?Y0:e<=-1?-Y0:Math.asin(e)}function vg(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);t=i}return e},()=>new V3(t)}function IW(e){return e.innerRadius}function PW(e){return e.outerRadius}function zW(e){return e.startAngle}function BW(e){return e.endAngle}function UW(e){return e&&e.padAngle}function jW(e,t,n,i,r,s,o,a){var u=n-e,l=i-t,c=o-r,f=a-s,d=f*u-c*l;if(!(d*d<rn))return d=(c*(t-s)-f*(e-r))/d,[e+d*u,t+d*l]}function ah(e,t,n,i,r,s,o){var a=e-n,u=t-i,l=(o?s:-s)/wa(a*a+u*u),c=l*u,f=-l*a,d=e+c,h=t+f,p=n+c,g=i+f,m=(d+p)/2,y=(h+g)/2,v=p-d,b=g-h,x=v*v+b*b,_=r-s,E=d*g-p*h,w=(b<0?-1:1)*wa(RW(0,_*_*x-E*E)),S=(E*b-v*w)/x,$=(-E*v-b*w)/x,F=(E*b+v*w)/x,T=(-E*v+b*w)/x,P=S-m,R=$-y,C=F-m,A=T-y;return P*P+R*R>C*C+A*A&&(S=F,$=T),{cx:S,cy:$,x01:-c,y01:-f,x11:S*(r/_-1),y11:$*(r/_-1)}}function HW(){var e=IW,t=PW,n=Ve(0),i=null,r=zW,s=BW,o=UW,a=null,u=vg(l);function l(){var c,f,d=+e.apply(this,arguments),h=+t.apply(this,arguments),p=r.apply(this,arguments)-Y0,g=s.apply(this,arguments)-Y0,m=E8(g-p),y=g>p;if(a||(a=c=u()),h<d&&(f=h,h=d,d=f),!(h>rn))a.moveTo(0,0);else if(m>jk-rn)a.moveTo(h*sa(p),h*mr(p)),a.arc(0,0,h,p,g,!y),d>rn&&(a.moveTo(d*sa(g),d*mr(g)),a.arc(0,0,d,g,p,y));else{var v=p,b=g,x=p,_=g,E=m,w=m,S=o.apply(this,arguments)/2,$=S>rn&&(i?+i.apply(this,arguments):wa(d*d+h*h)),F=Tm(E8(h-d)/2,+n.apply(this,arguments)),T=F,P=F,R,C;if($>rn){var A=C8($/d*mr(S)),M=C8($/h*mr(S));(E-=A*2)>rn?(A*=y?1:-1,x+=A,_-=A):(E=0,x=_=(p+g)/2),(w-=M*2)>rn?(M*=y?1:-1,v+=M,b-=M):(w=0,v=b=(p+g)/2)}var L=h*sa(v),D=h*mr(v),O=d*sa(_),j=d*mr(_);if(F>rn){var J=h*sa(b),K=h*mr(b),fe=d*sa(x),we=d*mr(x),de;if(m<fl)if(de=jW(L,D,fe,we,J,K,O,j)){var Pe=L-de[0],dt=D-de[1],xt=J-de[0],se=K-de[1],Ee=1/mr(OW((Pe*xt+dt*se)/(wa(Pe*Pe+dt*dt)*wa(xt*xt+se*se)))/2),Te=wa(de[0]*de[0]+de[1]*de[1]);T=Tm(F,(d-Te)/(Ee-1)),P=Tm(F,(h-Te)/(Ee+1))}else T=P=0}w>rn?P>rn?(R=ah(fe,we,L,D,h,P,y),C=ah(J,K,O,j,h,P,y),a.moveTo(R.cx+R.x01,R.cy+R.y01),P<F?a.arc(R.cx,R.cy,P,nn(R.y01,R.x01),nn(C.y01,C.x01),!y):(a.arc(R.cx,R.cy,P,nn(R.y01,R.x01),nn(R.y11,R.x11),!y),a.arc(0,0,h,nn(R.cy+R.y11,R.cx+R.x11),nn(C.cy+C.y11,C.cx+C.x11),!y),a.arc(C.cx,C.cy,P,nn(C.y11,C.x11),nn(C.y01,C.x01),!y))):(a.moveTo(L,D),a.arc(0,0,h,v,b,!y)):a.moveTo(L,D),!(d>rn)||!(E>rn)?a.lineTo(O,j):T>rn?(R=ah(O,j,J,K,d,-T,y),C=ah(L,D,fe,we,d,-T,y),a.lineTo(R.cx+R.x01,R.cy+R.y01),T<F?a.arc(R.cx,R.cy,T,nn(R.y01,R.x01),nn(C.y01,C.x01),!y):(a.arc(R.cx,R.cy,T,nn(R.y01,R.x01),nn(R.y11,R.x11),!y),a.arc(0,0,d,nn(R.cy+R.y11,R.cx+R.x11),nn(C.cy+C.y11,C.cx+C.x11),y),a.arc(C.cx,C.cy,T,nn(C.y11,C.x11),nn(C.y01,C.x01),!y))):a.arc(0,0,d,_,x,y)}if(a.closePath(),c)return a=null,c+""||null}return l.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,f=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-fl/2;return[sa(f)*c,mr(f)*c]},l.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:Ve(+c),l):e},l.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:Ve(+c),l):t},l.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:Ve(+c),l):n},l.padRadius=function(c){return arguments.length?(i=c==null?null:typeof c=="function"?c:Ve(+c),l):i},l.startAngle=function(c){return arguments.length?(r=typeof c=="function"?c:Ve(+c),l):r},l.endAngle=function(c){return arguments.length?(s=typeof c=="function"?c:Ve(+c),l):s},l.padAngle=function(c){return arguments.length?(o=typeof c=="function"?c:Ve(+c),l):o},l.context=function(c){return arguments.length?(a=c??null,l):a},l}function Hk(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function qk(e){this._context=e}qk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function v5(e){return new qk(e)}function Vk(e){return e[0]}function Wk(e){return e[1]}function Gk(e,t){var n=Ve(!0),i=null,r=v5,s=null,o=vg(a);e=typeof e=="function"?e:e===void 0?Vk:Ve(e),t=typeof t=="function"?t:t===void 0?Wk:Ve(t);function a(u){var l,c=(u=Hk(u)).length,f,d=!1,h;for(i==null&&(s=r(h=o())),l=0;l<=c;++l)!(l<c&&n(f=u[l],l,u))===d&&((d=!d)?s.lineStart():s.lineEnd()),d&&s.point(+e(f,l,u),+t(f,l,u));if(h)return s=null,h+""||null}return a.x=function(u){return arguments.length?(e=typeof u=="function"?u:Ve(+u),a):e},a.y=function(u){return arguments.length?(t=typeof u=="function"?u:Ve(+u),a):t},a.defined=function(u){return arguments.length?(n=typeof u=="function"?u:Ve(!!u),a):n},a.curve=function(u){return arguments.length?(r=u,i!=null&&(s=r(i)),a):r},a.context=function(u){return arguments.length?(u==null?i=s=null:s=r(i=u),a):i},a}function Yk(e,t,n){var i=null,r=Ve(!0),s=null,o=v5,a=null,u=vg(l);e=typeof e=="function"?e:e===void 0?Vk:Ve(+e),t=typeof t=="function"?t:Ve(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?Wk:Ve(+n);function l(f){var d,h,p,g=(f=Hk(f)).length,m,y=!1,v,b=new Array(g),x=new Array(g);for(s==null&&(a=o(v=u())),d=0;d<=g;++d){if(!(d<g&&r(m=f[d],d,f))===y)if(y=!y)h=d,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),p=d-1;p>=h;--p)a.point(b[p],x[p]);a.lineEnd(),a.areaEnd()}y&&(b[d]=+e(m,d,f),x[d]=+t(m,d,f),a.point(i?+i(m,d,f):b[d],n?+n(m,d,f):x[d]))}if(v)return a=null,v+""||null}function c(){return Gk().defined(r).curve(o).context(s)}return l.x=function(f){return arguments.length?(e=typeof f=="function"?f:Ve(+f),i=null,l):e},l.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Ve(+f),l):e},l.x1=function(f){return arguments.length?(i=f==null?null:typeof f=="function"?f:Ve(+f),l):i},l.y=function(f){return arguments.length?(t=typeof f=="function"?f:Ve(+f),n=null,l):t},l.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Ve(+f),l):t},l.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Ve(+f),l):n},l.lineX0=l.lineY0=function(){return c().x(e).y(t)},l.lineY1=function(){return c().x(e).y(n)},l.lineX1=function(){return c().x(i).y(t)},l.defined=function(f){return arguments.length?(r=typeof f=="function"?f:Ve(!!f),l):r},l.curve=function(f){return arguments.length?(o=f,s!=null&&(a=o(s)),l):o},l.context=function(f){return arguments.length?(f==null?s=a=null:a=o(s=f),l):s},l}const qW={draw(e,t){const n=wa(t/fl);e.moveTo(n,0),e.arc(0,0,n,0,jk)}};function VW(e,t){let n=null,i=vg(r);e=typeof e=="function"?e:Ve(e||qW),t=typeof t=="function"?t:Ve(t===void 0?64:+t);function r(){let s;if(n||(n=s=i()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),s)return n=null,s+""||null}return r.type=function(s){return arguments.length?(e=typeof s=="function"?s:Ve(s),r):e},r.size=function(s){return arguments.length?(t=typeof s=="function"?s:Ve(+s),r):t},r.context=function(s){return arguments.length?(n=s??null,r):n},r}function $o(){}function Z0(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function bg(e){this._context=e}bg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Z0(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Z0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function WW(e){return new bg(e)}function Zk(e){this._context=e}Zk.prototype={areaStart:$o,areaEnd:$o,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Z0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function GW(e){return new Zk(e)}function Xk(e){this._context=e}Xk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:Z0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function YW(e){return new Xk(e)}function Kk(e,t){this._basis=new bg(e),this._beta=t}Kk.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var i=e[0],r=t[0],s=e[n]-i,o=t[n]-r,a=-1,u;++a<=n;)u=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(i+u*s),this._beta*t[a]+(1-this._beta)*(r+u*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const ZW=function e(t){function n(i){return t===1?new bg(i):new Kk(i,t)}return n.beta=function(i){return e(+i)},n}(.85);function X0(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function b5(e,t){this._context=e,this._k=(1-t)/6}b5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:X0(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:X0(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const XW=function e(t){function n(i){return new b5(i,t)}return n.tension=function(i){return e(+i)},n}(0);function x5(e,t){this._context=e,this._k=(1-t)/6}x5.prototype={areaStart:$o,areaEnd:$o,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:X0(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const KW=function e(t){function n(i){return new x5(i,t)}return n.tension=function(i){return e(+i)},n}(0);function _5(e,t){this._context=e,this._k=(1-t)/6}_5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:X0(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const JW=function e(t){function n(i){return new _5(i,t)}return n.tension=function(i){return e(+i)},n}(0);function w5(e,t,n){var i=e._x1,r=e._y1,s=e._x2,o=e._y2;if(e._l01_a>rn){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,r=(r*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>rn){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*l+e._x1*e._l23_2a-t*e._l12_2a)/c,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(i,r,s,o,e._x2,e._y2)}function Jk(e,t){this._context=e,this._alpha=t}Jk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:w5(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const QW=function e(t){function n(i){return t?new Jk(i,t):new b5(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function Qk(e,t){this._context=e,this._alpha=t}Qk.prototype={areaStart:$o,areaEnd:$o,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:w5(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const eG=function e(t){function n(i){return t?new Qk(i,t):new x5(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function eA(e,t){this._context=e,this._alpha=t}eA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:w5(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const tG=function e(t){function n(i){return t?new eA(i,t):new _5(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function tA(e){this._context=e}tA.prototype={areaStart:$o,areaEnd:$o,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function nG(e){return new tA(e)}function S8(e){return e<0?-1:1}function k8(e,t,n){var i=e._x1-e._x0,r=t-e._x1,s=(e._y1-e._y0)/(i||r<0&&-0),o=(n-e._y1)/(r||i<0&&-0),a=(s*r+o*i)/(i+r);return(S8(s)+S8(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function A8(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Fm(e,t,n){var i=e._x0,r=e._y0,s=e._x1,o=e._y1,a=(s-i)/3;e._context.bezierCurveTo(i+a,r+a*t,s-a,o-a*n,s,o)}function K0(e){this._context=e}K0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Fm(this,this._t0,A8(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Fm(this,A8(this,n=k8(this,e,t)),n);break;default:Fm(this,this._t0,n=k8(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function nA(e){this._context=new iA(e)}(nA.prototype=Object.create(K0.prototype)).point=function(e,t){K0.prototype.point.call(this,t,e)};function iA(e){this._context=e}iA.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,s){this._context.bezierCurveTo(t,e,i,n,s,r)}};function iG(e){return new K0(e)}function rG(e){return new nA(e)}function rA(e){this._context=e}rA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=$8(e),r=$8(t),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(i[0][s],r[0][s],i[1][s],r[1][s],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function $8(e){var t,n=e.length-1,i,r=new Array(n),s=new Array(n),o=new Array(n);for(r[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,s[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=r[t]/s[t-1],s[t]-=i,o[t]-=i*o[t-1];for(r[n-1]=o[n-1]/s[n-1],t=n-2;t>=0;--t)r[t]=(o[t]-r[t+1])/s[t];for(s[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-r[t+1];return[r,s]}function sG(e){return new rA(e)}function xg(e,t){this._context=e,this._t=t}xg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function oG(e){return new xg(e,.5)}function aG(e){return new xg(e,0)}function uG(e){return new xg(e,1)}const uh=e=>()=>e;function lG(e,{sourceEvent:t,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function Vi(e,t,n){this.k=e,this.x=t,this.y=n}Vi.prototype={constructor:Vi,scale:function(e){return e===1?this:new Vi(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Vi(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var _g=new Vi(1,0,0);V2.prototype=Vi.prototype;function V2(e){for(;!e.__zoom;)if(!(e=e.parentNode))return _g;return e.__zoom}function Lm(e){e.stopImmediatePropagation()}function hc(e){e.preventDefault(),e.stopImmediatePropagation()}function cG(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function fG(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function M8(){return this.__zoom||_g}function dG(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function hG(){return navigator.maxTouchPoints||"ontouchstart"in this}function pG(e,t,n){var i=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function T8(){var e=cG,t=fG,n=pG,i=dG,r=hG,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,u=sS,l=Jp("start","zoom","end"),c,f,d,h=500,p=150,g=0,m=10;function y(C){C.property("__zoom",M8).on("wheel.zoom",S,{passive:!1}).on("mousedown.zoom",$).on("dblclick.zoom",F).filter(r).on("touchstart.zoom",T).on("touchmove.zoom",P).on("touchend.zoom touchcancel.zoom",R).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(C,A,M,L){var D=C.selection?C.selection():C;D.property("__zoom",M8),C!==D?_(C,A,M,L):D.interrupt().each(function(){E(this,arguments).event(L).start().zoom(null,typeof A=="function"?A.apply(this,arguments):A).end()})},y.scaleBy=function(C,A,M,L){y.scaleTo(C,function(){var D=this.__zoom.k,O=typeof A=="function"?A.apply(this,arguments):A;return D*O},M,L)},y.scaleTo=function(C,A,M,L){y.transform(C,function(){var D=t.apply(this,arguments),O=this.__zoom,j=M==null?x(D):typeof M=="function"?M.apply(this,arguments):M,J=O.invert(j),K=typeof A=="function"?A.apply(this,arguments):A;return n(b(v(O,K),j,J),D,o)},M,L)},y.translateBy=function(C,A,M,L){y.transform(C,function(){return n(this.__zoom.translate(typeof A=="function"?A.apply(this,arguments):A,typeof M=="function"?M.apply(this,arguments):M),t.apply(this,arguments),o)},null,L)},y.translateTo=function(C,A,M,L,D){y.transform(C,function(){var O=t.apply(this,arguments),j=this.__zoom,J=L==null?x(O):typeof L=="function"?L.apply(this,arguments):L;return n(_g.translate(J[0],J[1]).scale(j.k).translate(typeof A=="function"?-A.apply(this,arguments):-A,typeof M=="function"?-M.apply(this,arguments):-M),O,o)},L,D)};function v(C,A){return A=Math.max(s[0],Math.min(s[1],A)),A===C.k?C:new Vi(A,C.x,C.y)}function b(C,A,M){var L=A[0]-M[0]*C.k,D=A[1]-M[1]*C.k;return L===C.x&&D===C.y?C:new Vi(C.k,L,D)}function x(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function _(C,A,M,L){C.on("start.zoom",function(){E(this,arguments).event(L).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(L).end()}).tween("zoom",function(){var D=this,O=arguments,j=E(D,O).event(L),J=t.apply(D,O),K=M==null?x(J):typeof M=="function"?M.apply(D,O):M,fe=Math.max(J[1][0]-J[0][0],J[1][1]-J[0][1]),we=D.__zoom,de=typeof A=="function"?A.apply(D,O):A,Pe=u(we.invert(K).concat(fe/we.k),de.invert(K).concat(fe/de.k));return function(dt){if(dt===1)dt=de;else{var xt=Pe(dt),se=fe/xt[2];dt=new Vi(se,K[0]-xt[0]*se,K[1]-xt[1]*se)}j.zoom(null,dt)}})}function E(C,A,M){return!M&&C.__zooming||new w(C,A)}function w(C,A){this.that=C,this.args=A,this.active=0,this.sourceEvent=null,this.extent=t.apply(C,A),this.taps=0}w.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,A){return this.mouse&&C!=="mouse"&&(this.mouse[1]=A.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=A.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=A.invert(this.touch1[0])),this.that.__zoom=A,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var A=Ui(this.that).datum();l.call(C,this.that,new lG(C,{sourceEvent:this.sourceEvent,target:y,transform:this.that.__zoom,dispatch:l}),A)}};function S(C,...A){if(!e.apply(this,arguments))return;var M=E(this,A).event(C),L=this.__zoom,D=Math.max(s[0],Math.min(s[1],L.k*Math.pow(2,i.apply(this,arguments)))),O=ra(C);if(M.wheel)(M.mouse[0][0]!==O[0]||M.mouse[0][1]!==O[1])&&(M.mouse[1]=L.invert(M.mouse[0]=O)),clearTimeout(M.wheel);else{if(L.k===D)return;M.mouse=[O,L.invert(O)],Ih(this),M.start()}hc(C),M.wheel=setTimeout(j,p),M.zoom("mouse",n(b(v(L,D),M.mouse[0],M.mouse[1]),M.extent,o));function j(){M.wheel=null,M.end()}}function $(C,...A){if(d||!e.apply(this,arguments))return;var M=C.currentTarget,L=E(this,A,!0).event(C),D=Ui(C.view).on("mousemove.zoom",K,!0).on("mouseup.zoom",fe,!0),O=ra(C,M),j=C.clientX,J=C.clientY;Nz(C.view),Lm(C),L.mouse=[O,this.__zoom.invert(O)],Ih(this),L.start();function K(we){if(hc(we),!L.moved){var de=we.clientX-j,Pe=we.clientY-J;L.moved=de*de+Pe*Pe>g}L.event(we).zoom("mouse",n(b(L.that.__zoom,L.mouse[0]=ra(we,M),L.mouse[1]),L.extent,o))}function fe(we){D.on("mousemove.zoom mouseup.zoom",null),Dz(we.view,L.moved),hc(we),L.event(we).end()}}function F(C,...A){if(e.apply(this,arguments)){var M=this.__zoom,L=ra(C.changedTouches?C.changedTouches[0]:C,this),D=M.invert(L),O=M.k*(C.shiftKey?.5:2),j=n(b(v(M,O),L,D),t.apply(this,A),o);hc(C),a>0?Ui(this).transition().duration(a).call(_,j,L,C):Ui(this).call(y.transform,j,L,C)}}function T(C,...A){if(e.apply(this,arguments)){var M=C.touches,L=M.length,D=E(this,A,C.changedTouches.length===L).event(C),O,j,J,K;for(Lm(C),j=0;j<L;++j)J=M[j],K=ra(J,this),K=[K,this.__zoom.invert(K),J.identifier],D.touch0?!D.touch1&&D.touch0[2]!==K[2]&&(D.touch1=K,D.taps=0):(D.touch0=K,O=!0,D.taps=1+!!c);c&&(c=clearTimeout(c)),O&&(D.taps<2&&(f=K[0],c=setTimeout(function(){c=null},h)),Ih(this),D.start())}}function P(C,...A){if(this.__zooming){var M=E(this,A).event(C),L=C.changedTouches,D=L.length,O,j,J,K;for(hc(C),O=0;O<D;++O)j=L[O],J=ra(j,this),M.touch0&&M.touch0[2]===j.identifier?M.touch0[0]=J:M.touch1&&M.touch1[2]===j.identifier&&(M.touch1[0]=J);if(j=M.that.__zoom,M.touch1){var fe=M.touch0[0],we=M.touch0[1],de=M.touch1[0],Pe=M.touch1[1],dt=(dt=de[0]-fe[0])*dt+(dt=de[1]-fe[1])*dt,xt=(xt=Pe[0]-we[0])*xt+(xt=Pe[1]-we[1])*xt;j=v(j,Math.sqrt(dt/xt)),J=[(fe[0]+de[0])/2,(fe[1]+de[1])/2],K=[(we[0]+Pe[0])/2,(we[1]+Pe[1])/2]}else if(M.touch0)J=M.touch0[0],K=M.touch0[1];else return;M.zoom("touch",n(b(j,J,K),M.extent,o))}}function R(C,...A){if(this.__zooming){var M=E(this,A).event(C),L=C.changedTouches,D=L.length,O,j;for(Lm(C),d&&clearTimeout(d),d=setTimeout(function(){d=null},h),O=0;O<D;++O)j=L[O],M.touch0&&M.touch0[2]===j.identifier?delete M.touch0:M.touch1&&M.touch1[2]===j.identifier&&delete M.touch1;if(M.touch1&&!M.touch0&&(M.touch0=M.touch1,delete M.touch1),M.touch0)M.touch0[1]=this.__zoom.invert(M.touch0[0]);else if(M.end(),M.taps===2&&(j=ra(j,this),Math.hypot(f[0]-j[0],f[1]-j[1])<m)){var J=Ui(this).on("dblclick.zoom");J&&J.apply(this,arguments)}}}return y.wheelDelta=function(C){return arguments.length?(i=typeof C=="function"?C:uh(+C),y):i},y.filter=function(C){return arguments.length?(e=typeof C=="function"?C:uh(!!C),y):e},y.touchable=function(C){return arguments.length?(r=typeof C=="function"?C:uh(!!C),y):r},y.extent=function(C){return arguments.length?(t=typeof C=="function"?C:uh([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),y):t},y.scaleExtent=function(C){return arguments.length?(s[0]=+C[0],s[1]=+C[1],y):[s[0],s[1]]},y.translateExtent=function(C){return arguments.length?(o[0][0]=+C[0][0],o[1][0]=+C[1][0],o[0][1]=+C[0][1],o[1][1]=+C[1][1],y):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},y.constrain=function(C){return arguments.length?(n=C,y):n},y.duration=function(C){return arguments.length?(a=+C,y):a},y.interpolate=function(C){return arguments.length?(u=C,y):u},y.on=function(){var C=l.on.apply(l,arguments);return C===l?y:C},y.clickDistance=function(C){return arguments.length?(g=(C=+C)*C,y):Math.sqrt(g)},y.tapDistance=function(C){return arguments.length?(m=+C,y):m},y}const sA=(e,t)=>{const n=e.__vccOpts||e;for(const[i,r]of t)n[i]=r;return n},gG=""+new Gl("compass-DkjToY5z.svg",import.meta.url).href,mG=""+new Gl("../Changan.png",import.meta.url).href;function yi(e,t,n){return e.fields=t||[],e.fname=n,e}function kt(e){return e==null?null:e.fname}function Fn(e){return e==null?null:e.fields}function oA(e){return e.length===1?yG(e[0]):vG(e)}const yG=e=>function(t){return t[e]},vG=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function te(e){throw Error(e)}function Vo(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||te("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&te("Access path missing closing bracket: "+e),i&&te("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function Ji(e,t,n){const i=Vo(e);return e=i.length===1?i[0]:e,yi((n&&n.get||oA)(i),[e],t||e)}const wg=Ji("id"),In=yi(e=>e,[],"identity"),ga=yi(()=>0,[],"zero"),ud=yi(()=>1,[],"one"),Qi=yi(()=>!0,[],"true"),oa=yi(()=>!1,[],"false");function bG(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const xG=0,aA=1,uA=2,_G=3,wG=4;function lA(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:bG,i=e||xG;return{level(r){return arguments.length?(i=+r,this):i},error(){return i>=aA&&n("error","ERROR",arguments),this},warn(){return i>=uA&&n("warn","WARN",arguments),this},info(){return i>=_G&&n("log","INFO",arguments),this},debug(){return i>=wG&&n("log","DEBUG",arguments),this}}}var V=Array.isArray;function _e(e){return e===Object(e)}const F8=e=>e!=="__proto__";function cA(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((i,r)=>{for(const s in r)if(s==="signals")i.signals=EG(i.signals,r.signals);else{const o=s==="legend"?{layout:1}:s==="style"?!0:null;Eg(i,s,r[s],o)}return i},{})}function Eg(e,t,n,i){if(!F8(t))return;let r,s;if(_e(n)&&!V(n)){s=_e(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?Eg(s,r,n[r]):F8(r)&&(s[r]=n[r])}else e[t]=n}function EG(e,t){if(e==null)return t;const n={},i=[];function r(s){n[s.name]||(n[s.name]=1,i.push(s))}return t.forEach(r),e.forEach(r),i}function Xe(e){return e[e.length-1]}function $n(e){return e==null||e===""?null:+e}const fA=e=>t=>e*Math.exp(t),dA=e=>t=>Math.log(e*t),hA=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),pA=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,J0=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function Cg(e,t,n,i){const r=n(e[0]),s=n(Xe(e)),o=(s-r)*t;return[i(r-o),i(s-o)]}function CG(e,t){return Cg(e,t,$n,In)}function SG(e,t){var n=Math.sign(e[0]);return Cg(e,t,dA(n),fA(n))}function kG(e,t,n){return Cg(e,t,J0(n),J0(1/n))}function AG(e,t,n){return Cg(e,t,hA(n),pA(n))}function Sg(e,t,n,i,r){const s=i(e[0]),o=i(Xe(e)),a=t!=null?i(t):(s+o)/2;return[r(a+(s-a)*n),r(a+(o-a)*n)]}function gA(e,t,n){return Sg(e,t,n,$n,In)}function mA(e,t,n){const i=Math.sign(e[0]);return Sg(e,t,n,dA(i),fA(i))}function W2(e,t,n,i){return Sg(e,t,n,J0(i),J0(1/i))}function yA(e,t,n,i){return Sg(e,t,n,hA(i),pA(i))}function $G(e){return 1+~~(new Date(e).getMonth()/3)}function MG(e){return 1+~~(new Date(e).getUTCMonth()/3)}function ce(e){return e!=null?V(e)?e:[e]:[]}function TG(e,t,n){let i=e[0],r=e[1],s;return r<i&&(s=r,r=i,i=s),s=r-i,s>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-s),i+s]}function Me(e){return typeof e=="function"}const FG="descending";function vA(e,t,n){n=n||{},t=ce(t)||[];const i=[],r=[],s={},o=n.comparator||LG;return ce(e).forEach((a,u)=>{a!=null&&(i.push(t[u]===FG?-1:1),r.push(a=Me(a)?a:Ji(a,null,n)),(Fn(a)||[]).forEach(l=>s[l]=1))}),r.length===0?null:yi(o(r,i),Object.keys(s))}const kg=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),LG=(e,t)=>e.length===1?NG(e[0],t[0]):DG(e,t,e.length),NG=(e,t)=>function(n,i){return kg(e(n),e(i))*t},DG=(e,t,n)=>(t.push(0),function(i,r){let s,o=0,a=-1;for(;o===0&&++a<n;)s=e[a],o=kg(s(i),s(r));return o*t[a]});function Pn(e){return Me(e)?e:()=>e}function bA(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}}function Ht(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function Os(e,t){let n=0,i,r,s,o;if(e&&(i=e.length))if(t==null){for(r=e[n];n<i&&(r==null||r!==r);r=e[++n]);for(s=o=r;n<i;++n)r=e[n],r!=null&&(r<s&&(s=r),r>o&&(o=r))}else{for(r=t(e[n]);n<i&&(r==null||r!==r);r=t(e[++n]));for(s=o=r;n<i;++n)r=t(e[n]),r!=null&&(r<s&&(s=r),r>o&&(o=r))}return[s,o]}function RG(e,t){const n=e.length;let i=-1,r,s,o,a,u;if(t==null){for(;++i<n;)if(s=e[i],s!=null&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=u=i;++i<n;)s=e[i],s!=null&&(r>s&&(r=s,a=i),o<s&&(o=s,u=i))}else{for(;++i<n;)if(s=t(e[i],i,e),s!=null&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=u=i;++i<n;)s=t(e[i],i,e),s!=null&&(r>s&&(r=s,a=i),o<s&&(o=s,u=i))}return[a,u]}function pe(e,t){return Object.hasOwn(e,t)}const lh={};function ld(e){let t={},n;function i(s){return pe(t,s)&&t[s]!==lh}const r={size:0,empty:0,object:t,has:i,get(s){return i(s)?t[s]:void 0},set(s,o){return i(s)||(++r.size,t[s]===lh&&--r.empty),t[s]=o,this},delete(s){return i(s)&&(--r.size,++r.empty,t[s]=lh),this},clear(){r.size=r.empty=0,r.object=t={}},test(s){return arguments.length?(n=s,r):n},clean(){const s={};let o=0;for(const a in t){const u=t[a];u!==lh&&(!n||!n(u))&&(s[a]=u,++o)}r.size=o,r.empty=0,r.object=t=s}};return e&&Object.keys(e).forEach(s=>{r.set(s,e[s])}),r}function OG(e,t,n,i,r,s){if(!n&&n!==0)return s;const o=+n;let a=e[0],u=Xe(e),l;u<a&&(l=a,a=u,u=l),l=Math.abs(t-a);const c=Math.abs(u-t);return l<c&&l<=o?i:c<=o?r:s}function Q(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Ht(i,n)}function Nc(e,t,n,i){let r=t[0],s=t[t.length-1],o;return r>s&&(o=r,r=s,s=o),n=n===void 0||n,i=i===void 0||i,(n?r<=e:r<e)&&(i?e<=s:e<s)}function Pl(e){return typeof e=="boolean"}function Fa(e){return Object.prototype.toString.call(e)==="[object Date]"}function IG(e){return e&&Me(e[Symbol.iterator])}function Ke(e){return typeof e=="number"}function xA(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function le(e){return typeof e=="string"}function _A(e,t,n){e&&(e=t?ce(e).map(a=>a.replace(/\\(.)/g,"$1")):ce(e));const i=e&&e.length,r=n&&n.get||oA,s=a=>r(t?[a]:Vo(a));let o;if(!i)o=function(){return""};else if(i===1){const a=s(e[0]);o=function(u){return""+a(u)}}else{const a=e.map(s);o=function(u){let l=""+a[0](u),c=0;for(;++c<i;)l+="|"+a[c](u);return l}}return yi(o,e,"key")}function PG(e,t){const n=e[0],i=Xe(e),r=+t;return r?r===1?i:n+r*(i-n):n}const zG=1e4;function BG(e){e=+e||zG;let t,n,i;const r=()=>{t={},n={},i=0},s=(o,a)=>(++i>e&&(n=t,t={},i=1),t[o]=a);return r(),{clear:r,has:o=>pe(t,o)||pe(n,o),get:o=>pe(t,o)?t[o]:pe(n,o)?s(o,n[o]):void 0,set:(o,a)=>pe(t,o)?t[o]=a:s(o,a)}}function UG(e,t,n,i){const r=t.length,s=n.length;if(!s)return t;if(!r)return n;const o=i||new t.constructor(r+s);let a=0,u=0,l=0;for(;a<r&&u<s;++l)o[l]=e(t[a],n[u])>0?n[u++]:t[a++];for(;a<r;++a,++l)o[l]=t[a];for(;u<s;++u,++l)o[l]=n[u];return o}function ch(e,t){let n="";for(;--t>=0;)n+=e;return n}function jG(e,t,n,i){const r=n||" ",s=e+"",o=t-s.length;return o<=0?s:i==="left"?ch(r,o)+s:i==="center"?ch(r,~~(o/2))+s+ch(r,Math.ceil(o/2)):s+ch(r,o)}function Ag(e){return e&&Xe(e)-e[0]||0}function xe(e){return V(e)?"["+e.map(xe)+"]":_e(e)||le(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function wA(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const HG=e=>Ke(e)||Fa(e)?e:Date.parse(e);function EA(e,t){return t=t||HG,e==null||e===""?null:t(e)}function CA(e){return e==null||e===""?null:e+""}function Br(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function qG(e,t,n,i){const r=i??"…",s=e+"",o=s.length,a=Math.max(0,t-r.length);return o<=t?s:n==="left"?r+s.slice(o-a):n==="center"?s.slice(0,Math.ceil(a/2))+r+s.slice(o-~~(a/2)):s.slice(0,a)+r}function fa(e,t,n){if(e)if(t){const i=e.length;for(let r=0;r<i;++r){const s=t(e[r]);s&&n(s,r,e)}}else e.forEach(n)}function VG(e){return e}function WG(e){if(e==null)return VG;var t,n,i=e.scale[0],r=e.scale[1],s=e.translate[0],o=e.translate[1];return function(a,u){u||(t=n=0);var l=2,c=a.length,f=new Array(c);for(f[0]=(t+=a[0])*i+s,f[1]=(n+=a[1])*r+o;l<c;)f[l]=a[l],++l;return f}}function GG(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}function YG(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return L8(e,n)})}:L8(e,t)}function L8(e,t){var n=t.id,i=t.bbox,r=t.properties==null?{}:t.properties,s=SA(e,t);return n==null&&i==null?{type:"Feature",properties:r,geometry:s}:i==null?{type:"Feature",id:n,properties:r,geometry:s}:{type:"Feature",id:n,bbox:i,properties:r,geometry:s}}function SA(e,t){var n=WG(e.transform),i=e.arcs;function r(c,f){f.length&&f.pop();for(var d=i[c<0?~c:c],h=0,p=d.length;h<p;++h)f.push(n(d[h],h));c<0&&GG(f,p)}function s(c){return n(c)}function o(c){for(var f=[],d=0,h=c.length;d<h;++d)r(c[d],f);return f.length<2&&f.push(f[0]),f}function a(c){for(var f=o(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(a)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=s(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(s);break;case"LineString":d=o(c.arcs);break;case"MultiLineString":d=c.arcs.map(o);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function ZG(e,t){var n={},i={},r={},s=[],o=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++o],t[o]=l,t[c]=d)}),t.forEach(function(l){var c=a(l),f=c[0],d=c[1],h,p;if(h=r[f])if(delete r[h.end],h.push(l),h.end=d,p=i[d]){delete i[p.start];var g=p===h?h:h.concat(p);i[g.start=h.start]=r[g.end=p.end]=g}else i[h.start]=r[h.end]=h;else if(h=i[d])if(delete i[h.start],h.unshift(l),h.start=f,p=r[f]){delete r[p.end];var m=p===h?h:p.concat(h);i[m.start=p.start]=r[m.end=h.end]=m}else i[h.start]=r[h.end]=h;else h=[l],i[h.start=f]=r[h.end=d]=h});function a(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),s.push(d)}}return u(r,i),u(i,r),t.forEach(function(l){n[l<0?~l:l]||s.push([l])}),s}function XG(e){return SA(e,KG.apply(this,arguments))}function KG(e,t,n){var i,r,s;if(arguments.length>1)i=JG(e,t,n);else for(r=0,i=new Array(s=e.arcs.length);r<s;++r)i[r]=r;return{type:"MultiLineString",arcs:ZG(e,i)}}function JG(e,t,n){var i=[],r=[],s;function o(f){var d=f<0?~f:f;(r[d]||(r[d]=[])).push({i:f,g:s})}function a(f){f.forEach(o)}function u(f){f.forEach(a)}function l(f){f.forEach(u)}function c(f){switch(s=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":a(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),r.forEach(n==null?function(f){i.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&i.push(f[0].i)}),i}const dn="year",gi="quarter",Ln="month",Bt="week",mi="date",kn="day",Is="dayofyear",Mi="hours",Ti="minutes",er="seconds",Ur="milliseconds",kA=[dn,gi,Ln,Bt,mi,kn,Is,Mi,Ti,er,Ur],Nm=kA.reduce((e,t,n)=>(e[t]=1+n,e),{});function AA(e){const t=ce(e).slice(),n={};return t.length||te("Missing time unit."),t.forEach(r=>{pe(Nm,r)?n[r]=1:te(`Invalid time unit: ${r}.`)}),(n[Bt]||n[kn]?1:0)+(n[gi]||n[Ln]||n[mi]?1:0)+(n[Is]?1:0)>1&&te(`Incompatible time units: ${e}`),t.sort((r,s)=>Nm[r]-Nm[s]),t}const QG={[dn]:"%Y ",[gi]:"Q%q ",[Ln]:"%b ",[mi]:"%d ",[Bt]:"W%U ",[kn]:"%a ",[Is]:"%j ",[Mi]:"%H:00",[Ti]:"00:%M",[er]:":%S",[Ur]:".%L",[`${dn}-${Ln}`]:"%Y-%m ",[`${dn}-${Ln}-${mi}`]:"%Y-%m-%d ",[`${Mi}-${Ti}`]:"%H:%M"};function eY(e,t){const n=Ht({},QG,t),i=AA(e),r=i.length;let s="",o=0,a,u;for(o=0;o<r;)for(a=i.length;a>o;--a)if(u=i.slice(o,a).join("-"),n[u]!=null){s+=n[u],o=a;break}return s.trim()}const ma=new Date;function E5(e){return ma.setFullYear(e),ma.setMonth(0),ma.setDate(1),ma.setHours(0,0,0,0),ma}function tY(e){return $A(new Date(e))}function nY(e){return G2(new Date(e))}function $A(e){return As.count(E5(e.getFullYear())-1,e)}function G2(e){return Ol.count(E5(e.getFullYear())-1,e)}function Y2(e){return E5(e).getDay()}function iY(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(-1,t,n,i,r,s,o);return a.setFullYear(e),a}return new Date(e,t,n,i,r,s,o)}function rY(e){return MA(new Date(e))}function sY(e){return Z2(new Date(e))}function MA(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return xo.count(t-1,e)}function Z2(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Il.count(t-1,e)}function X2(e){return ma.setTime(Date.UTC(e,0,1)),ma.getUTCDay()}function oY(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(Date.UTC(-1,t,n,i,r,s,o));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,i,r,s,o))}function TA(e,t,n,i,r){const s=t||1,o=Xe(e),a=(y,v,b)=>(b=b||y,aY(n[b],i[b],y===o&&s,v)),u=new Date,l=Br(e),c=l[dn]?a(dn):Pn(2012),f=l[Ln]?a(Ln):l[gi]?a(gi):ga,d=l[Bt]&&l[kn]?a(kn,1,Bt+kn):l[Bt]?a(Bt,1):l[kn]?a(kn,1):l[mi]?a(mi,1):l[Is]?a(Is,1):ud,h=l[Mi]?a(Mi):ga,p=l[Ti]?a(Ti):ga,g=l[er]?a(er):ga,m=l[Ur]?a(Ur):ga;return function(y){u.setTime(+y);const v=c(u);return r(v,f(u),d(u,v),h(u),p(u),g(u),m(u))}}function aY(e,t,n,i){const r=n<=1?e:i?(s,o)=>i+n*Math.floor((e(s,o)-i)/n):(s,o)=>n*Math.floor(e(s,o)/n);return t?(s,o)=>t(r(s,o),o):r}function dl(e,t,n){return t+e*7-(n+6)%7}const uY={[dn]:e=>e.getFullYear(),[gi]:e=>Math.floor(e.getMonth()/3),[Ln]:e=>e.getMonth(),[mi]:e=>e.getDate(),[Mi]:e=>e.getHours(),[Ti]:e=>e.getMinutes(),[er]:e=>e.getSeconds(),[Ur]:e=>e.getMilliseconds(),[Is]:e=>$A(e),[Bt]:e=>G2(e),[Bt+kn]:(e,t)=>dl(G2(e),e.getDay(),Y2(t)),[kn]:(e,t)=>dl(1,e.getDay(),Y2(t))},lY={[gi]:e=>3*e,[Bt]:(e,t)=>dl(e,0,Y2(t))};function cY(e,t){return TA(e,t||1,uY,lY,iY)}const fY={[dn]:e=>e.getUTCFullYear(),[gi]:e=>Math.floor(e.getUTCMonth()/3),[Ln]:e=>e.getUTCMonth(),[mi]:e=>e.getUTCDate(),[Mi]:e=>e.getUTCHours(),[Ti]:e=>e.getUTCMinutes(),[er]:e=>e.getUTCSeconds(),[Ur]:e=>e.getUTCMilliseconds(),[Is]:e=>MA(e),[Bt]:e=>Z2(e),[kn]:(e,t)=>dl(1,e.getUTCDay(),X2(t)),[Bt+kn]:(e,t)=>dl(Z2(e),e.getUTCDay(),X2(t))},dY={[gi]:e=>3*e,[Bt]:(e,t)=>dl(e,0,X2(t))};function hY(e,t){return TA(e,t||1,fY,dY,oY)}const pY={[dn]:Pr,[gi]:Lf.every(3),[Ln]:Lf,[Bt]:Ol,[mi]:As,[kn]:As,[Is]:As,[Mi]:pg,[Ti]:dg,[er]:ws,[Ur]:ul},gY={[dn]:zr,[gi]:Nf.every(3),[Ln]:Nf,[Bt]:Il,[mi]:xo,[kn]:xo,[Is]:xo,[Mi]:gg,[Ti]:hg,[er]:ws,[Ur]:ul};function cd(e){return pY[e]}function fd(e){return gY[e]}function FA(e,t,n){return e?e.offset(t,n):void 0}function mY(e,t,n){return FA(cd(e),t,n)}function yY(e,t,n){return FA(fd(e),t,n)}function LA(e,t,n,i){return e?e.range(t,n,i):void 0}function vY(e,t,n,i){return LA(cd(e),t,n,i)}function bY(e,t,n,i){return LA(fd(e),t,n,i)}const Dc=1e3,Rc=Dc*60,Oc=Rc*60,$g=Oc*24,xY=$g*7,N8=$g*30,K2=$g*365,NA=[dn,Ln,mi,Mi,Ti,er,Ur],Ic=NA.slice(0,-1),Pc=Ic.slice(0,-1),zc=Pc.slice(0,-1),_Y=zc.slice(0,-1),wY=[dn,Bt],D8=[dn,Ln],DA=[dn],pc=[[Ic,1,Dc],[Ic,5,5*Dc],[Ic,15,15*Dc],[Ic,30,30*Dc],[Pc,1,Rc],[Pc,5,5*Rc],[Pc,15,15*Rc],[Pc,30,30*Rc],[zc,1,Oc],[zc,3,3*Oc],[zc,6,6*Oc],[zc,12,12*Oc],[_Y,1,$g],[wY,1,xY],[D8,1,N8],[D8,3,3*N8],[DA,1,K2]];function EY(e){const t=e.extent,n=e.maxbins||40,i=Math.abs(Ag(t))/n;let r=Nl(a=>a[2]).right(pc,i),s,o;return r===pc.length?(s=DA,o=ko(t[0]/K2,t[1]/K2,n)):r?(r=pc[i/pc[r-1][2]<pc[r][2]/i?r-1:r],s=r[0],o=r[1]):(s=NA,o=Math.max(ko(t[0],t[1],n),1)),{units:s,step:o}}function Bc(e){const t={};return n=>t[n]||(t[n]=e(n))}function CY(e,t){return n=>{const i=e(n),r=i.indexOf(t);if(r<0)return i;let s=SY(i,r);const o=s<i.length?i.slice(s):"";for(;--s>r;)if(i[s]!=="0"){++s;break}return i.slice(0,s)+o}}function SY(e,t){let n=e.lastIndexOf("e"),i;if(n>0)return n;for(n=e.length;--n>t;)if(i=e.charCodeAt(n),i>=48&&i<=57)return n+1}function RA(e){const t=Bc(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(i){const r=qa(i||",");if(r.precision==null){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1;break}return CY(t(r),t(".1f")(1)[1])}else return t(r)},formatSpan(i,r,s,o){o=qa(o??",f");const a=ko(i,r,s),u=Math.max(Math.abs(i),Math.abs(r));let l;if(o.precision==null)switch(o.type){case"s":return isNaN(l=_S(a,u))||(o.precision=l),n(o,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=wS(a,u))||(o.precision=l-(o.type==="e"));break}case"f":case"%":{isNaN(l=xS(a))||(o.precision=l-(o.type==="%")*2);break}}return t(o)}}}let J2;kY();function kY(){return J2=RA({format:og,formatPrefix:K3})}function OA(e){return RA(bS(e))}function Q2(e){return arguments.length?J2=OA(e):J2}function R8(e,t,n){n=n||{},_e(n)||te(`Invalid time multi-format specifier: ${n}`);const i=t(er),r=t(Ti),s=t(Mi),o=t(mi),a=t(Bt),u=t(Ln),l=t(gi),c=t(dn),f=e(n[Ur]||".%L"),d=e(n[er]||":%S"),h=e(n[Ti]||"%I:%M"),p=e(n[Mi]||"%I %p"),g=e(n[mi]||n[kn]||"%a %d"),m=e(n[Bt]||"%b %d"),y=e(n[Ln]||"%B"),v=e(n[gi]||"%B"),b=e(n[dn]||"%Y");return x=>(i(x)<x?f:r(x)<x?d:s(x)<x?h:o(x)<x?p:u(x)<x?a(x)<x?g:m:c(x)<x?l(x)<x?y:v:b)(x)}function IA(e){const t=Bc(e.format),n=Bc(e.utcFormat);return{timeFormat:i=>le(i)?t(i):R8(t,cd,i),utcFormat:i=>le(i)?n(i):R8(n,fd,i),timeParse:Bc(e.parse),utcParse:Bc(e.utcParse)}}let ev;AY();function AY(){return ev=IA({format:d5,parse:Rk,utcFormat:h5,utcParse:Ok})}function PA(e){return IA(Tk(e))}function Q0(e){return arguments.length?ev=PA(e):ev}const tv=(e,t)=>Ht({},e,t);function $Y(e,t){const n=e?OA(e):Q2(),i=t?PA(t):Q0();return tv(n,i)}function MY(e,t){const n=arguments.length;return n&&n!==2&&te("defaultLocale expects either zero or two arguments."),n?tv(Q2(e),Q0(t)):tv(Q2(),Q0())}const TY=/^(data:|([A-Za-z]+:)?\/\/)/,FY=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,LY=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,O8="file://";function NY(e,t){return n=>({options:n||{},sanitize:RY,load:DY,fileAccess:!1,file:OY(t),http:PY(e)})}async function DY(e,t){const n=await this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}async function RY(e,t){t=Ht({},this.options,t);const n=this.fileAccess,i={href:null};let r,s,o;const a=FY.test(e.replace(LY,""));(e==null||typeof e!="string"||!a)&&te("Sanitize failure, invalid URI: "+xe(e));const u=TY.test(e);return(o=t.baseURL)&&!u&&(!e.startsWith("/")&&!o.endsWith("/")&&(e="/"+e),e=o+e),s=(r=e.startsWith(O8))||t.mode==="file"||t.mode!=="http"&&!u&&n,r?e=e.slice(O8.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!s}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}function OY(e){return e?t=>new Promise((n,i)=>{e.readFile(t,(r,s)=>{r?i(r):n(s)})}):IY}async function IY(){te("No file system access.")}function PY(e){return e?async function(t,n){const i=Ht({},this.options.http,n),r=n&&n.response,s=await e(t,i);return s.ok?Me(s[r])?s[r]():s.text():te(s.status+""+s.statusText)}:zY}async function zY(){te("No HTTP fetch method available.")}const BY=e=>e!=null&&e===e,UY=e=>e==="true"||e==="false"||e===!0||e===!1,jY=e=>!Number.isNaN(Date.parse(e)),zA=e=>!Number.isNaN(+e)&&!(e instanceof Date),HY=e=>zA(e)&&Number.isInteger(+e),I8={boolean:wA,integer:$n,number:$n,date:EA,string:CA,unknown:In},fh=[UY,HY,zA,jY],qY=["boolean","integer","number","date"];function VY(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=fh.length,r=fh.map((s,o)=>o+1);for(let s=0,o=0,a,u;s<n;++s)for(u=t?e[s][t]:e[s],a=0;a<i;++a)if(r[a]&&BY(u)&&!fh[a](u)&&(r[a]=0,++o,o===fh.length))return"string";return qY[r.reduce((s,o)=>s===0?o:s,0)-1]}function WY(e,t){return t.reduce((n,i)=>(n[i]=VY(e,i),n),{})}function P8(e){const t=function(n,i){const r={delimiter:e};return C5(n,i?Ht(i,r):r)};return t.responseType="text",t}function C5(e,t){return t.header&&(e=t.header.map(xe).join(t.delimiter)+`
`+e),ej(t.delimiter).parse(e+"")}C5.responseType="text";function GY(e){return typeof Buffer=="function"&&Me(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function S5(e,t){const n=t&&t.property?Ji(t.property):In;return _e(e)&&!GY(e)?YY(n(e),t):n(JSON.parse(e))}S5.responseType="json";function YY(e,t){return!V(e)&&IG(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const ZY={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function BA(e,t){let n,i,r,s;return e=S5(e,t),t&&t.feature?(n=YG,r=t.feature):t&&t.mesh?(n=XG,r=t.mesh,s=ZY[t.filter]):te("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,s):te("Invalid TopoJSON object: "+r),i&&i.features||[i]}BA.responseType="json";const Dm={dsv:C5,csv:P8(","),tsv:P8("	"),json:S5,topojson:BA};function UA(e,t){return arguments.length>1?(Dm[e]=t,this):pe(Dm,e)?Dm[e]:null}function XY(e){const t=UA(e);return t&&t.responseType||"text"}function KY(e,t,n,i){t=t||{};const r=UA(t.type||"json");return r||te("Unknown data format type: "+t.type),e=r(e,t),t.parse&&JY(e,t.parse,n,i),pe(e,"columns")&&delete e.columns,e}function JY(e,t,n,i){if(!e.length)return;const r=Q0();n=n||r.timeParse,i=i||r.utcParse;let s=e.columns||Object.keys(e[0]),o,a,u,l,c,f;t==="auto"&&(t=WY(e,s)),s=Object.keys(t);const d=s.map(h=>{const p=t[h];let g,m;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),m=g[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(g[0]==="utc"?i:n)(m);if(!I8[p])throw Error("Illegal format pattern: "+h+":"+p);return I8[p]});for(u=0,c=e.length,f=s.length;u<c;++u)for(o=e[u],l=0;l<f;++l)a=s[l],o[a]=d[l](o[a])}const k5=NY(typeof fetch<"u"&&fetch,null);function Mg(e){const t=e||In,n=[],i={};return n.add=r=>{const s=t(r);return i[s]||(i[s]=1,n.push(r)),n},n.remove=r=>{const s=t(r);if(i[s]){i[s]=0;const o=n.indexOf(r);o>=0&&n.splice(o,1)}return n},n}async function Uh(e,t){try{await t(e)}catch(n){e.error(n)}}const jA=Symbol("vega_id");let QY=1;function A5(e){return!!(e&&ge(e))}function ge(e){return e[jA]}function HA(e,t){return e[jA]=t,e}function We(e){const t=e===Object(e)?e:{data:e};return ge(t)?t:HA(t,QY++)}function $5(e){return Tg(e,We({}))}function Tg(e,t){for(const n in e)t[n]=e[n];return t}function qA(e,t){return HA(t,ge(e))}function hu(e,t){return e?t?(n,i)=>e(n,i)||ge(t(n))-ge(t(i)):(n,i)=>e(n,i)||ge(n)-ge(i):null}function VA(e){return e&&e.constructor===zl}function zl(){const e=[],t=[],n=[],i=[],r=[];let s=null,o=!1;return{constructor:zl,insert(a){const u=ce(a),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(a){const u=Me(a)?i:t,l=ce(a),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(a,u,l){const c={field:u,value:Pn(l)};return Me(a)?(c.filter=a,r.push(c)):(c.tuple=a,n.push(c)),this},encode(a,u){return Me(a)?r.push({filter:a,field:u}):n.push({tuple:a,field:u}),this},clean(a){return s=a,this},reflow(){return o=!0,this},pulse(a,u){const l={},c={};let f,d,h,p,g,m;for(f=0,d=u.length;f<d;++f)l[ge(u[f])]=1;for(f=0,d=t.length;f<d;++f)g=t[f],l[ge(g)]=-1;for(f=0,d=i.length;f<d;++f)p=i[f],u.forEach(v=>{p(v)&&(l[ge(v)]=-1)});for(f=0,d=e.length;f<d;++f)g=e[f],m=ge(g),l[m]?l[m]=1:a.add.push(We(e[f]));for(f=0,d=u.length;f<d;++f)g=u[f],l[ge(g)]<0&&a.rem.push(g);function y(v,b,x){x?v[b]=x(v):a.encode=b,o||(c[ge(v)]=v)}for(f=0,d=n.length;f<d;++f)h=n[f],g=h.tuple,p=h.field,m=l[ge(g)],m>0&&(y(g,p,h.value),a.modifies(p));for(f=0,d=r.length;f<d;++f)h=r[f],p=h.filter,u.forEach(v=>{p(v)&&l[ge(v)]>0&&y(v,h.field,h.value)}),a.modifies(h.field);if(o)a.mod=t.length||i.length?u.filter(v=>l[ge(v)]>0):u.slice();else for(m in c)a.mod.push(c[m]);return(s||s==null&&(t.length||i.length))&&a.clean(!0),a}}}const jh="_:mod:_";function M5(){Object.defineProperty(this,jh,{writable:!0,value:{}})}M5.prototype={set(e,t,n,i){const r=this,s=r[e],o=r[jh];return t!=null&&t>=0?(s[t]!==n||i)&&(s[t]=n,o[t+":"+e]=-1,o[e]=-1):(s!==n||i)&&(r[e]=n,o[e]=V(n)?1+n.length:-1),r},modified(e,t){const n=this[jh];if(arguments.length){if(V(e)){for(let i=0;i<e.length;++i)if(n[e[i]])return!0;return!1}}else{for(const i in n)if(n[i])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[jh]={},this}};let eZ=0;const tZ="pulse",nZ=new M5,iZ=1,rZ=2;function ut(e,t,n,i){this.id=++eZ,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}function z8(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}ut.prototype={targets(){return this._targets||(this._targets=Mg(wg))},set(e){return this.value!==e?(this.value=e,1):0},skip:z8(iZ),modified:z8(rZ),parameters(e,t,n){t=t!==!1;const i=this._argval=this._argval||new M5,r=this._argops=this._argops||[],s=[];let o,a,u,l;const c=(f,d,h)=>{h instanceof ut?(h!==this&&(t&&h.targets().add(this),s.push(h)),r.push({op:h,name:f,index:d})):i.set(f,d,h)};for(o in e)if(a=e[o],o===tZ)ce(a).forEach(f=>{f instanceof ut?f!==this&&(f.targets().add(this),s.push(f)):te("Pulse parameters must be operator instances.")}),this.source=a;else if(V(a))for(i.set(o,-1,Array(u=a.length)),l=0;l<u;++l)c(o,l,a[l]);else c(o,-1,a);return this.marshall().clear(),n&&(r.initonly=!0),s},marshall(e){const t=this._argval||nZ,n=this._argops;let i,r,s,o;if(n){const a=n.length;for(r=0;r<a;++r)i=n[r],s=i.op,o=s.modified()&&s.stamp===e,t.set(i.name,i.index,s.value,o);if(n.initonly){for(r=0;r<a;++r)i=n[r],i.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,i,r;if(e)for(t=0,n=e.length;t<n;++t)i=e[t],r=i.op,r._targets&&r._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),i=t.call(this,n,e);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function sZ(e,t,n,i){let r=1,s;return e instanceof ut?s=e:e&&e.prototype instanceof ut?s=new e:Me(e)?s=new ut(null,e):(r=0,s=new ut(e,t)),this.rank(s),r&&(i=n,n=t),n&&this.connect(s,s.parameters(n,i)),this.touch(s),s}function oZ(e,t){const n=e.rank,i=t.length;for(let r=0;r<i;++r)if(n<t[r].rank){this.rerank(e);return}}let aZ=0;function T5(e,t,n){this.id=++aZ,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function to(e,t,n){return new T5(e,t,n)}T5.prototype={_filter:Qi,_apply:In,targets(){return this._targets||(this._targets=Mg(wg))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,i=n?n.length:0;for(let r=0;r<i;++r)n[r].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=to(e);return this.targets().add(t),t},apply(e){const t=to(null,e);return this.targets().add(t),t},merge(){const e=to();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=to();return this.targets().add(to(null,null,bA(e,n=>{const i=n.dataflow;t.receive(n),i&&i.run&&i.run()}))),t},between(e,t){let n=!1;return e.targets().add(to(null,null,()=>n=!0)),t.targets().add(to(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=Qi,this._targets=null}};function uZ(e,t,n,i){const r=this,s=to(n,i),o=function(l){l.dataflow=r;try{s.receive(l)}catch(c){r.error(c)}finally{r.run()}};let a;typeof e=="string"&&typeof document<"u"?a=document.querySelectorAll(e):a=ce(e);const u=a.length;for(let l=0;l<u;++l)a[l].addEventListener(t,o);return s}function lZ(e,t){const n=this.locale();return KY(e,t,n.timeParse,n.utcParse)}function cZ(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function fZ(e,t){const n=this;let i=0,r;try{r=await n.loader().load(e,{context:"dataflow",response:XY(t&&t.type)});try{r=n.parse(r,t)}catch(s){i=-2,n.warn("Data ingestion failed",e,s)}}catch(s){i=-1,n.warn("Loading failed",e,s)}return{data:r,status:i}}async function dZ(e,t,n){const i=this,r=i._pending||hZ(i);r.requests+=1;const s=await i.request(t,n);return i.pulse(e,i.changeset().remove(Qi).insert(s.data||[])),r.done(),s}function hZ(e){let t;const n=new Promise(i=>t=i);return n.requests=0,n.done=()=>{--n.requests===0&&(e._pending=null,t(e))},e._pending=n}const pZ={skip:!0};function gZ(e,t,n,i,r){return(e instanceof ut?yZ:mZ)(this,e,t,n,i,r),this}function mZ(e,t,n,i,r,s){const o=Ht({},s,pZ);let a,u;Me(n)||(n=Pn(n)),i===void 0?a=l=>e.touch(n(l)):Me(i)?(u=new ut(null,i,r,!1),a=l=>{u.evaluate(l);const c=n(l),f=u.value;VA(f)?e.pulse(c,f,s):e.update(c,f,o)}):a=l=>e.update(n(l),i,o),t.apply(a)}function yZ(e,t,n,i,r,s){if(i===void 0)t.targets().add(n);else{const o=s||{},a=new ut(null,vZ(n,i),r,!1);a.modified(o.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}function vZ(e,t){return t=Me(t)?t:Pn(t),e?function(n,i){const r=t(n,i);return e.skip()||(e.skip(r!==this.value).value=r),r}:t}function bZ(e){e.rank=++this._rank}function xZ(e){const t=[e];let n,i,r;for(;t.length;)if(this.rank(n=t.pop()),i=n._targets)for(r=i.length;--r>=0;)t.push(n=i[r]),n===e&&te("Cycle detected in dataflow graph.")}const ep={},xr=1,ao=2,ds=4,_Z=xr|ao,B8=xr|ds,Mu=xr|ao|ds,U8=8,gc=16,j8=32,H8=64;function La(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Rm(e,t){const n=[];return fa(e,t,i=>n.push(i)),n}function q8(e,t){const n={};return e.visit(t,i=>{n[ge(i)]=1}),i=>n[ge(i)]?null:i}function dh(e,t){return e?(n,i)=>e(n,i)&&t(n,i):t}La.prototype={StopPropagation:ep,ADD:xr,REM:ao,MOD:ds,ADD_REM:_Z,ADD_MOD:B8,ALL:Mu,REFLOW:U8,SOURCE:gc,NO_SOURCE:j8,NO_FIELDS:H8,fork(e){return new La(this.dataflow).init(this,e)},clone(){const e=this.fork(Mu);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(Mu|gc)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new La(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&H8)&&(n.fields=e.fields),t&xr?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&ao?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&ds?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&j8?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||Mu;return t&xr&&this.add.length||t&ao&&this.rem.length||t&ds&&this.mod.length},reflow(e){if(e)return this.fork(Mu).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(ds,q8(this,xr))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return V(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?V(e)?e.some(i=>n[i]):n[e]:!!n:!1},filter(e,t){const n=this;return e&xr&&(n.addF=dh(n.addF,t)),e&ao&&(n.remF=dh(n.remF,t)),e&ds&&(n.modF=dh(n.modF,t)),e&gc&&(n.srcF=dh(n.srcF,t)),n},materialize(e){e=e||Mu;const t=this;return e&xr&&t.addF&&(t.add=Rm(t.add,t.addF),t.addF=null),e&ao&&t.remF&&(t.rem=Rm(t.rem,t.remF),t.remF=null),e&ds&&t.modF&&(t.mod=Rm(t.mod,t.modF),t.modF=null),e&gc&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,i=t;if(e&gc)return fa(n.source,n.srcF,i),n;e&xr&&fa(n.add,n.addF,i),e&ao&&fa(n.rem,n.remF,i),e&ds&&fa(n.mod,n.modF,i);const r=n.source;if(e&U8&&r){const s=n.add.length+n.mod.length;s===r.length||(s?fa(r,q8(n,B8),i):fa(r,n.srcF,i))}return n}};function WA(e,t,n,i){const r=this;let s=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null,this.pulses=n;for(const o of n)if(o.stamp===t){if(o.fields){const a=r.fields||(r.fields={});for(const u in o.fields)a[u]=1}o.changed(r.ADD)&&(s|=r.ADD),o.changed(r.REM)&&(s|=r.REM),o.changed(r.MOD)&&(s|=r.MOD)}this.changes=s}Q(WA,La,{fork(e){const t=new La(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?V(e)?e.some(i=>n[i]):n[e]:0},filter(){te("MultiPulse does not support filtering.")},materialize(){te("MultiPulse does not support materialization.")},visit(e,t){const n=this,i=n.pulses,r=i.length;let s=0;if(e&n.SOURCE)for(;s<r;++s)i[s].visit(e,t);else for(;s<r;++s)i[s].stamp===n.stamp&&i[s].visit(e,t);return n}});async function wZ(e,t,n){const i=this,r=[];if(i._pulse)return GA(i);if(i._pending&&await i._pending,t&&await Uh(i,t),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const s=++i._clock;i._pulse=new La(i,s,e),i._touched.forEach(c=>i._enqueue(c,!0)),i._touched=Mg(wg);let o=0,a,u,l;try{for(;i._heap.size()>0;){if(a=i._heap.pop(),a.rank!==a.qrank){i._enqueue(a,!0);continue}u=a.run(i._getPulse(a,e)),u.then?u=await u:u.async&&(r.push(u.async),u=ep),u!==ep&&a._targets&&a._targets.forEach(c=>i._enqueue(c)),++o}}catch(c){i._heap.clear(),l=c}if(i._input={},i._pulse=null,i.debug(`Pulse ${s}: ${o} operators`),l&&(i._postrun=[],i.error(l)),i._postrun.length){const c=i._postrun.sort((f,d)=>d.priority-f.priority);i._postrun=[];for(let f=0;f<c.length;++f)await Uh(i,c[f].callback)}return n&&await Uh(i,n),r.length&&Promise.all(r).then(c=>i.runAsync(null,()=>{c.forEach(f=>{try{f(i)}catch(d){i.error(d)}})})),i}async function EZ(e,t,n){for(;this._running;)await this._running;const i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running}function CZ(e,t,n){return this._pulse?GA(this):(this.evaluate(e,t,n),this)}function SZ(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(i){this.error(i)}}function GA(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function kZ(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function AZ(e,t){const n=e.source,i=this._clock;return n&&V(n)?new WA(this,i,n.map(r=>r.pulse),t):this._input[e.id]||$Z(this._pulse,n&&n.pulse)}function $Z(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==ep&&(e.source=t.source),e)}const F5={skip:!1,force:!1};function MZ(e,t){const n=t||F5;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function TZ(e,t,n){const i=n||F5;return(e.set(t)||i.force)&&this.touch(e,i),this}function FZ(e,t,n){this.touch(e,n||F5);const i=new La(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this}function LZ(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),YA(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let i;return t.length?(i=t[0],t[0]=n,NZ(t,0,e)):i=n,i}}}function YA(e,t,n,i){let r,s;const o=e[n];for(;n>t;){if(s=n-1>>1,r=e[s],i(o,r)<0){e[n]=r,n=s;continue}break}return e[n]=o}function NZ(e,t,n){const i=t,r=e.length,s=e[t];let o=(t<<1)+1,a;for(;o<r;)a=o+1,a<r&&n(e[o],e[a])>=0&&(o=a),e[t]=e[o],t=o,o=(t<<1)+1;return e[t]=s,YA(e,i,t,n)}function lf(){this.logger(lA()),this.logLevel(aA),this._clock=0,this._rank=0,this._locale=MY();try{this._loader=k5()}catch{}this._touched=Mg(wg),this._input={},this._pulse=null,this._heap=LZ((e,t)=>e.qrank-t.qrank),this._postrun=[]}function mc(e){return function(){return this._log[e].apply(this,arguments)}}lf.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:mc("error"),warn:mc("warn"),info:mc("info"),debug:mc("debug"),logLevel:mc("level"),cleanThreshold:1e4,add:sZ,connect:oZ,rank:bZ,rerank:xZ,pulse:FZ,touch:MZ,update:TZ,changeset:zl,ingest:cZ,parse:lZ,preload:dZ,request:fZ,events:uZ,on:gZ,evaluate:wZ,run:CZ,runAsync:EZ,runAfter:SZ,_enqueue:kZ,_getPulse:AZ};function z(e,t){ut.call(this,e,null,t)}Q(z,ut,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const L5={};function*ZA(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)i=t(i,++n,e),i!=null&&i!==""&&(i=+i)>=i&&(yield i)}}function XA(e,t,n){const i=Float64Array.from(ZA(e,n));return i.sort(Ss),t.map(r=>bC(i,r))}function KA(e,t){return XA(e,[.25,.5,.75],t)}function JA(e,t){const n=e.length,i=BI(e,t),r=KA(e,t),s=(r[2]-r[0])/1.34;return 1.06*(Math.min(i,s)||i||Math.abs(r[0])||1)*Math.pow(n,-.2)}function DZ(e){const t=e.maxbins||20,n=e.base||10,i=Math.log(n),r=e.divide||[5,2];let s=e.extent[0],o=e.extent[1],a,u,l,c,f,d;const h=e.span||o-s||Math.abs(s)||1;if(e.step)a=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);a=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/i),l=e.minstep||0,a=Math.max(l,Math.pow(n,Math.round(Math.log(h)/i)-u));Math.ceil(h/a)>t;)a*=n;for(f=0,d=r.length;f<d;++f)c=a/r[f],c>=l&&h/c<=t&&(a=c)}c=Math.log(a);const p=c>=0?0:~~(-c/i)+1,g=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(s/a+g)*a,s=s<c?c-a:c,o=Math.ceil(o/a)*a),{start:s,stop:o===s?s+a:o,step:a}}var Ps=Math.random;function RZ(e,t,n,i){if(!e.length)return[void 0,void 0];const r=Float64Array.from(ZA(e,i)),s=r.length,o=t;let a,u,l,c;for(l=0,c=Array(o);l<o;++l){for(a=0,u=0;u<s;++u)a+=r[~~(Ps()*s)];c[l]=a/s}return c.sort(Ss),[a2(c,n/2),a2(c,1-n/2)]}function OZ(e,t,n,i){i=i||(d=>d);const r=e.length,s=new Float64Array(r);let o=0,a=1,u=i(e[0]),l=u,c=u+t,f;for(;a<r;++a){if(f=i(e[a]),f>=c){for(l=(u+l)/2;o<a;++o)s[o]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;o<a;++o)s[o]=l;return n?IZ(s,t+t/4):s}function IZ(e,t){const n=e.length;let i=0,r=1,s,o;for(;e[i]===e[r];)++r;for(;r<n;){for(s=r+1;e[r]===e[s];)++s;if(e[r]-e[r-1]<t){for(o=r+(i+s-r-r>>1);o<r;)e[o++]=e[r];for(;o>r;)e[o--]=e[i]}i=r,r=s}return e}const QA=Math.sqrt(2*Math.PI),PZ=Math.SQRT2;let yc=NaN;function N5(e,t){e=e||0,t=t??1;let n=0,i=0,r,s;if(yc===yc)n=yc,yc=NaN;else{do n=Ps()*2-1,i=Ps()*2-1,r=n*n+i*i;while(r===0||r>1);s=Math.sqrt(-2*Math.log(r)/r),n*=s,yc=i*s}return e+n*t}function e$(e,t,n){n=n??1;const i=(e-(t||0))/n;return Math.exp(-.5*i*i)/(n*QA)}function D5(e,t,n){t=t||0,n=n??1;const i=(e-t)/n,r=Math.abs(i);let s;if(r>37)s=0;else{const o=Math.exp(-r*r/2);let a;r<7.07106781186547?(a=.0352624965998911*r+.700383064443688,a=a*r+6.37396220353165,a=a*r+33.912866078383,a=a*r+112.079291497871,a=a*r+221.213596169931,a=a*r+220.206867912376,s=o*a,a=.0883883476483184*r+1.75566716318264,a=a*r+16.064177579207,a=a*r+86.7807322029461,a=a*r+296.564248779674,a=a*r+637.333633378831,a=a*r+793.826512519948,a=a*r+440.413735824752,s=s/a):(a=r+.65,a=r+4/a,a=r+3/a,a=r+2/a,a=r+1/a,s=o/a/2.506628274631)}return i>0?1-s:s}function R5(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*PZ*zZ(2*e-1)}function zZ(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function t$(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=s??1,r):i},sample:()=>N5(n,i),pdf:s=>e$(s,n,i),cdf:s=>D5(s,n,i),icdf:s=>R5(s,n,i)};return r.mean(e).stdev(t)}function n$(e,t){const n=t$();let i=0;const r={data(s){return arguments.length?(e=s,i=s?s.length:0,r.bandwidth(t)):e},bandwidth(s){return arguments.length?(t=s,!t&&e&&(t=JA(e)),r):t},sample(){return e[~~(Ps()*i)]+t*n.sample()},pdf(s){let o=0,a=0;for(;a<i;++a)o+=n.pdf((s-e[a])/t);return o/t/i},cdf(s){let o=0,a=0;for(;a<i;++a)o+=n.cdf((s-e[a])/t);return o/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(e)}function i$(e,t){return e=e||0,t=t??1,Math.exp(e+N5()*t)}function r$(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*QA*e)}function s$(e,t,n){return D5(Math.log(e),t,n)}function o$(e,t,n){return Math.exp(R5(e,t,n))}function BZ(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=s??1,r):i},sample:()=>i$(n,i),pdf:s=>r$(s,n,i),cdf:s=>s$(s,n,i),icdf:s=>o$(s,n,i)};return r.mean(e).stdev(t)}function UZ(e,t){let n=0,i;function r(o){const a=[];let u=0,l;for(l=0;l<n;++l)u+=a[l]=o[l]==null?1:+o[l];for(l=0;l<n;++l)a[l]/=u;return a}const s={weights(o){return arguments.length?(i=r(t=o||[]),s):t},distributions(o){return arguments.length?(o?(n=o.length,e=o):(n=0,e=[]),s.weights(t)):e},sample(){const o=Ps();let a=e[n-1],u=i[0],l=0;for(;l<n-1;u+=i[++l])if(o<u){a=e[l];break}return a.sample()},pdf(o){let a=0,u=0;for(;u<n;++u)a+=i[u]*e[u].pdf(o);return a},cdf(o){let a=0,u=0;for(;u<n;++u)a+=i[u]*e[u].cdf(o);return a},icdf(){throw Error("Mixture icdf not supported.")}};return s.distributions(e).weights(t)}function a$(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*Ps()}function u$(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function l$(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function c$(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function jZ(e,t){let n,i;const r={min(s){return arguments.length?(n=s||0,r):n},max(s){return arguments.length?(i=s??1,r):i},sample:()=>a$(n,i),pdf:s=>u$(s,n,i),cdf:s=>l$(s,n,i),icdf:s=>c$(s,n,i)};return t==null&&(t=e??1,e=0),r.min(e).max(t)}function f$(e,t,n){let i=0,r=0;for(const s of e){const o=n(s);t(s)==null||o==null||isNaN(o)||(i+=(o-i)/++r)}return{coef:[i],predict:()=>i,rSquared:0}}function dd(e,t,n,i){const r=i-e*e,s=Math.abs(r)<1e-24?0:(n-e*t)/r;return[t-s*e,s]}function Fg(e,t,n,i){e=e.filter(h=>{let p=t(h),g=n(h);return p!=null&&(p=+p)>=p&&g!=null&&(g=+g)>=g}),i&&e.sort((h,p)=>t(h)-t(p));const r=e.length,s=new Float64Array(r),o=new Float64Array(r);let a=0,u=0,l=0,c,f,d;for(d of e)s[a]=c=+t(d),o[a]=f=+n(d),++a,u+=(c-u)/a,l+=(f-l)/a;for(a=0;a<r;++a)s[a]-=u,o[a]-=l;return[s,o,u,l]}function hd(e,t,n,i){let r=-1,s,o;for(const a of e)s=t(a),o=n(a),s!=null&&(s=+s)>=s&&o!=null&&(o=+o)>=o&&i(s,o,++r)}function Bl(e,t,n,i,r){let s=0,o=0;return hd(e,t,n,(a,u)=>{const l=u-r(a),c=u-i;s+=l*l,o+=c*c}),1-s/o}function d$(e,t,n){let i=0,r=0,s=0,o=0,a=0;hd(e,t,n,(c,f)=>{++a,i+=(c-i)/a,r+=(f-r)/a,s+=(c*f-s)/a,o+=(c*c-o)/a});const u=dd(i,r,s,o),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:Bl(e,t,n,r,l)}}function HZ(e,t,n){let i=0,r=0,s=0,o=0,a=0;hd(e,t,n,(c,f)=>{++a,c=Math.log(c),i+=(c-i)/a,r+=(f-r)/a,s+=(c*f-s)/a,o+=(c*c-o)/a});const u=dd(i,r,s,o),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:Bl(e,t,n,r,l)}}function qZ(e,t,n){const[i,r,s,o]=Fg(e,t,n);let a=0,u=0,l=0,c=0,f=0,d,h,p;hd(e,t,n,(v,b)=>{d=i[f++],h=Math.log(b),p=d*b,a+=(b*h-a)/f,u+=(p-u)/f,l+=(p*h-l)/f,c+=(d*p-c)/f});const[g,m]=dd(u/o,a/o,l/o,c/o),y=v=>Math.exp(g+m*(v-s));return{coef:[Math.exp(g-m*s),m],predict:y,rSquared:Bl(e,t,n,o,y)}}function VZ(e,t,n){let i=0,r=0,s=0,o=0,a=0,u=0;hd(e,t,n,(f,d)=>{const h=Math.log(f),p=Math.log(d);++u,i+=(h-i)/u,r+=(p-r)/u,s+=(h*p-s)/u,o+=(h*h-o)/u,a+=(d-a)/u});const l=dd(i,r,s,o),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:Bl(e,t,n,a,c)}}function h$(e,t,n){const[i,r,s,o]=Fg(e,t,n),a=i.length;let u=0,l=0,c=0,f=0,d=0,h,p,g,m;for(h=0;h<a;)p=i[h],g=r[h++],m=p*p,u+=(m-u)/h,l+=(m*p-l)/h,c+=(m*m-c)/h,f+=(p*g-f)/h,d+=(m*g-d)/h;const y=c-u*u,v=u*y-l*l,b=(d*u-f*l)/v,x=(f*y-d*l)/v,_=-b*u,E=w=>(w=w-s,b*w*w+x*w+_+o);return{coef:[_-x*s+b*s*s+o,x-2*b*s,b],predict:E,rSquared:Bl(e,t,n,o,E)}}function WZ(e,t,n,i){if(i===0)return f$(e,t,n);if(i===1)return d$(e,t,n);if(i===2)return h$(e,t,n);const[r,s,o,a]=Fg(e,t,n),u=r.length,l=[],c=[],f=i+1;let d,h,p,g,m;for(d=0;d<f;++d){for(p=0,g=0;p<u;++p)g+=Math.pow(r[p],d)*s[p];for(l.push(g),m=new Float64Array(f),h=0;h<f;++h){for(p=0,g=0;p<u;++p)g+=Math.pow(r[p],d+h);m[h]=g}c.push(m)}c.push(l);const y=YZ(c),v=b=>{b-=o;let x=a+y[0]+y[1]*b+y[2]*b*b;for(d=3;d<f;++d)x+=y[d]*Math.pow(b,d);return x};return{coef:GZ(f,y,-o,a),predict:v,rSquared:Bl(e,t,n,a,v)}}function GZ(e,t,n,i){const r=Array(e);let s,o,a,u;for(s=0;s<e;++s)r[s]=0;for(s=e-1;s>=0;--s)for(a=t[s],u=1,r[s]+=a,o=1;o<=s;++o)u*=(s+1-o)/o,r[s-o]+=a*Math.pow(n,o)*u;return r[0]+=i,r}function YZ(e){const t=e.length-1,n=[];let i,r,s,o,a;for(i=0;i<t;++i){for(o=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][o])&&(o=r);for(s=i;s<t+1;++s)a=e[s][i],e[s][i]=e[s][o],e[s][o]=a;for(r=i+1;r<t;++r)for(s=t;s>=i;s--)e[s][r]-=e[s][i]*e[i][r]/e[i][i]}for(r=t-1;r>=0;--r){for(a=0,s=r+1;s<t;++s)a+=e[s][r]*n[s];n[r]=(e[t][r]-a)/e[r][r]}return n}const V8=2,W8=1e-12;function ZZ(e,t,n,i){const[r,s,o,a]=Fg(e,t,n,!0),u=r.length,l=Math.max(2,~~(i*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=V8;){const p=[0,l-1];for(let m=0;m<u;++m){const y=r[m],v=p[0],b=p[1],x=y-r[v]>r[b]-y?v:b;let _=0,E=0,w=0,S=0,$=0;const F=1/Math.abs(r[x]-y||1);for(let R=v;R<=b;++R){const C=r[R],A=s[R],M=XZ(Math.abs(y-C)*F)*d[R],L=C*M;_+=M,E+=L,w+=A*M,S+=A*L,$+=C*L}const[T,P]=dd(E/_,w/_,S/_,$/_);c[m]=T+P*y,f[m]=Math.abs(s[m]-c[m]),KZ(r,m+1,p)}if(h===V8)break;const g=xC(f);if(Math.abs(g)<W8)break;for(let m=0,y,v;m<u;++m)y=f[m]/(6*g),d[m]=y>=1?W8:(v=1-y*y)*v}return JZ(r,c,o,a)}function XZ(e){return(e=1-e*e*e)*e*e}function KZ(e,t,n){const i=e[t];let r=n[0],s=n[1]+1;if(!(s>=e.length))for(;t>r&&e[s]-i<=i-e[r];)n[0]=++r,n[1]=s,++s}function JZ(e,t,n,i){const r=e.length,s=[];let o=0,a=0,u=[],l;for(;o<r;++o)l=e[o]+n,u[0]===l?u[1]+=(t[o]-u[1])/++a:(a=0,u[1]+=i,u=[l,t[o]],s.push(u));return u[1]+=i,s}const QZ=.5*Math.PI/180;function O5(e,t,n,i){n=n||25,i=Math.max(n,i||200);const r=g=>[g,e(g)],s=t[0],o=t[1],a=o-s,u=a/i,l=[r(s)],c=[];if(n===i){for(let g=1;g<i;++g)l.push(r(s+g/n*a));return l.push(r(o)),l}else{c.push(r(o));for(let g=n;--g>0;)c.push(r(s+g/n*a))}let f=l[0],d=c[c.length-1];const h=1/a,p=eX(f[1],c);for(;d;){const g=r((f[0]+d[0])/2);g[0]-f[0]>=u&&tX(f,g,d,h,p)>QZ?c.push(g):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function eX(e,t){let n=e,i=e;const r=t.length;for(let s=0;s<r;++s){const o=t[s][1];o<n&&(n=o),o>i&&(i=o)}return 1/(i-n)}function tX(e,t,n,i,r){const s=Math.atan2(r*(n[1]-e[1]),i*(n[0]-e[0])),o=Math.atan2(r*(t[1]-e[1]),i*(t[0]-e[0]));return Math.abs(s-o)}function nX(e){return t=>{const n=e.length;let i=1,r=String(e[0](t));for(;i<n;++i)r+="|"+e[i](t);return r}}function nv(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:nX(e)}function p$(e,t,n){return n||e+(t?"_"+t:"")}const Om=()=>{},iX={init:Om,add:Om,rem:Om,idx:0},Df={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.valid?e.sum:void 0,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3},exponential:{init:(e,t)=>{e.exp=0,e.exp_r=t},value:e=>e.valid?e.exp*(1-e.exp_r)/(1-e.exp_r**e.valid):void 0,add:(e,t)=>e.exp=e.exp_r*e.exp+t,rem:(e,t)=>e.exp=(e.exp-t/e.exp_r**(e.valid-1))/e.exp_r},exponentialb:{value:e=>e.valid?e.exp*(1-e.exp_r):void 0,req:["exponential"],idx:1}},pd=Object.keys(Df).filter(e=>e!=="__count__");function rX(e,t){return(n,i)=>Ht({name:e,aggregate_param:i,out:n||e},iX,t)}[...pd,"__count__"].forEach(e=>{Df[e]=rX(e,Df[e])});function g$(e,t,n){return Df[e](n,t)}function m$(e,t){return e.idx-t.idx}function sX(e){const t={};e.forEach(i=>t[i.name]=i);const n=i=>{i.req&&i.req.forEach(r=>{t[r]||n(t[r]=Df[r]())})};return e.forEach(n),Object.values(t).sort(m$)}function oX(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.aggregate_param==null?e.init(this):e.init(this,e.aggregate_param))}function aX(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function uX(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function lX(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function y$(e,t){const n=t||In,i=sX(e),r=e.slice().sort(m$);function s(o){this._ops=i,this._out=r,this.cell=o,this.init()}return s.prototype.init=oX,s.prototype.add=aX,s.prototype.rem=uX,s.prototype.set=lX,s.prototype.get=n,s.fields=e.map(o=>o.out),s}function I5(e){this._key=e?Ji(e):ge,this.reset()}const en=I5.prototype;en.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};en.add=function(e){this._add.push(e)};en.rem=function(e){this._rem.push(e)};en.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,i=e.length,r=t.length,s=Array(i-r),o={};let a,u,l;for(a=0;a<r;++a)o[n(t[a])]=1;for(a=0,u=0;a<i;++a)o[n(l=e[a])]?o[n(l)]=0:s[u++]=l;return this._rem=[],this._add=s};en.distinct=function(e){const t=this.values(),n={};let i=t.length,r=0,s;for(;--i>=0;)s=e(t[i])+"",pe(n,s)||(n[s]=1,++r);return r};en.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=RG(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};en.argmin=function(e){return this.extent(e)[0]||{}};en.argmax=function(e){return this.extent(e)[1]||{}};en.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};en.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};en.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=KA(this.values(),e),this._get=e),this._q};en.q1=function(e){return this.quartile(e)[0]};en.q2=function(e){return this.quartile(e)[1]};en.q3=function(e){return this.quartile(e)[2]};en.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=RZ(this.values(),1e3,.05,e),this._get=e),this._ci};en.ci0=function(e){return this.ci(e)[0]};en.ci1=function(e){return this.ci(e)[1]};function Mo(e){z.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Mo.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:pd},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};Q(Mo,z,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):Object.create(null),t.visit(t.SOURCE,s=>n.add(s))):(n.value=n.value||n.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),i.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const e=this,t=e.value,n=e._dnames,i=n.map(()=>({})),r=n.length;function s(a){let u,l,c,f;for(u in a)for(c=a[u].tuple,l=0;l<r;++l)i[l][f=c[n[l]]]=f}s(e._prev),s(t);function o(a,u,l){const c=n[l],f=i[l++];for(const d in f){const h=a?a+"|"+d:d;u[c]=f[d],l<r?o(h,u,l):t[h]||e.cell(h,u)}}o("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],i={};function r(v){const b=ce(Fn(v)),x=b.length;let _=0,E;for(;_<x;++_)i[E=b[_]]||(i[E]=1,t.push(E))}this._dims=ce(e.groupby),this._dnames=this._dims.map(v=>{const b=kt(v);return r(v),n.push(b),b}),this.cellkey=e.key?e.key:nv(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const s=e.fields||[null],o=e.ops||["count"],a=e.aggregate_params||[null],u=e.as||[],l=s.length,c={};let f,d,h,p,g,m,y;for(l!==o.length&&te("Unmatched number of fields and aggregate ops."),y=0;y<l;++y){if(f=s[y],d=o[y],h=a[y]||null,f==null&&d!=="count"&&te("Null aggregate field specified."),g=kt(f),m=p$(d,g,u[y]),n.push(m),d==="count"){this._counts.push(m);continue}p=c[g],p||(r(f),p=c[g]=[],p.field=f,this._measures.push(p)),d!=="count"&&(this._countOnly=!1),p.push(g$(d,h,m))}return this._measures=this._measures.map(v=>y$(v,v.field)),Object.create(null)},cellkey:nv(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const i=this._measures,r=i.length;n.agg=Array(r);for(let s=0;s<r;++s)n.agg[s]=new i[s](n)}return n.store&&(n.data=new I5),n},newtuple(e,t){const n=this._dnames,i=this._dims,r=i.length,s={};for(let o=0;o<r;++o)s[n[o]]=i[o](e);return t?qA(t.tuple,s):We(s)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].add(i[r].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].rem(i[r].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let i=0,r=n.length;i<r;++i)t[n[i]]=e.num;if(!this._countOnly){const i=e.agg;for(let r=0,s=i.length;r<s;++r)i[r].set(t)}return t},changes(e){const t=this._adds,n=this._mods,i=this._prev,r=this._drop,s=e.add,o=e.rem,a=e.mod;let u,l,c,f;if(i)for(l in i)u=i[l],(!r||u.num)&&o.push(u.tuple);for(c=0,f=this._alen;c<f;++c)s.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&r?o:a).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const cX=1e-14;function P5(e){z.call(this,null,e)}P5.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};Q(P5,z,{transform(e,t){const n=e.interval!==!1,i=this._bins(e),r=i.start,s=i.step,o=e.as||["bin0","bin1"],a=o[0],u=o[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(Fn(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=i(c);c[a]=f,c[u]=f==null?null:r+s*(1+(f-r)/s)}:c=>c[a]=i(c)),t.modifies(n?o:a)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=DZ(e),i=n.step;let r=n.start,s=r+Math.ceil((n.stop-r)/i)*i,o,a;(o=e.anchor)!=null&&(a=o-(r+i*Math.floor((o-r)/i)),r+=a,s+=a);const u=function(l){let c=$n(t(l));return c==null?null:c<r?-1/0:c>s?1/0:(c=Math.max(r,Math.min(c,s-i)),r+i*Math.floor(cX+(c-r)/i))};return u.start=r,u.stop=n.stop,u.step=i,this.value=yi(u,Fn(t),e.name||"bin_"+kt(t))}});function v$(e,t,n){const i=e;let r=t||[],s=n||[],o={},a=0;return{add:u=>s.push(u),remove:u=>o[i(u)]=++a,size:()=>r.length,data:(u,l)=>(a&&(r=r.filter(c=>!o[i(c)]),o={},a=0),l&&u&&r.sort(u),s.length&&(r=u?UG(u,r,s.sort(u)):r.concat(s),s=[]),r)}}function z5(e){z.call(this,[],e)}z5.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};Q(z5,z,{transform(e,t){const n=t.fork(t.ALL),i=v$(ge,this.value,n.materialize(n.ADD).add),r=e.sort,s=t.changed()||r&&(e.modified("sort")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(s),this.value=n.source=i.data(hu(r),s),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function b$(e){ut.call(this,null,fX,e)}Q(b$,ut);function fX(e){return this.value&&!e.modified()?this.value:vA(e.fields,e.orders)}function B5(e){z.call(this,null,e)}B5.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function dX(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}Q(B5,z,{transform(e,t){const n=f=>d=>{for(var h=dX(a(d),e.case,s)||[],p,g=0,m=h.length;g<m;++g)o.test(p=h[g])||f(p)},i=this._parameterCheck(e,t),r=this._counts,s=this._match,o=this._stop,a=e.field,u=e.as||["text","count"],l=n(f=>r[f]=1+(r[f]||0)),c=n(f=>r[f]-=1);return i?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,i=this._tuples||(this._tuples={}),r=t[0],s=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);let a,u,l;for(a in n)u=i[a],l=n[a]||0,!u&&l?(i[a]=u=We({}),u[r]=a,u[s]=l,o.add.push(u)):l===0?(u&&o.rem.push(u),n[a]=null,i[a]=null):u[s]!==l&&(u[s]=l,o.mod.push(u));return o.modifies(t)}});function U5(e){z.call(this,null,e)}U5.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};Q(U5,z,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.as||["a","b"],r=i[0],s=i[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let a=this.value;return o?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=hX(a,r,s,e.filter||Qi)):n.mod=a,n.source=this.value,n.modifies(i)}});function hX(e,t,n,i){for(var r=[],s={},o=e.length,a=0,u,l;a<o;++a)for(s[t]=l=e[a],u=0;u<o;++u)s[n]=e[u],i(s)&&(r.push(We(s)),s={},s[t]=l);return r}const G8={kde:n$,mixture:UZ,normal:t$,lognormal:BZ,uniform:jZ},pX="distributions",Y8="function",gX="field";function x$(e,t){const n=e[Y8];pe(G8,n)||te("Unknown distribution function: "+n);const i=G8[n]();for(const r in e)r===gX?i.data((e.from||t()).map(e[r])):r===pX?i[r](e[r].map(s=>x$(s,t))):typeof i[r]===Y8&&i[r](e[r]);return i}function j5(e){z.call(this,null,e)}const _$=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],mX={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:_$},{name:"weights",type:"number",array:!0}]};j5.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:_$.concat(mX)},{name:"as",type:"string",array:!0,default:["value","density"]}]};Q(j5,z,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=x$(e.distribution,yX(t)),r=e.steps||e.minsteps||25,s=e.steps||e.maxsteps||200;let o=e.method||"pdf";o!=="pdf"&&o!=="cdf"&&te("Invalid density method: "+o),!e.extent&&!i.data&&te("Missing density extent parameter."),o=i[o];const a=e.as||["value","density"],u=e.extent||Os(i.data()),l=O5(o,u,r,s).map(c=>{const f={};return f[a[0]]=c[0],f[a[1]]=c[1],We(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function yX(e){return()=>e.materialize(e.SOURCE).source}function w$(e,t){return e?e.map((n,i)=>t[i]||kt(n)):null}function H5(e,t,n){const i=[],r=f=>f(u);let s,o,a,u,l,c;if(t==null)i.push(e.map(n));else for(s={},o=0,a=e.length;o<a;++o)u=e[o],l=t.map(r),c=s[l],c||(s[l]=c=[],c.dims=l,i.push(c)),c.push(n(u));return i}const E$="bin";function q5(e){z.call(this,null,e)}q5.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:E$}]};const vX=(e,t)=>Ag(Os(e,t))/30;Q(q5,z,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,i=H5(t.source,e.groupby,In),r=e.smooth||!1,s=e.field,o=e.step||vX(n,s),a=hu((p,g)=>s(p)-s(g)),u=e.as||E$,l=i.length;let c=1/0,f=-1/0,d=0,h;for(;d<l;++d){const p=i[d].sort(a);h=-1;for(const g of OZ(p,o,r,s))g<c&&(c=g),g>f&&(f=g),p[++h][u]=g}return this.value={start:c,stop:f,step:o},t.reflow(!0).modifies(u)}});function C$(e){ut.call(this,null,bX,e),this.modified(!0)}Q(C$,ut);function bX(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:yi(n=>t(n,e),Fn(t),kt(t))}function V5(e){z.call(this,[void 0,void 0],e)}V5.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};Q(V5,z,{transform(e,t){const n=this.value,i=e.field,r=t.changed()||t.modified(i.fields)||e.modified("field");let s=n[0],o=n[1];if((r||s==null)&&(s=1/0,o=-1/0),t.visit(r?t.SOURCE:t.ADD,a=>{const u=$n(i(a));u!=null&&(u<s&&(s=u),u>o&&(o=u))}),!Number.isFinite(s)||!Number.isFinite(o)){let a=kt(i);a&&(a=` for field "${a}"`),t.dataflow.warn(`Infinite extent${a}: [${s}, ${o}]`),s=o=void 0}this.value=[s,o]}});function W5(e,t){ut.call(this,e),this.parent=t,this.count=0}Q(W5,ut,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function Lg(e){z.call(this,{},e),this._keys=ld();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let i=0,r=t.active;i<r;++i)n(t[i],i,t)}}Q(Lg,z,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,i){const r=this.value;let s=pe(r,e)&&r[e],o,a;return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=i||(a=this._group[e])&&a.tuple,o=n.dataflow,s=new W5(n.fork(n.NO_SOURCE),this),o.add(s).connect(t(o,e,a)),r[e]=s,this.activate(s)),s},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const i=e[n].detachSubflow;i&&i(),delete e[n],++t}if(t){const n=this._targets.filter(i=>i&&i.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,i=e?e.length:0;let r=0;for(;r<i;++r)t[r]=e[r];for(;r<n&&t[r]!=null;++r)t[r]=null;t.active=i},transform(e,t){const n=t.dataflow,i=e.key,r=e.subflow,s=this._keys,o=e.modified("key"),a=u=>this.subflow(u,r,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=ge(u),c=s.get(l);c!==void 0&&(s.delete(l),a(c).rem(u))}),t.visit(t.ADD,u=>{const l=i(u);s.set(ge(u),l),a(l).add(u)}),o||t.modified(i.fields)?t.visit(t.MOD,u=>{const l=ge(u),c=s.get(l),f=i(u);c===f?a(f).mod(u):(s.set(l,f),a(c).rem(u),a(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{a(s.get(ge(u))).mod(u)}),o&&t.visit(t.REFLOW,u=>{const l=ge(u),c=s.get(l),f=i(u);c!==f&&(s.set(l,f),a(c).rem(u),a(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),s.clean()}):s.empty>n.cleanThreshold&&n.runAfter(s.clean),t}});function S$(e){ut.call(this,null,xX,e)}Q(S$,ut);function xX(e){return this.value&&!e.modified()?this.value:V(e.name)?ce(e.name).map(t=>Ji(t)):Ji(e.name,e.as)}function G5(e){z.call(this,ld(),e)}G5.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};Q(G5,z,{transform(e,t){const n=t.dataflow,i=this.value,r=t.fork(),s=r.add,o=r.rem,a=r.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=ge(f);i.has(d)?i.delete(d):o.push(f)}),t.visit(t.ADD,f=>{u(f,e)?s.push(f):i.set(ge(f),1)});function c(f){const d=ge(f),h=u(f,e),p=i.get(d);h&&p?(i.delete(d),s.push(f)):!h&&!p?(i.set(d,1),o.push(f)):l&&h&&!p&&a.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r}});function Y5(e){z.call(this,[],e)}Y5.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};Q(Y5,z,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=w$(i,e.as||[]),s=e.index||null,o=r.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{const u=i.map(p=>p(a)),l=u.reduce((p,g)=>Math.max(p,g.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=$5(a),f=0;f<o;++f)d[r[f]]=(h=u[f][c])==null?null:h;s&&(d[s]=c),n.add.push(d)}}),this.value=n.source=n.add,s&&n.modifies(s),n.modifies(r)}});function Z5(e){z.call(this,[],e)}Z5.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};Q(Z5,z,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=i.map(kt),s=e.as||["key","value"],o=s[0],a=s[1],u=i.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=$5(l),f[o]=r[c],f[a]=i[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(s)}});function X5(e){z.call(this,null,e)}X5.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};Q(X5,z,{transform(e,t){const n=e.expr,i=e.as,r=e.modified(),s=e.initonly?t.ADD:r?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return r&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(s,o=>o[i]=n(o,e))}});function k$(e){z.call(this,[],e)}Q(k$,z,{transform(e,t){const n=t.fork(t.ALL),i=e.generator;let r=this.value,s=e.size-r.length,o,a,u;if(s>0){for(o=[];--s>=0;)o.push(u=We(i(e))),r.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else a=r.slice(0,-s),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,r=r.slice(-s);return n.source=this.value=r,n}});const hh={value:"value",median:xC,mean:WI,min:o2,max:$a},_X=[];function K5(e){z.call(this,[],e)}K5.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function wX(e){var t=e.method||hh.value,n;if(hh[t]==null)te("Unrecognized imputation method: "+t);else return t===hh.value?(n=e.value!==void 0?e.value:0,()=>n):hh[t]}function EX(e){const t=e.field;return n=>n?t(n):NaN}Q(K5,z,{transform(e,t){var n=t.fork(t.ALL),i=wX(e),r=EX(e),s=kt(e.field),o=kt(e.key),a=(e.groupby||[]).map(kt),u=CX(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,p,g,m,y,v,b,x,_;for(m=0,b=u.length;m<b;++m)for(d=u[m],p=d.values,h=NaN,v=0;v<f;++v)if(d[v]==null){for(g=u.domain[v],_={_impute:!0},y=0,x=p.length;y<x;++y)_[a[y]]=p[y];_[o]=g,_[s]=Number.isNaN(h)?h=i(d,r):h,l.push(We(_))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function CX(e,t,n,i){var r=y=>y(m),s=[],o=i?i.slice():[],a={},u={},l,c,f,d,h,p,g,m;for(o.forEach((y,v)=>a[y]=v+1),d=0,g=e.length;d<g;++d)m=e[d],p=n(m),h=a[p]||(a[p]=o.push(p)),c=(l=t?t.map(r):_X)+"",(f=u[c])||(f=u[c]=[],s.push(f),f.values=l),f[h-1]=m;return s.domain=o,s}function J5(e){Mo.call(this,e)}J5.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:pd},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};Q(J5,Mo,{transform(e,t){const n=this,i=e.modified();let r;return n.value&&(i||t.modified(n._inputs,!0))?(r=n.value=i?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(r=n.value=n.value||this.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),n.changes(),t.visit(t.SOURCE,s=>{Ht(s,r[n.cellkey(s)].tuple)}),t.reflow(i).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(e[n]),e[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function Q5(e){z.call(this,null,e)}Q5.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};Q(Q5,z,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=H5(i,e.groupby,e.field),s=(e.groupby||[]).map(kt),o=e.bandwidth,a=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;a!=="pdf"&&a!=="cdf"&&te("Invalid density method: "+a),e.resolve==="shared"&&(c||(c=Os(i,e.field)),f=d=e.steps||d),r.forEach(h=>{const p=n$(h,o)[a],g=e.counts?h.length:1,m=c||Os(h);O5(p,m,f,d).forEach(y=>{const v={};for(let b=0;b<s.length;++b)v[s[b]]=h.dims[b];v[u[0]]=y[0],v[u[1]]=y[1]*g,l.push(We(v))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function A$(e){ut.call(this,null,SX,e)}Q(A$,ut);function SX(e){return this.value&&!e.modified()?this.value:_A(e.fields,e.flat)}function $$(e){z.call(this,[],e),this._pending=null}Q($$,z,{transform(e,t){const n=t.dataflow;return this._pending?Im(this,t,this._pending):kX(e)?t.StopPropagation:e.values?Im(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(r=>(this._pending=ce(r.data),s=>s.touch(this)))}:n.request(e.url,e.format).then(i=>Im(this,t,ce(i.data)))}});function kX(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function Im(e,t,n){n.forEach(We);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function eb(e){z.call(this,{},e)}eb.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};Q(eb,z,{transform(e,t){const n=e.fields,i=e.index,r=e.values,s=e.default==null?null:e.default,o=e.modified(),a=n.length;let u=o?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return r?(d=r.length,a>1&&!c&&te('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*d&&te('The "as" parameter has too few output field names.'),c=c||r.map(kt),f=function(p){for(var g=0,m=0,y,v;g<a;++g)if(v=i.get(n[g](p)),v==null)for(y=0;y<d;++y,++m)p[c[m]]=s;else for(y=0;y<d;++y,++m)p[c[m]]=r[y](v)}):(c||te("Missing output field names."),f=function(p){for(var g=0,m;g<a;++g)m=i.get(n[g](p)),p[c[g]]=m??s}),o?l=t.reflow(!0):(h=n.some(p=>t.modified(p.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function M$(e){ut.call(this,null,AX,e)}Q(M$,ut);function AX(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let i=1/0,r=-1/0,s,o;for(s=0;s<n;++s)o=t[s],o[0]<i&&(i=o[0]),o[1]>r&&(r=o[1]);return[i,r]}function T$(e){ut.call(this,null,$X,e)}Q(T$,ut);function $X(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function F$(e){z.call(this,null,e)}Q(F$,z,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function tb(e){Mo.call(this,e)}tb.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:pd,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};Q(tb,Mo,{_transform:Mo.prototype.transform,transform(e,t){return this._transform(MX(e,t),t)}});function MX(e,t){const n=e.field,i=e.value,r=(e.op==="count"?"__count__":e.op)||"sum",s=Fn(n).concat(Fn(i)),o=FX(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:o.map(()=>r),fields:o.map(a=>TX(a,n,i,s)),as:o.map(a=>a+""),modified:e.modified.bind(e)}}function TX(e,t,n,i){return yi(r=>t(r)===e?n(r):NaN,i,e+"")}function FX(e,t,n){const i={},r=[];return n.visit(n.SOURCE,s=>{const o=e(s);i[o]||(i[o]=1,r.push(o))}),r.sort(kg),t?r.slice(0,t):r}function L$(e){Lg.call(this,e)}Q(L$,Lg,{transform(e,t){const n=e.subflow,i=e.field,r=s=>this.subflow(ge(s),n,t,s);return(e.modified("field")||i&&t.modified(Fn(i)))&&te("PreFacet does not support field modification."),this.initTargets(),i?(t.visit(t.MOD,s=>{const o=r(s);i(s).forEach(a=>o.mod(a))}),t.visit(t.ADD,s=>{const o=r(s);i(s).forEach(a=>o.add(We(a)))}),t.visit(t.REM,s=>{const o=r(s);i(s).forEach(a=>o.rem(a))})):(t.visit(t.MOD,s=>r(s).mod(s)),t.visit(t.ADD,s=>r(s).add(s)),t.visit(t.REM,s=>r(s).rem(s))),t.clean()&&t.runAfter(()=>this.clean()),t}});function nb(e){z.call(this,null,e)}nb.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};Q(nb,z,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=w$(e.fields,e.as||[]),s=i?(a,u)=>LX(a,u,i,r):Tg;let o;return this.value?o=this.value:(t=t.addAll(),o=this.value={}),t.visit(t.REM,a=>{const u=ge(a);n.rem.push(o[u]),o[u]=null}),t.visit(t.ADD,a=>{const u=s(a,We({}));o[ge(a)]=u,n.add.push(u)}),t.visit(t.MOD,a=>{n.mod.push(s(a,o[ge(a)]))}),n}});function LX(e,t,n,i){for(let r=0,s=n.length;r<s;++r)t[i[r]]=n[r](e);return t}function N$(e){z.call(this,null,e)}Q(N$,z,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function ib(e){z.call(this,null,e)}ib.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const NX=1e-14;Q(ib,z,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const r=t.materialize(t.SOURCE).source,s=H5(r,e.groupby,e.field),o=(e.groupby||[]).map(kt),a=[],u=e.step||.01,l=e.probs||li(u/2,1-NX,u),c=l.length;return s.forEach(f=>{const d=XA(f,l);for(let h=0;h<c;++h){const p={};for(let g=0;g<o.length;++g)p[o[g]]=f.dims[g];p[i[0]]=l[h],p[i[1]]=d[h],a.push(We(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}});function D$(e){z.call(this,null,e)}Q(D$,z,{transform(e,t){let n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,r=>{const s=ge(r);n.rem.push(i[s]),i[s]=null}),t.visit(t.ADD,r=>{const s=$5(r);i[ge(r)]=s,n.add.push(s)}),t.visit(t.MOD,r=>{const s=i[ge(r)];for(const o in r)s[o]=r[o],n.modifies(o);n.mod.push(s)})),n}});function rb(e){z.call(this,[],e),this.count=0}rb.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};Q(rb,z,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.modified("size"),r=e.size,s=this.value.reduce((c,f)=>(c[ge(f)]=1,c),{});let o=this.value,a=this.count,u=0;function l(c){let f,d;o.length<r?o.push(c):(d=~~((a+1)*Ps()),d<o.length&&d>=u&&(f=o[d],s[ge(f)]&&n.rem.push(f),o[d]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{const f=ge(c);s[f]&&(s[f]=-1,n.rem.push(c)),--a}),o=o.filter(c=>s[ge(c)]!==-1)),(t.rem.length||i)&&o.length<r&&t.source&&(u=a=o.length,t.visit(t.SOURCE,c=>{s[ge(c)]||l(c)}),u=-1),i&&o.length>r){const c=o.length-r;for(let f=0;f<c;++f)s[ge(o[f])]=-1,n.rem.push(o[f]);o=o.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{s[ge(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=o.filter(c=>!s[ge(c)])),this.count=a,this.value=n.source=o,n}});function sb(e){z.call(this,null,e)}sb.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};Q(sb,z,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=li(e.start,e.stop,e.step||1).map(r=>{const s={};return s[i]=r,We(s)}),n.add=t.add.concat(this.value),n}});function R$(e){z.call(this,null,e),this.modified(!0)}Q(R$,z,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function ob(e){z.call(this,null,e)}const O$=["unit0","unit1"];ob.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:kA,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:O$}]};Q(ob,z,{transform(e,t){const n=e.field,i=e.interval!==!1,r=e.timezone==="utc",s=this._floor(e,t),o=(r?fd:cd)(s.unit).offset,a=e.as||O$,u=a[0],l=a[1],c=s.step;let f=s.start||1/0,d=s.stop||-1/0,h=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(Fn(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,p=>{const g=n(p);let m,y;g==null?(p[u]=null,i&&(p[l]=null)):(p[u]=m=y=s(g),i&&(p[l]=y=o(m,c)),m<f&&(f=m),y>d&&(d=y))}),s.start=f,s.stop=d,t.modifies(i?a:u)},_floor(e,t){const n=e.timezone==="utc",{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:EY({extent:e.extent||Os(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),s=AA(i),o=this.value||{},a=(n?hY:cY)(s,r);return a.unit=Xe(s),a.units=s,a.step=r,a.start=o.start,a.stop=o.stop,this.value=a}});function I$(e){z.call(this,ld(),e)}Q(I$,z,{transform(e,t){const n=t.dataflow,i=e.field,r=this.value,s=a=>r.set(i(a),a);let o=!0;return e.modified("field")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,s)):t.changed()?(t.visit(t.REM,a=>r.delete(i(a))),t.visit(t.ADD,s)):o=!1,this.modified(o),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()}});function P$(e){z.call(this,null,e)}Q(P$,z,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(hu(e.sort)):t.source).map(e.field))}});function DX(e,t,n,i){const r=Rf[e](t,n);return{init:r.init||ga,update:function(s,o){o[i]=r.next(s)}}}const Rf={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e}}},percent_rank:function(){const e=Rf.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,i=t.compare;let r=t.index;if(e<r){for(;r+1<n.length&&!i(n[r],n[r+1]);)++r;e=r}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||te("ntile num must be greater than zero.");const n=Rf.cume_dist(),i=n.next;return{init:n.init,next:r=>Math.ceil(t*i(r))}},lag:function(e,t){return t=+t||1,{next:n=>{const i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||te("nth_value nth must be greater than zero."),{next:n=>{const i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const i=e(n.data[n.index]);return i!=null?t=i:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{const r=i.data;return i.index<=n?t:(n=RX(e,r,i.index))<0?(n=r.length,t=null):t=e(r[n])}}}};function RX(e,t,n){for(let i=t.length;n<i;++n)if(e(t[n])!=null)return n;return-1}const OX=Object.keys(Rf);function z$(e){const t=ce(e.ops),n=ce(e.fields),i=ce(e.params),r=ce(e.aggregate_params),s=ce(e.as),o=this.outputs=[],a=this.windows=[],u={},l={},c=[],f=[];let d=!0;function h(p){ce(Fn(p)).forEach(g=>u[g]=1)}h(e.sort),t.forEach((p,g)=>{const m=n[g],y=i[g],v=r[g]||null,b=kt(m),x=p$(p,b,s[g]);if(h(m),o.push(x),pe(Rf,p))a.push(DX(p,m,y,x));else{if(m==null&&p!=="count"&&te("Null aggregate field specified."),p==="count"){c.push(x);return}d=!1;let _=l[b];_||(_=l[b]=[],_.field=m,f.push(_)),_.push(g$(p,v,x))}}),(c.length||f.length)&&(this.cell=IX(f,c,d)),this.inputs=Object.keys(u)}const B$=z$.prototype;B$.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};B$.update=function(e,t){const n=this.cell,i=this.windows,r=e.data,s=i&&i.length;let o;if(n){for(o=e.p0;o<e.i0;++o)n.rem(r[o]);for(o=e.p1;o<e.i1;++o)n.add(r[o]);n.set(t)}for(o=0;o<s;++o)i[o].update(e,t)};function IX(e,t,n){e=e.map(u=>y$(u,u.field));const i={num:0,agg:null,store:!1,count:t};if(!n)for(var r=e.length,s=i.agg=Array(r),o=0;o<r;++o)s[o]=new e[o](i);if(i.store)var a=i.data=new I5;return i.add=function(u){if(i.num+=1,!n){a&&a.add(u);for(let l=0;l<r;++l)s[l].add(s[l].get(u),u)}},i.rem=function(u){if(i.num-=1,!n){a&&a.rem(u);for(let l=0;l<r;++l)s[l].rem(s[l].get(u),u)}},i.set=function(u){let l,c;for(a&&a.values(),l=0,c=t.length;l<c;++l)u[t[l]]=i.num;if(!n)for(l=0,c=s.length;l<c;++l)s[l].set(u)},i.init=function(){i.num=0,a&&a.reset();for(let u=0;u<r;++u)s[u].init()},i}function ab(e){z.call(this,{},e),this._mlen=0,this._mods=[]}ab.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:OX.concat(pd)},{name:"params",type:"number",null:!0,array:!0},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};Q(ab,z,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=hu(e.sort),r=nv(e.groupby),s=a=>this.group(r(a));let o=this.state;(!o||n)&&(o=this.state=new z$(e)),n||t.modified(o.inputs)?(this.value={},t.visit(t.SOURCE,a=>s(a).add(a))):(t.visit(t.REM,a=>s(a).remove(a)),t.visit(t.ADD,a=>s(a).add(a)));for(let a=0,u=this._mlen;a<u;++a)PX(this._mods[a],o,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(o.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=v$(ge),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function PX(e,t,n,i){const r=i.sort,s=r&&!i.ignorePeers,o=i.frame||[null,0],a=e.data(n),u=a.length,l=s?Nl(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:r||Pn(-1)};t.init();for(let f=0;f<u;++f)zX(c,o,f,u),s&&BX(c,l),t.update(c,a[f])}function zX(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function BX(e,t){const n=e.i0,i=e.i1-1,r=e.compare,s=e.data,o=s.length-1;n>0&&!r(s[n],s[n-1])&&(e.i0=t.left(s,s[n])),i<o&&!r(s[i],s[i+1])&&(e.i1=t.right(s,s[i]))}const UX=Object.freeze(Object.defineProperty({__proto__:null,aggregate:Mo,bin:P5,collect:z5,compare:b$,countpattern:B5,cross:U5,density:j5,dotbin:q5,expression:C$,extent:V5,facet:Lg,field:S$,filter:G5,flatten:Y5,fold:Z5,formula:X5,generate:k$,impute:K5,joinaggregate:J5,kde:Q5,key:A$,load:$$,lookup:eb,multiextent:M$,multivalues:T$,params:F$,pivot:tb,prefacet:L$,project:nb,proxy:N$,quantile:ib,relay:D$,sample:rb,sequence:sb,sieve:R$,subflow:W5,timeunit:ob,tupleindex:I$,values:P$,window:ab},Symbol.toStringTag,{value:"Module"}));function _o(e,t){if(typeof document<"u"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const jX=()=>typeof Image<"u"?Image:null;function ub(e,t,n){const i=e-t+n*2;return e?i>0?i:1:0}const HX="identity",hl="linear",zs="log",gd="pow",md="sqrt",Ng="symlog",Ga="time",Ya="utc",Lr="sequential",Ul="diverging",Of="quantile",Dg="quantize",Rg="threshold",lb="ordinal",iv="point",U$="band",cb="bin-ordinal",Rt="continuous",yd="discrete",vd="discretizing",Di="interpolating",fb="temporal";function qX(e){return function(t){let n=t[0],i=t[1],r;return i<n&&(r=n,n=i,i=r),[e.invert(n),e.invert(i)]}}function VX(e){return function(t){const n=e.range();let i=t[0],r=t[1],s=-1,o,a,u,l;for(r<i&&(a=i,i=r,r=a),u=0,l=n.length;u<l;++u)n[u]>=i&&n[u]<=r&&(s<0&&(s=u),o=u);if(!(s<0))return i=e.invertExtent(n[s]),r=e.invertExtent(n[o]),[i[0]===void 0?i[1]:i[0],r[1]===void 0?r[0]:r[1]]}}function db(){const e=o5().unknown(void 0),t=e.domain,n=e.range;let i=[0,1],r,s,o=!1,a=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=i[1]<i[0],h=i[1-d],p=ub(f,a,u);let g=i[d-0];r=(h-g)/(p||1),o&&(r=Math.floor(r)),g+=(h-g-r*(f-a))*l,s=r*(1-a),o&&(g=Math.round(g),s=Math.round(s));const m=li(f).map(y=>g+r*y);return n(d?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(i=[+f[0],+f[1]],c()):i.slice()},e.rangeRound=function(f){return i=[+f[0],+f[1]],o=!0,c()},e.bandwidth=function(){return s},e.step=function(){return r},e.round=function(f){return arguments.length?(o=!!f,c()):o},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),a=u,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=i[1]<i[0],h=d?n().reverse():n(),p=h.length-1;let g=+f[0],m=+f[1],y,v,b;if(!(g!==g||m!==m)&&(m<g&&(b=g,g=m,m=b),!(m<h[0]||g>i[1-d])))return y=Math.max(0,So(h,g)-1),v=g===m?y:So(h,m)-1,g-h[y]>s+1e-10&&++y,d&&(b=y,y=p-v,v=p-b),y>v?void 0:t().slice(y,v+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return db().domain(t()).range(i).round(o).paddingInner(a).paddingOuter(u).align(l)},c()}function j$(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return j$(t())},e}function WX(){return j$(db().paddingInner(1))}var GX=Array.prototype.map;function YX(e){return GX.call(e,$n)}const ZX=Array.prototype.slice;function H$(){let e=[],t=[];function n(i){return i==null||i!==i?void 0:t[(So(e,i)-1)%t.length]}return n.domain=function(i){return arguments.length?(e=YX(i),n):e.slice()},n.range=function(i){return arguments.length?(t=ZX.call(i),n):t.slice()},n.tickFormat=function(i,r){return bk(e[0],Xe(e),i??10,r)},n.copy=function(){return H$().domain(n.domain()).range(n.range())},n}const tp=new Map,q$=Symbol("vega_scale");function V$(e){return e[q$]=!0,e}function Z8(e){return e&&e[q$]===!0}function XX(e,t,n){const i=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?qX(s):s.invertExtent?VX(s):void 0),s.type=e,V$(s)};return i.metadata=Br(ce(n)),i}function He(e,t,n){return arguments.length>1?(tp.set(e,XX(e,t,n)),this):KX(e)?tp.get(e):void 0}He(HX,_k);He(hl,xk,Rt);He(zs,Ek,[Rt,zs]);He(gd,c5,Rt);He(md,oV,Rt);He(Ng,Ck,Rt);He(Ga,_W,[Rt,fb]);He(Ya,wW,[Rt,fb]);He(Lr,g5,[Rt,Di]);He(`${Lr}-${hl}`,g5,[Rt,Di]);He(`${Lr}-${zs}`,Ik,[Rt,Di,zs]);He(`${Lr}-${gd}`,m5,[Rt,Di]);He(`${Lr}-${md}`,EW,[Rt,Di]);He(`${Lr}-${Ng}`,Pk,[Rt,Di]);He(`${Ul}-${hl}`,zk,[Rt,Di]);He(`${Ul}-${zs}`,Bk,[Rt,Di,zs]);He(`${Ul}-${gd}`,y5,[Rt,Di]);He(`${Ul}-${md}`,CW,[Rt,Di]);He(`${Ul}-${Ng}`,Uk,[Rt,Di]);He(Of,Sk,[vd,Of]);He(Dg,kk,vd);He(Rg,Ak,vd);He(cb,H$,[yd,vd]);He(lb,o5,yd);He(U$,db,yd);He(iv,WX,yd);function KX(e){return tp.has(e)}function jl(e,t){const n=tp.get(e);return n&&n.metadata[t]}function W$(e){return jl(e,Rt)}function G$(e){return jl(e,yd)}function JX(e){return jl(e,vd)}function Y$(e){return jl(e,zs)}function QX(e){return jl(e,fb)}function Z$(e){return jl(e,Di)}const eK=["clamp","base","constant","exponent"];function tK(e,t){const n=t[0],i=Xe(t)-n;return function(r){return e(n+r*i)}}function hb(e,t,n){return U3(K$(t||"rgb",n),e)}function nK(e,t){const n=new Array(t),i=t+1;for(let r=0;r<t;)n[r]=e(++r/i);return n}function X$(e,t,n){const i=n-t;let r,s,o;return!i||!Number.isFinite(i)?Pn(.5):(r=(s=e.type).indexOf("-"),s=r<0?s:s.slice(r+1),o=He(s)().domain([t,n]).range([0,1]),eK.forEach(a=>e[a]?o[a](e[a]()):0),o)}function K$(e,t){const n=mB[iK(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function iK(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const rK={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},sK={accent:kW,category10:SW,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:AW,observable10:$W,paired:MW,pastel1:TW,pastel2:FW,set1:LW,set2:NW,set3:DW,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"};function J$(e){if(V(e))return e;const t=e.length/6|0,n=new Array(t);for(let i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}function Q$(e,t){for(const n in e)eM(n,t(e[n]))}const X8={};Q$(sK,J$);Q$(rK,e=>hb(J$(e)));function eM(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(X8[e]=t,this):X8[e]}const Hh="symbol",oK="discrete",aK="gradient",uK=e=>V(e)?e.map(t=>String(t)):String(e),lK=(e,t)=>e[1]-t[1],cK=(e,t)=>t[1]-e[1];function pb(e,t,n){let i;return Ke(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(Ag(e.domain())/n||1)+1))),_e(t)&&(i=t.step,t=t.interval),le(t)&&(t=e.type===Ga?cd(t):e.type==Ya?fd(t):te("Only time and utc scales accept interval strings."),i&&(t=t.every(i))),t}function tM(e,t,n){let i=e.range(),r=i[0],s=Xe(i),o=lK;if(r>s&&(i=s,s=r,r=i,o=cK),r=Math.floor(r),s=Math.ceil(s),t=t.map(a=>[a,e(a)]).filter(a=>r<=a[1]&&a[1]<=s).sort(o).map(a=>a[0]),n>0&&t.length>1){const a=[t[0],Xe(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=a)}return t}function gb(e,t){return e.bins?tM(e,e.bins,t):e.ticks?e.ticks(t):e.domain()}function nM(e,t,n,i,r,s){const o=t.type;let a=uK;if(o===Ga||r===Ga)a=e.timeFormat(i);else if(o===Ya||r===Ya)a=e.utcFormat(i);else if(Y$(o)){const u=e.formatFloat(i);if(s||t.bins)a=u;else{const l=iM(t,n,!1);a=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();a=e.formatSpan(u[0],u[u.length-1],n,i)}else i&&(a=e.format(i));return a}function iM(e,t,n){const i=gb(e,t),r=e.base(),s=Math.log(r),o=Math.max(1,r*t/i.length),a=u=>{let l=u/Math.pow(r,Math.round(Math.log(u)/s));return l*r<r-.5&&(l*=r),l<=o};return n?i.filter(a):a}const rv={[Of]:"quantiles",[Dg]:"thresholds",[Rg]:"domain"},rM={[Of]:"quantiles",[Dg]:"domain"};function sM(e,t){return e.bins?hK(e.bins):e.type===zs?iM(e,t,!0):rv[e.type]?dK(e[rv[e.type]]()):gb(e,t)}function fK(e,t,n){const i=t[rM[t.type]](),r=i.length;let s=r>1?i[1]-i[0]:i[0],o;for(o=1;o<r;++o)s=Math.min(s,i[o]-i[o-1]);return e.formatSpan(0,s,3*10,n)}function dK(e){const t=[-1/0].concat(e);return t.max=1/0,t}function hK(e){const t=e.slice(0,-1);return t.max=Xe(e),t}const pK=e=>rv[e.type]||e.bins;function oM(e,t,n,i,r,s,o){const a=rM[t.type]&&s!==Ga&&s!==Ya?fK(e,t,r):nM(e,t,n,r,s,o);return i===Hh&&pK(t)?gK(a):i===oK?mK(a):yK(a)}const gK=e=>(t,n,i)=>{const r=K8(i[n+1],K8(i.max,1/0)),s=J8(t,e),o=J8(r,e);return s&&o?s+" – "+o:o?"< "+o:"≥ "+s},K8=(e,t)=>e??t,mK=e=>(t,n)=>n?e(t):null,yK=e=>t=>e(t),J8=(e,t)=>Number.isFinite(e)?t(e):null;function vK(e){const t=e.domain(),n=t.length-1;let i=+t[0],r=+Xe(t),s=r-i;if(e.type===Rg){const o=n?s/n:.1;i-=o,r+=o,s=r-i}return o=>(o-i)/s}function bK(e,t,n,i){const r=i||t.type;return le(n)&&QX(r)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&r===Ga?e.timeFormat("%A, %d %B %Y, %X"):!n&&r===Ya?e.utcFormat("%A, %d %B %Y, %X UTC"):oM(e,t,5,null,n,i,!0)}function aM(e,t,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=bK(e,t,n.format,n.formatType);if(JX(t.type)){const s=sM(t).slice(1).map(r),o=s.length;return`${o} boundar${o===1?"y":"ies"}: ${s.join(", ")}`}else if(G$(t.type)){const s=t.domain(),o=s.length,a=o>i?s.slice(0,i-2).map(r).join(", ")+", ending with "+s.slice(-1).map(r):s.map(r).join(", ");return`${o} value${o===1?"":"s"}: ${a}`}else{const s=t.domain();return`values from ${r(s[0])} to ${r(Xe(s))}`}}let xK=0;const np="p_";function mb(e){return e&&e.gradient}function uM(e,t,n){const i=e.gradient;let r=e.id,s=i==="radial"?np:"";return r||(r=e.id="gradient_"+xK++,i==="radial"?(e.x1=yr(e.x1,.5),e.y1=yr(e.y1,.5),e.r1=yr(e.r1,0),e.x2=yr(e.x2,.5),e.y2=yr(e.y2,.5),e.r2=yr(e.r2,.5),s=np):(e.x1=yr(e.x1,0),e.y1=yr(e.y1,0),e.x2=yr(e.x2,1),e.y2=yr(e.y2,0))),t[r]=e,"url("+(n||"")+"#"+s+r+")"}function yr(e,t){return e??t}function _K(e,t){var n=[],i;return i={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(r,s){return n.push({offset:r,color:s}),i}}}const Q8={basis:{curve:WW},"basis-closed":{curve:GW},"basis-open":{curve:YW},bundle:{curve:ZW,tension:"beta",value:.85},cardinal:{curve:XW,tension:"tension",value:0},"cardinal-open":{curve:JW,tension:"tension",value:0},"cardinal-closed":{curve:KW,tension:"tension",value:0},"catmull-rom":{curve:QW,tension:"alpha",value:.5},"catmull-rom-closed":{curve:eG,tension:"alpha",value:.5},"catmull-rom-open":{curve:tG,tension:"alpha",value:.5},linear:{curve:v5},"linear-closed":{curve:nG},monotone:{horizontal:rG,vertical:iG},natural:{curve:sG},step:{curve:oG},"step-after":{curve:uG},"step-before":{curve:aG}};function lM(e,t,n){var i=pe(Q8,e)&&Q8[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&n!=null&&(r=r[i.tension](n))),r}const wK={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},EK=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,CK=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,SK=/^((\s+,?\s*)|(,\s*))/,kK=/^[01]/;function yb(e){const t=[];return(e.match(EK)||[]).forEach(i=>{let r=i[0];const s=r.toLowerCase(),o=wK[s],a=AK(s,o,i.slice(1).trim()),u=a.length;if(u<o||u&&u%o!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([r,...a.slice(0,o)]),u!==o){s==="m"&&(r=r==="M"?"L":"l");for(let l=o;l<u;l+=o)t.push([r,...a.slice(l,l+o)])}}),t}function AK(e,t,n){const i=[];for(let r=0;t&&r<n.length;)for(let s=0;s<t;++s){const o=e==="a"&&(s===3||s===4)?kK:CK,a=n.slice(r).match(o);if(a===null)throw Error("Invalid SVG path, incorrect parameter type");r+=a[0].length,i.push(+a[0]);const u=n.slice(r).match(SK);u!==null&&(r+=u[0].length)}return i}const To=Math.PI/180,$K=1e-14,ya=Math.PI/2,kr=Math.PI*2,Tu=Math.sqrt(3)/2;var Pm={},zm={},cM=[].join;function MK(e,t,n,i,r,s,o,a,u){const l=cM.call(arguments);if(Pm[l])return Pm[l];const c=o*To,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),i=Math.abs(i);const h=d*(a-e)*.5+f*(u-t)*.5,p=d*(u-t)*.5-f*(a-e)*.5;let g=h*h/(n*n)+p*p/(i*i);g>1&&(g=Math.sqrt(g),n*=g,i*=g);const m=d/n,y=f/n,v=-f/i,b=d/i,x=m*a+y*u,_=v*a+b*u,E=m*e+y*t,w=v*e+b*t;let $=1/((E-x)*(E-x)+(w-_)*(w-_))-.25;$<0&&($=0);let F=Math.sqrt($);s==r&&(F=-F);const T=.5*(x+E)-F*(w-_),P=.5*(_+w)+F*(E-x),R=Math.atan2(_-P,x-T);let A=Math.atan2(w-P,E-T)-R;A<0&&s===1?A+=kr:A>0&&s===0&&(A-=kr);const M=Math.ceil(Math.abs(A/(ya+.001))),L=[];for(let D=0;D<M;++D){const O=R+D*A/M,j=R+(D+1)*A/M;L[D]=[T,P,O,j,n,i,f,d]}return Pm[l]=L}function TK(e){const t=cM.call(e);if(zm[t])return zm[t];var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],u=e[6],l=e[7];const c=l*o,f=-u*a,d=u*o,h=l*a,p=Math.cos(r),g=Math.sin(r),m=Math.cos(s),y=Math.sin(s),v=.5*(s-r),b=Math.sin(v*.5),x=8/3*b*b/Math.sin(v),_=n+p-x*g,E=i+g+x*p,w=n+m,S=i+y,$=w+x*y,F=S-x*m;return zm[t]=[c*_+f*E,d*_+h*E,c*$+f*F,d*$+h*F,c*w+f*S,d*w+h*S]}const vi=["l",0,0,0,0,0,0,0];function FK(e,t,n){const i=vi[0]=e[0];if(i==="a"||i==="A")vi[1]=t*e[1],vi[2]=n*e[2],vi[3]=e[3],vi[4]=e[4],vi[5]=e[5],vi[6]=t*e[6],vi[7]=n*e[7];else if(i==="h"||i==="H")vi[1]=t*e[1];else if(i==="v"||i==="V")vi[1]=n*e[1];else for(var r=1,s=e.length;r<s;++r)vi[r]=(r%2==1?t:n)*e[r];return vi}function ip(e,t,n,i,r,s){var o,a=null,u=0,l=0,c=0,f=0,d,h,p,g,m=0,y=0;n==null&&(n=0),i==null&&(i=0),r==null&&(r=1),s==null&&(s=r),e.beginPath&&e.beginPath();for(var v=0,b=t.length;v<b;++v){switch(o=t[v],(r!==1||s!==1)&&(o=FK(o,r,s)),o[0]){case"l":u+=o[1],l+=o[2],e.lineTo(u+n,l+i);break;case"L":u=o[1],l=o[2],e.lineTo(u+n,l+i);break;case"h":u+=o[1],e.lineTo(u+n,l+i);break;case"H":u=o[1],e.lineTo(u+n,l+i);break;case"v":l+=o[1],e.lineTo(u+n,l+i);break;case"V":l=o[1],e.lineTo(u+n,l+i);break;case"m":u+=o[1],l+=o[2],m=u,y=l,e.moveTo(u+n,l+i);break;case"M":u=o[1],l=o[2],m=u,y=l,e.moveTo(u+n,l+i);break;case"c":d=u+o[5],h=l+o[6],c=u+o[3],f=l+o[4],e.bezierCurveTo(u+o[1]+n,l+o[2]+i,c+n,f+i,d+n,h+i),u=d,l=h;break;case"C":u=o[5],l=o[6],c=o[3],f=o[4],e.bezierCurveTo(o[1]+n,o[2]+i,c+n,f+i,u+n,l+i);break;case"s":d=u+o[3],h=l+o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,u+o[1]+n,l+o[2]+i,d+n,h+i),c=u+o[1],f=l+o[2],u=d,l=h;break;case"S":d=o[3],h=o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,o[1]+n,o[2]+i,d+n,h+i),u=d,l=h,c=o[1],f=o[2];break;case"q":d=u+o[3],h=l+o[4],c=u+o[1],f=l+o[2],e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h;break;case"Q":d=o[3],h=o[4],e.quadraticCurveTo(o[1]+n,o[2]+i,d+n,h+i),u=d,l=h,c=o[1],f=o[2];break;case"t":d=u+o[1],h=l+o[2],a[0].match(/[QqTt]/)===null?(c=u,f=l):a[0]==="t"?(c=2*u-p,f=2*l-g):a[0]==="q"&&(c=2*u-c,f=2*l-f),p=c,g=f,e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h,c=u+o[1],f=l+o[2];break;case"T":d=o[1],h=o[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h;break;case"a":e_(e,u+n,l+i,[o[1],o[2],o[3],o[4],o[5],o[6]+u+n,o[7]+l+i]),u+=o[6],l+=o[7];break;case"A":e_(e,u+n,l+i,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+i]),u=o[6],l=o[7];break;case"z":case"Z":u=m,l=y,e.closePath();break}a=o}}function e_(e,t,n,i){const r=MK(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n);for(let s=0;s<r.length;++s){const o=TK(r[s]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const t_=.5773502691896257,n_={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,kr)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,s=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-s),e.lineTo(r,-s),e.lineTo(0,-n),e.lineTo(-r,-s),e.lineTo(-i,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=Tu*n,r=i-n*t_,s=n/4;e.moveTo(0,-i-r),e.lineTo(-s,i-r),e.lineTo(s,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=Tu*n,r=i-n*t_;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Tu*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Tu*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Tu*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Tu*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function LK(e){return pe(n_,e)?n_[e]:NK(e)}var Bm={};function NK(e){if(!pe(Bm,e)){const t=yb(e);Bm[e]={draw:function(n,i){ip(n,t,0,0,Math.sqrt(i)/2)}}}return Bm[e]}const Qs=.448084975506;function DK(e){return e.x}function RK(e){return e.y}function OK(e){return e.width}function IK(e){return e.height}function as(e){return typeof e=="function"?e:()=>+e}function ph(e,t,n){return Math.max(t,Math.min(e,n))}function PK(){var e=DK,t=RK,n=OK,i=IK,r=as(0),s=r,o=r,a=r,u=null;function l(c,f,d){var h,p=f??+e.call(this,c),g=d??+t.call(this,c),m=+n.call(this,c),y=+i.call(this,c),v=Math.min(m,y)/2,b=ph(+r.call(this,c),0,v),x=ph(+s.call(this,c),0,v),_=ph(+o.call(this,c),0,v),E=ph(+a.call(this,c),0,v);if(u||(u=h=W3()),b<=0&&x<=0&&_<=0&&E<=0)u.rect(p,g,m,y);else{var w=p+m,S=g+y;u.moveTo(p+b,g),u.lineTo(w-x,g),u.bezierCurveTo(w-Qs*x,g,w,g+Qs*x,w,g+x),u.lineTo(w,S-E),u.bezierCurveTo(w,S-Qs*E,w-Qs*E,S,w-E,S),u.lineTo(p+_,S),u.bezierCurveTo(p+Qs*_,S,p,S-Qs*_,p,S-_),u.lineTo(p,g+b),u.bezierCurveTo(p,g+Qs*b,p+Qs*b,g,p+b,g),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=as(c),l):e},l.y=function(c){return arguments.length?(t=as(c),l):t},l.width=function(c){return arguments.length?(n=as(c),l):n},l.height=function(c){return arguments.length?(i=as(c),l):i},l.cornerRadius=function(c,f,d,h){return arguments.length?(r=as(c),s=f!=null?as(f):r,a=d!=null?as(d):r,o=h!=null?as(h):s,l):r},l.context=function(c){return arguments.length?(u=c??null,l):u},l}function zK(){var e,t,n,i,r=null,s,o,a,u;function l(f,d,h){const p=h/2;if(s){var g=a-d,m=f-o;if(g||m){var y=Math.hypot(g,m),v=(g/=y)*u,b=(m/=y)*u,x=Math.atan2(m,g);r.moveTo(o-v,a-b),r.lineTo(f-g*p,d-m*p),r.arc(f,d,p,x-Math.PI,x),r.lineTo(o+v,a+b),r.arc(o,a,u,x,x+Math.PI)}else r.arc(f,d,p,0,kr);r.closePath()}else s=1;o=f,a=d,u=p}function c(f){var d,h=f.length,p,g=!1,m;for(r==null&&(r=m=W3()),d=0;d<=h;++d)!(d<h&&i(p=f[d],d,f))===g&&(g=!g)&&(s=0),g&&l(+e(p,d,f),+t(p,d,f),+n(p,d,f));if(m)return r=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(i=f,c):i},c.context=function(f){return arguments.length?(f==null?r=null:r=f,c):r},c}function bd(e,t){return e??t}const xd=e=>e.x||0,_d=e=>e.y||0,BK=e=>e.width||0,UK=e=>e.height||0,jK=e=>(e.x||0)+(e.width||0),HK=e=>(e.y||0)+(e.height||0),qK=e=>e.startAngle||0,VK=e=>e.endAngle||0,WK=e=>e.padAngle||0,GK=e=>e.innerRadius||0,YK=e=>e.outerRadius||0,ZK=e=>e.cornerRadius||0,XK=e=>bd(e.cornerRadiusTopLeft,e.cornerRadius)||0,KK=e=>bd(e.cornerRadiusTopRight,e.cornerRadius)||0,JK=e=>bd(e.cornerRadiusBottomRight,e.cornerRadius)||0,QK=e=>bd(e.cornerRadiusBottomLeft,e.cornerRadius)||0,eJ=e=>bd(e.size,64),tJ=e=>e.size||1,Og=e=>e.defined!==!1,nJ=e=>LK(e.shape||"circle"),iJ=HW().startAngle(qK).endAngle(VK).padAngle(WK).innerRadius(GK).outerRadius(YK).cornerRadius(ZK),rJ=Yk().x(xd).y1(_d).y0(HK).defined(Og),sJ=Yk().y(_d).x1(xd).x0(jK).defined(Og),oJ=Gk().x(xd).y(_d).defined(Og),aJ=PK().x(xd).y(_d).width(BK).height(UK).cornerRadius(XK,KK,JK,QK),uJ=VW().type(nJ).size(eJ),lJ=zK().x(xd).y(_d).defined(Og).size(tJ);function vb(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function cJ(e,t){return iJ.context(e)(t)}function fJ(e,t){const n=t[0],i=n.interpolate||"linear";return(n.orient==="horizontal"?sJ:rJ).curve(lM(i,n.orient,n.tension)).context(e)(t)}function dJ(e,t){const n=t[0],i=n.interpolate||"linear";return oJ.curve(lM(i,n.orient,n.tension)).context(e)(t)}function Hl(e,t,n,i){return aJ.context(e)(t,n,i)}function hJ(e,t){return(t.mark.shape||t.shape).context(e)(t)}function pJ(e,t){return uJ.context(e)(t)}function gJ(e,t){return lJ.context(e)(t)}var mJ=1;function bb(e,t,n){var i=t.clip,r=e._defs,s=t.clip_id||(t.clip_id="clip"+mJ++),o=r.clipping[s]||(r.clipping[s]={id:s});return Me(i)?o.path=i(null):vb(n)?o.path=Hl(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+s+")"}function Nt(e){this.clear(),e&&this.union(e)}Nt.prototype={clone(){return new Nt(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:s,y2:o}=this,a=Math.cos(e),u=Math.sin(e),l=t-t*a+n*u,c=n-t*u-n*a;return[a*i-u*r+l,u*i+a*r+c,a*i-u*o+l,u*i+a*o+c,a*s-u*r+l,u*s+a*r+c,a*s-u*o+l,u*s+a*o+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function xb(e){this.mark=e,this.bounds=this.bounds||new Nt}function _b(e){xb.call(this,e),this.items=this.items||[]}Q(_b,xb);class yJ{constructor(t){this._pending=0,this._loader=t||k5()}pending(){return this._pending}sanitizeURL(t){const n=this;return i_(n),n._loader.sanitize(t,{context:"href"}).then(i=>(vc(n),i)).catch(()=>(vc(n),null))}loadImage(t){const n=this,i=jX();return i_(n),n._loader.sanitize(t,{context:"image"}).then(r=>{const s=r.href;if(!s||!i)throw{url:s};const o=new i,a=pe(r,"crossOrigin")?r.crossOrigin:"anonymous";return a!=null&&(o.crossOrigin=a),o.onload=()=>vc(n),o.onerror=()=>vc(n),o.src=s,o}).catch(r=>(vc(n),{complete:!1,width:0,height:0,src:r&&r.url||""}))}ready(){const t=this;return new Promise(n=>{function i(r){t.pending()?setTimeout(()=>{i(!0)},10):n(r)}i(!1)})}}function i_(e){e._pending+=1}function vc(e){e._pending-=1}function Wo(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const i=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(i+(n?vJ(t,i):0))}return e}function vJ(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const bJ=kr-1e-8;let Ig,qh,Vh,Ea,sv,Wh,ov,av;const fo=(e,t)=>Ig.add(e,t),Gh=(e,t)=>fo(qh=e,Vh=t),r_=e=>fo(e,Ig.y1),s_=e=>fo(Ig.x1,e),va=(e,t)=>sv*e+ov*t,ba=(e,t)=>Wh*e+av*t,Um=(e,t)=>fo(va(e,t),ba(e,t)),jm=(e,t)=>Gh(va(e,t),ba(e,t));function Pg(e,t){return Ig=e,t?(Ea=t*To,sv=av=Math.cos(Ea),Wh=Math.sin(Ea),ov=-Wh):(sv=av=1,Ea=Wh=ov=0),xJ}const xJ={beginPath(){},closePath(){},moveTo:jm,lineTo:jm,rect(e,t,n,i){Ea?(Um(e+n,t),Um(e+n,t+i),Um(e,t+i),jm(e,t)):(fo(e+n,t+i),Gh(e,t))},quadraticCurveTo(e,t,n,i){const r=va(e,t),s=ba(e,t),o=va(n,i),a=ba(n,i);o_(qh,r,o,r_),o_(Vh,s,a,s_),Gh(o,a)},bezierCurveTo(e,t,n,i,r,s){const o=va(e,t),a=ba(e,t),u=va(n,i),l=ba(n,i),c=va(r,s),f=ba(r,s);a_(qh,o,u,c,r_),a_(Vh,a,l,f,s_),Gh(c,f)},arc(e,t,n,i,r,s){if(i+=Ea,r+=Ea,qh=n*Math.cos(r)+e,Vh=n*Math.sin(r)+t,Math.abs(r-i)>bJ)fo(e-n,t-n),fo(e+n,t+n);else{const o=l=>fo(n*Math.cos(l)+e,n*Math.sin(l)+t);let a,u;if(o(i),o(r),r!==i)if(i=i%kr,i<0&&(i+=kr),r=r%kr,r<0&&(r+=kr),r<i&&(s=!s,a=i,i=r,r=a),s)for(r-=kr,a=i-i%ya,u=0;u<4&&a>r;++u,a-=ya)o(a);else for(a=i-i%ya+ya,u=0;u<4&&a<r;++u,a=a+ya)o(a)}}};function o_(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function a_(e,t,n,i,r){const s=i-e+3*t-3*n,o=e+n-2*t,a=e-t;let u=0,l=0,c;Math.abs(s)>$K?(c=o*o+a*s,c>=0&&(c=Math.sqrt(c),u=(-o+c)/s,l=(-o-c)/s)):u=.5*a/o,0<u&&u<1&&r(u_(u,e,t,n,i)),0<l&&l<1&&r(u_(l,e,t,n,i))}function u_(e,t,n,i,r){const s=1-e,o=s*s,a=e*e;return o*s*t+3*o*e*n+3*s*a*i+a*e*r}var wo=(wo=_o(1,1))?wo.getContext("2d"):null;const uv=new Nt;function fM(e){return function(t,n){if(!wo)return!0;e(wo,t),uv.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:s,y2:o}=uv;for(let a=r;a<=o;++a)for(let u=i;u<=s;++u)if(wo.isPointInPath(u,a))return!0;return!1}}function dM(e,t){return t.contains(e.x||0,e.y||0)}function hM(e,t){const n=e.x||0,i=e.y||0,r=e.width||0,s=e.height||0;return t.intersects(uv.set(n,i,n+r,i+s))}function _J(e,t){const n=e.x||0,i=e.y||0,r=e.x2!=null?e.x2:n,s=e.y2!=null?e.y2:i;return Uc(t,n,i,r,s)}function Uc(e,t,n,i,r){const{x1:s,y1:o,x2:a,y2:u}=e,l=i-t,c=r-n;let f=0,d=1,h,p,g,m;for(m=0;m<4;++m){if(m===0&&(h=-l,p=-(s-t)),m===1&&(h=l,p=a-t),m===2&&(h=-c,p=-(o-n)),m===3&&(h=c,p=u-n),Math.abs(h)<1e-10&&p<0)return!1;if(g=p/h,h<0){if(g>d)return!1;g>f&&(f=g)}else if(h>0){if(g<f)return!1;g<d&&(d=g)}}return!0}function pl(e,t){e.globalCompositeOperation=t.blend||"source-over"}function Pi(e,t){return e??t}function l_(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}function wJ(e,t,n){const i=n.width(),r=n.height();let s;if(t.gradient==="radial")s=e.createRadialGradient(n.x1+Pi(t.x1,.5)*i,n.y1+Pi(t.y1,.5)*r,Math.max(i,r)*Pi(t.r1,0),n.x1+Pi(t.x2,.5)*i,n.y1+Pi(t.y2,.5)*r,Math.max(i,r)*Pi(t.r2,.5));else{const o=Pi(t.x1,0),a=Pi(t.y1,0),u=Pi(t.x2,1),l=Pi(t.y2,0);if(o===u||a===l||i===r)s=e.createLinearGradient(n.x1+o*i,n.y1+a*r,n.x1+u*i,n.y1+l*r);else{const c=_o(Math.ceil(i),Math.ceil(r)),f=c.getContext("2d");return f.scale(i,r),f.fillStyle=l_(f.createLinearGradient(o,a,u,l),t.stops),f.fillRect(0,0,i,r),e.createPattern(c,"no-repeat")}}return l_(s,t.stops)}function pM(e,t,n){return mb(n)?wJ(e,n,t.bounds):n}function rp(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=pM(e,t,t.fill),!0):!1}var EJ=[];function gl(e,t,n){var i=(i=t.strokeWidth)!=null?i:1;return i<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=pM(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||EJ),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function CJ(e,t){return e.zindex-t.zindex||e.index-t.index}function gM(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],i,r,s;for(r=0,s=t.length;r<s;++r)i=t[r],i.index=r,i.zindex&&n.push(i);return e.zdirty=!1,e.zitems=n.sort(CJ)}function jr(e,t){var n=e.items,i,r;if(!n||!n.length)return;const s=gM(e);if(s&&s.length){for(i=0,r=n.length;i<r;++i)n[i].zindex||t(n[i]);n=s}for(i=0,r=n.length;i<r;++i)t(n[i])}function lv(e,t){var n=e.items,i,r;if(!n||!n.length)return null;const s=gM(e);for(s&&s.length&&(n=s),r=n.length;--r>=0;)if(i=t(n[r]))return i;if(n===s){for(n=e.items,r=n.length;--r>=0;)if(!n[r].zindex&&(i=t(n[r])))return i}return null}function wb(e){return function(t,n,i){jr(n,r=>{(!i||i.intersects(r.bounds))&&mM(e,t,r,r)})}}function SJ(e){return function(t,n,i){n.items.length&&(!i||i.intersects(n.bounds))&&mM(e,t,n.items[0],n.items)}}function mM(e,t,n,i){var r=n.opacity==null?1:n.opacity;r!==0&&(e(t,i)||(pl(t,n),n.fill&&rp(t,n,r)&&t.fill(),n.stroke&&gl(t,n,r)&&t.stroke()))}function zg(e){return e=e||Qi,function(t,n,i,r,s,o){return i*=t.pixelRatio,r*=t.pixelRatio,lv(n,a=>{const u=a.bounds;if(!(u&&!u.contains(s,o)||!u)&&e(t,a,i,r,s,o))return a})}}function wd(e,t){return function(n,i,r,s){var o=Array.isArray(i)?i[0]:i,a=t??o.fill,u=o.stroke&&n.isPointInStroke,l,c;return u&&(l=o.strokeWidth,c=o.strokeCap,n.lineWidth=l??1,n.lineCap=c??"butt"),e(n,i)?!1:a&&n.isPointInPath(r,s)||u&&n.isPointInStroke(r,s)}}function Eb(e){return zg(wd(e))}function Na(e,t){return"translate("+e+","+t+")"}function Cb(e){return"rotate("+e+")"}function kJ(e,t){return"scale("+e+","+t+")"}function yM(e){return Na(e.x||0,e.y||0)}function AJ(e){return Na(e.x||0,e.y||0)+(e.angle?" "+Cb(e.angle):"")}function $J(e){return Na(e.x||0,e.y||0)+(e.angle?" "+Cb(e.angle):"")+(e.scaleX||e.scaleY?" "+kJ(e.scaleX||1,e.scaleY||1):"")}function Sb(e,t,n){function i(o,a){o("transform",AJ(a)),o("d",t(null,a))}function r(o,a){return t(Pg(o,a.angle),a),Wo(o,a).translate(a.x||0,a.y||0)}function s(o,a){var u=a.x||0,l=a.y||0,c=a.angle||0;o.translate(u,l),c&&o.rotate(c*=To),o.beginPath(),t(o,a),c&&o.rotate(-c),o.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:i,bound:r,draw:wb(s),pick:Eb(s),isect:n||fM(s)}}var MJ=Sb("arc",cJ);function TJ(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],i=e[0].orient==="horizontal"?"y":"x",r=e.length,s=1/0,o,a;--r>=0;)e[r].defined!==!1&&(a=Math.abs(e[r][i]-n),a<s&&(s=a,o=e[r]));return o}function FJ(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),i=e.length,r,s,o;--i>=0;)if(e[i].defined!==!1&&(r=e[i].x-t[0],s=e[i].y-t[1],o=r*r+s*s,o<n))return e[i];return null}function LJ(e,t){for(var n=e.length,i,r,s;--n>=0;)if(e[n].defined!==!1&&(i=e[n].x-t[0],r=e[n].y-t[1],s=i*i+r*r,i=e[n].size||1,s<i*i))return e[n];return null}function kb(e,t,n){function i(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function r(u,l){var c=l.items;return c.length===0?u:(t(Pg(u),c),Wo(u,c[0]))}function s(u,l){u.beginPath(),t(u,l)}const o=wd(s);function a(u,l,c,f,d,h){var p=l.items,g=l.bounds;return!p||!p.length||g&&!g.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,o(u,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:i,bound:r,draw:SJ(s),pick:a,isect:dM,tip:n}}var NJ=kb("area",fJ,TJ);function DJ(e,t){var n=t.clip;e.save(),Me(n)?(e.beginPath(),n(e),e.clip()):vM(e,t.group)}function vM(e,t){e.beginPath(),vb(t)?Hl(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function bM(e){const t=Pi(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function RJ(e,t){e("transform",yM(t))}function xM(e,t){const n=bM(t);e("d",Hl(null,t,n,n))}function OJ(e,t){e("class","background"),e("aria-hidden",!0),xM(e,t)}function IJ(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?xM(e,t):e("d","")}function PJ(e,t,n){const i=t.clip?bb(n,t,t):null;e("clip-path",i)}function zJ(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let r=0;r<i;++r)e.union(n[r].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Wo(e,t),e.translate(t.x||0,t.y||0)}function If(e,t,n,i){const r=bM(t);e.beginPath(),Hl(e,t,(n||0)+r,(i||0)+r)}const BJ=wd(If),UJ=wd(If,!1),jJ=wd(If,!0);function HJ(e,t,n,i){jr(t,r=>{const s=r.x||0,o=r.y||0,a=r.strokeForeground,u=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&u&&(If(e,r,s,o),pl(e,r),r.fill&&rp(e,r,u)&&e.fill(),r.stroke&&!a&&gl(e,r,u)&&e.stroke()),e.save(),e.translate(s,o),r.clip&&vM(e,r),n&&n.translate(-s,-o),jr(r,l=>{(l.marktype==="group"||i==null||i.includes(l.marktype))&&this.draw(e,l,n,i)}),n&&n.translate(s,o),e.restore(),a&&r.stroke&&u&&(If(e,r,s,o),pl(e,r),gl(e,r,u)&&e.stroke())})}function qJ(e,t,n,i,r,s){if(t.bounds&&!t.bounds.contains(r,s)||!t.items)return null;const o=n*e.pixelRatio,a=i*e.pixelRatio;return lv(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(r,s))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),p=f+(u.height||0),g=u.clip;if(g&&(r<c||r>h||s<f||s>p))return;if(e.save(),e.translate(c,f),c=r-c,f=s-f,g&&vb(u)&&!jJ(e,u,o,a))return e.restore(),null;const m=u.strokeForeground,y=t.interactive!==!1;return y&&m&&u.stroke&&UJ(e,u,o,a)?(e.restore(),u):(l=lv(u,v=>VJ(v,c,f)?this.pick(v,n,i,c,f):null),!l&&y&&(u.fill||!m&&u.stroke)&&BJ(e,u,o,a)&&(l=u),e.restore(),l||null)})}function VJ(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var WJ={type:"group",tag:"g",nested:!1,attr:RJ,bound:zJ,draw:HJ,pick:qJ,isect:hM,content:PJ,background:OJ,foreground:IJ},Pf={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Ab(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(i=>{e.image=i,e.image.url=e.url})),n}function $b(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function Mb(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function Bg(e,t){return e==="center"?t/2:e==="right"?t:0}function Ug(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function GJ(e,t,n){const i=Ab(t,n),r=$b(t,i),s=Mb(t,i),o=(t.x||0)-Bg(t.align,r),a=(t.y||0)-Ug(t.baseline,s),u=!i.src&&i.toDataURL?i.toDataURL():i.src||"";e("href",u,Pf["xmlns:xlink"],"xlink:href"),e("transform",Na(o,a)),e("width",r),e("height",s),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function YJ(e,t){const n=t.image,i=$b(t,n),r=Mb(t,n),s=(t.x||0)-Bg(t.align,i),o=(t.y||0)-Ug(t.baseline,r);return e.set(s,o,s+i,o+r)}function ZJ(e,t,n){jr(t,i=>{if(n&&!n.intersects(i.bounds))return;const r=Ab(i,this);let s=$b(i,r),o=Mb(i,r);if(s===0||o===0)return;let a=(i.x||0)-Bg(i.align,s),u=(i.y||0)-Ug(i.baseline,o),l,c,f,d;i.aspect!==!1&&(c=r.width/r.height,f=i.width/i.height,c===c&&f===f&&c!==f&&(f<c?(d=s/c,u+=(o-d)/2,o=d):(d=o*c,a+=(s-d)/2,s=d))),(r.complete||r.toDataURL)&&(pl(e,i),e.globalAlpha=(l=i.opacity)!=null?l:1,e.imageSmoothingEnabled=i.smooth!==!1,e.drawImage(r,a,u,s,o))})}var XJ={type:"image",tag:"image",nested:!1,attr:GJ,bound:YJ,draw:ZJ,pick:zg(),isect:Qi,get:Ab,xOffset:Bg,yOffset:Ug},KJ=kb("line",dJ,FJ);function JJ(e,t){var n=t.scaleX||1,i=t.scaleY||1;(n!==1||i!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",$J(t)),e("d",t.path)}function Yh(e,t){var n=t.path;if(n==null)return!0;var i=t.x||0,r=t.y||0,s=t.scaleX||1,o=t.scaleY||1,a=(t.angle||0)*To,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=yb(n)).path=n),a&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(a),ip(e,u,0,0,s,o),e.rotate(-a),e.translate(-i,-r)):ip(e,u,i,r,s,o)}function QJ(e,t){return Yh(Pg(e,t.angle),t)?e.set(0,0,0,0):Wo(e,t,!0)}var eQ={type:"path",tag:"path",nested:!1,attr:JJ,bound:QJ,draw:wb(Yh),pick:Eb(Yh),isect:fM(Yh)};function tQ(e,t){e("d",Hl(null,t))}function nQ(e,t){var n,i;return Wo(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)}function c_(e,t){e.beginPath(),Hl(e,t)}var iQ={type:"rect",tag:"path",nested:!1,attr:tQ,bound:nQ,draw:wb(c_),pick:Eb(c_),isect:hM};function rQ(e,t){e("transform",yM(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function sQ(e,t){var n,i;return Wo(e.set(n=t.x||0,i=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:i),t)}function _M(e,t,n){var i,r,s,o;return t.stroke&&gl(e,t,n)?(i=t.x||0,r=t.y||0,s=t.x2!=null?t.x2:i,o=t.y2!=null?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(s,o),!0):!1}function oQ(e,t,n){jr(t,i=>{if(!(n&&!n.intersects(i.bounds))){var r=i.opacity==null?1:i.opacity;r&&_M(e,i,r)&&(pl(e,i),e.stroke())}})}function aQ(e,t,n,i){return e.isPointInStroke?_M(e,t,1)&&e.isPointInStroke(n,i):!1}var uQ={type:"rule",tag:"line",nested:!1,attr:rQ,bound:sQ,draw:oQ,pick:zg(aQ),isect:_J},lQ=Sb("shape",hJ),cQ=Sb("symbol",pJ,dM);const f_=BG();var Ai={height:qs,measureWidth:Tb,estimateWidth:sp,width:sp,canvas:wM};wM(!0);function wM(e){Ai.width=e&&wo?Tb:sp}function sp(e,t){return EM(Fo(e,t),qs(e))}function EM(e,t){return~~(.8*e.length*t)}function Tb(e,t){return qs(e)<=0||!(t=Fo(e,t))?0:CM(t,Fb(e))}function CM(e,t){const n=`(${t}) ${e}`;let i=f_.get(n);return i===void 0&&(wo.font=t,i=wo.measureText(e).width,f_.set(n,i)),i}function qs(e){return e.fontSize!=null?+e.fontSize||0:11}function Za(e){return e.lineHeight!=null?e.lineHeight:qs(e)+2}function fQ(e){return V(e)?e.length>1?e:e[0]:e}function Ed(e){return fQ(e.lineBreak&&e.text&&!V(e.text)?e.text.split(e.lineBreak):e.text)}function SM(e){const t=Ed(e);return(V(t)?t.length-1:0)*Za(e)}function Fo(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?hQ(e,n):n}function dQ(e){if(Ai.width===Tb){const t=Fb(e);return n=>CM(n,t)}else if(Ai.width===sp){const t=qs(e);return n=>EM(n,t)}else return t=>Ai.width(e,t)}function hQ(e,t){var n=+e.limit,i=dQ(e);if(i(t)<n)return t;var r=e.ellipsis||"…",s=e.dir==="rtl",o=0,a=t.length,u;if(n-=i(r),s){for(;o<a;)u=o+a>>>1,i(t.slice(u))>n?o=u+1:a=u;return r+t.slice(o)}else{for(;o<a;)u=1+(o+a>>>1),i(t.slice(0,u))<n?o=u:a=u-1;return t.slice(0,o)+r}}function jg(e,t){var n=e.font;return n||"sans-serif"}function Fb(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+qs(e)+"px "+jg(e)}function Lb(e){var t=e.baseline,n=qs(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*Za(e):t==="line-bottom"?.29*n-.5*Za(e):0)}const pQ={left:"start",center:"middle",right:"end"},cf=new Nt;function Hg(e){var t=e.x||0,n=e.y||0,i=e.radius||0,r;return i&&(r=(e.theta||0)-ya,t+=i*Math.cos(r),n+=i*Math.sin(r)),cf.x1=t,cf.y1=n,cf}function gQ(e,t){var n=t.dx||0,i=(t.dy||0)+Lb(t),r=Hg(t),s=r.x1,o=r.y1,a=t.angle||0,u;e("text-anchor",pQ[t.align]||"start"),a?(u=Na(s,o)+" "+Cb(a),(n||i)&&(u+=" "+Na(n,i))):u=Na(s+n,o+i),e("transform",u)}function Nb(e,t,n){var i=Ai.height(t),r=t.align,s=Hg(t),o=s.x1,a=s.y1,u=t.dx||0,l=(t.dy||0)+Lb(t)-Math.round(.8*i),c=Ed(t),f;if(V(c)?(i+=Za(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,Ai.width(t,h)),0)):f=Ai.width(t,c),r==="center"?u-=f/2:r==="right"&&(u-=f),e.set(u+=o,l+=a,u+f,l+i),t.angle&&!n)e.rotate(t.angle*To,o,a);else if(n===2)return e.rotatedPoints(t.angle*To,o,a);return e}function mQ(e,t,n){jr(t,i=>{var r=i.opacity==null?1:i.opacity,s,o,a,u,l,c,f;if(!(n&&!n.intersects(i.bounds)||r===0||i.fontSize<=0||i.text==null||i.text.length===0)){if(e.font=Fb(i),e.textAlign=i.align||"left",s=Hg(i),o=s.x1,a=s.y1,i.angle&&(e.save(),e.translate(o,a),e.rotate(i.angle*To),o=a=0),o+=i.dx||0,a+=(i.dy||0)+Lb(i),c=Ed(i),pl(e,i),V(c))for(l=Za(i),u=0;u<c.length;++u)f=Fo(i,c[u]),i.fill&&rp(e,i,r)&&e.fillText(f,o,a),i.stroke&&gl(e,i,r)&&e.strokeText(f,o,a),a+=l;else f=Fo(i,c),i.fill&&rp(e,i,r)&&e.fillText(f,o,a),i.stroke&&gl(e,i,r)&&e.strokeText(f,o,a);i.angle&&e.restore()}})}function yQ(e,t,n,i,r,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=Hg(t),a=o.x1,u=o.y1,l=Nb(cf,t,1),c=-t.angle*To,f=Math.cos(c),d=Math.sin(c),h=f*r-d*s+(a-f*a+d*u),p=d*r+f*s+(u-d*a-f*u);return l.contains(h,p)}function vQ(e,t){const n=Nb(cf,e,2);return Uc(t,n[0],n[1],n[2],n[3])||Uc(t,n[0],n[1],n[4],n[5])||Uc(t,n[4],n[5],n[6],n[7])||Uc(t,n[2],n[3],n[6],n[7])}var bQ={type:"text",tag:"text",nested:!1,attr:gQ,bound:Nb,draw:mQ,pick:zg(yQ),isect:vQ},xQ=kb("trail",gJ,LJ),Fi={arc:MJ,area:NJ,group:WJ,image:XJ,line:KJ,path:eQ,rect:iQ,rule:uQ,shape:lQ,symbol:cQ,text:bQ,trail:xQ};function d_(e,t,n){var i=Fi[e.mark.marktype],r=t||i.bound;return i.nested&&(e=e.mark),r(e.bounds||(e.bounds=new Nt),e,n)}var h_={mark:null};function _Q(e,t,n){var i=Fi[e.marktype],r=i.bound,s=e.items,o=s&&s.length,a,u,l,c;if(i.nested)return o?l=s[0]:(h_.mark=e,l=h_),c=d_(l,r,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new Nt,o)for(a=0,u=s.length;a<u;++a)t.union(d_(s[a],r,n));return e.bounds=t}const wQ=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function EQ(e,t){return JSON.stringify(e,wQ,t)}function CQ(e){const t=typeof e=="string"?JSON.parse(e):e;return kM(t)}function kM(e){var t=e.marktype,n=e.items,i,r,s;if(n)for(r=0,s=n.length;r<s;++r)i=t?"mark":"group",n[r][i]=e,n[r].zindex&&(n[r][i].zdirty=!0),(t||i)==="group"&&kM(n[r]);return t&&_Q(e),e}class SQ{constructor(t){arguments.length?this.root=CQ(t):(this.root=p_({marktype:"group",name:"root",role:"frame"}),this.root.items=[new _b(this.root)])}toJSON(t){return EQ(this.root,t||0)}mark(t,n,i){n=n||this.root.items[0];const r=p_(t,n);return n.items[i]=r,r.zindex&&(r.group.zdirty=!0),r}}function p_(e,t){const n={bounds:new Nt,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function Ca(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function AM(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function It(e,t,n,i){var r=e.childNodes[t],s;return(!r||r.tagName.toLowerCase()!==n.toLowerCase())&&(s=r||null,r=Ca(e.ownerDocument,n,i),e.insertBefore(r,s)),r}function zi(e,t){for(var n=e.childNodes,i=n.length;i>t;)e.removeChild(n[--i]);return e}function $M(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Db(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function kQ(e,t,n,i){var r=e&&e.mark,s,o;if(r&&(s=Fi[r.marktype]).tip){for(o=Db(t,n),o[0]-=i[0],o[1]-=i[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=s.tip(r.items,o)}return e}class MM{constructor(t,n){this._active=null,this._handlers={},this._loader=t||k5(),this._tooltip=n||AQ}initialize(t,n,i){return this._el=t,this._obj=i||null,this.origin(n)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()}scene(t){return arguments.length?(this._scene=t,this):this._scene}on(){}off(){}_handlerIndex(t,n,i){for(let r=t?t.length:0;--r>=0;)if(t[r].type===n&&(!i||t[r].handler===i))return r;return-1}handlers(t){const n=this._handlers,i=[];if(t)i.push(...n[this.eventName(t)]);else for(const r in n)i.push(...n[r]);return i}eventName(t){const n=t.indexOf(".");return n<0?t:t.slice(0,n)}handleHref(t,n,i){this._loader.sanitize(i,{context:"href"}).then(r=>{const s=new MouseEvent(t.type,t),o=Ca(null,"a");for(const a in r)o.setAttribute(a,r[a]);o.dispatchEvent(s)}).catch(()=>{})}handleTooltip(t,n,i){if(n&&n.tooltip!=null){n=kQ(n,t,this.canvas(),this._origin);const r=i&&n&&n.tooltip||null;this._tooltip.call(this._obj,this,t,n,r)}}getItemBoundingClientRect(t){const n=this.canvas();if(!n)return;const i=n.getBoundingClientRect(),r=this._origin,s=t.bounds,o=s.width(),a=s.height();let u=s.x1+r[0]+i.left,l=s.y1+r[1]+i.top;for(;t.mark&&(t=t.mark.group);)u+=t.x||0,l+=t.y||0;return{x:u,y:l,width:o,height:a,left:u,top:l,right:u+o,bottom:l+a}}}function AQ(e,t,n,i){e.element().setAttribute("title",i||"")}class qg{constructor(t){this._el=null,this._bgcolor=null,this._loader=new yJ(t)}initialize(t,n,i,r,s){return this._el=t,this.resize(n,i,r,s)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}background(t){return arguments.length===0?this._bgcolor:(this._bgcolor=t,this)}resize(t,n,i,r){return this._width=t,this._height=n,this._origin=i||[0,0],this._scale=r||1,this}dirty(){}render(t,n){const i=this;return i._call=function(){i._render(t,n)},i._call(),i._call=null,i}_render(){}renderAsync(t,n){const i=this.render(t,n);return this._ready?this._ready.then(()=>i):Promise.resolve(i)}_load(t,n){var i=this,r=i._loader[t](n);if(!i._ready){const s=i._call;i._ready=i._loader.ready().then(o=>{o&&s(),i._ready=null})}return r}sanitizeURL(t){return this._load("sanitizeURL",t)}loadImage(t){return this._load("loadImage",t)}}const $Q="keydown",MQ="keypress",TQ="keyup",TM="dragenter",Zh="dragleave",FM="dragover",cv="pointerdown",FQ="pointerup",op="pointermove",Xh="pointerout",LM="pointerover",fv="mousedown",LQ="mouseup",NM="mousemove",ap="mouseout",DM="mouseover",up="click",NQ="dblclick",DQ="wheel",RM="mousewheel",lp="touchstart",cp="touchmove",fp="touchend",RQ=[$Q,MQ,TQ,TM,Zh,FM,cv,FQ,op,Xh,LM,fv,LQ,NM,ap,DM,up,NQ,DQ,RM,lp,cp,fp],dv=op,ff=ap,hv=up;class Vg extends MM{constructor(t,n){super(t,n),this._down=null,this._touch=null,this._first=!0,this._events={},this.events=RQ,this.pointermove=m_([op,NM],[LM,DM],[Xh,ap]),this.dragover=m_([FM],[TM],[Zh]),this.pointerout=y_([Xh,ap]),this.dragleave=y_([Zh])}initialize(t,n,i){return this._canvas=t&&AM(t,"canvas"),[up,fv,cv,op,Xh,Zh].forEach(r=>g_(this,r)),super.initialize(t,n,i)}canvas(){return this._canvas}context(){return this._canvas.getContext("2d")}DOMMouseScroll(t){this.fire(RM,t)}pointerdown(t){this._down=this._active,this.fire(cv,t)}mousedown(t){this._down=this._active,this.fire(fv,t)}click(t){this._down===this._active&&(this.fire(up,t),this._down=null)}touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(lp,t,!0)}touchmove(t){this.fire(cp,t,!0)}touchend(t){this.fire(fp,t,!0),this._touch=null}fire(t,n,i){const r=i?this._touch:this._active,s=this._handlers[t];if(n.vegaType=t,t===hv&&r&&r.href?this.handleHref(n,r,r.href):(t===dv||t===ff)&&this.handleTooltip(n,r,t!==ff),s)for(let o=0,a=s.length;o<a;++o)s[o].handler.call(this._obj,n,r)}on(t,n){const i=this.eventName(t),r=this._handlers;return this._handlerIndex(r[i],t,n)<0&&(g_(this,t),(r[i]||(r[i]=[])).push({type:t,handler:n})),this}off(t,n){const i=this.eventName(t),r=this._handlers[i],s=this._handlerIndex(r,t,n);return s>=0&&r.splice(s,1),this}pickEvent(t){const n=Db(t,this._canvas),i=this._origin;return this.pick(this._scene,n[0],n[1],n[0]-i[0],n[1]-i[1])}pick(t,n,i,r,s){const o=this.context();return Fi[t.marktype].pick.call(this,o,t,n,i,r,s)}}const OQ=e=>e===lp||e===cp||e===fp?[lp,cp,fp]:[e];function g_(e,t){OQ(t).forEach(n=>IQ(e,n))}function IQ(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?i=>e[t](i):i=>e.fire(t,i)))}function jc(e,t,n){t.forEach(i=>e.fire(i,n))}function m_(e,t,n){return function(i){const r=this._active,s=this.pickEvent(i);s===r?jc(this,e,i):((!r||!r.exit)&&jc(this,n,i),this._active=s,jc(this,t,i),jc(this,e,i))}}function y_(e){return function(t){jc(this,e,t),this._active=null}}function PQ(){return typeof window<"u"&&window.devicePixelRatio||1}function zQ(e,t,n,i,r,s){const o=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,a=e.getContext("2d"),u=o?PQ():r;e.width=t*u,e.height=n*u;for(const l in s)a[l]=s[l];return o&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=u,a.setTransform(u,0,0,u,u*i[0],u*i[1]),e}class pv extends qg{constructor(t){super(t),this._options={},this._redraw=!1,this._dirty=new Nt,this._tempb=new Nt}initialize(t,n,i,r,s,o){return this._options=o||{},this._canvas=this._options.externalContext?null:_o(1,1,this._options.type),t&&this._canvas&&(zi(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),super.initialize(t,n,i,r,s)}resize(t,n,i,r){if(super.resize(t,n,i,r),this._canvas)zQ(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const s=this._options.externalContext;s||te("CanvasRenderer is missing a valid canvas or context"),s.scale(this._scale,this._scale),s.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this}canvas(){return this._canvas}context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)}dirty(t){const n=this._tempb.clear().union(t.bounds);let i=t.mark.group;for(;i;)n.translate(i.x||0,i.y||0),i=i.mark.group;this._dirty.union(n)}_render(t,n){const i=this.context(),r=this._origin,s=this._width,o=this._height,a=this._dirty,u=BQ(r,s,o);i.save();const l=this._redraw||a.empty()?(this._redraw=!1,u.expand(1)):UQ(i,u.intersect(a),r);return this.clear(-r[0],-r[1],s,o),this.draw(i,t,l,n),i.restore(),a.clear(),this}draw(t,n,i,r){if(n.marktype!=="group"&&r!=null&&!r.includes(n.marktype))return;const s=Fi[n.marktype];n.clip&&DJ(t,n),s.draw.call(this,t,n,i,r),n.clip&&t.restore()}clear(t,n,i,r){const s=this._options,o=this.context();s.type!=="pdf"&&!s.externalContext&&o.clearRect(t,n,i,r),this._bgcolor!=null&&(o.fillStyle=this._bgcolor,o.fillRect(t,n,i,r))}}const BQ=(e,t,n)=>new Nt().set(0,0,t,n).translate(-e[0],-e[1]);function UQ(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}class jQ extends MM{constructor(t,n){super(t,n);const i=this;i._hrefHandler=Hm(i,(r,s)=>{s&&s.href&&i.handleHref(r,s,s.href)}),i._tooltipHandler=Hm(i,(r,s)=>{i.handleTooltip(r,s,r.type!==ff)})}initialize(t,n,i){let r=this._svg;return r&&(r.removeEventListener(hv,this._hrefHandler),r.removeEventListener(dv,this._tooltipHandler),r.removeEventListener(ff,this._tooltipHandler)),this._svg=r=t&&AM(t,"svg"),r&&(r.addEventListener(hv,this._hrefHandler),r.addEventListener(dv,this._tooltipHandler),r.addEventListener(ff,this._tooltipHandler)),super.initialize(t,n,i)}canvas(){return this._svg}on(t,n){const i=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[i],t,n)<0){const o={type:t,handler:n,listener:Hm(this,n)};(r[i]||(r[i]=[])).push(o),this._svg&&this._svg.addEventListener(i,o.listener)}return this}off(t,n){const i=this.eventName(t),r=this._handlers[i],s=this._handlerIndex(r,t,n);return s>=0&&(this._svg&&this._svg.removeEventListener(i,r[s].listener),r.splice(s,1)),this}}const Hm=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)},OM="aria-hidden",Rb="aria-label",Ob="role",Ib="aria-roledescription",IM="graphics-object",Pb="graphics-symbol",PM=(e,t,n)=>({[Ob]:e,[Ib]:t,[Rb]:n||void 0}),HQ=Br(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),v_={axis:{desc:"axis",caption:WQ},legend:{desc:"legend",caption:GQ},"title-text":{desc:"title",caption:e=>`Title text '${x_(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${x_(e)}'`}},b_={ariaRole:Ob,ariaRoleDescription:Ib,description:Rb};function zM(e,t){const n=t.aria===!1;if(e(OM,n||void 0),n||t.description==null)for(const i in b_)e(b_[i],void 0);else{const i=t.mark.marktype;e(Rb,t.description),e(Ob,t.ariaRole||(i==="group"?IM:Pb)),e(Ib,t.ariaRoleDescription||`${i} mark`)}}function BM(e){return e.aria===!1?{[OM]:!0}:HQ[e.role]?null:v_[e.role]?VQ(e,v_[e.role]):qQ(e)}function qQ(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(i=>i.description!=null&&i.aria!==!1);return PM(n?IM:Pb,`${t} mark container`,e.description)}function VQ(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return PM(t.role||Pb,t.desc,n.description||i(n))}catch{return null}}function x_(e){return ce(e.text).join(" ")}function WQ(e){const t=e.datum,n=e.orient,i=t.title?UM(e):null,r=e.context,s=r.scales[t.scale].value,o=r.dataflow.locale(),a=s.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(i?` titled '${i}'`:"")+` for a ${G$(a)?"discrete":a} scale with ${aM(o,s,e)}`}function GQ(e){const t=e.datum,n=t.title?UM(e):null,i=`${t.type||""} legend`.trim(),r=t.scales,s=Object.keys(r),o=e.context,a=o.scales[r[s[0]]].value,u=o.dataflow.locale();return ZQ(i)+(n?` titled '${n}'`:"")+` for ${YQ(s)} with ${aM(u,a,e)}`}function UM(e){try{return ce(Xe(e.items).items[0].text).join(" ")}catch{return null}}function YQ(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Xe(e)}function ZQ(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const jM=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),XQ=e=>jM(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function HM(){let e="",t="",n="";const i=[],r=()=>t=n="",s=u=>{t&&(e+=`${t}>${n}`,r()),i.push(u)},o=(u,l)=>(l!=null&&(t+=` ${u}="${XQ(l)}"`),a),a={open(u){s(u),t="<"+u;for(var l=arguments.length,c=new Array(l>1?l-1:0),f=1;f<l;f++)c[f-1]=arguments[f];for(const d of c)for(const h in d)o(h,d[h]);return a},close(){const u=i.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,r(),a},attr:o,text:u=>(n+=jM(u),a),toString:()=>e};return a}const KQ=e=>qM(HM(),e)+"";function qM(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,i=n.length;for(let r=0;r<i;++r)e.attr(n[r].name,n[r].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const i of n)i.nodeType===3?e.text(i.nodeValue):qM(e,i)}return e.close()}const dp={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},hp={blend:"mix-blend-mode"},VM={fill:"none","stroke-miterlimit":10},bc=0,__="http://www.w3.org/2000/xmlns/",Ft=Pf.xmlns;class WM extends qg{constructor(t){super(t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}initialize(t,n,i,r,s){return this._defs={},this._clearDefs(),t&&(this._svg=It(t,0,"svg",Ft),this._svg.setAttributeNS(__,"xmlns",Ft),this._svg.setAttributeNS(__,"xmlns:xlink",Pf["xmlns:xlink"]),this._svg.setAttribute("version",Pf.version),this._svg.setAttribute("class","marks"),zi(t,1),this._root=It(this._svg,bc,"g",Ft),ho(this._root,VM),zi(this._svg,bc+1)),this.background(this._bgcolor),super.initialize(t,n,i,r,s)}background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),super.background(...arguments)}resize(t,n,i,r){return super.resize(t,n,i,r),this._svg&&(ho(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this}canvas(){return this._svg}svg(){const t=this._svg,n=this._bgcolor;if(!t)return null;let i;n&&(t.removeAttribute("style"),i=It(t,bc,"rect",Ft),ho(i,{width:this._width,height:this._height,fill:n}));const r=KQ(t);return n&&(t.removeChild(i),this._svg.style.setProperty("background-color",n)),r}_render(t,n){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,n),zi(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this}dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))}isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID}_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const n=++this._dirtyID;let i,r,s,o,a,u,l;for(a=0,u=t.length;a<u;++a)if(i=t[a],r=i.mark,r.marktype!==s&&(s=r.marktype,o=Fi[s]),r.zdirty&&r.dirty!==n&&(this._dirtyAll=!1,w_(i,n),r.items.forEach(c=>{c.dirty=n})),!r.zdirty){if(i.exit){o.nested&&r.items.length?(l=r.items[0],l._svg&&this._update(o,l._svg,l)):i._svg&&(l=i._svg.parentNode,l&&l.removeChild(i._svg)),i._svg=null;continue}i=o.nested?r.items[0]:i,i._update!==n&&(!i._svg||!i._svg.ownerSVGElement?(this._dirtyAll=!1,w_(i,n)):this._update(o,i._svg,i),i._update=n)}return!this._dirtyAll}mark(t,n,i,r){if(!this.isDirty(n))return n._svg;const s=this._svg,o=n.marktype,a=Fi[o],u=n.interactive===!1?"none":null,l=a.tag==="g",c=E_(n,t,i,"g",s);if(o!=="group"&&r!=null&&!r.includes(o))return zi(c,0),n._svg;c.setAttribute("class",$M(n));const f=BM(n);for(const g in f)vn(c,g,f[g]);l||vn(c,"pointer-events",u),vn(c,"clip-path",n.clip?bb(this,n,n.group):null);let d=null,h=0;const p=g=>{const m=this.isDirty(g),y=E_(g,c,d,a.tag,s);m&&(this._update(a,y,g),l&&eee(this,y,g,r)),d=y,++h};return a.nested?n.items.length&&p(n.items[0]):jr(n,p),zi(c,h),c}_update(t,n,i){Es=n,on=n.__values__,zM(df,i),t.attr(df,i,this);const r=nee[t.type];r&&r.call(this,t,n,i),Es&&this.style(Es,i)}style(t,n){if(n!=null){for(const i in dp){let r=i==="font"?jg(n):n[i];if(r===on[i])continue;const s=dp[i];r==null?t.removeAttribute(s):(mb(r)&&(r=uM(r,this._defs.gradient,GM())),t.setAttribute(s,r+"")),on[i]=r}for(const i in hp)Kh(t,hp[i],n[i])}}defs(){const t=this._svg,n=this._defs;let i=n.el,r=0;for(const s in n.gradient)i||(n.el=i=It(t,bc+1,"defs",Ft)),r=JQ(i,n.gradient[s],r);for(const s in n.clipping)i||(n.el=i=It(t,bc+1,"defs",Ft)),r=QQ(i,n.clipping[s],r);i&&(r===0?(t.removeChild(i),n.el=null):zi(i,r))}_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}}function w_(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function JQ(e,t,n){let i,r,s;if(t.gradient==="radial"){let o=It(e,n++,"pattern",Ft);ho(o,{id:np+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=It(o,0,"rect",Ft),ho(o,{width:1,height:1,fill:`url(${GM()}#${t.id})`}),e=It(e,n++,"radialGradient",Ft),ho(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=It(e,n++,"linearGradient",Ft),ho(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(i=0,r=t.stops.length;i<r;++i)s=It(e,i,"stop",Ft),s.setAttribute("offset",t.stops[i].offset),s.setAttribute("stop-color",t.stops[i].color);return zi(e,i),n}function QQ(e,t,n){let i;return e=It(e,n,"clipPath",Ft),e.setAttribute("id",t.id),t.path?(i=It(e,0,"path",Ft),i.setAttribute("d",t.path)):(i=It(e,0,"rect",Ft),ho(i,{x:0,y:0,width:t.width,height:t.height})),zi(e,1),n+1}function eee(e,t,n,i){t=t.lastChild.previousSibling;let r,s=0;jr(n,o=>{r=e.mark(t,o,r,i),++s}),zi(t,1+s)}function E_(e,t,n,i,r){let s=e._svg,o;if(!s&&(o=t.ownerDocument,s=Ca(o,i,Ft),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},i==="g"))){const a=Ca(o,"path",Ft);s.appendChild(a),a.__data__=e;const u=Ca(o,"g",Ft);s.appendChild(u),u.__data__=e;const l=Ca(o,"path",Ft);s.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(s.ownerSVGElement!==r||tee(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}function tee(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let Es=null,on=null;const nee={group(e,t,n){const i=Es=t.childNodes[2];on=i.__values__,e.foreground(df,n,this),on=t.__values__,Es=t.childNodes[1],e.content(df,n,this);const r=Es=t.childNodes[0];e.background(df,n,this);const s=n.mark.interactive===!1?"none":null;if(s!==on.events&&(vn(i,"pointer-events",s),vn(r,"pointer-events",s),on.events=s),n.strokeForeground&&n.stroke){const o=n.fill;vn(i,"display",null),this.style(r,n),vn(r,"stroke",null),o&&(n.fill=null),on=i.__values__,this.style(i,n),o&&(n.fill=o),Es=null}else vn(i,"display","none")},image(e,t,n){n.smooth===!1?(Kh(t,"image-rendering","optimizeSpeed"),Kh(t,"image-rendering","pixelated")):Kh(t,"image-rendering",null)},text(e,t,n){const i=Ed(n);let r,s,o,a;V(i)?(s=i.map(u=>Fo(n,u)),r=s.join(`
`),r!==on.text&&(zi(t,0),o=t.ownerDocument,a=Za(n),s.forEach((u,l)=>{const c=Ca(o,"tspan",Ft);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),on.text=r)):(s=Fo(n,i),s!==on.text&&(t.textContent=s,on.text=s)),vn(t,"font-family",jg(n)),vn(t,"font-size",qs(n)+"px"),vn(t,"font-style",n.fontStyle),vn(t,"font-variant",n.fontVariant),vn(t,"font-weight",n.fontWeight)}};function df(e,t,n){t!==on[e]&&(n?iee(Es,e,t,n):vn(Es,e,t),on[e]=t)}function Kh(e,t,n){n!==on[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),on[t]=n)}function ho(e,t){for(const n in t)vn(e,n,t[n])}function vn(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function iee(e,t,n,i){n!=null?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}function GM(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}class ree extends qg{constructor(t){super(t),this._text=null,this._defs={gradient:{},clipping:{}}}svg(){return this._text}_render(t){const n=HM();n.open("svg",Ht({},Pf,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const i=this._bgcolor;return i&&i!=="transparent"&&i!=="none"&&n.open("rect",{width:this._width,height:this._height,fill:i}).close(),n.open("g",VM,{transform:"translate("+this._origin+")"}),this.mark(n,t),n.close(),this.defs(n),this._text=n.close()+"",this}mark(t,n){const i=Fi[n.marktype],r=i.tag,s=[zM,i.attr];t.open("g",{class:$M(n),"clip-path":n.clip?bb(this,n,n.group):null},BM(n),{"pointer-events":r!=="g"&&n.interactive===!1?"none":null});const o=a=>{const u=this.href(a);if(u&&t.open("a",u),t.open(r,this.attr(n,a,s,r!=="g"?r:null)),r==="text"){const l=Ed(a);if(V(l)){const c={x:0,dy:Za(a)};for(let f=0;f<l.length;++f)t.open("tspan",f?c:null).text(Fo(a,l[f])).close()}else t.text(Fo(a,l))}else if(r==="g"){const l=a.strokeForeground,c=a.fill,f=a.stroke;l&&f&&(a.stroke=null),t.open("path",this.attr(n,a,i.background,"bgrect")).close(),t.open("g",this.attr(n,a,i.content)),jr(a,d=>this.mark(t,d)),t.close(),l&&f?(c&&(a.fill=null),a.stroke=f,t.open("path",this.attr(n,a,i.foreground,"bgrect")).close(),c&&(a.fill=c)):t.open("path",this.attr(n,a,i.foreground,"bgfore")).close()}t.close(),u&&t.close()};return i.nested?n.items&&n.items.length&&o(n.items[0]):jr(n,o),t.close()}href(t){const n=t.href;let i;if(n){if(i=this._hrefs&&this._hrefs[n])return i;this.sanitizeURL(n).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[n]=r})}return null}attr(t,n,i,r){const s={},o=(a,u,l,c)=>{s[c||a]=u};return Array.isArray(i)?i.forEach(a=>a(o,n,this)):i(o,n,this),r&&see(s,n,t,r,this._defs),s}defs(t){const n=this._defs.gradient,i=this._defs.clipping;if(Object.keys(n).length+Object.keys(i).length!==0){t.open("defs");for(const s in n){const o=n[s],a=o.stops;o.gradient==="radial"?(t.open("pattern",{id:np+s,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+s+")"}).close(),t.close(),t.open("radialGradient",{id:s,fx:o.x1,fy:o.y1,fr:o.r1,cx:o.x2,cy:o.y2,r:o.r2})):t.open("linearGradient",{id:s,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2});for(let u=0;u<a.length;++u)t.open("stop",{offset:a[u].offset,"stop-color":a[u].color}).close();t.close()}for(const s in i){const o=i[s];t.open("clipPath",{id:s}),o.path?t.open("path",{d:o.path}).close():t.open("rect",{x:0,y:0,width:o.width,height:o.height}).close(),t.close()}t.close()}}}function see(e,t,n,i,r){let s;if(t==null||(i==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),i==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;i==="image"&&t.smooth===!1&&(s=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),i==="text"&&(e["font-family"]=jg(t),e["font-size"]=qs(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const o in dp){let a=t[o];const u=dp[o];a==="transparent"&&(u==="fill"||u==="stroke")||a!=null&&(mb(a)&&(a=uM(a,r.gradient,"")),e[u]=a)}for(const o in hp){const a=t[o];a!=null&&(s=s||[],s.push(`${hp[o]}: ${a};`))}return s&&(e.style=s.join(" ")),e}const qm={svgMarkTypes:["text"]};class C_ extends qg{constructor(t){super(t),this._svgRenderer=new WM(t),this._canvasRenderer=new pv(t)}initialize(t,n,i,r,s){this._root_el=It(t,0,"div");const o=It(this._root_el,0,"div"),a=It(this._root_el,1,"div");return this._root_el.style.position="relative",o.style.height="100%",a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.height="100%",a.style.width="100%",this._svgEl=a,this._canvasEl=o,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,n,i,r,s),this._svgRenderer.initialize(this._svgEl,n,i,r,s),super.initialize(t,n,i,r,s)}dirty(t){return qm.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this}_render(t,n){const r=(n??["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter(s=>!qm.svgMarkTypes.includes(s));this._svgRenderer.render(t,qm.svgMarkTypes),this._canvasRenderer.render(t,r)}resize(t,n,i,r){return super.resize(t,n,i,r),this._svgRenderer.resize(t,n,i,r),this._canvasRenderer.resize(t,n,i,r),this}background(t){return this._canvasRenderer.background(t),this}}class oee extends Vg{constructor(t,n){super(t,n)}initialize(t,n,i){const r=It(It(t,0,"div"),0,"div");return super.initialize(r,n,i)}}const YM="canvas",aee="hybrid",ZM="png",XM="svg",uee="none",Sa={Canvas:YM,PNG:ZM,SVG:XM},Xa={};Xa[YM]=Xa[ZM]={renderer:pv,headless:pv,handler:Vg};Xa[XM]={renderer:WM,headless:ree,handler:jQ};Xa[aee]={renderer:C_,headless:C_,handler:oee};Xa[uee]={};function zb(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Xa[e]=t,this):Xa[e]}function lee(e,t,n){const i=[],r=new Nt().union(t),s=e.marktype;return s?KM(e,r,n,i):s==="group"?JM(e,r,n,i):te("Intersect scene must be mark node or group item.")}function KM(e,t,n,i){if(cee(e,t,n)){const r=e.items,s=e.marktype,o=r.length;let a=0;if(s==="group")for(;a<o;++a)JM(r[a],t,n,i);else for(const u=Fi[s].isect;a<o;++a){const l=r[a];QM(l,t,u)&&i.push(l)}}return i}function cee(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function JM(e,t,n,i){n&&n(e.mark)&&QM(e,t,Fi.group.isect)&&i.push(e);const r=e.items,s=r&&r.length;if(s){const o=e.x||0,a=e.y||0;t.translate(-o,-a);for(let u=0;u<s;++u)KM(r[u],t,n,i);t.translate(o,a)}return i}function QM(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}const Vm=new Nt;function fee(e){const t=e.clip;if(Me(t))t(Pg(Vm.clear()));else if(t)Vm.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(Vm)}const ml="top",Hi="left",Wi="right",Lo="bottom",dee="top-left",hee="top-right",pee="bottom-left",gee="bottom-right",Bb="start",gv="middle",xn="end",mee="x",yee="y",Wg="group",Ub="axis",jb="title",vee="frame",bee="scope",Hb="legend",eT="row-header",tT="row-footer",nT="row-title",iT="column-header",rT="column-footer",sT="column-title",xee="padding",_ee="symbol",oT="fit",aT="fit-x",uT="fit-y",wee="pad",qb="none",gh="all",mv="each",Vb="flush",po="column",go="row";function lT(e){z.call(this,null,e)}Q(lT,z,{transform(e,t){const n=t.dataflow,i=e.mark,r=i.marktype,s=Fi[r],o=s.bound;let a=i.bounds,u;if(s.nested)i.items.length&&n.dirty(i.items[0]),a=mh(i,o),i.items.forEach(l=>{l.bounds.clear().union(a)});else if(r===Wg||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),a.clear(),i.items.forEach(l=>a.union(mh(l,o))),i.role){case Ub:case Hb:case jb:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{a.union(mh(l,o))}),t.visit(t.MOD,l=>{u=u||a.alignsWith(l.bounds),n.dirty(l),a.union(mh(l,o))}),u&&(a.clear(),i.items.forEach(l=>a.union(l.bounds)));return fee(i),t.modifies("bounds")}});function mh(e,t,n){return t(e.bounds.clear(),e,n)}const S_=":vega_identifier:";function Wb(e){z.call(this,0,e)}Wb.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};Q(Wb,z,{transform(e,t){const n=Eee(t.dataflow),i=e.as;let r=n.value;return t.visit(t.ADD,s=>s[i]=s[i]||++r),n.set(this.value=r),t}});function Eee(e){return e._signals[S_]||(e._signals[S_]=e.add(0))}function cT(e){z.call(this,null,e)}Q(cT,z,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,Cee(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const i=n.marktype===Wg?_b:xb;return t.visit(t.ADD,r=>i.call(r,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function Cee(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function fT(e){z.call(this,null,e)}const k_={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((i,r)=>!r||!dT(n.bounds,i.bounds,t)?(n=i,1):i.opacity=0)}},dT=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),A_=(e,t)=>{for(var n=1,i=e.length,r=e[0].bounds,s;n<i;r=s,++n)if(dT(r,s=e[n].bounds,t))return!0},See=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},kee=(e,t,n)=>{var i=e.range(),r=new Nt;return t===ml||t===Lo?r.set(i[0],-1/0,i[1],1/0):r.set(-1/0,i[0],1/0,i[1]),r.expand(n||1),s=>r.encloses(s.bounds)},$_=e=>(e.forEach(t=>t.opacity=1),e),M_=(e,t)=>e.reflow(t.modified()).modifies("opacity");Q(fT,z,{transform(e,t){const n=k_[e.method]||k_.parity,i=e.separation||0;let r=t.materialize(t.SOURCE).source,s,o;if(!r||!r.length)return;if(!e.method)return e.modified("method")&&($_(r),t=M_(t,e)),t;if(r=r.filter(See),!r.length)return;if(e.sort&&(r=r.slice().sort(e.sort)),s=$_(r),t=M_(t,e),s.length>=3&&A_(s,i)){do s=n(s,i);while(s.length>=3&&A_(s,i));s.length<3&&!Xe(r).opacity&&(s.length>1&&(Xe(s).opacity=0),Xe(r).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=kee(e.boundScale,e.boundOrient,+e.boundTolerance),r.forEach(u=>{o(u)||(u.opacity=0)}));const a=s[0].mark.bounds.clear();return r.forEach(u=>{u.opacity&&a.union(u.bounds)}),t}});function hT(e){z.call(this,null,e)}Q(hT,z,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,i=>n.dirty(i)),t.fields&&t.fields.zindex){const i=t.source&&t.source[0];i&&(i.mark.zdirty=!0)}}});const sn=new Nt;function Uu(e,t,n){return e[t]===n?0:(e[t]=n,1)}function Aee(e){var t=e.items[0].orient;return t===Hi||t===Wi}function $ee(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function Mee(e,t,n,i){var r=t.items[0],s=r.datum,o=r.translate!=null?r.translate:.5,a=r.orient,u=$ee(s),l=r.range,c=r.offset,f=r.position,d=r.minExtent,h=r.maxExtent,p=s.title&&r.items[u[2]].items[0],g=r.titlePadding,m=r.bounds,y=p&&SM(p),v=0,b=0,x,_;switch(sn.clear().union(m),m.clear(),(x=u[0])>-1&&m.union(r.items[x].bounds),(x=u[1])>-1&&m.union(r.items[x].bounds),a){case ml:v=f||0,b=-c,_=Math.max(d,Math.min(h,-m.y1)),m.add(0,-_).add(l,0),p&&yh(e,p,_,g,y,0,-1,m);break;case Hi:v=-c,b=f||0,_=Math.max(d,Math.min(h,-m.x1)),m.add(-_,0).add(0,l),p&&yh(e,p,_,g,y,1,-1,m);break;case Wi:v=n+c,b=f||0,_=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(_,l),p&&yh(e,p,_,g,y,1,1,m);break;case Lo:v=f||0,b=i+c,_=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(l,_),p&&yh(e,p,_,g,0,0,1,m);break;default:v=r.x,b=r.y}return Wo(m.translate(v,b),r),Uu(r,"x",v+o)|Uu(r,"y",b+o)&&(r.bounds=sn,e.dirty(r),r.bounds=m,e.dirty(r)),r.mark.bounds.clear().union(m)}function yh(e,t,n,i,r,s,o,a){const u=t.bounds;if(t.auto){const l=o*(n+r+i);let c=0,f=0;e.dirty(t),s?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}a.union(u)}const T_=(e,t)=>Math.floor(Math.min(e,t)),F_=(e,t)=>Math.ceil(Math.max(e,t));function Tee(e){var t=e.items,n=t.length,i=0,r,s;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i)if(r=t[i],s=r.items,r.marktype===Wg)switch(r.role){case Ub:case Hb:case jb:break;case eT:o.rowheaders.push(...s);break;case tT:o.rowfooters.push(...s);break;case iT:o.colheaders.push(...s);break;case rT:o.colfooters.push(...s);break;case nT:o.rowtitle=s[0];break;case sT:o.coltitle=s[0];break;default:o.marks.push(...s)}return o}function Fee(e){return new Nt().set(0,0,e.width||0,e.height||0)}function Lee(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function ht(e,t,n){const i=_e(e)?e[t]:e;return i??(n!==void 0?n:0)}function L_(e){return e<0?Math.ceil(-e):0}function pT(e,t,n){var i=!n.nodirty,r=n.bounds===Vb?Fee:Lee,s=sn.set(0,0,0,0),o=ht(n.align,po),a=ht(n.align,go),u=ht(n.padding,po),l=ht(n.padding,go),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),p=Array(c),g=0,m=Array(d),y=Array(f),v=0,b=Array(d),x=Array(d),_=Array(d),E,w,S,$,F,T,P,R,C,A,M;for(w=0;w<c;++w)p[w]=0;for(w=0;w<f;++w)y[w]=0;for(w=0;w<d;++w)T=t[w],F=_[w]=r(T),T.x=T.x||0,b[w]=0,T.y=T.y||0,x[w]=0,S=w%c,$=~~(w/c),g=Math.max(g,P=Math.ceil(F.x2)),v=Math.max(v,R=Math.ceil(F.y2)),p[S]=Math.max(p[S],P),y[$]=Math.max(y[$],R),h[w]=u+L_(F.x1),m[w]=l+L_(F.y1),i&&e.dirty(t[w]);for(w=0;w<d;++w)w%c===0&&(h[w]=0),w<c&&(m[w]=0);if(o===mv)for(S=1;S<c;++S){for(M=0,w=S;w<d;w+=c)M<h[w]&&(M=h[w]);for(w=S;w<d;w+=c)h[w]=M+p[S-1]}else if(o===gh){for(M=0,w=0;w<d;++w)w%c&&M<h[w]&&(M=h[w]);for(w=0;w<d;++w)w%c&&(h[w]=M+g)}else for(o=!1,S=1;S<c;++S)for(w=S;w<d;w+=c)h[w]+=p[S-1];if(a===mv)for($=1;$<f;++$){for(M=0,w=$*c,E=w+c;w<E;++w)M<m[w]&&(M=m[w]);for(w=$*c;w<E;++w)m[w]=M+y[$-1]}else if(a===gh){for(M=0,w=c;w<d;++w)M<m[w]&&(M=m[w]);for(w=c;w<d;++w)m[w]=M+v}else for(a=!1,$=1;$<f;++$)for(w=$*c,E=w+c;w<E;++w)m[w]+=y[$-1];for(C=0,w=0;w<d;++w)C=h[w]+(w%c?C:0),b[w]+=C-t[w].x;for(S=0;S<c;++S)for(A=0,w=S;w<d;w+=c)A+=m[w],x[w]+=A-t[w].y;if(o&&ht(n.center,po)&&f>1)for(w=0;w<d;++w)F=o===gh?g:p[w%c],C=F-_[w].x2-t[w].x-b[w],C>0&&(b[w]+=C/2);if(a&&ht(n.center,go)&&c!==1)for(w=0;w<d;++w)F=a===gh?v:y[~~(w/c)],A=F-_[w].y2-t[w].y-x[w],A>0&&(x[w]+=A/2);for(w=0;w<d;++w)s.union(_[w].translate(b[w],x[w]));switch(C=ht(n.anchor,mee),A=ht(n.anchor,yee),ht(n.anchor,po)){case xn:C-=s.width();break;case gv:C-=s.width()/2}switch(ht(n.anchor,go)){case xn:A-=s.height();break;case gv:A-=s.height()/2}for(C=Math.round(C),A=Math.round(A),s.clear(),w=0;w<d;++w)t[w].mark.bounds.clear();for(w=0;w<d;++w)T=t[w],T.x+=b[w]+=C,T.y+=x[w]+=A,s.union(T.mark.bounds.union(T.bounds.translate(b[w],x[w]))),i&&e.dirty(T);return s}function Nee(e,t,n){var i=Tee(t),r=i.marks,s=n.bounds===Vb?Dee:Ree,o=n.offset,a=n.columns||r.length,u=a<=0?1:Math.ceil(r.length/a),l=u*a,c,f,d,h,p,g,m;const y=pT(e,r,n);y.empty()&&y.set(0,0,0,0),i.rowheaders&&(g=ht(n.headerBand,go,null),c=vh(e,i.rowheaders,r,a,u,-ht(o,"rowHeader"),T_,0,s,"x1",0,a,1,g)),i.colheaders&&(g=ht(n.headerBand,po,null),f=vh(e,i.colheaders,r,a,a,-ht(o,"columnHeader"),T_,1,s,"y1",0,1,a,g)),i.rowfooters&&(g=ht(n.footerBand,go,null),d=vh(e,i.rowfooters,r,a,u,ht(o,"rowFooter"),F_,0,s,"x2",a-1,a,1,g)),i.colfooters&&(g=ht(n.footerBand,po,null),h=vh(e,i.colfooters,r,a,a,ht(o,"columnFooter"),F_,1,s,"y2",l-a,1,a,g)),i.rowtitle&&(p=ht(n.titleAnchor,go),m=ht(o,"rowTitle"),m=p===xn?d+m:c-m,g=ht(n.titleBand,go,.5),N_(e,i.rowtitle,m,0,y,g)),i.coltitle&&(p=ht(n.titleAnchor,po),m=ht(o,"columnTitle"),m=p===xn?h+m:f-m,g=ht(n.titleBand,po,.5),N_(e,i.coltitle,m,1,y,g))}function Dee(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function Ree(e,t){return e.bounds[t]}function vh(e,t,n,i,r,s,o,a,u,l,c,f,d,h){var p=n.length,g=0,m=0,y,v,b,x,_,E,w,S,$;if(!p)return g;for(y=c;y<p;y+=f)n[y]&&(g=o(g,u(n[y],l)));if(!t.length)return g;for(t.length>r&&(e.warn("Grid headers exceed limit: "+r),t=t.slice(0,r)),g+=s,v=0,x=t.length;v<x;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(y=c,v=0,x=t.length;v<x;++v,y+=f){for(E=t[v],_=E.mark.bounds,b=y;b>=0&&(w=n[b])==null;b-=d);a?(S=h==null?w.x:Math.round(w.bounds.x1+h*w.bounds.width()),$=g):(S=g,$=h==null?w.y:Math.round(w.bounds.y1+h*w.bounds.height())),_.union(E.bounds.translate(S-(E.x||0),$-(E.y||0))),E.x=S,E.y=$,e.dirty(E),m=o(m,_[l])}return m}function N_(e,t,n,i,r,s){if(t){e.dirty(t);var o=n,a=n;i?o=Math.round(r.x1+s*r.width()):a=Math.round(r.y1+s*r.height()),t.bounds.translate(o-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=a,e.dirty(t)}}function Oee(e,t){const n=e[t]||{};return(i,r)=>n[i]!=null?n[i]:e[i]!=null?e[i]:r}function Iee(e,t){let n=-1/0;return e.forEach(i=>{i.offset!=null&&(n=Math.max(n,i.offset))}),n>-1/0?n:t}function Pee(e,t,n,i,r,s,o){const a=Oee(n,t),u=Iee(e,a("offset",0)),l=a("anchor",Bb),c=l===xn?1:l===gv?.5:0,f={align:mv,bounds:a("bounds",Vb),columns:a("direction")==="vertical"?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case Hi:f.anchor={x:Math.floor(i.x1)-u,column:xn,y:c*(o||i.height()+2*i.y1),row:l};break;case Wi:f.anchor={x:Math.ceil(i.x2)+u,y:c*(o||i.height()+2*i.y1),row:l};break;case ml:f.anchor={y:Math.floor(r.y1)-u,row:xn,x:c*(s||r.width()+2*r.x1),column:l};break;case Lo:f.anchor={y:Math.ceil(r.y2)+u,x:c*(s||r.width()+2*r.x1),column:l};break;case dee:f.anchor={x:u,y:u};break;case hee:f.anchor={x:s-u,y:u,column:xn};break;case pee:f.anchor={x:u,y:o-u,row:xn};break;case gee:f.anchor={x:s-u,y:o-u,column:xn,row:xn};break}return f}function zee(e,t){var n=t.items[0],i=n.datum,r=n.orient,s=n.bounds,o=n.x,a=n.y,u,l;return n._bounds?n._bounds.clear().union(s):n._bounds=s.clone(),s.clear(),Uee(e,n,n.items[0].items[0]),s=Bee(n,s),u=2*n.padding,l=2*n.padding,s.empty()||(u=Math.ceil(s.width()+u),l=Math.ceil(s.height()+l)),i.type===_ee&&jee(n.items[0].items[0].items[0].items),r!==qb&&(n.x=o=0,n.y=a=0),n.width=u,n.height=l,Wo(s.set(o,a,o+u,a+l),n),n.mark.bounds.clear().union(s),n}function Bee(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function Uee(e,t,n){var i=t.padding,r=i-n.x,s=i-n.y;if(!t.datum.title)(r||s)&&xc(e,n,r,s);else{var o=t.items[1].items[0],a=o.anchor,u=t.titlePadding||0,l=i-o.x,c=i-o.y;switch(o.orient){case Hi:r+=Math.ceil(o.bounds.width())+u;break;case Wi:case Lo:break;default:s+=o.bounds.height()+u}switch((r||s)&&xc(e,n,r,s),o.orient){case Hi:c+=Fu(t,n,o,a,1,1);break;case Wi:l+=Fu(t,n,o,xn,0,0)+u,c+=Fu(t,n,o,a,1,1);break;case Lo:l+=Fu(t,n,o,a,0,0),c+=Fu(t,n,o,xn,-1,0,1)+u;break;default:l+=Fu(t,n,o,a,0,0)}(l||c)&&xc(e,o,l,c),(l=Math.round(o.bounds.x1-i))<0&&(xc(e,n,-l,0),xc(e,o,-l,0))}}function Fu(e,t,n,i,r,s,o){const a=e.datum.type!=="symbol",u=n.datum.vgrad,l=a&&(s||!u)&&!o?t.items[0]:t,c=l.bounds[r?"y2":"x2"]-e.padding,f=u&&s?c:0,d=u&&s?0:c,h=r<=0?0:SM(n);return Math.round(i===Bb?f:i===xn?d-h:.5*(c-h))}function xc(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function jee(e){const t=e.reduce((n,i)=>(n[i.column]=Math.max(i.bounds.x2-i.x,n[i.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function Hee(e,t,n,i,r){var s=t.items[0],o=s.frame,a=s.orient,u=s.anchor,l=s.offset,c=s.padding,f=s.items[0].items[0],d=s.items[1]&&s.items[1].items[0],h=a===Hi||a===Wi?i:n,p=0,g=0,m=0,y=0,v=0,b;if(o!==Wg?a===Hi?(p=r.y2,h=r.y1):a===Wi?(p=r.y1,h=r.y2):(p=r.x1,h=r.x2):a===Hi&&(p=i,h=0),b=u===Bb?p:u===xn?h:(p+h)/2,d&&d.text){switch(a){case ml:case Lo:v=f.bounds.height()+c;break;case Hi:y=f.bounds.width()+c;break;case Wi:y=-f.bounds.width()-c;break}sn.clear().union(d.bounds),sn.translate(y-(d.x||0),v-(d.y||0)),Uu(d,"x",y)|Uu(d,"y",v)&&(e.dirty(d),d.bounds.clear().union(sn),d.mark.bounds.clear().union(sn),e.dirty(d)),sn.clear().union(d.bounds)}else sn.clear();switch(sn.union(f.bounds),a){case ml:g=b,m=r.y1-sn.height()-l;break;case Hi:g=r.x1-sn.width()-l,m=b;break;case Wi:g=r.x2+sn.width()+l,m=b;break;case Lo:g=b,m=r.y2+l;break;default:g=s.x,m=s.y}return Uu(s,"x",g)|Uu(s,"y",m)&&(sn.translate(g,m),e.dirty(s),s.bounds.clear().union(sn),t.bounds.clear().union(sn),e.dirty(s)),s.bounds}function gT(e){z.call(this,null,e)}Q(gT,z,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(i=>{e.layout&&Nee(n,i,e.layout),Vee(n,i,e)}),qee(e.mark.group)?t.reflow():t}});function qee(e){return e&&e.mark.role!=="legend-entry"}function Vee(e,t,n){var i=t.items,r=Math.max(0,t.width||0),s=Math.max(0,t.height||0),o=new Nt().set(0,0,r,s),a=o.clone(),u=o.clone(),l=[],c,f,d,h,p,g;for(p=0,g=i.length;p<g;++p)switch(f=i[p],f.role){case Ub:h=Aee(f)?a:u,h.union(Mee(e,f,r,s));break;case jb:c=f;break;case Hb:l.push(zee(e,f));break;case vee:case bee:case eT:case tT:case nT:case iT:case rT:case sT:a.union(f.bounds),u.union(f.bounds);break;default:o.union(f.bounds)}if(l.length){const m={};l.forEach(y=>{d=y.orient||Wi,d!==qb&&(m[d]||(m[d]=[])).push(y)});for(const y in m){const v=m[y];pT(e,v,Pee(v,y,n.legends,a,u,r,s))}l.forEach(y=>{const v=y.bounds;if(v.equals(y._bounds)||(y.bounds=y._bounds,e.dirty(y),y.bounds=v,e.dirty(y)),n.autosize&&(n.autosize.type===oT||n.autosize.type===aT||n.autosize.type===uT))switch(y.orient){case Hi:case Wi:o.add(v.x1,0).add(v.x2,0);break;case ml:case Lo:o.add(0,v.y1).add(0,v.y2)}else o.union(v)})}o.union(a).union(u),c&&o.union(Hee(e,c,r,s,o)),t.clip&&o.set(0,0,t.width||0,t.height||0),Wee(e,t,o,n)}function Wee(e,t,n,i){const r=i.autosize||{},s=r.type;if(e._autosize<1||!s)return;let o=e._width,a=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(r.contains===xee){const p=e.padding();o-=p.left+p.right,a-=p.top+p.bottom}s===qb?(l=0,f=0,u=o,c=a):s===oT?(u=Math.max(0,o-l-d),c=Math.max(0,a-f-h)):s===aT?(u=Math.max(0,o-l-d),a=c+f+h):s===uT?(o=u+l+d,c=Math.max(0,a-f-h)):s===wee&&(o=u+l+d,a=c+f+h),e._resizeView(o,a,u,c,[l,f],r.resize)}const Gee=Object.freeze(Object.defineProperty({__proto__:null,bound:lT,identifier:Wb,mark:cT,overlap:fT,render:hT,viewlayout:gT},Symbol.toStringTag,{value:"Module"}));function mT(e){z.call(this,null,e)}Q(mT,z,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.scale,o=e.count==null?e.values?e.values.length:10:e.count,a=pb(s,o,e.minstep),u=e.format||nM(n,s,a,e.formatSpecifier,e.formatType,!!e.values),l=e.values?tM(s,e.values,a):gb(s,a);return r&&(i.rem=r),r=l.map((c,f)=>We({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&r.length&&r.push(We({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i}});function yT(e){z.call(this,null,e)}function Yee(){return We({})}function Zee(e){const t=ld().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}Q(yT,z,{transform(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||Yee,s=e.key||ge,o=this.value;return V(i.encode)&&(i.encode=null),o&&(e.modified("key")||t.modified(s))&&te("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=Zee(s)),t.visit(t.ADD,a=>{const u=s(a);let l=o.get(u);l?l.exit?(o.empty--,i.add.push(l)):i.mod.push(l):(l=r(a),o.set(u,l),i.add.push(l)),l.datum=a,l.exit=!1}),t.visit(t.MOD,a=>{const u=s(a),l=o.get(u);l&&(l.datum=a,i.mod.push(l))}),t.visit(t.REM,a=>{const u=s(a),l=o.get(u);a===l.datum&&!l.exit&&(i.rem.push(l),l.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),i}});function vT(e){z.call(this,null,e)}Q(vT,z,{transform(e,t){var n=t.fork(t.ADD_REM),i=e.mod||!1,r=e.encoders,s=t.encode;if(V(s))if(n.changed()||s.every(f=>r[f]))s=s[0],n.encode=null;else return t.StopPropagation;var o=s==="enter",a=r.update||oa,u=r.enter||oa,l=r.exit||oa,c=(s&&!o?r[s]:a)||oa;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),a(f,e)}),n.modifies(u.output),n.modifies(a.output),c!==oa&&c!==a&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==oa&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),o||c!==oa){const f=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(f,d=>{const h=u(d,e)||i;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||i)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function bT(e){z.call(this,[],e)}Q(bT,z,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.type||Hh,o=e.scale,a=+e.limit,u=pb(o,e.count==null?5:e.count,e.minstep),l=!!e.values||s===Hh,c=e.format||oM(n,o,u,s,e.formatSpecifier,e.formatType,l),f=e.values||sM(o,u),d,h,p,g,m;return r&&(i.rem=r),s===Hh?(a&&f.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),r=f.slice(0,a-1),m=!0):r=f,Me(p=e.size)?(!e.values&&o(r[0])===0&&(r=r.slice(1)),g=r.reduce((y,v)=>Math.max(y,p(v,e)),0)):p=Pn(g=p||8),r=r.map((y,v)=>We({index:v,label:c(y,v,r),value:y,offset:g,size:p(y,e)})),m&&(m=f[r.length],r.push(We({index:r.length,label:`…${f.length-r.length} entries`,value:m,offset:g,size:p(m,e)})))):s===aK?(d=o.domain(),h=X$(o,d[0],Xe(d)),f.length<3&&!e.values&&d[0]!==Xe(d)&&(f=[d[0],Xe(d)]),r=f.map((y,v)=>We({index:v,label:c(y,v,f),value:y,perc:h(y)}))):(p=f.length-1,h=vK(o),r=f.map((y,v)=>We({index:v,label:c(y,v,f),value:y,perc:v?h(y):0,perc2:v===p?1:h(f[v+1])}))),i.source=r,i.add=r,this.value=r,i}});const Xee=e=>e.source.x,Kee=e=>e.source.y,Jee=e=>e.target.x,Qee=e=>e.target.y;function Gb(e){z.call(this,{},e)}Gb.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};Q(Gb,z,{transform(e,t){var n=e.sourceX||Xee,i=e.sourceY||Kee,r=e.targetX||Jee,s=e.targetY||Qee,o=e.as||"path",a=e.orient||"vertical",u=e.shape||"line",l=D_.get(u+"-"+a)||D_.get(u);return l||te("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[o]=l(n(c),i(c),r(c),s(c))}),t.reflow(e.modified()).modifies(o)}});const xT=(e,t,n,i)=>"M"+e+","+t+"L"+n+","+i,ete=(e,t,n,i)=>xT(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),_T=(e,t,n,i)=>{var r=n-e,s=i-t,o=Math.hypot(r,s)/2,a=180*Math.atan2(s,r)/Math.PI;return"M"+e+","+t+"A"+o+","+o+" "+a+" 0 1 "+n+","+i},tte=(e,t,n,i)=>_T(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),wT=(e,t,n,i)=>{const r=n-e,s=i-t,o=.2*(r+s),a=.2*(s-r);return"M"+e+","+t+"C"+(e+o)+","+(t+a)+" "+(n+a)+","+(i-o)+" "+n+","+i},nte=(e,t,n,i)=>wT(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),ite=(e,t,n,i)=>"M"+e+","+t+"V"+i+"H"+n,rte=(e,t,n,i)=>"M"+e+","+t+"H"+n+"V"+i,ste=(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*r+","+t*s+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*o+","+t*a+"L"+i*o+","+i*a},ote=(e,t,n,i)=>{const r=(e+n)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+i+" "+n+","+i},ate=(e,t,n,i)=>{const r=(t+i)/2;return"M"+e+","+t+"C"+e+","+r+" "+n+","+r+" "+n+","+i},ute=(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),u=(t+i)/2;return"M"+t*r+","+t*s+"C"+u*r+","+u*s+" "+u*o+","+u*a+" "+i*o+","+i*a},D_=ld({line:xT,"line-radial":ete,arc:_T,"arc-radial":tte,curve:wT,"curve-radial":nte,"orthogonal-horizontal":ite,"orthogonal-vertical":rte,"orthogonal-radial":ste,"diagonal-horizontal":ote,"diagonal-vertical":ate,"diagonal-radial":ute});function Yb(e){z.call(this,null,e)}Yb.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};Q(Yb,z,{transform(e,t){var n=e.as||["startAngle","endAngle"],i=n[0],r=n[1],s=e.field||ud,o=e.startAngle||0,a=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(s),c=l.length,f=o,d=(a-o)/wC(l),h=li(c),p,g,m;for(e.sort&&h.sort((y,v)=>l[y]-l[v]),p=0;p<c;++p)m=l[h[p]],g=u[h[p]],g[i]=f,g[r]=f+=m*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const lte=5;function cte(e){const t=e.type;return!e.bins&&(t===hl||t===gd||t===md)}function ET(e){return W$(e)&&e!==Lr}const fte=Br(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function CT(e){z.call(this,null,e),this.modified(!0)}Q(CT,z,{transform(e,t){var n=t.dataflow,i=this.value,r=dte(e);(!i||r!==i.type)&&(this.value=i=He(r)());for(r in e)if(!fte[r]){if(r==="padding"&&ET(i.type))continue;Me(i[r])?i[r](e[r]):n.warn("Unsupported scale property: "+r)}return vte(i,e,yte(i,e,pte(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function dte(e){var t=e.type,n="",i;return t===Lr?Lr+"-"+hl:(hte(e)&&(i=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=i===2?Lr+"-":i===3?Ul+"-":""),(n+t||hl).toLowerCase())}function hte(e){const t=e.type;return W$(t)&&t!==Ga&&t!==Ya&&(e.scheme||e.range&&e.range.length&&e.range.every(le))}function pte(e,t,n){const i=gte(e,t.domainRaw,n);if(i>-1)return i;var r=t.domain,s=e.type,o=t.zero||t.zero===void 0&&cte(e),a,u;if(!r)return 0;if((o||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(a=(r=r.slice()).length-1||1,o&&(r[0]>0&&(r[0]=0),r[a]<0&&(r[a]=0)),t.domainMin!=null&&(r[0]=t.domainMin),t.domainMax!=null&&(r[a]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>r[a]?a+1:u<r[0]?0:a;l!==a&&n.warn("Scale domainMid exceeds domain min or max.",u),r.splice(l,0,u)}return ET(s)&&t.padding&&r[0]!==Xe(r)&&(r=mte(s,r,t.range,t.padding,t.exponent,t.constant)),e.domain(ST(s,r,n)),s===lb&&e.unknown(t.domainImplicit?j2:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&pb(e,t.nice)||null),r.length}function gte(e,t,n){return t?(e.domain(ST(e.type,t,n)),t.length):-1}function mte(e,t,n,i,r,s){var o=Math.abs(Xe(n)-n[0]),a=o/(o-2*i),u=e===zs?mA(t,null,a):e===md?W2(t,null,a,.5):e===gd?W2(t,null,a,r||1):e===Ng?yA(t,null,a,s||1):gA(t,null,a);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function ST(e,t,n){if(Y$(e)){var i=Math.abs(t.reduce((r,s)=>r+(s<0?-1:s>0?1:0),0));i!==t.length&&n.warn("Log scale domain includes zero: "+xe(t))}return t}function yte(e,t,n){let i=t.bins;if(i&&!V(i)){const r=e.domain(),s=r[0],o=Xe(r),a=i.step;let u=i.start==null?s:i.start,l=i.stop==null?o:i.stop;a||te("Scale bins parameter missing step property."),u<s&&(u=a*Math.ceil(s/a)),l>o&&(l=a*Math.floor(o/a)),i=li(u,l+a/2,a)}return i?e.bins=i:e.bins&&delete e.bins,e.type===cb&&(i?!t.domain&&!t.domainRaw&&(e.domain(i),n=i.length):e.bins=e.domain()),n}function vte(e,t,n){var i=e.type,r=t.round||!1,s=t.range;if(t.rangeStep!=null)s=bte(i,t,n);else if(t.scheme&&(s=xte(i,t,n),Me(s))){if(e.interpolator)return e.interpolator(s);te(`Scale type ${i} does not support interpolating color schemes.`)}if(s&&Z$(i))return e.interpolator(hb(yv(s,t.reverse),t.interpolate,t.interpolateGamma));s&&t.interpolate&&e.interpolate?e.interpolate(K$(t.interpolate,t.interpolateGamma)):Me(e.round)?e.round(r):Me(e.rangeRound)&&e.interpolate(r?nd:jo),s&&e.range(yv(s,t.reverse))}function bte(e,t,n){e!==U$&&e!==iv&&te("Only band and point scales support rangeStep.");var i=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,r=e===iv?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*ub(n,r,i)]}function xte(e,t,n){var i=t.schemeExtent,r,s;return V(t.scheme)?s=hb(t.scheme,t.interpolate,t.interpolateGamma):(r=t.scheme.toLowerCase(),s=eM(r),s||te(`Unrecognized scheme name: ${t.scheme}`)),n=e===Rg?n+1:e===cb?n-1:e===Of||e===Dg?+t.schemeCount||lte:n,Z$(e)?R_(s,i,t.reverse):Me(s)?nK(R_(s,i),n):e===lb?s:s.slice(0,n)}function R_(e,t,n){return Me(e)&&(t||n)?tK(e,yv(t||[0,1],n)):e}function yv(e,t){return t?e.slice().reverse():e}function kT(e){z.call(this,null,e)}Q(kT,z,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(hu(e.sort)),this.modified(n),t}});const O_="zero",AT="center",$T="normalize",MT=["y0","y1"];function Zb(e){z.call(this,null,e)}Zb.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:O_,values:[O_,AT,$T]},{name:"as",type:"string",array:!0,length:2,default:MT}]};Q(Zb,z,{transform(e,t){var n=e.as||MT,i=n[0],r=n[1],s=hu(e.sort),o=e.field||ud,a=e.offset===AT?_te:e.offset===$T?wte:Ete,u,l,c,f;for(u=Cte(t.source,e.groupby,s,o),l=0,c=u.length,f=u.max;l<c;++l)a(u[l],f,o,i,r);return t.reflow(e.modified()).modifies(n)}});function _te(e,t,n,i,r){for(var s=(t-e.sum)/2,o=e.length,a=0,u;a<o;++a)u=e[a],u[i]=s,u[r]=s+=Math.abs(n(u))}function wte(e,t,n,i,r){for(var s=1/e.sum,o=0,a=e.length,u=0,l=0,c;u<a;++u)c=e[u],c[i]=o,c[r]=o=s*(l+=Math.abs(n(c)))}function Ete(e,t,n,i,r){for(var s=0,o=0,a=e.length,u=0,l,c;u<a;++u)c=e[u],l=+n(c),l<0?(c[i]=o,c[r]=o+=l):(c[i]=s,c[r]=s+=l)}function Cte(e,t,n,i){var r=[],s=g=>g(c),o,a,u,l,c,f,d,h,p;if(t==null)r.push(e.slice());else for(o={},a=0,u=e.length;a<u;++a)c=e[a],f=t.map(s),d=o[f],d||(o[f]=d=[],r.push(d)),d.push(c);for(f=0,p=0,l=r.length;f<l;++f){for(d=r[f],a=0,h=0,u=d.length;a<u;++a)h+=Math.abs(i(d[a]));d.sum=h,h>p&&(p=h),n&&d.sort(n)}return r.max=p,r}const Ste=Object.freeze(Object.defineProperty({__proto__:null,axisticks:mT,datajoin:yT,encode:vT,legendentries:bT,linkpath:Gb,pie:Yb,scale:CT,sortitems:kT,stack:Zb},Symbol.toStringTag,{value:"Module"}));var kte=Math.abs,vv=Math.cos,pp=Math.sin,Ate=1e-6,TT=Math.PI,bv=TT/2,I_=$te(2);function P_(e){return e>1?bv:e<-1?-bv:Math.asin(e)}function $te(e){return e>0?Math.sqrt(e):0}function Mte(e,t){var n=e*pp(t),i=30,r;do t-=r=(t+pp(t)-n)/(1+vv(t));while(kte(r)>Ate&&--i>0);return t/2}function Tte(e,t,n){function i(r,s){return[e*r*vv(s=Mte(n,s)),t*pp(s)]}return i.invert=function(r,s){return s=P_(s/t),[r/(e*vv(s)),P_((2*s+pp(2*s))/n)]},i}var Fte=Tte(I_/bv,I_,TT);function Lte(){return Gr(Fte).scale(169.529)}const Nte=KS(),xv=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function Dte(e,t){return function n(){const i=t();return i.type=e,i.path=KS().projection(i),i.copy=i.copy||function(){const r=n();return xv.forEach(s=>{i[s]&&r[s](i[s]())}),r.path.pointRadius(i.path.pointRadius()),r},V$(i)}}function FT(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(gp[e]=Dte(e,t),this):gp[e]||null}function LT(e){return e&&e.path||Nte}const gp={albers:QS,albersusa:LH,azimuthalequalarea:NH,azimuthalequidistant:DH,conicconformal:IH,conicequalarea:H0,conicequidistant:BH,equalEarth:jH,equirectangular:PH,gnomonic:HH,identity:qH,mercator:RH,mollweide:Lte,naturalEarth1:VH,orthographic:WH,stereographic:GH,transversemercator:YH};for(const e in gp)FT(e,gp[e]);function Rte(){}const us=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function NT(){var e=1,t=1,n=a;function i(u,l){return l.map(c=>r(u,c))}function r(u,l){var c=[],f=[];return s(u,l,d=>{n(d,u,l),Ote(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,p=c.length,g;h<p;++h)if(Ite((g=c[h])[0],d)!==-1){g.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function s(u,l,c){var f=[],d=[],h,p,g,m,y,v;for(h=p=-1,m=u[0]>=l,us[m<<1].forEach(b);++h<e-1;)g=m,m=u[h+1]>=l,us[g|m<<1].forEach(b);for(us[m<<0].forEach(b);++p<t-1;){for(h=-1,m=u[p*e+e]>=l,y=u[p*e]>=l,us[m<<1|y<<2].forEach(b);++h<e-1;)g=m,m=u[p*e+e+h+1]>=l,v=y,y=u[p*e+h+1]>=l,us[g|m<<1|y<<2|v<<3].forEach(b);us[m|y<<3].forEach(b)}for(h=-1,y=u[p*e]>=l,us[y<<2].forEach(b);++h<e-1;)v=y,y=u[p*e+h+1]>=l,us[y<<2|v<<3].forEach(b);us[y<<3].forEach(b);function b(x){var _=[x[0][0]+h,x[0][1]+p],E=[x[1][0]+h,x[1][1]+p],w=o(_),S=o(E),$,F;($=d[w])?(F=f[S])?(delete d[$.end],delete f[F.start],$===F?($.ring.push(E),c($.ring)):f[$.start]=d[F.end]={start:$.start,end:F.end,ring:$.ring.concat(F.ring)}):(delete d[$.end],$.ring.push(E),d[$.end=S]=$):($=f[S])?(F=d[w])?(delete f[$.start],delete d[F.end],$===F?($.ring.push(E),c($.ring)):f[F.start]=d[$.end]={start:F.start,end:$.end,ring:F.ring.concat($.ring)}):(delete f[$.start],$.ring.unshift(_),f[$.start=w]=$):f[w]=d[S]={start:w,end:S,ring:[_,E]}}}function o(u){return u[0]*2+u[1]*(e+1)*4}function a(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],p=d|0,g=h|0,m,y=l[g*e+p];d>0&&d<e&&p===d&&(m=l[g*e+p-1],f[0]=d+(c-m)/(y-m)-.5),h>0&&h<t&&g===h&&(m=l[(g-1)*e+p],f[1]=h+(c-m)/(y-m)-.5)})}return i.contour=r,i.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||te("invalid size"),e=l,t=c,i},i.smooth=function(u){return arguments.length?(n=u?a:Rte,i):n===a},i}function Ote(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}function Ite(e,t){for(var n=-1,i=t.length,r;++n<i;)if(r=Pte(e,t[n]))return r;return 0}function Pte(e,t){for(var n=t[0],i=t[1],r=-1,s=0,o=e.length,a=o-1;s<o;a=s++){var u=e[s],l=u[0],c=u[1],f=e[a],d=f[0],h=f[1];if(zte(u,f,t))return 0;c>i!=h>i&&n<(d-l)*(i-c)/(h-c)+l&&(r=-r)}return r}function zte(e,t,n){var i;return Bte(e,t,n)&&Ute(e[i=+(e[0]===t[0])],n[i],t[i])}function Bte(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function Ute(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function DT(e,t,n){return function(i){var r=Os(i),s=n?Math.min(r[0],0):r[0],o=r[1],a=o-s,u=t?ko(s,o,e):a/(e+1);return li(s+u,o,u)}}function Xb(e){z.call(this,null,e)}Xb.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};Q(Xb,z,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e.field||In,s=NT().smooth(e.smooth!==!1),o=e.thresholds||jte(i,r,e),a=e.as===null?null:e.as||"contour",u=[];return i.forEach(l=>{const c=r(l),f=s.size([c.width,c.height])(c.values,V(o)?o:o(c.values));Hte(f,c,l,e),f.forEach(d=>{u.push(Tg(l,We(a!=null?{[a]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function jte(e,t,n){const i=DT(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?i:i(e.map(r=>$a(t(r).values)))}function Hte(e,t,n,i){let r=i.scale||t.scale,s=i.translate||t.translate;if(Me(r)&&(r=r(n,i)),Me(s)&&(s=s(n,i)),(r===1||r==null)&&!s)return;const o=(Ke(r)?r:r[0])||1,a=(Ke(r)?r:r[1])||1,u=s&&s[0]||0,l=s&&s[1]||0;e.forEach(RT(t,o,a,u,l))}function RT(e,t,n,i,r){const s=e.x1||0,o=e.y1||0,a=t*n<0;function u(f){f.forEach(l)}function l(f){a&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-s)*t+i,f[1]=(f[1]-o)*n+r}return function(f){return f.coordinates.forEach(u),f}}function z_(e,t,n){const i=e>=0?e:JA(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function Wm(e){return Me(e)?e:Pn(+e)}function OT(){var e=u=>u[0],t=u=>u[1],n=ud,i=[-1,-1],r=960,s=500,o=2;function a(u,l){const c=z_(i[0],u,e)>>o,f=z_(i[1],u,t)>>o,d=c?c+2:0,h=f?f+2:0,p=2*d+(r>>o),g=2*h+(s>>o),m=new Float32Array(p*g),y=new Float32Array(p*g);let v=m;u.forEach(x=>{const _=d+(+e(x)>>o),E=h+(+t(x)>>o);_>=0&&_<p&&E>=0&&E<g&&(m[_+E*p]+=+n(x))}),c>0&&f>0?(Lu(p,g,m,y,c),Nu(p,g,y,m,f),Lu(p,g,m,y,c),Nu(p,g,y,m,f),Lu(p,g,m,y,c),Nu(p,g,y,m,f)):c>0?(Lu(p,g,m,y,c),Lu(p,g,y,m,c),Lu(p,g,m,y,c),v=y):f>0&&(Nu(p,g,m,y,f),Nu(p,g,y,m,f),Nu(p,g,m,y,f),v=y);const b=l?Math.pow(2,-2*o):1/wC(v);for(let x=0,_=p*g;x<_;++x)v[x]*=b;return{values:v,scale:1<<o,width:p,height:g,x1:d,y1:h,x2:d+(r>>o),y2:h+(s>>o)}}return a.x=function(u){return arguments.length?(e=Wm(u),a):e},a.y=function(u){return arguments.length?(t=Wm(u),a):t},a.weight=function(u){return arguments.length?(n=Wm(u),a):n},a.size=function(u){if(!arguments.length)return[r,s];var l=+u[0],c=+u[1];return l>=0&&c>=0||te("invalid size"),r=l,s=c,a},a.cellSize=function(u){return arguments.length?((u=+u)>=1||te("invalid cell size"),o=Math.floor(Math.log(u)/Math.LN2),a):1<<o},a.bandwidth=function(u){return arguments.length?(u=ce(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&te("invalid bandwidth"),i=u,a):i},a}function Lu(e,t,n,i,r){const s=(r<<1)+1;for(let o=0;o<t;++o)for(let a=0,u=0;a<e+r;++a)a<e&&(u+=n[a+o*e]),a>=r&&(a>=s&&(u-=n[a-s+o*e]),i[a-r+o*e]=u/Math.min(a+1,e-1+s-a,s))}function Nu(e,t,n,i,r){const s=(r<<1)+1;for(let o=0;o<e;++o)for(let a=0,u=0;a<t+r;++a)a<t&&(u+=n[o+a*e]),a>=r&&(a>=s&&(u-=n[o+(a-s)*e]),i[o+(a-r)*e]=u/Math.min(a+1,t-1+s-a,s))}function Kb(e){z.call(this,null,e)}Kb.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const qte=["x","y","weight","size","cellSize","bandwidth"];function IT(e,t){return qte.forEach(n=>t[n]!=null?e[n](t[n]):0),e}Q(Kb,z,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=Vte(i,e.groupby),s=(e.groupby||[]).map(kt),o=IT(OT(),e),a=e.as||"grid",u=[];function l(c,f){for(let d=0;d<s.length;++d)c[s[d]]=f[d];return c}return u=r.map(c=>We(l({[a]:o(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function Vte(e,t){var n=[],i=c=>c(a),r,s,o,a,u,l;if(t==null)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function Jb(e){z.call(this,null,e)}Jb.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};Q(Jb,z,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=NT().smooth(e.smooth!==!1),r=e.values,s=e.thresholds||DT(e.count||10,e.nice,!!r),o=e.size,a,u;return r||(r=t.materialize(t.SOURCE).source,a=IT(OT(),e)(r,!0),u=RT(a,a.scale||1,a.scale||1,0,0),o=[a.width,a.height],r=a.values),s=V(s)?s:s(r),r=i.size(o)(r,s),u&&r.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(r||[]).map(We),n}});const _v="Feature",Qb="FeatureCollection",Wte="MultiPoint";function ex(e){z.call(this,null,e)}ex.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};Q(ex,z,{transform(e,t){var n=this._features,i=this._points,r=e.fields,s=r&&r[0],o=r&&r[1],a=e.geojson||!r&&In,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(Fn(a))||s&&t.modified(Fn(s))||o&&t.modified(Fn(o)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=i=[]),a&&t.visit(u,c=>n.push(a(c))),s&&o&&(t.visit(u,c=>{var f=s(c),d=o(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&i.push([f,d])}),n=n.concat({type:_v,geometry:{type:Wte,coordinates:i}})),this.value={type:Qb,features:n}}});function tx(e){z.call(this,null,e)}tx.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};Q(tx,z,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||In,s=e.as||"path",o=n.SOURCE;!i||e.modified()?(this.value=i=LT(e.projection),n.materialize().reflow()):o=r===In||t.modified(r.fields)?n.ADD_MOD:n.ADD;const a=Gte(i,e.pointRadius);return n.visit(o,u=>u[s]=i(r(u))),i.pointRadius(a),n.modifies(s)}});function Gte(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function nx(e){z.call(this,null,e)}nx.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};Q(nx,z,{transform(e,t){var n=e.projection,i=e.fields[0],r=e.fields[1],s=e.as||["x","y"],o=s[0],a=s[1],u;function l(c){const f=n([i(c),r(c)]);f?(c[o]=f[0],c[a]=f[1]):(c[o]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(i.fields)||t.modified(r.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(s)}});function ix(e){z.call(this,null,e)}ix.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};Q(ix,z,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||"shape",s=n.ADD;return(!i||e.modified())&&(this.value=i=Yte(LT(e.projection),e.field||Ji("datum"),e.pointRadius),n.materialize().reflow(),s=n.SOURCE),n.visit(s,o=>o[r]=i),n.modifies(r)}});function Yte(e,t,n){const i=n==null?r=>e(t(r)):r=>{var s=e.pointRadius(),o=e.pointRadius(n)(t(r));return e.pointRadius(s),o};return i.context=r=>(e.context(r),i),i}function rx(e){z.call(this,[],e),this.generator=fH()}rx.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};Q(rx,z,{transform(e,t){var n=this.value,i=this.generator,r;if(!n.length||e.modified())for(const s in e)Me(i[s])&&i[s](e[s]);return r=i(),n.length?t.mod.push(qA(n[0],r)):t.add.push(We(r)),n[0]=r,t}});function sx(e){z.call(this,null,e)}sx.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};Q(sx,z,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,i=e.resolve==="shared",r=e.field||In,s=Xte(e.opacity,e),o=Zte(e.color,e),a=e.as||"image",u={$x:0,$y:0,$value:0,$max:i?$a(n.map(l=>$a(r(l).values))):0};return n.forEach(l=>{const c=r(l),f=Ht({},l,u);i||(f.$max=$a(c.values||[])),l[a]=Kte(c,f,o.dep?o:Pn(o(f)),s.dep?s:Pn(s(f)))}),t.reflow(!0).modifies(a)}});function Zte(e,t){let n;return Me(e)?(n=i=>Ao(e(i,t)),n.dep=PT(e)):n=Pn(Ao(e||"#888")),n}function Xte(e,t){let n;return Me(e)?(n=i=>e(i,t),n.dep=PT(e)):e?n=Pn(e):(n=i=>i.$value/i.$max||0,n.dep=!0),n}function PT(e){if(!Me(e))return!1;const t=Br(Fn(e));return t.$x||t.$y||t.$value||t.$max}function Kte(e,t,n,i){const r=e.width,s=e.height,o=e.x1||0,a=e.y1||0,u=e.x2||r,l=e.y2||s,c=e.values,f=c?m=>c[m]:ga,d=_o(u-o,l-a),h=d.getContext("2d"),p=h.getImageData(0,0,u-o,l-a),g=p.data;for(let m=a,y=0;m<l;++m){t.$y=m-a;for(let v=o,b=m*r;v<u;++v,y+=4){t.$x=v-o,t.$value=f(v+b);const x=n(t);g[y+0]=x.r,g[y+1]=x.g,g[y+2]=x.b,g[y+3]=~~(255*i(t))}}return h.putImageData(p,0,0),d}function zT(e){z.call(this,null,e),this.modified(!0)}Q(zT,z,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=Qte(e.type),xv.forEach(i=>{e[i]!=null&&B_(n,i,e[i])})):xv.forEach(i=>{e.modified(i)&&B_(n,i,e[i])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&Jte(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Jte(e,t){const n=ene(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function Qte(e){const t=FT((e||"mercator").toLowerCase());return t||te("Unrecognized projection type: "+e),t()}function B_(e,t,n){Me(e[t])&&e[t](n)}function ene(e){return e=ce(e),e.length===1?e[0]:{type:Qb,features:e.reduce((t,n)=>t.concat(tne(n)),[])}}function tne(e){return e.type===Qb?e.features:ce(e).filter(t=>t!=null).map(t=>t.type===_v?t:{type:_v,geometry:t})}const nne=Object.freeze(Object.defineProperty({__proto__:null,contour:Jb,geojson:ex,geopath:tx,geopoint:nx,geoshape:ix,graticule:rx,heatmap:sx,isocontour:Xb,kde2d:Kb,projection:zT},Symbol.toStringTag,{value:"Module"})),U_={center:tj,collide:xj,nbody:Fj,link:wj,x:Lj,y:Nj},Hc="forces",wv=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],ine=["static","iterations"],BT=["x","y","vx","vy"];function ox(e){z.call(this,null,e)}ox.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:BT}]};Q(ox,z,{transform(e,t){var n=this.value,i=t.changed(t.ADD_REM),r=e.modified(wv),s=e.iterations||300;if(n?(i&&(t.modifies("index"),n.nodes(t.source)),(r||t.changed(t.MOD))&&UT(n,e,0,t)):(this.value=n=sne(t.source,e),n.on("tick",rne(t.dataflow,this)),e.static||(i=!0,n.tick()),t.modifies("index")),r||i||e.modified(ine)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/s)),e.static)for(n.stop();--s>=0;)n.tick();else if(n.stopped()&&n.restart(),!i)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let a=this._argops,u=0,l=a.length,c;u<l;++u)if(c=a[u],!(c.name!==Hc||c.op._argval.force!=="link")){for(var i=c.op._argops,r=0,s=i.length,o;r<s;++r)if(i[r].name==="links"&&(o=i[r].op.source)){n.pulse(o,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(BT)}});function rne(e,t){return()=>e.touch(t).run()}function sne(e,t){const n=Tj(e),i=n.stop,r=n.restart;let s=!1;return n.stopped=()=>s,n.restart=()=>(s=!1,r()),n.stop=()=>(s=!0,i()),UT(n,t,!0).on("end",()=>s=!0)}function UT(e,t,n,i){var r=ce(t.forces),s,o,a,u;for(s=0,o=wv.length;s<o;++s)a=wv[s],a!==Hc&&t.modified(a)&&e[a](t[a]);for(s=0,o=r.length;s<o;++s)u=Hc+s,a=n||t.modified(Hc,s)?ane(r[s]):i&&one(r[s],i)?e.force(u):null,a&&e.force(u,a);for(o=e.numForces||0;s<o;++s)e.force(Hc+s,null);return e.numForces=r.length,e}function one(e,t){var n,i;for(n in e)if(Me(i=e[n])&&t.modified(Fn(i)))return 1;return 0}function ane(e){var t,n;pe(U_,e.force)||te("Unrecognized force: "+e.force),t=U_[e.force]();for(n in e)Me(t[n])&&une(t[n],e[n],e);return t}function une(e,t,n){e(Me(t)?i=>t(i,n):t)}const lne=Object.freeze(Object.defineProperty({__proto__:null,force:ox},Symbol.toStringTag,{value:"Module"}));function Ev(e,t,n){const i={};return e.each(r=>{const s=r.data;n(s)&&(i[t(s)]=r)}),e.lookup=i,e}function ax(e){z.call(this,null,e)}ax.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const cne=e=>e.values;Q(ax,z,{transform(e,t){t.source||te("Nest transform requires an upstream data source.");var n=e.generate,i=e.modified(),r=t.clone(),s=this.value;return(!s||i||t.changed())&&(s&&s.each(o=>{o.children&&A5(o.data)&&r.rem.push(o.data)}),this.value=s=s5({values:ce(e.keys).reduce((o,a)=>(o.key(a),o),fne()).entries(r.source)},cne),n&&s.each(o=>{o.children&&(o=We(o.data),r.add.push(o),r.source.push(o))}),Ev(s,ge,ge)),r.source.root=s,r}});function fne(){const e=[],t={entries:r=>i(n(r,0),0),key:r=>(e.push(r),t)};function n(r,s){if(s>=e.length)return r;const o=r.length,a=e[s++],u={},l={};let c=-1,f,d,h;for(;++c<o;)f=a(d=r[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],s);return l}function i(r,s){if(++s>e.length)return r;const o=[];for(const a in r)o.push({key:a,values:i(r[a],s)});return o}return t}function Vs(e){z.call(this,null,e)}const dne=(e,t)=>e.parent===t.parent?1:2;Q(Vs,z,{transform(e,t){(!t.source||!t.source.root)&&te(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),i=this.fields,r=t.source.root,s=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort(hu(e.sort,o=>o.data)),hne(n,this.params,e),n.separation&&n.separation(e.separation!==!1?dne:ud);try{this.value=n(r)}catch(o){te(o)}return r.each(o=>pne(o,i,s)),t.reflow(e.modified()).modifies(s).modifies("leaf")}});function hne(e,t,n){for(let i,r=0,s=t.length;r<s;++r)i=t[r],i in n&&e[i](n[i])}function pne(e,t,n){const i=e.data,r=t.length-1;for(let s=0;s<r;++s)i[n[s]]=e[t[s]];i[n[r]]=e.children?e.children.length:0}const Cv=["x","y","r","depth","children"];function ux(e){Vs.call(this,e)}ux.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Cv.length,default:Cv}]};Q(ux,Vs,{layout:Nq,params:["radius","size","padding"],fields:Cv});const Sv=["x0","y0","x1","y1","depth","children"];function lx(e){Vs.call(this,e)}lx.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Sv.length,default:Sv}]};Q(lx,Vs,{layout:Dq,params:["size","round","padding"],fields:Sv});function cx(e){z.call(this,null,e)}cx.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};Q(cx,z,{transform(e,t){t.source||te("Stratify transform requires an upstream data source.");let n=this.value;const i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),s=!n||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),s&&(n=r.source.length?Ev(i8().id(e.key).parentId(e.parentKey)(r.source),e.key,Qi):Ev(i8()([{}]),e.key,e.key)),r.source.root=this.value=n,r}});const j_={tidy:qq,cluster:nq},kv=["x","y","depth","children"];function fx(e){Vs.call(this,e)}fx.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:kv.length,default:kv}]};Q(fx,Vs,{layout(e){const t=e||"tidy";if(pe(j_,t))return j_[t]();te("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:kv});function dx(e){z.call(this,[],e)}dx.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};Q(dx,z,{transform(e,t){const n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),s={};return i||te("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,o=>s[ge(o)]=1),i.each(o=>{const a=o.data,u=o.parent&&o.parent.data;u&&s[ge(a)]&&s[ge(u)]&&r.add.push(We({source:u,target:a}))}),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,o=>s[ge(o)]=1),n.forEach(o=>{(s[ge(o.source)]||s[ge(o.target)])&&r.mod.push(o)})),r}});const H_={binary:Wq,dice:od,slice:cg,slicedice:Gq,squarify:yk,resquarify:Yq},Av=["x0","y0","x1","y1","depth","children"];function hx(e){Vs.call(this,e)}hx.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Av.length,default:Av}]};Q(hx,Vs,{layout(){const e=Vq();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{pe(H_,t)?e.tile(H_[t]):te("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:Av});const gne=Object.freeze(Object.defineProperty({__proto__:null,nest:ax,pack:ux,partition:lx,stratify:cx,tree:fx,treelinks:dx,treemap:hx},Symbol.toStringTag,{value:"Module"})),Gm=4278190080;function mne(e,t){const n=e.bitmap();return(t||[]).forEach(i=>n.set(e(i.boundary[0]),e(i.boundary[3]))),[n,void 0]}function yne(e,t,n,i,r){const s=e.width,o=e.height,a=i||r,u=_o(s,o).getContext("2d"),l=_o(s,o).getContext("2d"),c=a&&_o(s,o).getContext("2d");n.forEach(S=>Jh(u,S,!1)),Jh(l,t,!1),a&&Jh(c,t,!0);const f=Ym(u,s,o),d=Ym(l,s,o),h=a&&Ym(c,s,o),p=e.bitmap(),g=a&&e.bitmap();let m,y,v,b,x,_,E,w;for(y=0;y<o;++y)for(m=0;m<s;++m)x=y*s+m,_=f[x]&Gm,w=d[x]&Gm,E=a&&h[x]&Gm,(_||E||w)&&(v=e(m),b=e(y),!r&&(_||w)&&p.set(v,b),a&&(_||E)&&g.set(v,b));return[p,g]}function Ym(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function Jh(e,t,n){if(!t.length)return;const i=t[0].mark.marktype;i==="group"?t.forEach(r=>{r.items.forEach(s=>Jh(e,s.items,n))}):Fi[i].draw(e,{items:n?t.map(vne):t})}function vne(e){const t=Tg(e,{});return t.stroke&&t.strokeOpacity!==0||t.fill&&t.fillOpacity!==0?{...t,strokeOpacity:1,stroke:"#000",fillOpacity:0}:t}const ls=5,mn=31,zf=32,uo=new Uint32Array(zf+1),Bi=new Uint32Array(zf+1);Bi[0]=0;uo[0]=~Bi[0];for(let e=1;e<=zf;++e)Bi[e]=Bi[e-1]<<1|1,uo[e]=~Bi[e];function bne(e,t){const n=new Uint32Array(~~((e*t+zf)/zf));function i(s,o){n[s]|=o}function r(s,o){n[s]&=o}return{array:n,get:(s,o)=>{const a=o*e+s;return n[a>>>ls]&1<<(a&mn)},set:(s,o)=>{const a=o*e+s;i(a>>>ls,1<<(a&mn))},clear:(s,o)=>{const a=o*e+s;r(a>>>ls,~(1<<(a&mn)))},getRange:(s,o,a,u)=>{let l=u,c,f,d,h;for(;l>=o;--l)if(c=l*e+s,f=l*e+a,d=c>>>ls,h=f>>>ls,d===h){if(n[d]&uo[c&mn]&Bi[(f&mn)+1])return!0}else{if(n[d]&uo[c&mn]||n[h]&Bi[(f&mn)+1])return!0;for(let p=d+1;p<h;++p)if(n[p])return!0}return!1},setRange:(s,o,a,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+s,c=o*e+a,f=l>>>ls,d=c>>>ls,f===d)i(f,uo[l&mn]&Bi[(c&mn)+1]);else for(i(f,uo[l&mn]),i(d,Bi[(c&mn)+1]),h=f+1;h<d;++h)i(h,4294967295)},clearRange:(s,o,a,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+s,c=o*e+a,f=l>>>ls,d=c>>>ls,f===d)r(f,Bi[l&mn]|uo[(c&mn)+1]);else for(r(f,Bi[l&mn]),r(d,uo[(c&mn)+1]),h=f+1;h<d;++h)r(h,0)},outOfBounds:(s,o,a,u)=>s<0||o<0||u>=t||a>=e}}function xne(e,t,n){const i=Math.max(1,Math.sqrt(e*t/1e6)),r=~~((e+2*n+i)/i),s=~~((t+2*n+i)/i),o=a=>~~((a+n)/i);return o.invert=a=>a*i-n,o.bitmap=()=>bne(r,s),o.ratio=i,o.padding=n,o.width=e,o.height=t,o}function _ne(e,t,n,i){const r=e.width,s=e.height;return function(o){const a=o.datum.datum.items[i].items,u=a.length,l=o.datum.fontSize,c=Ai.width(o.datum,o.datum.text);let f=0,d,h,p,g,m,y,v;for(let b=0;b<u;++b)d=a[b].x,p=a[b].y,h=a[b].x2===void 0?d:a[b].x2,g=a[b].y2===void 0?p:a[b].y2,m=(d+h)/2,y=(p+g)/2,v=Math.abs(h-d+g-p),v>=f&&(f=v,o.x=m,o.y=y);return m=c/2,y=l/2,d=o.x-m,h=o.x+m,p=o.y-y,g=o.y+y,o.align="center",d<0&&h<=r?o.align="left":0<=d&&r<h&&(o.align="right"),o.baseline="middle",p<0&&g<=s?o.baseline="top":0<=p&&s<g&&(o.baseline="bottom"),!0}}function mp(e,t,n,i,r,s){let o=n/2;return e-o<0||e+o>r||t-(o=i/2)<0||t+o>s}function mo(e,t,n,i,r,s,o,a){const u=r*s/(i*2),l=e(t-u),c=e(t+u),f=e(n-(s=s/2)),d=e(n+s);return o.outOfBounds(l,f,c,d)||o.getRange(l,f,c,d)||a&&a.getRange(l,f,c,d)}function wne(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1];function u(l,c,f,d,h){const p=e.invert(l),g=e.invert(c);let m=f,y=s,v;if(!mp(p,g,d,h,r,s)&&!mo(e,p,g,h,d,m,o,a)&&!mo(e,p,g,h,d,h,o,null)){for(;y-m>=1;)v=(m+y)/2,mo(e,p,g,h,d,v,o,a)?y=v:m=v;if(m>f)return[p,g,m,!0]}}return function(l){const c=l.datum.datum.items[i].items,f=c.length,d=l.datum.fontSize,h=Ai.width(l.datum,l.datum.text);let p=n?d:0,g=!1,m=!1,y=0,v,b,x,_,E,w,S,$,F,T,P,R,C,A,M,L,D;for(let O=0;O<f;++O){for(v=c[O].x,x=c[O].y,b=c[O].x2===void 0?v:c[O].x2,_=c[O].y2===void 0?x:c[O].y2,v>b&&(D=v,v=b,b=D),x>_&&(D=x,x=_,_=D),F=e(v),P=e(b),T=~~((F+P)/2),R=e(x),A=e(_),C=~~((R+A)/2),S=T;S>=F;--S)for($=C;$>=R;--$)L=u(S,$,p,h,d),L&&([l.x,l.y,p,g]=L);for(S=T;S<=P;++S)for($=C;$<=A;++$)L=u(S,$,p,h,d),L&&([l.x,l.y,p,g]=L);!g&&!n&&(M=Math.abs(b-v+_-x),E=(v+b)/2,w=(x+_)/2,M>=y&&!mp(E,w,h,d,r,s)&&!mo(e,E,w,d,h,d,o,null)&&(y=M,l.x=E,l.y=w,m=!0))}return g||m?(E=h/2,w=d/2,o.setRange(e(l.x-E),e(l.y-w),e(l.x+E),e(l.y+w)),l.align="center",l.baseline="middle",!0):!1}}const Ene=[-1,-1,1,1],Cne=[-1,1,-1,1];function Sne(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1],u=e.bitmap();return function(l){const c=l.datum.datum.items[i].items,f=c.length,d=l.datum.fontSize,h=Ai.width(l.datum,l.datum.text),p=[];let g=n?d:0,m=!1,y=!1,v=0,b,x,_,E,w,S,$,F,T,P,R,C;for(let A=0;A<f;++A){for(b=c[A].x,_=c[A].y,x=c[A].x2===void 0?b:c[A].x2,E=c[A].y2===void 0?_:c[A].y2,p.push([e((b+x)/2),e((_+E)/2)]);p.length;)if([$,F]=p.pop(),!(o.get($,F)||a.get($,F)||u.get($,F))){u.set($,F);for(let M=0;M<4;++M)w=$+Ene[M],S=F+Cne[M],u.outOfBounds(w,S,w,S)||p.push([w,S]);if(w=e.invert($),S=e.invert(F),T=g,P=s,!mp(w,S,h,d,r,s)&&!mo(e,w,S,d,h,T,o,a)&&!mo(e,w,S,d,h,d,o,null)){for(;P-T>=1;)R=(T+P)/2,mo(e,w,S,d,h,R,o,a)?P=R:T=R;T>g&&(l.x=w,l.y=S,g=T,m=!0)}}!m&&!n&&(C=Math.abs(x-b+E-_),w=(b+x)/2,S=(_+E)/2,C>=v&&!mp(w,S,h,d,r,s)&&!mo(e,w,S,d,h,d,o,null)&&(v=C,l.x=w,l.y=S,y=!0))}return m||y?(w=h/2,S=d/2,o.setRange(e(l.x-w),e(l.y-S),e(l.x+w),e(l.y+S)),l.align="center",l.baseline="middle",!0):!1}}const kne=["right","center","left"],Ane=["bottom","middle","top"];function $ne(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1],u=i.length;return function(l){const c=l.boundary,f=l.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>r||c[3]>s)return!1;let d=l.textWidth??0,h,p,g,m,y,v,b,x,_,E,w,S,$,F,T;for(let P=0;P<u;++P){if(h=(n[P]&3)-1,p=(n[P]>>>2&3)-1,g=h===0&&p===0||i[P]<0,m=h&&p?Math.SQRT1_2:1,y=i[P]<0?-1:1,v=c[1+h]+i[P]*h*m,w=c[4+p]+y*f*p/2+i[P]*p*m,x=w-f/2,_=w+f/2,S=e(v),F=e(x),T=e(_),!d)if(q_(S,S,F,T,o,a,v,v,x,_,c,g))d=Ai.width(l.datum,l.datum.text);else continue;if(E=v+y*d*h/2,v=E-d/2,b=E+d/2,S=e(v),$=e(b),q_(S,$,F,T,o,a,v,b,x,_,c,g))return l.x=h?h*y<0?b:v:E,l.y=p?p*y<0?_:x:w,l.align=kne[h*y+1],l.baseline=Ane[p*y+1],o.setRange(S,F,$,T),!0}return!1}}function q_(e,t,n,i,r,s,o,a,u,l,c,f){return!(r.outOfBounds(e,n,t,i)||(f&&s||r).getRange(e,n,t,i))}const Zm=0,Xm=4,Km=8,Jm=0,Qm=1,ey=2,Mne={"top-left":Zm+Jm,top:Zm+Qm,"top-right":Zm+ey,left:Xm+Jm,middle:Xm+Qm,right:Xm+ey,"bottom-left":Km+Jm,bottom:Km+Qm,"bottom-right":Km+ey},Tne={naive:_ne,"reduced-search":wne,floodfill:Sne};function Fne(e,t,n,i,r,s,o,a,u,l,c){if(!e.length)return e;const f=Math.max(i.length,r.length),d=Lne(i,f),h=Nne(r,f),p=Dne(e[0].datum),g=p==="group"&&e[0].datum.items[u].marktype,m=g==="area",y=Rne(p,g,a,u),v=l===null||l===1/0,b=m&&c==="naive";let x=-1,_=-1;const E=e.map(F=>{const T=v?Ai.width(F,F.text):void 0;return x=Math.max(x,T),_=Math.max(_,F.fontSize),{datum:F,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(F),textWidth:T}});l=l===null||l===1/0?Math.max(x,_)+Math.max(...i):l;const w=xne(t[0],t[1],l);let S;if(!b){n&&E.sort((P,R)=>n(P.datum,R.datum));let F=!1;for(let P=0;P<h.length&&!F;++P)F=h[P]===5||d[P]<0;const T=(p&&o||m)&&e.map(P=>P.datum);S=s.length||T?yne(w,T||[],s,F,m):mne(w,o&&E)}const $=m?Tne[c](w,S,o,u):$ne(w,S,h,d);return E.forEach(F=>F.opacity=+$(F)),E}function Lne(e,t){const n=new Float64Array(t),i=e.length;for(let r=0;r<i;++r)n[r]=e[r]||0;for(let r=i;r<t;++r)n[r]=n[i-1];return n}function Nne(e,t){const n=new Int8Array(t),i=e.length;for(let r=0;r<i;++r)n[r]|=Mne[e[r]];for(let r=i;r<t;++r)n[r]=n[i-1];return n}function Dne(e){return e&&e.mark&&e.mark.marktype}function Rne(e,t,n,i){const r=s=>[s.x,s.x,s.x,s.y,s.y,s.y];return e?e==="line"||e==="area"?s=>r(s.datum):t==="line"?s=>{const o=s.datum.items[i].items;return r(o.length?o[n==="start"?0:o.length-1]:{x:NaN,y:NaN})}:s=>{const o=s.datum.bounds;return[o.x1,(o.x1+o.x2)/2,o.x2,o.y1,(o.y1+o.y2)/2,o.y2]}:r}const $v=["x","y","opacity","align","baseline"],jT=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function px(e){z.call(this,null,e)}px.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:jT},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:$v.length,default:$v}]};Q(px,z,{transform(e,t){function n(s){const o=e[s];return Me(o)&&t.modified(o.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&te("Size parameter should be specified as a [width, height] array.");const r=e.as||$v;return Fne(t.materialize(t.SOURCE).source||[],e.size,e.sort,ce(e.offset==null?1:e.offset),ce(e.anchor||jT),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(s=>{const o=s.datum;o[r[0]]=s.x,o[r[1]]=s.y,o[r[2]]=s.opacity,o[r[3]]=s.align,o[r[4]]=s.baseline}),t.reflow(i).modifies(r)}});const One=Object.freeze(Object.defineProperty({__proto__:null,label:px},Symbol.toStringTag,{value:"Module"}));function HT(e,t){var n=[],i=function(c){return c(a)},r,s,o,a,u,l;if(t==null)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function gx(e){z.call(this,null,e)}gx.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};Q(gx,z,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=HT(i,e.groupby),s=(e.groupby||[]).map(kt),o=s.length,a=e.as||[kt(e.x),kt(e.y)],u=[];r.forEach(l=>{ZZ(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<o;++d)f[s[d]]=l.dims[d];f[a[0]]=c[0],f[a[1]]=c[1],u.push(We(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const Mv={constant:f$,linear:d$,log:HZ,exp:qZ,pow:VZ,quad:h$,poly:WZ},Ine=(e,t)=>e==="poly"?t:e==="quad"?2:1;function mx(e){z.call(this,null,e)}mx.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(Mv)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};Q(mx,z,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=HT(i,e.groupby),s=(e.groupby||[]).map(kt),o=e.method||"linear",a=e.order==null?3:e.order,u=Ine(o,a),l=e.as||[kt(e.x),kt(e.y)],c=Mv[o],f=[];let d=e.extent;pe(Mv,o)||te("Invalid regression method: "+o),d!=null&&o==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),r.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const g=c(h,e.x,e.y,a);if(e.params){f.push(We({keys:h.dims,coef:g.coef,rSquared:g.rSquared}));return}const m=d||Os(h,e.x),y=v=>{const b={};for(let x=0;x<s.length;++x)b[s[x]]=h.dims[x];b[l[0]]=v[0],b[l[1]]=v[1],f.push(We(b))};o==="linear"||o==="constant"?m.forEach(v=>y([v,g.predict(v)])):O5(g.predict,m,25,200).forEach(y)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});const Pne=Object.freeze(Object.defineProperty({__proto__:null,loess:gx,regression:mx},Symbol.toStringTag,{value:"Module"}));function yx(e){z.call(this,null,e)}yx.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const zne=[-1e5,-1e5,1e5,1e5];Q(yx,z,{transform(e,t){const n=e.as||"path",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:zne;const s=this.value=G3.from(i,e.x,e.y).voronoi(r);for(let o=0,a=i.length;o<a;++o){const u=s.cellPolygon(o);i[o][n]=u&&!Une(u)?Bne(u):null}return t.reflow(e.modified()).modifies(n)}});function Bne(e){const t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return"M"+e.slice(0,i+1).join("L")+"Z"}function Une(e){return e.length===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]}const jne=Object.freeze(Object.defineProperty({__proto__:null,voronoi:yx},Symbol.toStringTag,{value:"Module"}));var ty=Math.PI/180,qc=64,Qh=2048;function Hne(){var e=[256,256],t,n,i,r,s,o,a,u=qT,l=[],c=Math.random,f={};f.layout=function(){for(var p=d(_o()),g=Zne((e[0]>>5)*e[1]),m=null,y=l.length,v=-1,b=[],x=l.map(E=>({text:t(E),font:n(E),style:r(E),weight:s(E),rotate:o(E),size:~~(i(E)+1e-14),padding:a(E),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:E})).sort((E,w)=>w.size-E.size);++v<y;){var _=x[v];_.x=e[0]*(c()+.5)>>1,_.y=e[1]*(c()+.5)>>1,qne(p,_,x,v),_.hasText&&h(g,_,m)&&(b.push(_),m?Wne(m,_):m=[{x:_.x+_.x0,y:_.y+_.y0},{x:_.x+_.x1,y:_.y+_.y1}],_.x-=e[0]>>1,_.y-=e[1]>>1)}return b};function d(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=(qc<<5)/g,p.height=Qh/g;var m=p.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:g}}function h(p,g,m){for(var y=g.x,v=g.y,b=Math.hypot(e[0],e[1]),x=u(e),_=c()<.5?1:-1,E=-_,w,S,$;(w=x(E+=_))&&(S=~~w[0],$=~~w[1],!(Math.min(Math.abs(S),Math.abs($))>=b));)if(g.x=y+S,g.y=v+$,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!m||!Vne(g,p,e[0]))&&(!m||Gne(g,m))){for(var F=g.sprite,T=g.width>>5,P=e[0]>>5,R=g.x-(T<<4),C=R&127,A=32-C,M=g.y1-g.y0,L=(g.y+g.y0)*P+(R>>5),D,O=0;O<M;O++){D=0;for(var j=0;j<=T;j++)p[L+j]|=D<<A|(j<T?(D=F[O*T+j])>>>C:0);L+=P}return g.sprite=null,!0}return!1}return f.words=function(p){return arguments.length?(l=p,f):l},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=aa(p),f):n},f.fontStyle=function(p){return arguments.length?(r=aa(p),f):r},f.fontWeight=function(p){return arguments.length?(s=aa(p),f):s},f.rotate=function(p){return arguments.length?(o=aa(p),f):o},f.text=function(p){return arguments.length?(t=aa(p),f):t},f.spiral=function(p){return arguments.length?(u=Xne[p]||p,f):u},f.fontSize=function(p){return arguments.length?(i=aa(p),f):i},f.padding=function(p){return arguments.length?(a=aa(p),f):a},f.random=function(p){return arguments.length?(c=p,f):c},f}function qne(e,t,n,i){if(!t.sprite){var r=e.context,s=e.ratio;r.clearRect(0,0,(qc<<5)/s,Qh/s);var o=0,a=0,u=0,l=n.length,c,f,d,h,p;for(--i;++i<l;){if(t=n[i],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font,c=r.measureText(t.text+"m").width*s,d=t.size<<1,t.rotate){var g=Math.sin(t.rotate*ty),m=Math.cos(t.rotate*ty),y=c*m,v=c*g,b=d*m,x=d*g;c=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,d=~~Math.max(Math.abs(v+b),Math.abs(v-b))}else c=c+31>>5<<5;if(d>u&&(u=d),o+c>=qc<<5&&(o=0,a+=u,u=0),a+d>=Qh)break;r.translate((o+(c>>1))/s,(a+(d>>1))/s),t.rotate&&r.rotate(t.rotate*ty),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=c,t.height=d,t.xoff=o,t.yoff=a,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,o+=c}for(var _=r.getImageData(0,0,(qc<<5)/s,Qh/s).data,E=[];--i>=0;)if(t=n[i],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)E[h]=0;if(o=t.xoff,o==null)return;a=t.yoff;var w=0,S=-1;for(p=0;p<d;p++){for(h=0;h<c;h++){var $=f*p+(h>>5),F=_[(a+p)*(qc<<5)+(o+h)<<2]?1<<31-h%32:0;E[$]|=F,w|=F}w?S=p:(t.y0++,d--,p--,a++)}t.y1=t.y0+S,t.sprite=E.slice(0,(t.y1-t.y0)*f)}}}function Vne(e,t,n){n>>=5;for(var i=e.sprite,r=e.width>>5,s=e.x-(r<<4),o=s&127,a=32-o,u=e.y1-e.y0,l=(e.y+e.y0)*n+(s>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=r;d++)if((c<<a|(d<r?(c=i[f*r+d])>>>o:0))&t[l+d])return!0;l+=n}return!1}function Wne(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function Gne(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function qT(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Yne(e){var t=4,n=t*e[0]/e[1],i=0,r=0;return function(s){var o=s<0?-1:1;switch(Math.sqrt(1+4*o*s)-o&3){case 0:i+=n;break;case 1:r+=t;break;case 2:i-=n;break;default:r-=t;break}return[i,r]}}function Zne(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function aa(e){return typeof e=="function"?e:function(){return e}}var Xne={archimedean:qT,rectangular:Yne};const VT=["x","y","font","fontSize","fontStyle","fontWeight","angle"],Kne=["text","font","rotate","fontSize","fontStyle","fontWeight"];function vx(e){z.call(this,Hne(),e)}vx.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:VT}]};Q(vx,z,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&te("Wordcloud size dimensions must be non-zero.");function n(p){const g=e[p];return Me(g)&&t.modified(g.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||Kne.some(n)))return;const r=t.materialize(t.SOURCE).source,s=this.value,o=e.as||VT;let a=e.fontSize||14,u;if(Me(a)?u=e.fontSizeRange:a=Pn(a),u){const p=a,g=He("sqrt")().domain(Os(r,p)).range(u);a=m=>g(p(m))}r.forEach(p=>{p[o[0]]=NaN,p[o[1]]=NaN,p[o[3]]=0});const l=s.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(Ps).layout(),c=s.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let p=0,g,m;p<h;++p)g=l[p],m=g.datum,m[o[0]]=g.x+f,m[o[1]]=g.y+d,m[o[2]]=g.font,m[o[3]]=g.size,m[o[4]]=g.style,m[o[5]]=g.weight,m[o[6]]=g.rotate;return t.reflow(i).modifies(o)}});const Jne=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:vx},Symbol.toStringTag,{value:"Module"})),Qne=e=>new Uint8Array(e),eie=e=>new Uint16Array(e),hf=e=>new Uint32Array(e);function tie(){let e=8,t=[],n=hf(0),i=bh(0,e),r=bh(0,e);return{data:()=>t,seen:()=>n=nie(n,t.length),add(s){for(let o=0,a=t.length,u=s.length,l;o<u;++o)l=s[o],l._index=a++,t.push(l)},remove(s,o){const a=t.length,u=Array(a-s),l=t;let c,f,d;for(f=0;!o[f]&&f<a;++f)u[f]=t[f],l[f]=f;for(d=f;f<a;++f)c=t[f],o[f]?l[f]=-1:(l[f]=d,i[d]=i[f],r[d]=r[f],u[d]=c,c._index=d++),i[f]=0;return t=u,l},size:()=>t.length,curr:()=>i,prev:()=>r,reset:s=>r[s]=i[s],all:()=>e<257?255:e<65537?65535:4294967295,set(s,o){i[s]|=o},clear(s,o){i[s]&=~o},resize(s,o){const a=i.length;(s>a||o>e)&&(e=Math.max(o,e),i=bh(s,e,i),r=bh(s,e))}}}function nie(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function bh(e,t,n){const i=(t<257?Qne:t<65537?eie:hf)(e);return n&&i.set(n),i}function V_(e,t,n){const i=1<<t;return{one:i,zero:~i,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(r,s){const o=this,a=o.bisect(o.range,r.value),u=r.index,l=a[0],c=a[1],f=u.length;let d;for(d=0;d<l;++d)s[u[d]]|=i;for(d=c;d<f;++d)s[u[d]]|=i;return o}}}function W_(){let e=hf(0),t=[],n=0;function i(a,u,l){if(!u.length)return[];const c=n,f=u.length,d=hf(f);let h=Array(f),p,g,m;for(m=0;m<f;++m)h[m]=a(u[m]),d[m]=m;if(h=iie(h,d),c)p=t,g=e,t=Array(c+f),e=hf(c+f),rie(l,p,g,c,h,d,f,t,e);else{if(l>0)for(m=0;m<f;++m)d[m]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function r(a,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-a}function s(a){for(let u=0,l=n;u<l;++u)e[u]=a[e[u]]}function o(a,u){let l;return u?l=u.length:(u=t,l=n),[PI(u,a[0],0,l),So(u,a[1],0,l)]}return{insert:i,remove:r,bisect:o,reindex:s,index:()=>e,size:()=>n}}function iie(e,t){return e.sort.call(t,(n,i)=>{const r=e[n],s=e[i];return r<s?-1:r>s?1:0}),UI(e,t)}function rie(e,t,n,i,r,s,o,a,u){let l=0,c=0,f;for(f=0;l<i&&c<o;++f)t[l]<r[c]?(a[f]=t[l],u[f]=n[l++]):(a[f]=r[c],u[f]=s[c++]+e);for(;l<i;++l,++f)a[f]=t[l],u[f]=n[l];for(;c<o;++c,++f)a[f]=r[c],u[f]=s[c]+e}function bx(e){z.call(this,tie(),e),this._indices=null,this._dims=null}bx.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};Q(bx,z,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(i=>t.modified(i.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,i=e.query,r=this._indices={},s=this._dims=[],o=i.length;let a=0,u,l;for(;a<o;++a)u=n[a].fname,l=r[u]||(r[u]=W_()),s.push(V_(l,a,i[a]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),i=e.fields,r=e.query,s=this._indices,o=this._dims,a=this.value,u=a.curr(),l=a.prev(),c=a.all(),f=n.rem=n.add,d=n.mod,h=r.length,p={};let g,m,y,v,b,x,_,E,w;if(l.set(u),t.rem.length&&(b=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(x={},v=t.mod,_=0,E=v.length;_<E;++_)x[v[_]._index]=1;for(_=0;_<h;++_)w=i[_],(!o[_]||e.modified("fields",_)||t.modified(w.fields))&&(y=w.fname,(g=p[y])||(s[y]=m=W_(),p[y]=g=m.insert(w,t.source,0)),o[_]=V_(m,_,r[_]).onAdd(g,u));for(_=0,E=a.data().length;_<E;++_)b[_]||(l[_]!==u[_]?f.push(_):x[_]&&u[_]!==c&&d.push(_));return a.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),i=this._dims.length;let r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},insert(e,t,n){const i=t.add,r=this.value,s=this._dims,o=this._indices,a=e.fields,u={},l=n.add,c=r.size()+i.length,f=s.length;let d=r.size(),h,p,g;r.resize(c,f),r.add(i);const m=r.curr(),y=r.prev(),v=r.all();for(h=0;h<f;++h)p=a[h].fname,g=u[p]||(u[p]=o[p].insert(a[h],i,d)),s[h].onAdd(g,m);for(;d<c;++d)y[d]=v,m[d]!==v&&l.push(d)},modify(e,t){const n=t.mod,i=this.value,r=i.curr(),s=i.all(),o=e.mod;let a,u,l;for(a=0,u=o.length;a<u;++a)l=o[a]._index,r[l]!==s&&n.push(l)},remove(e,t,n){const i=this._indices,r=this.value,s=r.curr(),o=r.prev(),a=r.all(),u={},l=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,o[h]=p=s[h],s[h]=a,p!==a&&l.push(h);for(h in i)i[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const i=this._indices,r=this.value;e.runAfter(()=>{const s=r.remove(t,n);for(const o in i)i[o].reindex(s)})},update(e,t,n){const i=this._dims,r=e.query,s=t.stamp,o=i.length;let a=0,u,l;for(n.filters=0,l=0;l<o;++l)e.modified("query",l)&&(u=l,++a);if(a===1)a=i[u].one,this.incrementOne(i[u],r[u],n.add,n.rem);else for(l=0,a=0;l<o;++l)e.modified("query",l)&&(a|=i[l].one,this.incrementAll(i[l],r[l],s,n.add),n.rem=n.add);return a},incrementAll(e,t,n,i){const r=this.value,s=r.seen(),o=r.curr(),a=r.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],p=l[1],g=e.one;let m,y,v;if(f<h)for(m=f,y=Math.min(h,d);m<y;++m)v=u[m],s[v]!==n&&(a[v]=o[v],s[v]=n,i.push(v)),o[v]^=g;else if(f>h)for(m=h,y=Math.min(f,p);m<y;++m)v=u[m],s[v]!==n&&(a[v]=o[v],s[v]=n,i.push(v)),o[v]^=g;if(d>p)for(m=Math.max(f,p),y=d;m<y;++m)v=u[m],s[v]!==n&&(a[v]=o[v],s[v]=n,i.push(v)),o[v]^=g;else if(d<p)for(m=Math.max(h,d),y=p;m<y;++m)v=u[m],s[v]!==n&&(a[v]=o[v],s[v]=n,i.push(v)),o[v]^=g;e.range=t.slice()},incrementOne(e,t,n,i){const r=this.value,s=r.curr(),o=e.index(),a=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=a[0],d=a[1],h=e.one;let p,g,m;if(l<f)for(p=l,g=Math.min(f,c);p<g;++p)m=o[p],s[m]^=h,n.push(m);else if(l>f)for(p=f,g=Math.min(l,d);p<g;++p)m=o[p],s[m]^=h,i.push(m);if(c>d)for(p=Math.max(l,d),g=c;p<g;++p)m=o[p],s[m]^=h,n.push(m);else if(c<d)for(p=Math.max(f,c),g=d;p<g;++p)m=o[p],s[m]^=h,i.push(m);e.range=t.slice()}});function xx(e){z.call(this,null,e)}xx.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};Q(xx,z,{transform(e,t){const n=~(e.ignore||0),i=e.filter,r=i.mask;if((r&n)===0)return t.StopPropagation;const s=t.fork(t.ALL),o=i.data(),a=i.curr(),u=i.prev(),l=c=>a[c]&n?null:o[c];return s.filter(s.MOD,l),r&r-1?(s.filter(s.ADD,c=>{const f=a[c]&n;return!f&&f^u[c]&n?o[c]:null}),s.filter(s.REM,c=>{const f=a[c]&n;return f&&!(f^(f^u[c]&n))?o[c]:null})):(s.filter(s.ADD,l),s.filter(s.REM,c=>(a[c]&n)===r?o[c]:null)),s.filter(s.SOURCE,c=>l(c._index))}});const sie=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:bx,resolvefilter:xx},Symbol.toStringTag,{value:"Module"})),yl="Literal";var Xr,oie=1,aie=2,uie=3,lie=4,cie=5,fie=6,die=7,hie=8,pie=9;Xr={};Xr[oie]="Boolean";Xr[aie]="<end>";Xr[uie]="Identifier";Xr[lie]="Keyword";Xr[cie]="Null";Xr[fie]="Numeric";Xr[die]="Punctuator";Xr[hie]="String";Xr[pie]="RegularExpression";var WT={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function GT(e){function t(o,a,u,l){let c=e(a[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+o+(l<0?"":l===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(o,a,u){return l=>t(o,l,a,u)}const i="new Date",r="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&te("Missing arguments to clamp function."),o.length>3&&te("Too many arguments to clamp function.");const a=o.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),trim:n("trim",r,0),btoa:"btoa",atob:"atob",regexp:s,test:n("test",s),if:function(o){o.length<3&&te("Missing arguments to if function."),o.length>3&&te("Too many arguments to if function.");const a=o.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function gie(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function mie(e){e=e||{};const t=e.allowed?Br(e.allowed):{},n=e.forbidden?Br(e.forbidden):{},i=e.constants||WT,r=(e.functions||GT)(f),s=e.globalvar,o=e.fieldvar,a=Me(s)?s:p=>`${s}["${p}"]`;let u={},l={},c=0;function f(p){if(le(p))return p;const g=d[p.type];return g==null&&te("Unsupported type: "+p.type),g(p)}const d={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:pe(n,g)?te("Illegal identifier: "+g):pe(i,g)?i[g]:pe(t,g)?g:(u[g]=1,a(g))},MemberExpression:p=>{const g=!p.computed,m=f(p.object);g&&(c+=1);const y=f(p.property);return m===o&&(l[gie(y)]=1),g&&(c-=1),m+(g?"."+y:"["+y+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&te("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,y=pe(r,g)&&r[g];return y||te("Unrecognized function: "+g),Me(y)?y(m):y+"("+m.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function h(p){const g={code:f(p),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},g}return h.functions=r,h.constants=i,h}const G_=Symbol("vega_selection_getter");function YT(e){return(!e.getter||!e.getter[G_])&&(e.getter=Ji(e.field),e.getter[G_]=!0),e.getter}const _x="intersect",Y_="union",yie="vlMulti",vie="vlPoint",Z_="or",bie="and",Er="_vgsid_",Bf=Ji(Er),xie="E",_ie="R",wie="R-E",Eie="R-LE",Cie="R-RE",Sie="E-LT",kie="E-LTE",Aie="E-GT",$ie="E-GTE",Mie="E-VALID",Tie="E-ONE",yp="index:unit";function X_(e,t){for(var n=t.fields,i=t.values,r=n.length,s=0,o,a;s<r;++s)if(a=n[s],o=YT(a)(e),Fa(o)&&(o=$n(o)),Fa(i[s])&&(i[s]=$n(i[s])),V(i[s])&&Fa(i[s][0])&&(i[s]=i[s].map($n)),a.type===xie){if(V(i[s])?!i[s].includes(o):o!==i[s])return!1}else if(a.type===_ie){if(!Nc(o,i[s]))return!1}else if(a.type===Cie){if(!Nc(o,i[s],!0,!1))return!1}else if(a.type===wie){if(!Nc(o,i[s],!1,!1))return!1}else if(a.type===Eie){if(!Nc(o,i[s],!1,!0))return!1}else if(a.type===Sie){if(o>=i[s])return!1}else if(a.type===kie){if(o>i[s])return!1}else if(a.type===Aie){if(o<=i[s])return!1}else if(a.type===$ie){if(o<i[s])return!1}else if(a.type===Mie){if(o===null||isNaN(o))return!1}else if(a.type===Tie&&i[s].indexOf(o)===-1)return!1;return!0}function Fie(e,t,n){for(var i=this.context.data[e],r=i?i.values.value:[],s=i?i[yp]&&i[yp].value:void 0,o=n===_x,a=r.length,u=0,l,c,f,d,h;u<a;++u)if(l=r[u],s&&o){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=X_(t,l),c[d]=h?-1:++f,h&&s.size===1)return!0;if(!h&&f===s.get(d).count)return!1}else if(h=X_(t,l),o^h)return h;return a&&o}const ZT=Nl(Bf),Lie=ZT.left,Nie=ZT.right;function Die(e,t,n){const i=this.context.data[e],r=i?i.values.value:[],s=i?i[yp]&&i[yp].value:void 0,o=n===_x,a=Bf(t),u=Lie(r,a);if(u===r.length||Bf(r[u])!==a)return!1;if(s&&o){if(s.size===1)return!0;if(Nie(r,a)-u<s.size)return!1}return!0}function Rie(e,t){return e.map(n=>Ht(t.fields?{values:t.fields.map(i=>YT(i)(n.datum))}:{[Er]:Bf(n.datum)},t))}function Oie(e,t,n,i){for(var r=this.context.data[e],s=r?r.values.value:[],o={},a={},u={},l,c,f,d,h,p,g,m,y,v,b=s.length,x=0,_,E;x<b;++x)if(l=s[x],d=l.unit,c=l.fields,f=l.values,c&&f){for(_=0,E=c.length;_<E;++_)h=c[_],g=o[h.field]||(o[h.field]={}),m=g[d]||(g[d]=[]),u[h.field]=y=h.type.charAt(0),v=ny[`${y}_union`],g[d]=v(m,ce(f[_]));n&&(m=a[d]||(a[d]=[]),m.push(ce(f).reduce((w,S,$)=>(w[c[$].field]=S,w),{})))}else h=Er,p=Bf(l),g=o[h]||(o[h]={}),m=g[d]||(g[d]=[]),m.push(p),n&&(m=a[d]||(a[d]=[]),m.push({[Er]:p}));if(t=t||Y_,o[Er]?o[Er]=ny[`${Er}_${t}`](...Object.values(o[Er])):Object.keys(o).forEach(w=>{o[w]=Object.keys(o[w]).map(S=>o[w][S]).reduce((S,$)=>S===void 0?$:ny[`${u[w]}_${t}`](S,$))}),s=Object.keys(a),n&&s.length){const w=i?vie:yie;o[w]=t===Y_?{[Z_]:s.reduce((S,$)=>(S.push(...a[$]),S),[])}:{[bie]:s.map(S=>({[Z_]:a[S]}))}}return o}var ny={[`${Er}_union`]:XI,[`${Er}_intersect`]:YI,E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.includes(t[n])||e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.includes(n)):t},R_union:function(e,t){var n=$n(t[0]),i=$n(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=$n(t[0]),i=$n(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}};const Iie=":",Pie="@";function wx(e,t,n,i){t[0].type!==yl&&te("First argument to selection functions must be a string literal.");const r=t[0].value,s=t.length>=2&&Xe(t).value,o="unit",a=Pie+o,u=Iie+r;s===_x&&!pe(i,a)&&(i[a]=n.getData(r).indataRef(n,o)),pe(i,u)||(i[u]=n.getData(r).tuplesRef())}function XT(e){const t=this.context.data[e];return t?t.values.value:[]}function zie(e,t,n){const i=this.context.data[e]["index:"+t],r=i?i.value.get(n):void 0;return r&&r.count}function Bie(e,t){const n=this.context.dataflow,i=this.context.data[e],r=i.input;return n.pulse(r,n.changeset().remove(Qi).insert(t)),1}function Uie(e,t,n){if(e){const i=this.context.dataflow,r=e.mark.source;i.pulse(r,i.changeset().encode(e,t))}return n!==void 0?n:e}const Cd=e=>function(t,n){const i=this.context.dataflow.locale();return t===null?"null":i[e](n)(t)},jie=Cd("format"),KT=Cd("timeFormat"),Hie=Cd("utcFormat"),qie=Cd("timeParse"),Vie=Cd("utcParse"),xh=new Date(2e3,0,1);function Gg(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(xh.setYear(2e3),xh.setMonth(e),xh.setDate(t),KT.call(this,xh,n))}function Wie(e){return Gg.call(this,e,1,"%B")}function Gie(e){return Gg.call(this,e,1,"%b")}function Yie(e){return Gg.call(this,0,2+e,"%A")}function Zie(e){return Gg.call(this,0,2+e,"%a")}const Xie=":",Kie="@",Tv="%",Jie="$";function Ex(e,t,n,i){t[0].type!==yl&&te("First argument to data functions must be a string literal.");const r=t[0].value,s=Xie+r;if(!pe(s,i))try{i[s]=n.getData(r).tuplesRef()}catch{}}function Qie(e,t,n,i){t[0].type!==yl&&te("First argument to indata must be a string literal."),t[1].type!==yl&&te("Second argument to indata must be a string literal.");const r=t[0].value,s=t[1].value,o=Kie+s;pe(o,i)||(i[o]=n.getData(r).indataRef(n,s))}function Nn(e,t,n,i){if(t[0].type===yl)K_(n,i,t[0].value);else for(e in n.scales)K_(n,i,e)}function K_(e,t,n){const i=Tv+n;if(!pe(t,i))try{t[i]=e.scaleRef(n)}catch{}}function Kr(e,t){if(le(e)){const n=t.scales[e];return n&&Z8(n.value)?n.value:void 0}else if(Me(e))return Z8(e)?e:void 0}function ere(e,t,n){t.__bandwidth=r=>r&&r.bandwidth?r.bandwidth():0,n._bandwidth=Nn,n._range=Nn,n._scale=Nn;const i=r=>"_["+(r.type===yl?xe(Tv+r.value):xe(Tv)+"+"+e(r))+"]";return{_bandwidth:r=>`this.__bandwidth(${i(r[0])})`,_range:r=>`${i(r[0])}.range()`,_scale:r=>`${i(r[0])}(${e(r[1])})`}}function Cx(e,t){return function(n,i,r){if(n){const s=Kr(n,(r||this).context);return s&&s.path[e](i)}else return t(i)}}const tre=Cx("area",qj),nre=Cx("bounds",Yj),ire=Cx("centroid",eH);function rre(e,t){const n=Kr(e,(t||this).context);return n&&n.scale()}function sre(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function Sx(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(i){e.warn(i)}return n[n.length-1]}function ore(){return Sx(this.context.dataflow,"warn",arguments)}function are(){return Sx(this.context.dataflow,"info",arguments)}function ure(){return Sx(this.context.dataflow,"debug",arguments)}function iy(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Fv(e){const t=Ao(e),n=iy(t.r),i=iy(t.g),r=iy(t.b);return .2126*n+.7152*i+.0722*r}function lre(e,t){const n=Fv(e),i=Fv(t),r=Math.max(n,i),s=Math.min(n,i);return(r+.05)/(s+.05)}function cre(){const e=[].slice.call(arguments);return e.unshift({}),Ht(...e)}function JT(e,t){return e===t||e!==e&&t!==t?!0:V(e)?V(t)&&e.length===t.length?fre(e,t):!1:_e(e)&&_e(t)?QT(e,t):!1}function fre(e,t){for(let n=0,i=e.length;n<i;++n)if(!JT(e[n],t[n]))return!1;return!0}function QT(e,t){for(const n in e)if(!JT(e[n],t[n]))return!1;return!0}function J_(e){return t=>QT(e,t)}function dre(e,t,n,i,r,s){const o=this.context.dataflow,a=this.context.data[e],u=a.input,l=o.stamp();let c=a.changes,f,d;if(o._trigger===!1||!(u.value.length||t||i))return 0;if((!c||c.stamp<l)&&(a.changes=c=o.changeset(),c.stamp=l,o.runAfter(()=>{a.modified=!0,o.pulse(u,c).run()},!0,1)),n&&(f=n===!0?Qi:V(n)||A5(n)?n:J_(n),c.remove(f)),t&&c.insert(t),i&&(f=J_(i),u.value.some(f)?c.remove(f):c.insert(i)),r)for(d in s)c.modify(r,d,s[d]);return 1}function hre(e){const t=e.touches,n=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.hypot(n,i)}function pre(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const Q_={};function gre(e,t){const n=Q_[t]||(Q_[t]=Ji(t));return V(e)?e.map(n):n(e)}function Yg(e){return V(e)||ArrayBuffer.isView(e)?e:null}function kx(e){return Yg(e)||(le(e)?e:null)}function mre(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Yg(e).join(...n)}function yre(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return kx(e).indexOf(...n)}function vre(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return kx(e).lastIndexOf(...n)}function bre(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return kx(e).slice(...n)}function xre(e,t,n){return Me(n)&&te("Function argument passed to replace."),!le(t)&&!xA(t)&&te("Please pass a string or RegExp argument to replace."),String(e).replace(t,n)}function _re(e){return Yg(e).slice().reverse()}function wre(e){return Yg(e).slice().sort(kg)}function Ere(e,t,n){return ub(e||0,t||0,n||0)}function Cre(e,t){const n=Kr(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function Sre(e,t){const n=Kr(e,(t||this).context);return n?n.copy():void 0}function kre(e,t){const n=Kr(e,(t||this).context);return n?n.domain():[]}function Are(e,t,n){const i=Kr(e,(n||this).context);return i?V(t)?(i.invertRange||i.invert)(t):(i.invert||i.invertExtent)(t):void 0}function $re(e,t){const n=Kr(e,(t||this).context);return n&&n.range?n.range():[]}function Mre(e,t,n){const i=Kr(e,(n||this).context);return i?i(t):void 0}function Tre(e,t,n,i,r){e=Kr(e,(r||this).context);const s=_K(t,n);let o=e.domain(),a=o[0],u=Xe(o),l=In;return u-a?l=X$(e,a,u):e=(e.interpolator?He("sequential")().interpolator(e.interpolator()):He("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,u=1]),e.ticks&&(o=e.ticks(+i||15),a!==o[0]&&o.unshift(a),u!==Xe(o)&&o.push(u)),o.forEach(c=>s.stop(l(c),e(c))),s}function Fre(e,t,n){const i=Kr(e,(n||this).context);return function(r){return i?i.path.context(r)(t):""}}function Lre(e){let t=null;return function(n){return n?ip(n,t=t||yb(e)):e}}const eF=e=>e.data;function tF(e,t){const n=XT.call(t,e);return n.root&&n.root.lookup||{}}function Nre(e,t,n){const i=tF(e,this),r=i[t],s=i[n];return r&&s?r.path(s).map(eF):void 0}function Dre(e,t){const n=tF(e,this)[t];return n?n.ancestors().map(eF):void 0}const nF=()=>typeof window<"u"&&window||null;function Rre(){const e=nF();return e?e.screen:{}}function Ore(){const e=nF();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function Ire(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function iF(e,t,n){if(!e)return[];const[i,r]=e,s=new Nt().set(i[0],i[1],r[0],r[1]),o=n||this.context.dataflow.scenegraph().root;return lee(o,s,Pre(t))}function Pre(e){let t=null;if(e){const n=ce(e.marktype),i=ce(e.markname);t=r=>(!n.length||n.some(s=>r.marktype===s))&&(!i.length||i.some(s=>r.name===s))}return t}function zre(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;e=ce(e);const r=e[e.length-1];return r===void 0||Math.hypot(r[0]-t,r[1]-n)>i?[...e,[t,n]]:e}function Bre(e){return ce(e).reduce((t,n,i)=>{let[r,s]=n;return t+=i==0?`M ${r},${s} `:i===e.length-1?" Z":`L ${r},${s} `},"")}function Ure(e,t,n){const{x:i,y:r,mark:s}=n,o=new Nt().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[u,l]of t)u<o.x1&&(o.x1=u),u>o.x2&&(o.x2=u),l<o.y1&&(o.y1=l),l>o.y2&&(o.y2=l);return o.translate(i,r),iF([[o.x1,o.y1],[o.x2,o.y2]],e,s).filter(u=>jre(u.x,u.y,t))}function jre(e,t,n){let i=0;for(let r=0,s=n.length-1;r<n.length;s=r++){const[o,a]=n[s],[u,l]=n[r];l>t!=a>t&&e<(o-u)*(t-l)/(a-l)+u&&i++}return i&1}const Uf={random(){return Ps()},cumulativeNormal:D5,cumulativeLogNormal:s$,cumulativeUniform:l$,densityNormal:e$,densityLogNormal:r$,densityUniform:u$,quantileNormal:R5,quantileLogNormal:o$,quantileUniform:c$,sampleNormal:N5,sampleLogNormal:i$,sampleUniform:a$,isArray:V,isBoolean:Pl,isDate:Fa,isDefined(e){return e!==void 0},isNumber:Ke,isObject:_e,isRegExp:xA,isString:le,isTuple:A5,isValid(e){return e!=null&&e===e},toBoolean:wA,toDate(e){return EA(e)},toNumber:$n,toString:CA,indexof:yre,join:mre,lastindexof:vre,replace:xre,reverse:_re,sort:wre,slice:bre,flush:OG,lerp:PG,merge:cre,pad:jG,peek:Xe,pluck:gre,span:Ag,inrange:Nc,truncate:qG,rgb:Ao,lab:y0,hcl:v0,hsl:g0,luminance:Fv,contrast:lre,sequence:li,format:jie,utcFormat:Hie,utcParse:Vie,utcOffset:yY,utcSequence:bY,timeFormat:KT,timeParse:qie,timeOffset:mY,timeSequence:vY,timeUnitSpecifier:eY,monthFormat:Wie,monthAbbrevFormat:Gie,dayFormat:Yie,dayAbbrevFormat:Zie,quarter:$G,utcquarter:MG,week:nY,utcweek:sY,dayofyear:tY,utcdayofyear:rY,warn:ore,info:are,debug:ure,extent(e){return Os(e)},inScope:sre,intersect:iF,clampRange:TG,pinchDistance:hre,pinchAngle:pre,screen:Rre,containerSize:Ire,windowSize:Ore,bandspace:Ere,setdata:Bie,pathShape:Lre,panLinear:CG,panLog:SG,panPow:kG,panSymlog:AG,zoomLinear:gA,zoomLog:mA,zoomPow:W2,zoomSymlog:yA,encode:Uie,modify:dre,lassoAppend:zre,lassoPath:Bre,intersectLasso:Ure},Hre=["view","item","group","xy","x","y"],qre="event.vega.",rF="this.",Ax={},Vre={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${xe(Jie+e)}]`,functions:Wre,constants:WT,visitors:Ax},e7=mie(Vre);function Wre(e){const t=GT(e);Hre.forEach(n=>t[n]=qre+n);for(const n in Uf)t[n]=rF+n;return Ht(t,ere(e,Uf,Ax)),t}function Tt(e,t,n){return arguments.length===1?Uf[e]:(Uf[e]=t,n&&(Ax[e]=n),e7&&(e7.functions[e]=rF+e),this)}Tt("bandwidth",Cre,Nn);Tt("copy",Sre,Nn);Tt("domain",kre,Nn);Tt("range",$re,Nn);Tt("invert",Are,Nn);Tt("scale",Mre,Nn);Tt("gradient",Tre,Nn);Tt("geoArea",tre,Nn);Tt("geoBounds",nre,Nn);Tt("geoCentroid",ire,Nn);Tt("geoShape",Fre,Nn);Tt("geoScale",rre,Nn);Tt("indata",zie,Qie);Tt("data",XT,Ex);Tt("treePath",Nre,Ex);Tt("treeAncestors",Dre,Ex);Tt("vlSelectionTest",Fie,wx);Tt("vlSelectionIdTest",Die,wx);Tt("vlSelectionResolve",Oie,wx);Tt("vlSelectionTuples",Rie);function Gre(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(i=>t.parseOperator(i)),n.forEach(i=>t.parseOperatorParameters(i)),(e.streams||[]).forEach(i=>t.parseStream(i)),(e.updates||[]).forEach(i=>t.parseUpdate(i)),t.resolve()}const Yre=Br(["rule"]),t7=Br(["group","image","rect"]);function Zre(e,t){let n="";return Yre[t]||(e.x2&&(e.x?(t7[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(t7[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function $x(e){return(e+"").toLowerCase()}function Xre(e){return $x(e)==="operator"}function Kre(e){return $x(e)==="collect"}function _c(e,t,n){n.endsWith(";")||(n="return("+n+");");const i=Function(...t.concat(n));return e&&e.functions?i.bind(e.functions):i}function Jre(e,t,n,i){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${i}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${i} : `}var Qre={operator:(e,t)=>_c(e,["_"],t.code),parameter:(e,t)=>_c(e,["datum","_"],t.code),event:(e,t)=>_c(e,["event"],t.code),handler:(e,t)=>{const n=`var datum=event.item&&event.item.datum;return ${t.code};`;return _c(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:i}=t;let r="var o=item,datum=o.datum,m=0,$;";for(const s in i){const o="o["+xe(s)+"]";r+=`$=${i[s].code};if(${o}!==$)${o}=$,m=1;`}return r+=Zre(i,n),r+="return m;",_c(e,["item","_"],r)},codegen:{get(e){const t=`[${e.map(xe).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const i=(s,o)=>{const a=t[o];let u,l;return s.path?(u=`a${s.path}`,l=`b${s.path}`):((n=n||{})["f"+o]=s,u=`this.f${o}(a)`,l=`this.f${o}(b)`),Jre(u,l,-a,a)},r=Function("a","b","var u, v; return "+e.map(i).join("")+"0;");return n?r.bind(n):r}}};function ese(e){const t=this;Xre(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function tse(e){const t=this;if(e.params){const n=t.get(e.id);n||te("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function nse(e,t){t=t||{};const n=this;for(const i in e){const r=e[i];t[i]=V(r)?r.map(s=>n7(s,n,t)):n7(r,n,t)}return t}function n7(e,t,n){if(!e||!_e(e))return e;for(let i=0,r=i7.length,s;i<r;++i)if(s=i7[i],pe(e,s.key))return s.parse(e,t,n);return e}var i7=[{key:"$ref",parse:ise},{key:"$key",parse:sse},{key:"$expr",parse:rse},{key:"$field",parse:ose},{key:"$encode",parse:use},{key:"$compare",parse:ase},{key:"$context",parse:lse},{key:"$subflow",parse:cse},{key:"$tupleid",parse:fse}];function ise(e,t){return t.get(e.$ref)||te("Operator not defined: "+e.$ref)}function rse(e,t,n){e.$params&&t.parseParameters(e.$params,n);const i="e:"+e.$expr.code;return t.fn[i]||(t.fn[i]=yi(t.parameterExpression(e.$expr),e.$fields))}function sse(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=_A(e.$key,e.$flat,t.expr.codegen))}function ose(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Ji(e.$field,e.$name,t.expr.codegen))}function ase(e,t){const n="c:"+e.$compare+"_"+e.$order,i=ce(e.$compare).map(r=>r&&r.$tupleid?ge:r);return t.fn[n]||(t.fn[n]=vA(i,e.$order,t.expr.codegen))}function use(e,t){const n=e.$encode,i={};for(const r in n){const s=n[r];i[r]=yi(t.encodeExpression(s.$expr),s.$fields),i[r].output=s.$output}return i}function lse(e,t){return t}function cse(e,t){const n=e.$subflow;return function(i,r,s){const o=t.fork().parse(n),a=o.get(n.operators[0].id),u=o.signals.parent;return u&&u.set(s),a.detachSubflow=()=>t.detach(o),a}}function fse(){return ge}function dse(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,i=e.stream!=null?t.get(e.stream):void 0,r;e.source?i=t.events(e.source,e.type,n):e.merge&&(r=e.merge.map(s=>t.get(s)),i=r[0].merge.apply(r[0],r.slice(1))),e.between&&(r=e.between.map(s=>t.get(s)),i=i.between(r[0],r[1])),e.filter&&(i=i.filter(n)),e.throttle!=null&&(i=i.throttle(+e.throttle)),e.debounce!=null&&(i=i.debounce(+e.debounce)),i==null&&te("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),t.stream(e,i)}function hse(e){var t=this,n=_e(n=e.source)?n.$ref:n,i=t.get(n),r=null,s=e.update,o=void 0;i||te("Source not defined: "+e.source),r=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),s&&s.$expr&&(s.$params&&(o=t.parseParameters(s.$params)),s=t.handlerExpression(s.$expr)),t.update(e,i,r,s,o)}const pse={skip:!0};function gse(e){var t=this,n={};if(e.signals){var i=n.signals={};Object.keys(t.signals).forEach(s=>{const o=t.signals[s];e.signals(s,o)&&(i[s]=o.value)})}if(e.data){var r=n.data={};Object.keys(t.data).forEach(s=>{const o=t.data[s];e.data(s,o)&&(r[s]=o.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(s=>s.getState(e))),n}function mse(e){var t=this,n=t.dataflow,i=e.data,r=e.signals;Object.keys(r||{}).forEach(s=>{n.update(t.signals[s],r[s],pse)}),Object.keys(i||{}).forEach(s=>{n.pulse(t.data[s].input,n.changeset().remove(Qi).insert(i[s]))}),(e.subcontext||[]).forEach((s,o)=>{const a=t.subcontext[o];a&&a.setState(s)})}function yse(e,t,n,i){return new sF(e,t,n,i)}function sF(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||Qre,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function r7(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}sF.prototype=r7.prototype={fork(){const e=new r7(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,i=n.dataflow,r=e.value;if(n.set(e.id,t),Kre(e.type)&&r&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){let s=n.get(e.parent.$ref);s?(i.connect(s,[t]),t.targets().add(s)):(n.unresolved=n.unresolved||[]).push(()=>{s=n.get(e.parent.$ref),i.connect(s,[t]),t.targets().add(s)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const s in e.data){const o=n.data[s]||(n.data[s]={});e.data[s].forEach(a=>o[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[$x(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:Gre,parseOperator:ese,parseOperatorParameters:tse,parseParameters:nse,parseStream:dse,parseUpdate:hse,getState:gse,setState:mse};function vse(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),oF(t,e.description()))}function oF(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function bse(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const ry="default";function xse(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:ry,item:null}));e.on(e.events("view","pointermove"),t,(n,i)=>{const r=t.value,s=r?le(r)?r:r.user:ry,o=i.item&&i.item.cursor||null;return r&&s===r.user&&o==r.item?r:{user:s,item:o}}),e.add(null,function(n){let i=n.cursor,r=this.value;return le(i)||(r=i.item,i=i.user),Lv(e,i&&i!==ry?i:r||i),r},{cursor:t})}function Lv(e,t){const n=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function vp(e,t){var n=e._runtime.data;return pe(n,t)||te("Unrecognized data set: "+t),n[t]}function _se(e,t){return arguments.length<2?vp(this,e).values.value:Zg.call(this,e,zl().remove(Qi).insert(t))}function Zg(e,t){VA(t)||te("Second argument to changes must be a changeset.");const n=vp(this,e);return n.modified=!0,this.pulse(n.input,t)}function wse(e,t){return Zg.call(this,e,zl().insert(t))}function Ese(e,t){return Zg.call(this,e,zl().remove(t))}function aF(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function uF(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function Xg(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function Cse(e){var t=Xg(e),n=aF(e),i=uF(e);e._renderer.background(e.background()),e._renderer.resize(n,i,t),e._handler.origin(t),e._resizeListeners.forEach(r=>{try{r(n,i)}catch(s){e.error(s)}})}function Sse(e,t,n){var i=e._renderer,r=i&&i.canvas(),s,o,a;return r&&(a=Xg(e),o=t.changedTouches?t.changedTouches[0]:t,s=Db(o,r),s[0]-=a[0],s[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=kse(e,n,s),t}function kse(e,t,n){const i=t?t.mark.marktype==="group"?t:t.mark.group:null;function r(o){var a=i,u;if(o){for(u=t;u;u=u.mark.group)if(u.mark.name===o){a=u;break}}return a&&a.mark&&a.mark.interactive?a:{}}function s(o){if(!o)return n;le(o)&&(o=r(o));const a=n.slice();for(;o;)a[0]-=o.x||0,a[1]-=o.y||0,o=o.mark&&o.mark.group;return a}return{view:Pn(e),item:Pn(t||{}),group:r,xy:s,x:o=>s(o)[0],y:o=>s(o)[1]}}const s7="view",Ase="timer",$se="window",Mse={trap:!1};function Tse(e){const t=Ht({defaults:{}},e),n=(i,r)=>{r.forEach(s=>{V(i[s])&&(i[s]=Br(i[s]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function lF(e,t,n,i){e._eventListeners.push({type:n,sources:ce(t),handler:i})}function Fse(e,t){var n=e._eventConfig.defaults,i=n.prevent,r=n.allow;return i===!1||r===!0?!1:i===!0||r===!1?!0:i?i[t]:r?!r[t]:e.preventDefault()}function _h(e,t,n){const i=e._eventConfig&&e._eventConfig[t];return i===!1||_e(i)&&!i[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function Lse(e,t,n){var i=this,r=new T5(n),s=function(l,c){i.runAsync(null,()=>{e===s7&&Fse(i,t)&&l.preventDefault(),r.receive(Sse(i,l,c))})},o;if(e===Ase)_h(i,"timer",t)&&i.timer(s,t);else if(e===s7)_h(i,"view",t)&&i.addEventListener(t,s,Mse);else if(e===$se?_h(i,"window",t)&&typeof window<"u"&&(o=[window]):typeof document<"u"&&_h(i,"selector",t)&&(o=Array.from(document.querySelectorAll(e))),!o)i.warn("Can not resolve event source: "+e);else{for(var a=0,u=o.length;a<u;++a)o[a].addEventListener(t,s);lF(i,o,t,s)}return r}function o7(e){return e.item}function a7(e){return e.item.mark.source}function u7(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Nse(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","pointerover",o7),a7,u7(e)),this.on(this.events("view","pointerout",o7),a7,u7(t)),this}function Dse(){var e=this._tooltip,t=this._timers,n=this._handler.handlers(),i=this._eventListeners,r,s,o,a,u;for(r=t.length;--r>=0;)t[r].stop();for(r=i.length;--r>=0;)for(o=i[r],s=o.sources.length;--s>=0;)o.sources[s].removeEventListener(o.type,o.handler);for(e&&e.call(this,this._handler,null,null,null),r=n.length;--r>=0;)u=n[r].type,a=n[r].handler,this._handler.off(u,a);return this}function di(e,t,n){const i=document.createElement(e);for(const r in t)i.setAttribute(r,t[r]);return n!=null&&(i.textContent=n),i}const Rse="vega-bind",Ose="vega-bind-name",Ise="vega-bind-radio";function Pse(e,t,n){if(!t)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:o=>{o!=e.signal(i.signal)&&e.runAsync(null,()=>{r.source=!0,e.signal(i.signal,o)})}},i.debounce&&(r.update=bA(i.debounce,r.update))),(i.input==null&&i.element?zse:Use)(r,t,i,e),r.active||(e.on(e._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(e.signal(i.signal))}),r.active=!0),r}function zse(e,t,n,i){const r=n.event||"input",s=()=>e.update(t.value);i.signal(n.signal,t.value),t.addEventListener(r,s),lF(i,t,r,s),e.set=o=>{t.value=o,t.dispatchEvent(Bse(r))}}function Bse(e){return typeof Event<"u"?new Event(e):{type:e}}function Use(e,t,n,i){const r=i.signal(n.signal),s=di("div",{class:Rse}),o=n.input==="radio"?s:s.appendChild(di("label"));o.appendChild(di("span",{class:Ose},n.name||n.signal)),t.appendChild(s);let a=jse;switch(n.input){case"checkbox":a=Hse;break;case"select":a=qse;break;case"radio":a=Vse;break;case"range":a=Wse;break}a(e,o,n,r)}function jse(e,t,n,i){const r=di("input");for(const s in n)s!=="signal"&&s!=="element"&&r.setAttribute(s==="input"?"type":s,n[s]);r.setAttribute("name",n.signal),r.value=i,t.appendChild(r),r.addEventListener("input",()=>e.update(r.value)),e.elements=[r],e.set=s=>r.value=s}function Hse(e,t,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const s=di("input",r);t.appendChild(s),s.addEventListener("change",()=>e.update(s.checked)),e.elements=[s],e.set=o=>s.checked=!!o||null}function qse(e,t,n,i){const r=di("select",{name:n.signal}),s=n.labels||[];n.options.forEach((o,a)=>{const u={value:o};bp(o,i)&&(u.selected=!0),r.appendChild(di("option",u,(s[a]||o)+""))}),t.appendChild(r),r.addEventListener("change",()=>{e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=o=>{for(let a=0,u=n.options.length;a<u;++a)if(bp(n.options[a],o)){r.selectedIndex=a;return}}}function Vse(e,t,n,i){const r=di("span",{class:Ise}),s=n.labels||[];t.appendChild(r),e.elements=n.options.map((o,a)=>{const u={type:"radio",name:n.signal,value:o};bp(o,i)&&(u.checked=!0);const l=di("input",u);l.addEventListener("change",()=>e.update(o));const c=di("label",{},(s[a]||o)+"");return c.prepend(l),r.appendChild(c),l}),e.set=o=>{const a=e.elements,u=a.length;for(let l=0;l<u;++l)bp(a[l].value,o)&&(a[l].checked=!0)}}function Wse(e,t,n,i){i=i!==void 0?i:(+n.max+ +n.min)/2;const r=n.max!=null?n.max:Math.max(100,+i)||100,s=n.min||Math.min(0,r,+i)||0,o=n.step||ko(s,r,100),a=di("input",{type:"range",name:n.signal,min:s,max:r,step:o});a.value=i;const u=di("span",{},+i);t.appendChild(a),t.appendChild(u);const l=()=>{u.textContent=a.value,e.update(+a.value)};a.addEventListener("input",l),a.addEventListener("change",l),e.elements=[a],e.set=c=>{a.value=c,u.textContent=c}}function bp(e,t){return e===t||e+""==t+""}function cF(e,t,n,i,r,s){return t=t||new i(e.loader()),t.initialize(n,aF(e),uF(e),Xg(e),r,s).background(e.background())}function Mx(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function Gse(e,t,n,i){const r=new i(e.loader(),Mx(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,Xg(e),e);return t&&t.handlers().forEach(s=>{r.on(s.type,s.handler)}),r}function Yse(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,s=zb(i);e=n._el=e?sy(n,e,!0):null,vse(n),s||n.error("Unrecognized renderer type: "+i);const o=s.handler||Vg,a=e?s.renderer:s.headless;return n._renderer=a?cF(n,n._renderer,e,a):null,n._handler=Gse(n,n._handler,e,o),n._redraw=!0,e&&r!=="none"&&(t=t?n._elBind=sy(n,t,!0):e.appendChild(di("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&r!=="container"&&(u.element=sy(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{Pse(n,u.element||t,u)})),n}function sy(e,t,n){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.textContent=""}catch(i){t=null,e.error(i)}return t}const wc=e=>+e||0,Zse=e=>({top:e,bottom:e,left:e,right:e});function l7(e){return _e(e)?{top:wc(e.top),bottom:wc(e.bottom),left:wc(e.left),right:wc(e.right)}:Zse(wc(e))}async function Tx(e,t,n,i){const r=zb(t),s=r&&r.headless;return s||te("Unrecognized renderer type: "+t),await e.runAsync(),cF(e,null,null,s,n,i).renderAsync(e._scenegraph.root)}async function Xse(e,t){e!==Sa.Canvas&&e!==Sa.SVG&&e!==Sa.PNG&&te("Unrecognized image type: "+e);const n=await Tx(this,e,t);return e===Sa.SVG?Kse(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function Kse(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function Jse(e,t){return(await Tx(this,Sa.Canvas,e,t)).canvas()}async function Qse(e){return(await Tx(this,Sa.SVG,e)).svg()}function eoe(e,t,n){return yse(e,L5,Uf,n).parse(t)}function toe(e){var t=this._runtime.scales;return pe(t,e)||te("Unrecognized scale or projection: "+e),t[e].value}var fF="width",dF="height",Fx="padding",c7={skip:!0};function hF(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===Fx?i.left+i.right:0)}function pF(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===Fx?i.top+i.bottom:0)}function noe(e){var t=e._signals,n=t[fF],i=t[dF],r=t[Fx];function s(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=hF(e,a.size),s()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=pF(e,a.size),s()},{size:i});const o=e.add(null,s,{pad:r});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=i.rank+1,o.rank=r.rank+1}function ioe(e,t,n,i,r,s){this.runAfter(o=>{let a=0;o._autosize=0,o.width()!==n&&(a=1,o.signal(fF,n,c7),o._resizeWidth.skip(!0)),o.height()!==i&&(a=1,o.signal(dF,i,c7),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),(o._origin[0]!==r[0]||o._origin[1]!==r[1])&&(o._resize=1,o._origin=r),a&&o.run("enter"),s&&o.runAfter(u=>u.resize())},!1,1)}function roe(e){return this._runtime.getState(e||{data:soe,signals:ooe,recurse:!0})}function soe(e,t){return t.modified&&V(t.input.value)&&!e.startsWith("_:vega:_")}function ooe(e,t){return!(e==="parent"||t instanceof L5.proxy)}function aoe(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function uoe(e,t){function n(i){e({timestamp:Date.now(),elapsed:i})}this._timers.push(_B(n,t))}function loe(e,t,n,i){const r=e.element();r&&r.setAttribute("title",coe(i))}function coe(e){return e==null?"":V(e)?gF(e):_e(e)&&!Fa(e)?foe(e):e+""}function foe(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(V(n)?gF(n):mF(n))}).join(`
`)}function gF(e){return"["+e.map(mF).join(", ")+"]"}function mF(e){return V(e)?"[…]":_e(e)&&!Fa(e)?"{…}":e}function doe(){if(this.renderer()==="canvas"&&this._renderer._canvas){let e=null;const t=()=>{e!=null&&e();const n=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);n.addEventListener("change",t),e=()=>{n.removeEventListener("change",t)},this._renderer._canvas.getContext("2d").pixelRatio=window.devicePixelRatio||1,this._redraw=!0,this._resize=1,this.resize().runAsync()};t()}}function hoe(e,t){const n=this;if(t=t||{},lf.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const s=Ht({},e.locale,t.locale);n.locale($Y(s.number,s.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Sa.Canvas,n._scenegraph=new SQ;const i=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||loe,n._redraw=!0,n._handler=new Vg().scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=Tse(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=eoe(n,e,t.expr);n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(s=>({state:null,param:Ht({},s)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=hF(n,n._width),n._viewHeight=pF(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,noe(n),bse(n),xse(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind),t.watchPixelRatio&&n._watchPixelRatio()}function wh(e,t){return pe(e._signals,t)?e._signals[t]:te("Unrecognized signal name: "+xe(t))}function yF(e,t){const n=(e._targets||[]).filter(i=>i._update&&i._update.handler===t);return n.length?n[0]:null}function f7(e,t,n,i){let r=yF(n,i);return r||(r=Mx(e,()=>i(t,n.value)),r.handler=i,e.on(n,null,r)),e}function d7(e,t,n){const i=yF(t,n);return i&&t._targets.remove(i),e}Q(hoe,lf,{async evaluate(e,t,n){if(await lf.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,Cse(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(i){this.error(i)}return n&&Uh(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&oF(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const i=wh(this,e);return arguments.length===1?i.value:this.update(i,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",l7(e)):l7(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(zb(e)||te("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(lf.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(wh(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:ioe,addEventListener(e,t,n){let i=t;return n&&n.trap===!1||(i=Mx(this,t),i.raw=t),this._handler.on(e,i),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),i=n.length,r,s;--i>=0;)if(s=n[i].type,r=n[i].handler,e===s&&(t===r||t===r.raw)){this._handler.off(s,r);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.includes(e)||t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return f7(this,e,wh(this,e),t)},removeSignalListener(e,t){return d7(this,wh(this,e),t)},addDataListener(e,t){return f7(this,e,vp(this,e).values,t)},removeDataListener(e,t){return d7(this,vp(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=Lv(this,null);this._globalCursor=!!e,t&&Lv(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:uoe,events:Lse,finalize:Dse,hover:Nse,data:_se,change:Zg,insert:wse,remove:Ese,scale:toe,initialize:Yse,toImageURL:Xse,toCanvas:Jse,toSVG:Qse,getState:roe,setState:aoe,_watchPixelRatio:doe});const poe="view",xp="[",_p="]",vF="{",bF="}",goe=":",xF=",",moe="@",yoe=">",voe=/[[\]{}]/,boe={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let _F,wF;function ql(e,t,n){return _F=t||poe,wF=boe,EF(e.trim()).map(Nv)}function xoe(e){return wF[e]}function pf(e,t,n,i,r){const s=e.length;let o=0,a;for(;t<s;++t){if(a=e[t],!o&&a===n)return t;r&&r.indexOf(a)>=0?--o:i&&i.indexOf(a)>=0&&++o}return t}function EF(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=pf(e,r,xF,xp+vF,_p+bF),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function Nv(e){return e[0]==="["?_oe(e):woe(e)}function _oe(e){const t=e.length;let n=1,i;if(n=pf(e,n,_p,xp,_p),n===t)throw"Empty between selector: "+e;if(i=EF(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==yoe)throw"Expected '>' after between selector: "+e;i=i.map(Nv);const r=Nv(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function woe(e){const t={source:_F},n=[];let i=[0,0],r=0,s=0,o=e.length,a=0,u,l;if(e[o-1]===bF){if(a=e.lastIndexOf(vF),a>=0){try{i=Eoe(e.substring(a+1,o-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),o=e.length}else throw"Unmatched right brace: "+e;a=0}if(!o)throw e;if(e[0]===moe&&(r=++a),u=pf(e,a,goe),u<o&&(n.push(e.substring(s,u).trim()),s=a=++u),a=pf(e,a,xp),a===o)n.push(e.substring(s,o).trim());else if(n.push(e.substring(s,a).trim()),l=[],s=++a,s===o)throw"Unmatched left bracket: "+e;for(;a<o;){if(a=pf(e,a,_p),a===o)throw"Unmatched left bracket: "+e;if(l.push(e.substring(s,a).trim()),a<o-1&&e[++a]!==xp)throw"Expected left bracket: "+e;s=++a}if(!(o=n.length)||voe.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],r?t.markname=n[0].slice(1):xoe(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function Eoe(e){const t=e.split(xF);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}const Coe="left",Soe="right",koe="center",Aoe="start",$oe="end";function Moe(e,t,n){return`item.anchor === '${Aoe}' ? ${e} : item.anchor === '${$oe}' ? ${t} : ${n}`}Moe(xe(Coe),xe(Soe),xe(koe));Ht(L5,UX,Gee,Ste,nne,lne,One,gne,Pne,jne,Jne,sie);const Toe=new Set([Function,eval,setTimeout,setInterval]);typeof setImmediate=="function"&&Toe.add(setImmediate);const Foe="5.23.0",Loe={version:Foe};function Lx(e){return G(e,"or")}function Nx(e){return G(e,"and")}function Dx(e){return G(e,"not")}function e0(e,t){if(Dx(e))e0(e.not,t);else if(Nx(e))for(const n of e.and)e0(n,t);else if(Lx(e))for(const n of e.or)e0(n,t);else t(e)}function Zu(e,t){return Dx(e)?{not:Zu(e.not,t)}:Nx(e)?{and:e.and.map(n=>Zu(n,t))}:Lx(e)?{or:e.or.map(n=>Zu(n,t))}:t(e)}const Ce=structuredClone;function CF(e){throw new Error(e)}function vl(e,t){const n={};for(const i of t)pe(e,i)&&(n[i]=e[i]);return n}function Yn(e,t){const n={...e};for(const i of t)delete n[i];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>tt(e)).join(",")})`};function De(e){if(Ke(e))return e;const t=le(e)?e:tt(e);if(t.length<250)return t;let n=0;for(let i=0;i<t.length;i++){const r=t.charCodeAt(i);n=(n<<5)-n+r,n=n&n}return n}function Dv(e){return e===!1||e===null}function Ne(e,t){return e.includes(t)}function bl(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function Rx(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function SF(e,...t){for(const n of t)Noe(e,n??{});return e}function Noe(e,t){for(const n of W(t))Eg(e,n,t[n],!0)}function Ar(e,t){const n=[],i={};let r;for(const s of e)r=t(s),!(r in i)&&(i[r]=1,n.push(s));return n}function Doe(e,t){const n=W(e),i=W(t);if(n.length!==i.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0}function kF(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Ox(e,t){for(const n of e)if(t.has(n))return!0;return!1}function Rv(e){const t=new Set;for(const n of e){const r=Vo(n).map((o,a)=>a===0?o:`[${o}]`),s=r.map((o,a)=>r.slice(0,a+1).join(""));for(const o of s)t.add(o)}return t}function Ix(e,t){return e===void 0||t===void 0?!0:Ox(Rv(e),Rv(t))}function et(e){return W(e).length===0}const W=Object.keys,Qt=Object.values,No=Object.entries;function jf(e){return e===!0||e===!1}function pt(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function gf(e,t){return Dx(e)?`!(${gf(e.not,t)})`:Nx(e)?`(${e.and.map(n=>gf(n,t)).join(") && (")})`:Lx(e)?`(${e.or.map(n=>gf(n,t)).join(") || (")})`:t(e)}function wp(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&wp(e[n],t)&&delete e[n],et(e)}function Sd(e){return e.charAt(0).toUpperCase()+e.substr(1)}function Px(e,t="datum"){const n=Vo(e),i=[];for(let r=1;r<=n.length;r++){const s=`[${n.slice(0,r).map(xe).join("][")}]`;i.push(`${t}${s}`)}return i.join(" && ")}function AF(e,t="datum"){return`${t}[${xe(Vo(e).join("."))}]`}function Ye(e){return`datum['${e.replaceAll("'","\\'")}']`}function Roe(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Li(e){return`${Vo(e).map(Roe).join("\\.")}`}function Ka(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function Vl(e){return`${Vo(e).join(".")}`}function xl(e){return e?Vo(e).length:0}function At(...e){return e.find(t=>t!==void 0)}let $F=42;function MF(e){const t=++$F;return e?String(e)+t:t}function Ooe(){$F=42}function TF(e){return FF(e)?e:`__${e}`}function FF(e){return e.startsWith("__")}function Hf(e){if(e!==void 0)return(e%360+360)%360}function Kg(e){return Ke(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const h7=Object.getPrototypeOf(structuredClone({}));function ci(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor.name!==t.constructor.name)return!1;let n,i;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(i=n;i--!==0;)if(!ci(e[i],t[i]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const s of e.entries())if(!t.has(s[0]))return!1;for(const s of e.entries())if(!ci(s[1],t.get(s[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const s of e.entries())if(!t.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(i=n;i--!==0;)if(e[i]!==t[i])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&e.valueOf!==h7.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&e.toString!==h7.toString)return e.toString()===t.toString();const r=Object.keys(e);if(n=r.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(t,r[i]))return!1;for(i=n;i--!==0;){const s=r[i];if(!ci(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function tt(e){const t=[];return function n(i){if(i&&i.toJSON&&typeof i.toJSON=="function"&&(i=i.toJSON()),i===void 0)return;if(typeof i=="number")return isFinite(i)?""+i:"null";if(typeof i!="object")return JSON.stringify(i);let r,s;if(Array.isArray(i)){for(s="[",r=0;r<i.length;r++)r&&(s+=","),s+=n(i[r])||"null";return s+"]"}if(i===null)return"null";if(t.includes(i))throw new TypeError("Converting circular structure to JSON");const o=t.push(i)-1,a=Object.keys(i).sort();for(s="",r=0;r<a.length;r++){const u=a[r],l=n(i[u]);l&&(s&&(s+=","),s+=JSON.stringify(u)+":"+l)}return t.splice(o,1),`{${s}}`}(e)}function G(e,t){return _e(e)&&pe(e,t)&&e[t]!==void 0}const $s="row",Ms="column",Jg="facet",gt="x",Wt="y",or="x2",Jr="y2",Go="xOffset",Wl="yOffset",ar="radius",Ws="radius2",Ri="theta",Gs="theta2",ur="latitude",lr="longitude",cr="latitude2",Ni="longitude2",Yo="time",Kn="color",Qr="fill",es="stroke",Jn="shape",Ys="size",pu="angle",Zs="opacity",Zo="fillOpacity",Xo="strokeOpacity",Ko="strokeWidth",Jo="strokeDash",kd="text",_l="order",Ad="detail",Qg="key",Ja="tooltip",e1="href",Gl="url",t1="description",Ioe={x:1,y:1,x2:1,y2:1},LF={theta:1,theta2:1,radius:1,radius2:1};function NF(e){return pe(LF,e)}const zx={longitude:1,longitude2:1,latitude:1,latitude2:1};function DF(e){switch(e){case ur:return"y";case cr:return"y2";case lr:return"x";case Ni:return"x2"}}function RF(e){return pe(zx,e)}const Poe=W(zx),Bx={...Ioe,...LF,...zx,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,time:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function Xu(e){return e===Kn||e===Qr||e===es}const OF={row:1,column:1,facet:1},Si=W(OF),Ux={...Bx,...OF},zoe=W(Ux),{order:_1e,detail:w1e,tooltip:E1e,...Boe}=Ux,{row:C1e,column:S1e,facet:k1e,...Uoe}=Boe;function joe(e){return pe(Uoe,e)}function IF(e){return pe(Ux,e)}const Hoe=[or,Jr,cr,Ni,Gs,Ws];function PF(e){return gu(e)!==e}function gu(e){switch(e){case or:return gt;case Jr:return Wt;case cr:return ur;case Ni:return lr;case Gs:return Ri;case Ws:return ar}return e}function Do(e){if(NF(e))switch(e){case Ri:return"startAngle";case Gs:return"endAngle";case ar:return"outerRadius";case Ws:return"innerRadius"}return e}function ts(e){switch(e){case gt:return or;case Wt:return Jr;case ur:return cr;case lr:return Ni;case Ri:return Gs;case ar:return Ws}}function Qn(e){switch(e){case gt:case or:return"width";case Wt:case Jr:return"height"}}function zF(e){switch(e){case gt:return"xOffset";case Wt:return"yOffset";case or:return"x2Offset";case Jr:return"y2Offset";case Ri:return"thetaOffset";case ar:return"radiusOffset";case Gs:return"theta2Offset";case Ws:return"radius2Offset"}}function jx(e){switch(e){case gt:return"xOffset";case Wt:return"yOffset"}}function qoe(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const Voe=W(Bx),{x:A1e,y:$1e,x2:M1e,y2:T1e,xOffset:F1e,yOffset:L1e,latitude:N1e,longitude:D1e,latitude2:R1e,longitude2:O1e,theta:I1e,theta2:P1e,radius:z1e,radius2:B1e,...Hx}=Bx,Woe=W(Hx),qx={x:1,y:1},Xs=W(qx);function $t(e){return pe(qx,e)}const Vx={theta:1,radius:1},Goe=W(Vx);function n1(e){return e==="width"?gt:Wt}const BF={xOffset:1,yOffset:1};function $d(e){return pe(BF,e)}const Yoe={time:1};function oy(e){return e in Yoe}const{text:U1e,tooltip:j1e,href:H1e,url:q1e,description:V1e,detail:W1e,key:G1e,order:Y1e,...UF}=Hx,Zoe=W(UF);function Xoe(e){return pe(Hx,e)}function Koe(e){switch(e){case Kn:case Qr:case es:case Ys:case Jn:case Zs:case Ko:case Jo:return!0;case Zo:case Xo:case pu:case Yo:return!1}}const jF={...qx,...Vx,...BF,...UF},Wx=W(jF);function ns(e){return pe(jF,e)}function Joe(e,t){return eae(e)[t]}const HF={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:Z1e,...Qoe}=HF;function eae(e){switch(e){case Kn:case Qr:case es:case t1:case Ad:case Qg:case Ja:case e1:case _l:case Zs:case Zo:case Xo:case Ko:case Jg:case $s:case Ms:return HF;case gt:case Wt:case Go:case Wl:case ur:case lr:case Yo:return Qoe;case or:case Jr:case cr:case Ni:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case Ys:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Jo:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case Jn:return{point:"always",geoshape:"always"};case kd:return{text:"always"};case pu:return{point:"always",square:"always",text:"always"};case Gl:return{image:"always"};case Ri:return{text:"always",arc:"always"};case ar:return{text:"always",arc:"always"};case Gs:case Ws:return{arc:"always"}}}function ay(e){switch(e){case gt:case Wt:case Ri:case ar:case Go:case Wl:case Ys:case pu:case Ko:case Zs:case Zo:case Xo:case Yo:case or:case Jr:case Gs:case Ws:return;case Jg:case $s:case Ms:case Jn:case Jo:case kd:case Ja:case e1:case Gl:case t1:return"discrete";case Kn:case Qr:case es:return"flexible";case ur:case lr:case cr:case Ni:case Ad:case Qg:case _l:return}}const tae={argmax:1,argmin:1,average:1,count:1,distinct:1,exponential:1,exponentialb:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},nae={count:1,min:1,max:1};function Bs(e){return G(e,"argmin")}function Qo(e){return G(e,"argmax")}function Gx(e){return le(e)&&pe(tae,e)}const iae=new Set(["count","valid","missing","distinct"]);function i1(e){return le(e)&&iae.has(e)}function rae(e){return le(e)&&Ne(["min","max"],e)}const sae=new Set(["count","sum","distinct","valid","missing"]),oae=new Set(["mean","average","median","q1","q3","min","max"]);function qF(e){return Pl(e)&&(e=g1(e,void 0)),"bin"+W(e).map(t=>r1(e[t])?pt(`_${t}_${No(e[t])}`):pt(`_${t}_${e[t]}`)).join("")}function lt(e){return e===!0||mu(e)&&!e.binned}function Gt(e){return e==="binned"||mu(e)&&e.binned===!0}function mu(e){return _e(e)}function r1(e){return G(e,"param")}function p7(e){switch(e){case $s:case Ms:case Ys:case Kn:case Qr:case es:case Ko:case Zs:case Zo:case Xo:case Jn:return 6;case Jo:return 4;default:return 10}}function Md(e){return G(e,"expr")}function Yt(e,{level:t}={level:0}){const n=W(e||{}),i={};for(const r of n)i[r]=t===0?oi(e[r]):Yt(e[r],{level:t-1});return i}function VF(e){const{anchor:t,frame:n,offset:i,orient:r,angle:s,limit:o,color:a,subtitleColor:u,subtitleFont:l,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:p,...g}=e,m={...g,...a?{fill:a}:{}},y={...t?{anchor:t}:{},...n?{frame:n}:{},...i?{offset:i}:{},...r?{orient:r}:{},...s!==void 0?{angle:s}:{},...o!==void 0?{limit:o}:{}},v={...u?{subtitleColor:u}:{},...l?{subtitleFont:l}:{},...c?{subtitleFontSize:c}:{},...f?{subtitleFontStyle:f}:{},...d?{subtitleFontWeight:d}:{},...h?{subtitleLineHeight:h}:{},...p?{subtitlePadding:p}:{}},b=vl(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:m,subtitleMarkConfig:b,nonMarkTitleProperties:y,subtitle:v}}function lo(e){return le(e)||V(e)&&le(e[0])}function ue(e){return G(e,"signal")}function yu(e){return G(e,"step")}function aae(e){return V(e)?!1:G(e,"fields")&&!G(e,"data")}function uae(e){return V(e)?!1:G(e,"fields")&&G(e,"data")}function Cs(e){return V(e)?!1:G(e,"field")&&G(e,"data")}const lae={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},cae=W(lae),fae={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},Ov=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function WF(e){const t=V(e.condition)?e.condition.map(g7):g7(e.condition);return{...oi(e),condition:t}}function oi(e){if(Md(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function g7(e){if(Md(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function ct(e){if(Md(e)){const{expr:t,...n}=e;return{signal:t,...n}}return ue(e)?e:e!==void 0?{value:e}:void 0}function dae(e){return ue(e)?e.signal:xe(e)}function m7(e){return ue(e)?e.signal:xe(e.value)}function Gi(e){return ue(e)?e.signal:e==null?null:xe(e)}function hae(e,t,n){for(const i of n){const r=Hr(i,t.markDef,t.config);r!==void 0&&(e[i]=ct(r))}return e}function GF(e){return[].concat(e.type,e.style??[])}function Qe(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:s}=i;return r&&G(t,r)?t[r]:t[e]!==void 0?t[e]:s&&(!r||r===e)?void 0:Hr(e,t,n,i)}function Hr(e,t,n,{vgChannel:i}={}){const r=Iv(e,t,n.style);return At(i?r:void 0,r,i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function Iv(e,t,n){return YF(e,GF(t),n)}function YF(e,t,n){t=ce(t);let i;for(const r of t){const s=n[r];G(s,e)&&(i=s[e])}return i}function ZF(e,t){return ce(e).reduce((n,i)=>(n.field.push(ee(i,t)),n.order.push(i.sort??"ascending"),n),{field:[],order:[]})}function XF(e,t){const n=[...e];return t.forEach(i=>{for(const r of n)if(ci(r,i))return;n.push(i)}),n}function KF(e,t){return ci(e,t)||!t?e:e?[...ce(e),...ce(t)].join(", "):t}function JF(e,t){const n=e.value,i=t.value;if(n==null||i===null)return{explicit:e.explicit,value:null};if((lo(n)||ue(n))&&(lo(i)||ue(i)))return{explicit:e.explicit,value:KF(n,i)};if(lo(n)||ue(n))return{explicit:e.explicit,value:n};if(lo(i)||ue(i))return{explicit:e.explicit,value:i};if(!lo(n)&&!ue(n)&&!lo(i)&&!ue(i))return{explicit:e.explicit,value:XF(n,i)};throw new Error("It should never reach here")}function Yx(e){return`Invalid specification ${tt(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const pae='Autosize "fit" only works for single views and layered views.';function y7(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function v7(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function b7(e){return e?`Dropping "fit-${e}" because spec has discrete ${Qn(e)}.`:'Dropping "fit" because spec has discrete size.'}function Zx(e){return`Unknown field for ${e}. Cannot calculate view size.`}function x7(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function gae(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function mae(e){return`The "nearest" transform is not supported for ${e} marks.`}function QF(e){return`Selection not supported for ${e} yet.`}function yae(e){return`Cannot find a selection named "${e}".`}const vae="Scale bindings are currently only supported for scales with unbinned, continuous domains.",bae="Sequntial scales are deprecated. The available quantitative scale type values are linear, log, pow, sqrt, symlog, time and utc",xae="Legend bindings are only supported for selections over an individual field or encoding channel.";function _ae(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function wae(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const Eae="The same selection must be used to override scale domains in a layered view.",Cae='Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.';function Sae(e){return`Unknown repeated value "${e}".`}function _7(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const kae="Multiple timer selections in one unit spec are not supported. Ignoring all but the first.",Xx="Animation involving facet, layer, or concat is currently unsupported.";function Aae(e){return`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${xe(e)}.`}function $ae(e,t,n,i){return(e.length?"Multiple ":"No ")+`matching ${xe(t)} encoding found for selection ${xe(n.param)}. Using "field": ${xe(i)}.`}const Mae="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function Tae(e){return`Unrecognized parse "${e}".`}function w7(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const Fae="Attempt to add the same child twice.";function Lae(e){return`Ignoring an invalid transform: ${tt(e)}.`}const Nae='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function E7(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function Dae(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${tt(t)} is overridden by a child projection ${tt(n)}.`}const Rae="Arc marks uses theta channel rather than angle, replacing angle with theta.";function Oae(e){return`${e}Offset dropped because ${e} is continuous`}function Iae(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${tt(n)}}.`}function eL(e){return`Invalid field type "${e}".`}function Pae(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function zae(e){return`Invalid aggregation operator "${e}".`}function tL(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function Bae(e){return`Position range does not support relative band size for ${e}.`}function Pv(e,t){return`Dropping ${tt(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const Uae="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function s1(e,t,n){return`${e} dropped as it is incompatible with "${t}".`}function jae(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function Hae(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function qae(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function Vae(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function uy(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function Wae(e){return`The ${e} for range marks cannot be an expression`}function Gae(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function Yae(e,t){return`Specified orient "${e}" overridden with "${t}".`}function Zae(e){return`Cannot use the scale property "${e}" with non-color channel.`}function Xae(e){return`Cannot use the relative band size with ${e} scale.`}function Kae(e){return`Using unaggregated domain with raw field has no effect (${tt(e)}).`}function Jae(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function Qae(e){return`Unaggregated domain is currently unsupported for log scale (${tt(e)}).`}function eue(e){return`Cannot apply size to non-oriented mark "${e}".`}function tue(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function nue(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function nL(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function iL(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function iue(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${tt(n)} and ${tt(i)}). Using ${tt(n)}.`}function rue(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${tt(n)} and ${tt(i)}). Using the union of the two domains.`}function sue(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function oue(e){return`Dropping sort property ${tt(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const C7="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",aue="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",uue="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",lue="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function cue(e){return`Cannot stack "${e}" if there is already "${e}2".`}function fue(e){return`Stack is applied to a non-linear scale (${e}).`}function due(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function Ep(e,t){return`Invalid ${e}: ${tt(t)}.`}function hue(e){return`Dropping day from datetime ${tt(e)} as day cannot be combined with other units.`}function pue(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function gue(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function mue(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function S7(e){return`1D error band does not support ${e}.`}function rL(e){return`Channel ${e} is required for "binned" bin.`}function yue(e){return`Channel ${e} should not be used with "binned" bin.`}function vue(e){return`Domain for ${e} is required for threshold scale.`}const sL=lA(uA);let Qa=sL;function bue(e){return Qa=e,Qa}function xue(){return Qa=sL,Qa}function Kx(...e){Qa.error(...e)}function Y(...e){Qa.warn(...e)}function _ue(...e){Qa.debug(...e)}function vu(e){if(e&&_e(e)){for(const t of Qx)if(G(e,t))return!0}return!1}const oL=["january","february","march","april","may","june","july","august","september","october","november","december"],wue=oL.map(e=>e.substr(0,3)),aL=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Eue=aL.map(e=>e.substr(0,3));function Cue(e){if(Kg(e)&&(e=+e),Ke(e))return e>4&&Y(Ep("quarter",e)),e-1;throw new Error(Ep("quarter",e))}function Sue(e){if(Kg(e)&&(e=+e),Ke(e))return e-1;{const t=e.toLowerCase(),n=oL.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=wue.indexOf(i);if(r!==-1)return r;throw new Error(Ep("month",e))}}function kue(e){if(Kg(e)&&(e=+e),Ke(e))return e%7;{const t=e.toLowerCase(),n=aL.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=Eue.indexOf(i);if(r!==-1)return r;throw new Error(Ep("day",e))}}function Jx(e,t){const n=[];if(t&&e.day!==void 0&&W(e).length>1&&(Y(hue(e)),e=Ce(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const i=t?Sue(e.month):e.month;n.push(i)}else if(e.quarter!==void 0){const i=t?Cue(e.quarter):e.quarter;n.push(Ke(i)?i*3:`${i}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const i=t?kue(e.day):e.day;n.push(Ke(i)?i+1:`${i}+1`)}else n.push(1);for(const i of["hours","minutes","seconds","milliseconds"]){const r=e[i];n.push(typeof r>"u"?0:r)}return n}function eu(e){const n=Jx(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Aue(e){const n=Jx(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function $ue(e){const t=Jx(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const uL={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},Qx=W(uL);function Mue(e){return pe(uL,e)}function bu(e){return _e(e)?e.binned:lL(e)}function lL(e){return e&&e.startsWith("binned")}function e4(e){return e.startsWith("utc")}function Tue(e){return e.substring(3)}const Fue={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function o1(e){return Qx.filter(t=>fL(e,t))}function cL(e){const t=o1(e);return t[t.length-1]}function fL(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function Lue(e,t,{end:n}={end:!1}){const i=Px(t),r=e4(e)?"utc":"";function s(u){return u==="quarter"?`(${r}quarter(${i})-1)`:`${r}${u}(${i})`}let o;const a={};for(const u of Qx)fL(e,u)&&(a[u]=s(u),o=u);return n&&(a[o]+="+1"),Aue(a)}function dL(e){if(!e)return;const t=o1(e);return`timeUnitSpecifier(${tt(t)}, ${tt(Fue)})`}function Nue(e,t,n){if(!e)return;const i=dL(e);return`${n||e4(e)?"utc":"time"}Format(${t}, ${i})`}function jt(e){if(!e)return;let t;return le(e)?lL(e)?t={unit:e.substring(6),binned:!0}:t={unit:e}:_e(e)&&(t={...e,...e.unit?{unit:e.unit}:{}}),e4(t.unit)&&(t.utc=!0,t.unit=Tue(t.unit)),t}function Due(e){const{utc:t,...n}=jt(e);return n.unit?(t?"utc":"")+W(n).map(i=>pt(`${i==="unit"?"":`_${i}_`}${n[i]}`)).join(""):(t?"utc":"")+"timeunit"+W(n).map(i=>pt(`_${i}_${n[i]}`)).join("")}function hL(e,t=n=>n){const n=jt(e),i=cL(n.unit);if(i&&i!=="day"){const r={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},{step:s,part:o}=pL(i,n.step),a={...r,[o]:+r[o]+s};return`${t(eu(a))} - ${t(eu(r))}`}}const Rue={year:1,month:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};function Oue(e){return pe(Rue,e)}function pL(e,t=1){if(Oue(e))return{part:e,step:t};switch(e){case"day":case"dayofyear":return{part:"date",step:t};case"quarter":return{part:"month",step:t*3};case"week":return{part:"date",step:t*7}}}function Iue(e){return G(e,"param")}function t4(e){return!!(e!=null&&e.field)&&e.equal!==void 0}function n4(e){return!!(e!=null&&e.field)&&e.lt!==void 0}function i4(e){return!!(e!=null&&e.field)&&e.lte!==void 0}function r4(e){return!!(e!=null&&e.field)&&e.gt!==void 0}function s4(e){return!!(e!=null&&e.field)&&e.gte!==void 0}function o4(e){if(e!=null&&e.field){if(V(e.range)&&e.range.length===2)return!0;if(ue(e.range))return!0}return!1}function a4(e){return!!(e!=null&&e.field)&&(V(e.oneOf)||V(e.in))}function Pue(e){return!!(e!=null&&e.field)&&e.valid!==void 0}function gL(e){return a4(e)||t4(e)||o4(e)||n4(e)||r4(e)||i4(e)||s4(e)}function vr(e,t){return m1(e,{timeUnit:t,wrapTime:!0})}function zue(e,t){return e.map(n=>vr(n,t))}function mL(e,t=!0){const{field:n}=e,i=jt(e.timeUnit),{unit:r,binned:s}=i||{},o=ee(e,{expr:"datum"}),a=r?`time(${s?o:Lue(r,n)})`:o;if(t4(e))return`${a}===${vr(e.equal,r)}`;if(n4(e)){const u=e.lt;return`${a}<${vr(u,r)}`}else if(r4(e)){const u=e.gt;return`${a}>${vr(u,r)}`}else if(i4(e)){const u=e.lte;return`${a}<=${vr(u,r)}`}else if(s4(e)){const u=e.gte;return`${a}>=${vr(u,r)}`}else{if(a4(e))return`indexof([${zue(e.oneOf,r).join(",")}], ${a}) !== -1`;if(Pue(e))return a1(a,e.valid);if(o4(e)){const{range:u}=Yt(e),l=ue(u)?{signal:`${u.signal}[0]`}:u[0],c=ue(u)?{signal:`${u.signal}[1]`}:u[1];if(l!==null&&c!==null&&t)return"inrange("+a+", ["+vr(l,r)+", "+vr(c,r)+"])";const f=[];return l!==null&&f.push(`${a} >= ${vr(l,r)}`),c!==null&&f.push(`${a} <= ${vr(c,r)}`),f.length>0?f.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${tt(e)}`)}function a1(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function Bue(e){return gL(e)&&e.timeUnit?{...e,timeUnit:jt(e.timeUnit)}:e}const Td={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function Uue(e){return e==="quantitative"||e==="temporal"}function yL(e){return e==="ordinal"||e==="nominal"}const tu=Td.quantitative,u4=Td.ordinal,wl=Td.temporal,l4=Td.nominal,Yl=Td.geojson;function jue(e){if(e)switch(e=e.toLowerCase(),e){case"q":case tu:return"quantitative";case"t":case wl:return"temporal";case"o":case u4:return"ordinal";case"n":case l4:return"nominal";case Yl:return"geojson"}}const Zt={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",TIME:"time",UTC:"utc",POINT:"point",BAND:"band"},zv={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function Hue(e,t){const n=zv[e],i=zv[t];return n===i||n==="ordinal-position"&&i==="time"||i==="ordinal-position"&&n==="time"}const que={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function k7(e){return que[e]}const vL=new Set(["linear","log","pow","sqrt","symlog"]),bL=new Set([...vL,"time","utc"]);function xL(e){return vL.has(e)}const _L=new Set(["quantile","quantize","threshold"]),Vue=new Set([...bL,..._L,"sequential","identity"]),Wue=new Set(["ordinal","bin-ordinal","point","band"]);function qt(e){return Wue.has(e)}function tr(e){return Vue.has(e)}function $r(e){return bL.has(e)}function El(e){return _L.has(e)}const Gue={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,tickBandPaddingInner:.25,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:4,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0,framesPerSecond:2,animationDuration:5};function Yue(e){return!le(e)&&G(e,"name")}function wL(e){return G(e,"param")}function Zue(e){return G(e,"unionWith")}function Xue(e){return _e(e)&&"field"in e}const Kue={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,domainRaw:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:X1e,domain:K1e,range:J1e,rangeMax:Q1e,rangeMin:eme,scheme:tme,...Jue}=Kue,Que=W(Jue);function Bv(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return $r(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return $r(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"domainRaw":case"clamp":return $r(e);case"nice":return $r(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return tr(e)&&!Ne(["log","time","utc","threshold","quantile"],e)}}function EL(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Xu(e)?void 0:Zae(t);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"domainRaw":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function ele(e,t){return Ne([u4,l4],t)?e===void 0||qt(e):t===wl?Ne([Zt.TIME,Zt.UTC,void 0],e):t===tu?xL(e)||El(e)||e===void 0:!0}function tle(e,t,n=!1){if(!ns(e))return!1;switch(e){case gt:case Wt:case Go:case Wl:case Ri:case ar:return $r(t)||t==="band"?!0:t==="point"?!n:!1;case Yo:return Ne(["linear","band"],t);case Ys:case Ko:case Zs:case Zo:case Xo:case pu:return $r(t)||El(t)||Ne(["band","point","ordinal"],t);case Kn:case Qr:case es:return t!=="band";case Jo:case Jn:return t==="ordinal"||El(t)}}function nle(e){return _e(e)&&"value"in e}const Un={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},CL=Un.arc,u1=Un.area,l1=Un.bar,ile=Un.image,c1=Un.line,f1=Un.point,rle=Un.rect,Cp=Un.rule,SL=Un.text,c4=Un.tick,sle=Un.trail,f4=Un.circle,d4=Un.square,kL=Un.geoshape;function ea(e){return["line","area","trail"].includes(e)}function qf(e){return["rect","bar","image","arc","tick"].includes(e)}const ole=new Set(W(Un));function qr(e){return G(e,"type")}const ale=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],ule=["fill","fillOpacity"],lle=[...ale,...ule],cle={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},A7=W(cle),ly=["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],fle={area:["line","point"],bar:ly,rect:ly,line:["point"],tick:["bandSize","thickness",...ly]},dle={color:"#4c78a8",invalid:"break-paths-show-path-domains",timeUnitBandSize:1},hle={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},AL=W(hle);function nu(e){return G(e,"band")}const ple={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},gle=5,h4={binSpacing:0,continuousBandSize:gle,minBandSize:.25,timeUnitBandPosition:.5},mle={...h4,binSpacing:1},yle={...h4,thickness:1};function vle(e){return qr(e)?e.type:e}function $L(e,{isPath:t}){return e===void 0||e==="break-paths-show-path-domains"?t?"break-paths-show-domains":"filter":e===null?"show":e}function p4({markDef:e,config:t,scaleChannel:n,scaleType:i,isCountAggregate:r}){var a,u;if(!i||!tr(i)||r)return"always-valid";const s=$L(Qe("invalid",e,t),{isPath:ea(e.type)});return((u=(a=t.scale)==null?void 0:a.invalid)==null?void 0:u[n])!==void 0?"show":s}function ble(e){return e==="break-paths-filter-domains"||e==="break-paths-show-domains"}function ML({scaleName:e,scale:t,mode:n}){const i=`domain('${e}')`;if(!t||!e)return;const r=`${i}[0]`,s=`peek(${i})`,o=t.domainHasZero();return o==="definitely"?{scale:e,value:0}:o==="maybe"?{signal:`scale('${e}', inrange(0, ${i}) ? 0 : ${n==="zeroOrMin"?r:s})`}:{signal:`scale('${e}', ${n==="zeroOrMin"?r:s})`}}function TL({scaleChannel:e,channelDef:t,scale:n,scaleName:i,markDef:r,config:s}){var c;const o=n==null?void 0:n.get("type"),a=ir(t),u=i1(a==null?void 0:a.aggregate),l=p4({scaleChannel:e,markDef:r,config:s,scaleType:o,isCountAggregate:u});if(a&&l==="show"){const f=((c=s.scale.invalid)==null?void 0:c[e])??"zero-or-min";return{test:a1(ee(a,{expr:"datum"}),!1),...xle(f,n,i)}}}function xle(e,t,n){if(nle(e)){const{value:i}=e;return ue(i)?{signal:i.signal}:{value:i}}return ML({scale:t,scaleName:n,mode:"zeroOrMin"})}function g4(e){const{channel:t,channelDef:n,markDef:i,scale:r,scaleName:s,config:o}=e,a=gu(t),u=m4(e),l=TL({scaleChannel:a,channelDef:n,scale:r,scaleName:s,markDef:i,config:o});return l!==void 0?[l,u]:u}function _le(e){const{datum:t}=e;return vu(t)?eu(t):`${tt(t)}`}function Da(e,t,n,i){const r={};if(t&&(r.scale=t),is(e)){const{datum:s}=e;vu(s)?r.signal=eu(s):ue(s)?r.signal=s.signal:Md(s)?r.signal=s.expr:r.value=s}else r.field=ee(e,n);if(i){const{offset:s,band:o}=i;s&&(r.offset=s),o&&(r.band=o)}return r}function Sp({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,endSuffix:s="end",bandPosition:o=.5}){const a=!ue(o)&&0<o&&o<1?"datum":void 0,u=ee(t,{expr:a,suffix:r}),l=n!==void 0?ee(n,{expr:a}):ee(t,{suffix:s,expr:a}),c={};if(o===0||o===1){c.scale=e;const f=o===0?u:l;c.field=f}else{const f=ue(o)?`(1-${o.signal}) * ${u} + ${o.signal} * ${l}`:`${1-o} * ${u} + ${o} * ${l}`;c.signal=`scale("${e}", ${f})`}return i&&(c.offset=i),c}function wle({scaleName:e,fieldDef:t}){const n=ee(t,{expr:"datum"}),i=ee(t,{expr:"datum",suffix:"end"});return`abs(scale("${e}", ${i}) - scale("${e}", ${n}))`}function m4({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:u,defaultRef:l,bandPosition:c}){if(t){if(ke(t)){const f=o==null?void 0:o.get("type");if(zn(t)){c??(c=Ro({fieldDef:t,fieldDef2:n,markDef:i,config:r}));const{bin:d,timeUnit:h,type:p}=t;if(lt(d)||c&&h&&p===wl)return a!=null&&a.impute?Da(t,s,{binSuffix:"mid"},{offset:u}):c&&!qt(f)?Sp({scaleName:s,fieldOrDatumDef:t,bandPosition:c,offset:u}):Da(t,s,Rd(t,e)?{binSuffix:"range"}:{},{offset:u});if(Gt(d)){if(Z(n))return Sp({scaleName:s,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:u});Y(rL(e===gt?or:Jr))}}return Da(t,s,qt(f)?{binSuffix:"range"}:{},{offset:u,band:f==="band"?c??t.bandPosition??.5:void 0})}else if(nr(t)){const f=t.value,d=u?{offset:u}:{};return{...mf(e,f),...d}}}return Me(l)&&(l=l()),l&&{...l,...u?{offset:u}:{}}}function mf(e,t){return Ne(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:Ne(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:ct(t)}function iu(e){return e&&e!=="number"&&e!=="time"}function FL(e,t,n){return`${e}(${t}${n?`, ${tt(n)}`:""})`}const Ele=" – ";function y4({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s}){var u,l;if(iu(n))return Yi({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:s});const o=LL(e,i,r),a=Cl(e);if(t===void 0&&n===void 0&&s.customFormatTypes){if(a==="quantitative"){if(r&&s.normalizedNumberFormatType)return Yi({fieldOrDatumDef:e,format:s.normalizedNumberFormat,formatType:s.normalizedNumberFormatType,expr:i,config:s});if(s.numberFormatType)return Yi({fieldOrDatumDef:e,format:s.numberFormat,formatType:s.numberFormatType,expr:i,config:s})}if(a==="temporal"&&s.timeFormatType&&Z(e)&&e.timeUnit===void 0)return Yi({fieldOrDatumDef:e,format:s.timeFormat,formatType:s.timeFormatType,expr:i,config:s})}if(kl(e)){const c=Sle({field:o,timeUnit:Z(e)?(u=jt(e.timeUnit))==null?void 0:u.unit:void 0,format:t,formatType:s.timeFormatType,rawTimeFormat:s.timeFormat,isUTCScale:xu(e)&&((l=e.scale)==null?void 0:l.type)===Zt.UTC});return c?{signal:c}:void 0}if(t=Uv({type:a,specifiedFormat:t,config:s,normalizeStack:r}),Z(e)&&lt(e.bin)){const c=ee(e,{expr:i,binSuffix:"end"});return{signal:Fd(o,c,t,n,s)}}else return t||Cl(e)==="quantitative"?{signal:`${RL(o,t)}`}:{signal:`isValid(${o}) ? ${o} : ""+${o}`}}function LL(e,t,n){return Z(e)?n?`${ee(e,{expr:t,suffix:"end"})}-${ee(e,{expr:t,suffix:"start"})}`:ee(e,{expr:t}):_le(e)}function Yi({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s,field:o}){if(o??(o=LL(e,i,r)),o!=="datum.value"&&Z(e)&&lt(e.bin)){const a=ee(e,{expr:i,binSuffix:"end"});return{signal:Fd(o,a,t,n,s)}}return{signal:FL(n,o,t)}}function NL(e,t,n,i,r,s){var o;if(!(le(i)&&iu(i))&&!(n===void 0&&i===void 0&&r.customFormatTypes&&Cl(e)==="quantitative"&&(r.normalizedNumberFormatType&&Sl(e)&&e.stack==="normalize"||r.numberFormatType))){if(Sl(e)&&e.stack==="normalize"&&r.normalizedNumberFormat)return Uv({type:"quantitative",config:r,normalizeStack:!0});if(kl(e)){const a=Z(e)?(o=jt(e.timeUnit))==null?void 0:o.unit:void 0;return a===void 0&&r.customFormatTypes&&r.timeFormatType?void 0:Cle({specifiedFormat:n,timeUnit:a,config:r,omitTimeFormatConfig:s})}return Uv({type:t,specifiedFormat:n,config:r})}}function DL(e,t,n){var i;if(e&&(ue(e)||e==="number"||e==="time"))return e;if(kl(t)&&n!=="time"&&n!=="utc")return Z(t)&&((i=jt(t==null?void 0:t.timeUnit))!=null&&i.utc)?"utc":"time"}function Uv({type:e,specifiedFormat:t,config:n,normalizeStack:i}){if(le(t))return t;if(e===tu)return i?n.normalizedNumberFormat:n.numberFormat}function Cle({specifiedFormat:e,timeUnit:t,config:n,omitTimeFormatConfig:i}){return e||(t?{signal:dL(t)}:i?void 0:n.timeFormat)}function RL(e,t){return`format(${e}, "${t||""}")`}function $7(e,t,n,i){return iu(n)?FL(n,e,t):RL(e,(le(t)?t:void 0)??i.numberFormat)}function Fd(e,t,n,i,r){if(n===void 0&&i===void 0&&r.customFormatTypes&&r.numberFormatType)return Fd(e,t,r.numberFormat,r.numberFormatType,r);const s=$7(e,n,i,r),o=$7(t,n,i,r);return`${a1(e,!1)} ? "null" : ${s} + "${Ele}" + ${o}`}function Sle({field:e,timeUnit:t,format:n,formatType:i,rawTimeFormat:r,isUTCScale:s}){return!t||n?!t&&i?`${i}(${e}, '${n}')`:(n=le(n)?n:r,`${s?"utc":"time"}Format(${e}, '${n}')`):Nue(t,e,s)}const d1="min",kle={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function M7(e){return pe(kle,e)}function Ale(e){return G(e,"encoding")}function Ts(e){return e&&(e.op==="count"||G(e,"field"))}function OL(e){return e&&V(e)}function Ld(e){return G(e,"row")||G(e,"column")}function v4(e){return G(e,"header")}function h1(e){return G(e,"facet")}function $le(e){return G(e,"param")}function Mle(e){return!le(e)&&G(e,"repeat")}function T7(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return{...n?{timeUnit:n}:{},...i?{bin:i}:{},...r?{aggregate:r}:{},field:t}}function b4(e){return G(e,"sort")}function Ro({fieldDef:e,fieldDef2:t,markDef:n,config:i}){if(ke(e)&&e.bandPosition!==void 0)return e.bandPosition;if(Z(e)){const{timeUnit:r,bin:s}=e;if(r&&!t)return Hr("timeUnitBandPosition",n,i);if(lt(s))return .5}}function IL({channel:e,fieldDef:t,fieldDef2:n,markDef:i,config:r,scaleType:s,useVlSizeChannel:o}){var l,c,f;const a=Qn(e),u=Qe(o?"size":a,i,r,{vgChannel:a});if(u!==void 0)return u;if(Z(t)){const{timeUnit:d,bin:h}=t;if(d&&!n)return{band:Hr("timeUnitBandSize",i,r)};if(lt(h)&&!qt(s))return{band:1}}if(qf(i.type))return s?qt(s)?((l=r[i.type])==null?void 0:l.discreteBandSize)||{band:1}:(c=r[i.type])==null?void 0:c.continuousBandSize:(f=r[i.type])==null?void 0:f.discreteBandSize}function PL(e,t,n,i){return lt(e.bin)||e.timeUnit&&zn(e)&&e.type==="temporal"?Ro({fieldDef:e,fieldDef2:t,markDef:n,config:i})!==void 0:!1}function zL(e){return G(e,"sort")&&!G(e,"field")}function Nd(e){return G(e,"condition")}function p1(e){const t=e==null?void 0:e.condition;return!!t&&!V(t)&&Z(t)}function Dd(e){const t=e==null?void 0:e.condition;return!!t&&!V(t)&&ke(t)}function Tle(e){const t=e==null?void 0:e.condition;return!!t&&(V(t)||nr(t))}function Z(e){return G(e,"field")||(e==null?void 0:e.aggregate)==="count"}function Cl(e){return e==null?void 0:e.type}function is(e){return G(e,"datum")}function yo(e){return zn(e)&&!Ap(e)||kp(e)}function F7(e){return zn(e)&&e.type==="quantitative"&&!e.bin||kp(e)}function kp(e){return is(e)&&Ke(e.datum)}function ke(e){return Z(e)||is(e)}function zn(e){return e&&(G(e,"field")||e.aggregate==="count")&&G(e,"type")}function nr(e){return G(e,"value")}function xu(e){return G(e,"scale")||G(e,"sort")}function Sl(e){return G(e,"axis")||G(e,"stack")||G(e,"impute")}function BL(e){return G(e,"legend")}function UL(e){return G(e,"format")||G(e,"formatType")}function Fle(e){return Yn(e,["legend","axis","header","scale"])}function Lle(e){return G(e,"op")}function ee(e,t={}){let n=e.field;const i=t.prefix;let r=t.suffix,s="";if(Dle(e))n=TF("count");else{let o;if(!t.nofn)if(Lle(e))o=e.op;else{const{bin:a,aggregate:u,timeUnit:l}=e;lt(a)?(o=qF(a),r=(t.binSuffix??"")+(t.suffix??"")):u?Qo(u)?(s=`["${n}"]`,n=`argmax_${u.argmax}`):Bs(u)?(s=`["${n}"]`,n=`argmin_${u.argmin}`):o=String(u):l&&!bu(l)&&(o=Due(l),r=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(t.suffix??""))}o&&(n=n?`${o}_${n}`:o)}return r&&(n=`${n}_${r}`),i&&(n=`${i}_${n}`),t.forAs?Vl(n):t.expr?AF(n,t.expr)+s:Li(n)+s}function Ap(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return Z(e)&&!!e.bin;case"temporal":return!1}throw new Error(eL(e.type))}function Nle(e){var t;return xu(e)&&El((t=e.scale)==null?void 0:t.type)}function Dle(e){return e.aggregate==="count"}function Rle(e,t){var o;const{field:n,bin:i,timeUnit:r,aggregate:s}=e;if(s==="count")return t.countTitle;if(lt(i))return`${n} (binned)`;if(r&&!bu(r)){const a=(o=jt(r))==null?void 0:o.unit;if(a)return`${n} (${o1(a).join("-")})`}else if(s)return Qo(s)?`${n} for max ${s.argmax}`:Bs(s)?`${n} for min ${s.argmin}`:`${Sd(s)} of ${n}`;return n}function Ole(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(Qo(t))return`${r} for argmax(${t.argmax})`;if(Bs(t))return`${r} for argmin(${t.argmin})`;const s=i&&!bu(i)?jt(i):void 0,o=t||(s==null?void 0:s.unit)||(s==null?void 0:s.maxbins)&&"timeunit"||lt(n)&&"bin";return o?`${o.toUpperCase()}(${r})`:r}const jL=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return Ole(e);default:return Rle(e,t)}};let HL=jL;function qL(e){HL=e}function Ile(){qL(jL)}function Ku(e,t,{allowDisabling:n,includeDefault:i=!0}){var a;const r=(a=x4(e))==null?void 0:a.title;if(!Z(e))return r??e.title;const s=e,o=i?_4(s,t):void 0;return n?At(r,s.title,o):r??s.title??o}function x4(e){if(Sl(e)&&e.axis)return e.axis;if(BL(e)&&e.legend)return e.legend;if(v4(e)&&e.header)return e.header}function _4(e,t){return HL(e,t)}function $p(e){if(UL(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n}}else{const t=x4(e)??{},{format:n,formatType:i}=t;return{format:n,formatType:i}}}function Ple(e,t){var s;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(b4(e)&&V(e.sort))return"ordinal";const{aggregate:n,bin:i,timeUnit:r}=e;if(r)return"temporal";if(i||n&&!Qo(n)&&!Bs(n))return"quantitative";if(xu(e)&&((s=e.scale)!=null&&s.type))switch(zv[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function ir(e){if(Z(e))return e;if(p1(e))return e.condition}function Lt(e){if(ke(e))return e;if(Dd(e))return e.condition}function VL(e,t,n,i={}){if(le(e)||Ke(e)||Pl(e)){const r=le(e)?"string":Ke(e)?"number":"boolean";return Y(Iae(t,r,e)),{value:e}}return ke(e)?Mp(e,t,n,i):Dd(e)?{...e,condition:Mp(e.condition,t,n,i)}:e}function Mp(e,t,n,i){if(UL(e)){const{format:r,formatType:s,...o}=e;if(iu(s)&&!n.customFormatTypes)return Y(E7(t)),Mp(o,t,n,i)}else{const r=Sl(e)?"axis":BL(e)?"legend":v4(e)?"header":null;if(r&&e[r]){const{format:s,formatType:o,...a}=e[r];if(iu(o)&&!n.customFormatTypes)return Y(E7(t)),Mp({...e,[r]:a},t,n,i)}}return Z(e)?w4(e,t,i):zle(e)}function zle(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Ke(n)?"quantitative":le(n)?"nominal":vu(n)?"temporal":void 0,{...e,type:t}}function w4(e,t,{compositeMark:n=!1}={}){const{aggregate:i,timeUnit:r,bin:s,field:o}=e,a={...e};if(!n&&i&&!Gx(i)&&!Qo(i)&&!Bs(i)&&(Y(zae(i)),delete a.aggregate),r&&(a.timeUnit=jt(r)),o&&(a.field=`${o}`),lt(s)&&(a.bin=g1(s,t)),Gt(s)&&!$t(t)&&Y(yue(t)),zn(a)){const{type:u}=a,l=jue(u);u!==l&&(a.type=l),u!=="quantitative"&&i1(i)&&(Y(Pae(u,i)),a.type="quantitative")}else if(!PF(t)){const u=Ple(a,t);a.type=u}if(zn(a)){const{compatible:u,warning:l}=Ble(a,t)||{};u===!1&&Y(l)}if(b4(a)&&le(a.sort)){const{sort:u}=a;if(M7(u))return{...a,sort:{encoding:u}};const l=u.substring(1);if(u.charAt(0)==="-"&&M7(l))return{...a,sort:{encoding:l,order:"descending"}}}if(v4(a)){const{header:u}=a;if(u){const{orient:l,...c}=u;if(l)return{...a,header:{...c,labelOrient:u.labelOrient||l,titleOrient:u.titleOrient||l}}}}return a}function g1(e,t){return Pl(e)?{maxbins:p7(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?{...e,maxbins:p7(t)}:e}const Du={compatible:!0};function Ble(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case $s:case Ms:case Jg:return Ap(e)?Du:{compatible:!1,warning:Hae(t)};case gt:case Wt:case Go:case Wl:case Kn:case Qr:case es:case kd:case Ad:case Qg:case Ja:case e1:case Gl:case pu:case Ri:case ar:case t1:return Du;case lr:case Ni:case ur:case cr:return n!==tu?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Du;case Zs:case Zo:case Xo:case Ko:case Ys:case Gs:case Ws:case or:case Jr:case Yo:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:Du;case Jn:case Jo:return!Ap(e)&&!Nle(e)?{compatible:!1,warning:qae(t)}:Du;case _l:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:Du}}function kl(e){const{formatType:t}=$p(e);return t==="time"||!t&&Ule(e)}function Ule(e){return e&&(e.type==="temporal"||Z(e)&&!!e.timeUnit)}function m1(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){var u;const s=t&&((u=jt(t))==null?void 0:u.unit);let o=s||n==="temporal",a;return Md(e)?a=e.expr:ue(e)?a=e.signal:vu(e)?(o=!0,a=eu(e)):(le(e)||Ke(e))&&o&&(a=`datetime(${tt(e)})`,Mue(s)&&(Ke(e)&&e<1e4||le(e)&&isNaN(Date.parse(e)))&&(a=eu({[s]:e}))),a?i&&o?`time(${a})`:a:r?void 0:tt(e)}function WL(e,t){const{type:n}=e;return t.map(i=>{const r=Z(e)&&!bu(e.timeUnit)?e.timeUnit:void 0,s=m1(i,{timeUnit:r,type:n,undefinedIfExprNotRequired:!0});return s!==void 0?{signal:s}:i})}function Rd(e,t){return lt(e.bin)?ns(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const L7={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function Od(e){return e==null?void 0:e.condition}const GL=["domain","grid","labels","ticks","title"],jle={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},YL={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},Hle={...YL,style:1,labelExpr:1,encoding:1};function N7(e){return pe(Hle,e)}const qle={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},ZL=W(qle);function Ks(e){return G(e,"mark")}class y1{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return Ks(t)?vle(t.mark)===this.name:!1}}function Ra(e,t){const n=e&&e[t];return n?V(n)?bl(n,i=>!!i.field):Z(n)||p1(n):!1}function XL(e,t){const n=e&&e[t];return n?V(n)?bl(n,i=>!!i.field):Z(n)||is(n)||Dd(n):!1}function KL(e,t){if($t(t)){const n=e[t];if((Z(n)||is(n))&&(yL(n.type)||Z(n)&&n.timeUnit)){const i=jx(t);return XL(e,i)}}return!1}function JL(e){return bl(zoe,t=>{if(Ra(e,t)){const n=e[t];if(V(n))return bl(n,i=>!!i.aggregate);{const i=ir(n);return i&&!!i.aggregate}}return!1})}function QL(e,t){const n=[],i=[],r=[],s=[],o={};return E4(e,(a,u)=>{if(Z(a)){const{field:l,aggregate:c,bin:f,timeUnit:d,...h}=a;if(c||d||f){const p=x4(a),g=p==null?void 0:p.title;let m=ee(a,{forAs:!0});const y={...g?[]:{title:Ku(a,t,{allowDisabling:!0})},...h,field:m};if(c){let v;if(Qo(c)?(v="argmax",m=ee({op:"argmax",field:c.argmax},{forAs:!0}),y.field=`${m}.${l}`):Bs(c)?(v="argmin",m=ee({op:"argmin",field:c.argmin},{forAs:!0}),y.field=`${m}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(v=c),v){const b={op:v,as:m};l&&(b.field=l),s.push(b)}}else if(n.push(m),zn(a)&&lt(f)){if(i.push({bin:f,field:l,as:m}),n.push(ee(a,{binSuffix:"end"})),Rd(a,u)&&n.push(ee(a,{binSuffix:"range"})),$t(u)){const v={field:`${m}_end`};o[`${u}2`]=v}y.bin="binned",PF(u)||(y.type=tu)}else if(d&&!bu(d)){r.push({timeUnit:d,field:l,as:m});const v=zn(a)&&a.type!==wl&&"time";v&&(u===kd||u===Ja?y.formatType=v:Xoe(u)?y.legend={formatType:v,...y.legend}:$t(u)&&(y.axis={formatType:v,...y.axis}))}o[u]=y}else n.push(l),o[u]=e[u]}else o[u]=e[u]}),{bins:i,timeUnits:r,aggregate:s,groupby:n,encoding:o}}function Vle(e,t,n){const i=Joe(t,n);if(i){if(i==="binned"){const r=e[t===or?gt:Wt];return!!(Z(r)&&Z(e[t])&&Gt(r.bin))}}else return!1;return!0}function Wle(e,t,n,i){const r={};for(const s of W(e))IF(s)||Y(jae(s));for(let s of Voe){if(!e[s])continue;const o=e[s];if($d(s)){const a=qoe(s),u=r[a];if(Z(u)&&Uue(u.type)&&Z(o)&&!u.timeUnit){Y(Oae(a));continue}}if(s==="angle"&&t==="arc"&&!e.theta&&(Y(Rae),s=Ri),!Vle(e,s,t)){Y(s1(s,t));continue}if(s===Ys&&t==="line"){const a=ir(e[s]);if(a!=null&&a.aggregate){Y(Uae);continue}}if(s===Kn&&(n?"fill"in e:"stroke"in e)){Y(tL("encoding",{fill:"fill"in e,stroke:"stroke"in e}));continue}if(s===Ad||s===_l&&!V(o)&&!nr(o)||s===Ja&&V(o)){if(o){if(s===_l){const a=e[s];if(zL(a)){r[s]=a;continue}}r[s]=ce(o).reduce((a,u)=>(Z(u)?a.push(w4(u,s)):Y(Pv(u,s)),a),[])}}else{if(s===Ja&&o===null)r[s]=null;else if(!Z(o)&&!is(o)&&!nr(o)&&!Nd(o)&&!ue(o)){Y(Pv(o,s));continue}r[s]=VL(o,s,i)}}return r}function v1(e,t){const n={};for(const i of W(e)){const r=VL(e[i],i,t,{compositeMark:!0});n[i]=r}return n}function Gle(e){const t=[];for(const n of W(e))if(Ra(e,n)){const i=e[n],r=ce(i);for(const s of r)Z(s)?t.push(s):p1(s)&&t.push(s.condition)}return t}function E4(e,t,n){if(e)for(const i of W(e)){const r=e[i];if(V(r))for(const s of r)t.call(n,s,i);else t.call(n,r,i)}}function Yle(e,t,n,i){return e?W(e).reduce((r,s)=>{const o=e[s];return V(o)?o.reduce((a,u)=>t.call(i,a,u,s),r):t.call(i,r,o,s)},n):n}function eN(e,t){return W(t).reduce((n,i)=>{switch(i){case gt:case Wt:case e1:case t1:case Gl:case or:case Jr:case Go:case Wl:case Ri:case Gs:case ar:case Ws:case Yo:case ur:case lr:case cr:case Ni:case kd:case Jn:case pu:case Ja:return n;case _l:if(e==="line"||e==="trail")return n;case Ad:case Qg:{const r=t[i];if(V(r)||Z(r))for(const s of ce(r))s.aggregate||n.push(ee(s,{}));return n}case Ys:if(e==="trail")return n;case Kn:case Qr:case es:case Zs:case Zo:case Xo:case Jo:case Ko:{const r=ir(t[i]);return r&&!r.aggregate&&n.push(ee(r,{})),n}}},[])}function Zle(e){const{tooltip:t,...n}=e;if(!t)return{filteredEncoding:n};let i,r;if(V(t)){for(const s of t)s.aggregate?(i||(i=[]),i.push(s)):(r||(r=[]),r.push(s));i&&(n.tooltip=i)}else t.aggregate?n.tooltip=t:r=t;return V(r)&&r.length===1&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n}}function jv(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};const r=e.map(({fieldPrefix:o,titlePrefix:a})=>{const u=i?` of ${C4(t)}`:"";return{field:o+t.field,type:t.type,title:ue(a)?{signal:`${a}"${escape(u)}"`}:a+u}}),s=Gle(n).map(Fle);return{tooltip:[...r,...Ar(s,De)]}}function C4(e){const{title:t,field:n}=e;return At(t,n)}function S4(e,t,n,i,r){const{scale:s,axis:o}=n;return({partName:a,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,extraEncoding:f={}})=>{const d=C4(n);return tN(e,a,r,{mark:u,encoding:{[t]:{field:`${l}_${n.field}`,type:n.type,...d!==void 0?{title:d}:{},...s!==void 0?{scale:s}:{},...o!==void 0?{axis:o}:{}},...le(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{},...i,...f}})}}function tN(e,t,n,i){const{clip:r,color:s,opacity:o}=e,a=e.type;return e[t]||e[t]===void 0&&n[t]?[{...i,mark:{...n[t],...r?{clip:r}:{},...s?{color:s}:{},...o?{opacity:o}:{},...qr(i.mark)?i.mark:{type:i.mark},style:`${a}-${String(t)}`,...Pl(e[t])?{}:e[t]}}]:[]}function nN(e,t,n){const{encoding:i}=e,r=t==="vertical"?"y":"x",s=i[r],o=i[`${r}2`],a=i[`${r}Error`],u=i[`${r}Error2`];return{continuousAxisChannelDef:Eh(s,n),continuousAxisChannelDef2:Eh(o,n),continuousAxisChannelDefError:Eh(a,n),continuousAxisChannelDefError2:Eh(u,n),continuousAxis:r}}function Eh(e,t){if(e!=null&&e.aggregate){const{aggregate:n,...i}=e;return n!==t&&Y(mue(n,t)),i}else return e}function iN(e,t){const{mark:n,encoding:i}=e,{x:r,y:s}=i;if(qr(n)&&n.orient)return n.orient;if(yo(r)){if(yo(s)){const o=Z(r)&&r.aggregate,a=Z(s)&&s.aggregate;if(!o&&a===t)return"vertical";if(!a&&o===t)return"horizontal";if(o===t&&a===t)throw new Error("Both x and y cannot have aggregate");return kl(s)&&!kl(r)?"horizontal":"vertical"}return"horizontal"}else{if(yo(s))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}const Tp="boxplot",Xle=["box","median","outliers","rule","ticks"],Kle=new y1(Tp,sN);function rN(e){return Ke(e)?"tukey":e}function sN(e,{config:t}){e={...e,encoding:v1(e.encoding,t)};const{mark:n,encoding:i,params:r,projection:s,...o}=e,a=qr(n)?n:{type:n};r&&Y(QF("boxplot"));const u=a.extent??t.boxplot.extent,l=Qe("size",a,t),c=a.invalid,f=rN(u),{bins:d,timeUnits:h,transform:p,continuousAxisChannelDef:g,continuousAxis:m,groupby:y,aggregate:v,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:_,customTooltipWithoutAggregatedField:E}=Jle(e,u,t),w=Vl(g.field),{color:S,size:$,...F}=b,T=ie=>S4(a,m,g,ie,t.boxplot),P=T(F),R=T(b),C=(_e(t.boxplot.box)?t.boxplot.box.color:t.mark.color)||"#4c78a8",A=T({...F,...$?{size:$}:{},color:{condition:{test:`${Ye(`lower_box_${g.field}`)} >= ${Ye(`upper_box_${g.field}`)}`,...S||{value:C}}}}),M=jv([{fieldPrefix:f==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:f==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],g,b),L={type:"tick",color:"black",opacity:1,orient:x,invalid:c,aria:!1},D=f==="min-max"?M:jv([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],g,b),O=[...P({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:D}),...P({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:D}),...P({partName:"ticks",mark:L,positionPrefix:"lower_whisker",extraEncoding:D}),...P({partName:"ticks",mark:L,positionPrefix:"upper_whisker",extraEncoding:D})],j=[...f!=="tukey"?O:[],...R({partName:"box",mark:{type:"bar",...l?{size:l}:{},orient:_,invalid:c,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:M}),...A({partName:"median",mark:{type:"tick",invalid:c,..._e(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},...l?{size:l}:{},orient:x,aria:!1},positionPrefix:"mid_box",extraEncoding:M})];if(f==="min-max")return{...o,transform:(o.transform??[]).concat(p),layer:j};const J=Ye(`lower_box_${g.field}`),K=Ye(`upper_box_${g.field}`),fe=`(${K} - ${J})`,we=`${J} - ${u} * ${fe}`,de=`${K} + ${u} * ${fe}`,Pe=Ye(g.field),dt={joinaggregate:oN(g.field),groupby:y},xt={transform:[{filter:`(${we} <= ${Pe}) && (${Pe} <= ${de})`},{aggregate:[{op:"min",field:g.field,as:`lower_whisker_${w}`},{op:"max",field:g.field,as:`upper_whisker_${w}`},{op:"min",field:`lower_box_${g.field}`,as:`lower_box_${w}`},{op:"max",field:`upper_box_${g.field}`,as:`upper_box_${w}`},...v],groupby:y}],layer:O},{tooltip:se,...Ee}=F,{scale:Te,axis:k}=g,N=C4(g),I=Yn(k,["title"]),H=tN(a,"outliers",t.boxplot,{transform:[{filter:`(${Pe} < ${we}) || (${Pe} > ${de})`}],mark:"point",encoding:{[m]:{field:g.field,type:g.type,...N!==void 0?{title:N}:{},...Te!==void 0?{scale:Te}:{},...et(I)?{}:{axis:I}},...Ee,...S?{color:S}:{},...E?{tooltip:E}:{}}})[0];let U;const q=[...d,...h,dt];return H?U={transform:q,layer:[H,xt]}:(U=xt,U.transform.unshift(...q)),{...o,layer:[U,{transform:p,layer:j}]}}function oN(e){const t=Vl(e);return[{op:"q1",field:e,as:`lower_box_${t}`},{op:"q3",field:e,as:`upper_box_${t}`}]}function Jle(e,t,n){const i=iN(e,Tp),{continuousAxisChannelDef:r,continuousAxis:s}=nN(e,i,Tp),o=r.field,a=Vl(o),u=rN(t),l=[...oN(o),{op:"median",field:o,as:`mid_box_${a}`},{op:"min",field:o,as:(u==="min-max"?"lower_whisker_":"min_")+a},{op:"max",field:o,as:(u==="min-max"?"upper_whisker_":"max_")+a}],c=u==="min-max"||u==="tukey"?[]:[{calculate:`${Ye(`upper_box_${a}`)} - ${Ye(`lower_box_${a}`)}`,as:`iqr_${a}`},{calculate:`min(${Ye(`upper_box_${a}`)} + ${Ye(`iqr_${a}`)} * ${t}, ${Ye(`max_${a}`)})`,as:`upper_whisker_${a}`},{calculate:`max(${Ye(`lower_box_${a}`)} - ${Ye(`iqr_${a}`)} * ${t}, ${Ye(`min_${a}`)})`,as:`lower_whisker_${a}`}],{[s]:f,...d}=e.encoding,{customTooltipWithoutAggregatedField:h,filteredEncoding:p}=Zle(d),{bins:g,timeUnits:m,aggregate:y,groupby:v,encoding:b}=QL(p,n),x=i==="vertical"?"horizontal":"vertical",_=i,E=[...g,...m,{aggregate:[...y,...l],groupby:v},...c];return{bins:g,timeUnits:m,transform:E,groupby:v,aggregate:y,continuousAxisChannelDef:r,continuousAxis:s,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:_,customTooltipWithoutAggregatedField:h}}const k4="errorbar",Qle=["ticks","rule"],ece=new y1(k4,aN);function aN(e,{config:t}){e={...e,encoding:v1(e.encoding,t)};const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,ticksOrient:o,markDef:a,outerSpec:u,tooltipEncoding:l}=uN(e,k4,t);delete s.size;const c=S4(a,r,i,s,t.errorbar),f=a.thickness,d=a.size,h={type:"tick",orient:o,aria:!1,...f!==void 0?{thickness:f}:{},...d!==void 0?{size:d}:{}},p=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:l}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...f!==void 0?{size:f}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return{...u,transform:n,...p.length>1?{layer:p}:{...p[0]}}}function tce(e,t){const{encoding:n}=e;if(nce(n))return{orient:iN(e,t),inputType:"raw"};const i=ice(n),r=rce(n),s=n.x,o=n.y;if(i){if(r)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const a=n.x2,u=n.y2;if(ke(a)&&ke(u))throw new Error(`${t} cannot have both x2 and y2`);if(ke(a)){if(yo(s))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(ke(u)){if(yo(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const a=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(ke(u)&&!ke(a))throw new Error(`${t} cannot have xError2 without xError`);if(ke(c)&&!ke(l))throw new Error(`${t} cannot have yError2 without yError`);if(ke(a)&&ke(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(ke(a)){if(yo(s))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(ke(l)){if(yo(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function nce(e){return(ke(e.x)||ke(e.y))&&!ke(e.x2)&&!ke(e.y2)&&!ke(e.xError)&&!ke(e.xError2)&&!ke(e.yError)&&!ke(e.yError2)}function ice(e){return ke(e.x2)||ke(e.y2)}function rce(e){return ke(e.xError)||ke(e.xError2)||ke(e.yError)||ke(e.yError2)}function uN(e,t,n){const{mark:i,encoding:r,params:s,projection:o,...a}=e,u=qr(i)?i:{type:i};s&&Y(QF(t));const{orient:l,inputType:c}=tce(e,t),{continuousAxisChannelDef:f,continuousAxisChannelDef2:d,continuousAxisChannelDefError:h,continuousAxisChannelDefError2:p,continuousAxis:g}=nN(e,l,t),{errorBarSpecificAggregate:m,postAggregateCalculates:y,tooltipSummary:v,tooltipTitleWithFieldName:b}=sce(u,f,d,h,p,c,t,n),{[g]:x,[g==="x"?"x2":"y2"]:_,[g==="x"?"xError":"yError"]:E,[g==="x"?"xError2":"yError2"]:w,...S}=r,{bins:$,timeUnits:F,aggregate:T,groupby:P,encoding:R}=QL(S,n),C=[...T,...m],A=c!=="raw"?[]:P,M=jv(v,f,R,b);return{transform:[...a.transform??[],...$,...F,...C.length===0?[]:[{aggregate:C,groupby:A}],...y],groupby:A,continuousAxisChannelDef:f,continuousAxis:g,encodingWithoutContinuousAxis:R,ticksOrient:l==="vertical"?"horizontal":"vertical",markDef:u,outerSpec:a,tooltipEncoding:M}}function sce(e,t,n,i,r,s,o,a){let u=[],l=[];const c=t.field;let f,d=!1;if(s==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":a.errorbar.center,p=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(p==="iqr")&&Y(gue(h,p,o)),p==="stderr"||p==="stdev")u=[{op:p,field:c,as:`extent_${c}`},{op:h,field:c,as:`center_${c}`}],l=[{calculate:`${Ye(`center_${c}`)} + ${Ye(`extent_${c}`)}`,as:`upper_${c}`},{calculate:`${Ye(`center_${c}`)} - ${Ye(`extent_${c}`)}`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:Sd(h)},{fieldPrefix:"upper_",titlePrefix:D7(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:D7(h,p,"-")}],d=!0;else{let g,m,y;p==="ci"?(g="mean",m="ci0",y="ci1"):(g="median",m="q1",y="q3"),u=[{op:m,field:c,as:`lower_${c}`},{op:y,field:c,as:`upper_${c}`},{op:g,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:Ku({field:c,aggregate:y,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Ku({field:c,aggregate:m,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Ku({field:c,aggregate:g,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&Y(pue(e.center,e.extent)),s==="aggregated-upper-lower"?(f=[],l=[{calculate:Ye(n.field),as:`upper_${c}`},{calculate:Ye(c),as:`lower_${c}`}]):s==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`${Ye(c)} + ${Ye(i.field)}`,as:`upper_${c}`}],r?l.push({calculate:`${Ye(c)} + ${Ye(r.field)}`,as:`lower_${c}`}):l.push({calculate:`${Ye(c)} - ${Ye(i.field)}`,as:`lower_${c}`}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:Ka(Ka(h.calculate,"datum['",""),"']","")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function D7(e,t,n){return`${Sd(e)} ${n} ${t}`}const A4="errorband",oce=["band","borders"],ace=new y1(A4,lN);function lN(e,{config:t}){e={...e,encoding:v1(e.encoding,t)};const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,markDef:o,outerSpec:a,tooltipEncoding:u}=uN(e,A4,t),l=o,c=S4(l,r,i,s,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const p={...l.interpolate?{interpolate:l.interpolate}:{},...l.tension&&l.interpolate?{tension:l.tension}:{}};return f?(d={...d,...p,ariaRoleDescription:"errorband"},h={...h,...p,aria:!1}):l.interpolate?Y(S7("interpolate")):l.tension&&Y(S7("tension")),{...a,transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:u})]}}const cN={};function $4(e,t,n){const i=new y1(e,t);cN[e]={normalizer:i,parts:n}}function uce(){return W(cN)}$4(Tp,sN,Xle);$4(k4,aN,Qle);$4(A4,lN,oce);const lce=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],fN={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},dN={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},cce=W(fN),fce=W(dN),dce={header:1,headerRow:1,headerColumn:1,headerFacet:1},hN=W(dce),pN=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],hce={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},pce={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},rr="_vgsid_",gce={point:{on:"click",fields:[rr],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[pointerdown, window:pointerup] > window:pointermove!",encodings:["x","y"],translate:"[pointerdown, window:pointerup] > window:pointermove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function M4(e){return e==="legend"||!!(e!=null&&e.legend)}function cy(e){return M4(e)&&_e(e)}function T4(e){return!!(e!=null&&e.select)}function gN(e){const t=[];for(const n of e||[]){if(T4(n))continue;const{expr:i,bind:r,...s}=n;if(r&&i){const o={...s,bind:r,init:i};t.push(o)}else{const o={...s,...i?{update:i}:{},...r?{bind:r}:{}};t.push(o)}}return t}function mce(e){return b1(e)||L4(e)||F4(e)}function F4(e){return G(e,"concat")}function b1(e){return G(e,"vconcat")}function L4(e){return G(e,"hconcat")}function mN({step:e,offsetIsDiscrete:t}){return t?e.for??"offset":"position"}function Vr(e){return G(e,"step")}function R7(e){return G(e,"view")||G(e,"width")||G(e,"height")}const O7=20,yce={align:1,bounds:1,center:1,columns:1,spacing:1},vce=W(yce);function bce(e,t,n){const i=n[t],r={},{spacing:s,columns:o}=i;s!==void 0&&(r.spacing=s),o!==void 0&&(h1(e)&&!Ld(e.facet)||F4(e))&&(r.columns=o),b1(e)&&(r.columns=1);for(const a of vce)if(e[a]!==void 0)if(a==="spacing"){const u=e[a];r[a]=Ke(u)?u:{row:u.row??s,column:u.column??s}}else r[a]=e[a];return r}function Hv(e,t){return e[t]??e[t==="width"?"continuousWidth":"continuousHeight"]}function qv(e,t){const n=Fp(e,t);return Vr(n)?n.step:yN}function Fp(e,t){const n=e[t]??e[t==="width"?"discreteWidth":"discreteHeight"];return At(n,{step:e.step})}const yN=20,xce={continuousWidth:200,continuousHeight:200,step:yN},_ce={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:xce,mark:dle,arc:{},area:{},bar:mle,circle:{},geoshape:{},image:{},line:{},point:{},rect:h4,rule:{color:"black"},square:{},text:{color:"black"},tick:yle,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:Gue,projection:{},legend:hce,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:gce,style:{},title:{},facet:{spacing:O7},concat:{spacing:O7},normalizedNumberFormat:".0%"},cs=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],I7={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},P7={blue:cs[0],orange:cs[1],red:cs[2],teal:cs[3],green:cs[4],yellow:cs[5],purple:cs[6],pink:cs[7],brown:cs[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function wce(e={}){return{signals:[{name:"color",value:_e(e)?{...P7,...e}:P7}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function Ece(e){return{signals:[{name:"fontSize",value:_e(e)?{...I7,...e}:I7}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function Cce(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function vN(e){const t=W(e||{}),n={};for(const i of t){const r=e[i];n[i]=Od(r)?WF(r):oi(r)}return n}function Sce(e){const t=W(e),n={};for(const i of t)n[i]=vN(e[i]);return n}const kce=[...AL,...ZL,...hN,"background","padding","legend","lineBreak","scale","style","title","view"];function bN(e={}){const{color:t,font:n,fontSize:i,selection:r,...s}=e,o=cA({},Ce(_ce),n?Cce(n):{},t?wce(t):{},i?Ece(i):{},s||{});r&&Eg(o,"selection",r,!0);const a=Yn(o,kce);for(const u of["background","lineBreak","padding"])o[u]&&(a[u]=oi(o[u]));for(const u of AL)o[u]&&(a[u]=Yt(o[u]));for(const u of ZL)o[u]&&(a[u]=vN(o[u]));for(const u of hN)o[u]&&(a[u]=Yt(o[u]));if(o.legend&&(a.legend=Yt(o.legend)),o.scale){const{invalid:u,...l}=o.scale,c=Yt(u,{level:1});a.scale={...Yt(l),...W(c).length>0?{invalid:c}:{}}}return o.style&&(a.style=Sce(o.style)),o.title&&(a.title=Yt(o.title)),o.view&&(a.view=Yt(o.view)),a}const Ace=new Set(["view",...ole]),$ce=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],Mce={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],...fle};function Tce(e){e=Ce(e);for(const t of $ce)delete e[t];if(e.axis)for(const t in e.axis)Od(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of lce)delete e.legend[t];if(e.mark){for(const t of A7)delete e.mark[t];e.mark.tooltip&&_e(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(gN(e.params)),delete e.params);for(const t of Ace){for(const i of A7)delete e[t][i];const n=Mce[t];if(n)for(const i of n)delete e[t][i];Lce(e,t)}for(const t of uce())delete e[t];Fce(e);for(const t in e)_e(e[t])&&et(e[t])&&delete e[t];return et(e)?void 0:e}function Fce(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=VF(e.title);et(t)||(e.style["group-title"]={...e.style["group-title"],...t}),et(n)||(e.style["group-subtitle"]={...e.style["group-subtitle"],...n}),et(i)?delete e.title:e.title=i}function Lce(e,t,n,i){const r=e[t];t==="view"&&(n="cell");const s={...r,...e.style[n??t]};et(s)||(e.style[n??t]=s),delete e[t]}function x1(e){return G(e,"layer")}function Nce(e){return G(e,"repeat")}function Dce(e){return!V(e.repeat)&&G(e.repeat,"layer")}class N4{map(t,n){return h1(t)?this.mapFacet(t,n):Nce(t)?this.mapRepeat(t,n):L4(t)?this.mapHConcat(t,n):b1(t)?this.mapVConcat(t,n):F4(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(x1(t))return this.mapLayer(t,n);if(Ks(t))return this.mapUnit(t,n);throw new Error(Yx(t))}mapLayer(t,n){return{...t,layer:t.layer.map(i=>this.mapLayerOrUnit(i,n))}}mapHConcat(t,n){return{...t,hconcat:t.hconcat.map(i=>this.map(i,n))}}mapVConcat(t,n){return{...t,vconcat:t.vconcat.map(i=>this.map(i,n))}}mapConcat(t,n){const{concat:i,...r}=t;return{...r,concat:i.map(s=>this.map(s,n))}}mapFacet(t,n){return{...t,spec:this.map(t.spec,n)}}mapRepeat(t,n){return{...t,spec:this.map(t.spec,n)}}}const Rce={zero:1,center:1,normalize:1};function Oce(e){return pe(Rce,e)}const Ice=new Set([CL,l1,u1,Cp,f1,f4,d4,c1,SL,c4]),Pce=new Set([l1,u1,CL]);function Ru(e){return Z(e)&&Cl(e)==="quantitative"&&!e.bin}function z7(e,t,{orient:n,type:i}){const r=t==="x"?"y":"radius",s=t==="x"&&["bar","area"].includes(i),o=e[t],a=e[r];if(Z(o)&&Z(a))if(Ru(o)&&Ru(a)){if(o.stack)return t;if(a.stack)return r;const u=Z(o)&&!!o.aggregate,l=Z(a)&&!!a.aggregate;if(u!==l)return u?t:r;if(s){if(n==="vertical")return r;if(n==="horizontal")return t}}else{if(Ru(o))return t;if(Ru(a))return r}else{if(Ru(o))return s&&n==="vertical"?void 0:t;if(Ru(a))return s&&n==="horizontal"?void 0:r}}function zce(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function xN(e,t){var g,m;const n=qr(e)?e:{type:e},i=n.type;if(!Ice.has(i))return null;const r=z7(t,"x",n)||z7(t,"theta",n);if(!r)return null;const s=t[r],o=Z(s)?ee(s,{}):void 0,a=zce(r),u=[],l=new Set;if(t[a]){const y=t[a],v=Z(y)?ee(y,{}):void 0;v&&v!==o&&(u.push(a),l.add(v))}const c=a==="x"?"xOffset":"yOffset",f=t[c],d=Z(f)?ee(f,{}):void 0;d&&d!==o&&(u.push(c),l.add(d));const h=Woe.reduce((y,v)=>{if(v!=="tooltip"&&Ra(t,v)){const b=t[v];for(const x of ce(b)){const _=ir(x);if(_.aggregate)continue;const E=ee(_,{});(!E||!l.has(E))&&y.push({channel:v,fieldDef:_})}}return y},[]);let p;return s.stack!==void 0?Pl(s.stack)?p=s.stack?"zero":null:p=s.stack:Pce.has(i)&&(p="zero"),!p||!Oce(p)||JL(t)&&h.length===0?null:((g=s==null?void 0:s.scale)!=null&&g.type&&((m=s==null?void 0:s.scale)==null?void 0:m.type)!==Zt.LINEAR&&s!=null&&s.stack&&Y(fue(s.scale.type)),ke(t[ts(r)])?(s.stack!==void 0&&Y(cue(r)),null):(Z(s)&&s.aggregate&&!sae.has(s.aggregate)&&Y(due(s.aggregate)),{groupbyChannels:u,groupbyFields:l,fieldChannel:r,impute:s.impute===null?!1:ea(i),stackBy:h,offset:p}))}function _N(e,t,n){const i=Yt(e),r=Qe("orient",i,n);if(i.orient=Hce(i.type,t,r),r!==void 0&&r!==i.orient&&Y(Yae(i.orient,r)),i.type==="bar"&&i.orient){const u=Qe("cornerRadiusEnd",i,n);if(u!==void 0){const l=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:ple[i.orient];for(const c of l)i[c]=u;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}const s=Qe("opacity",i,n),o=Qe("fillOpacity",i,n);return s===void 0&&o===void 0&&(i.opacity=Uce(i.type,t)),Qe("cursor",i,n)===void 0&&(i.cursor=Bce(i,t,n)),i}function Bce(e,t,n){return t.href||e.href||Qe("href",e,n)?"pointer":e.cursor}function Uce(e,t){if(Ne([f1,c4,f4,d4],e)&&!JL(t))return .7}function jce(e,t,{graticule:n}){if(n)return!1;const i=Hr("filled",e,t),r=e.type;return At(i,r!==f1&&r!==c1&&r!==Cp)}function Hce(e,t,n){switch(e){case f1:case f4:case d4:case SL:case rle:case ile:return}const{x:i,y:r,x2:s,y2:o}=t;switch(e){case l1:if(Z(i)&&(Gt(i.bin)||Z(r)&&r.aggregate&&!i.aggregate))return"vertical";if(Z(r)&&(Gt(r.bin)||Z(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(o||s){if(n)return n;if(!s)return(Z(i)&&i.type===tu&&!lt(i.bin)||kp(i))&&Z(r)&&Gt(r.bin)?"horizontal":"vertical";if(!o)return(Z(r)&&r.type===tu&&!lt(r.bin)||kp(r))&&Z(i)&&Gt(i.bin)?"vertical":"horizontal"}case Cp:if(s&&!(Z(i)&&Gt(i.bin))&&o&&!(Z(r)&&Gt(r.bin)))return;case u1:if(o)return Z(r)&&Gt(r.bin)?"horizontal":"vertical";if(s)return Z(i)&&Gt(i.bin)?"vertical":"horizontal";if(e===Cp){if(i&&!r)return"vertical";if(r&&!i)return"horizontal"}case c1:case c4:{const a=F7(i),u=F7(r);if(n)return n;if(a&&!u)return e!=="tick"?"horizontal":"vertical";if(!a&&u)return e!=="tick"?"vertical":"horizontal";if(a&&u)return"vertical";{const l=zn(i)&&i.type===wl,c=zn(r)&&r.type===wl;if(l&&!c)return"vertical";if(!l&&c)return"horizontal"}return}}return"vertical"}function qce(e){const{point:t,line:n,...i}=e;return W(i).length>1?i:i.type}function Vce(e){for(const t of["line","area","rule","trail"])e[t]&&(e={...e,[t]:Yn(e[t],["point","line"])});return e}function fy(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?_e(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?_e(t.point)?t.point:{}:void 0}function B7(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class Wce{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(Ks(t)){const{mark:i,encoding:r}=t,s=qr(i)?i:{type:i};switch(s.type){case"line":case"rule":case"trail":return!!fy(s,n[s.type],r);case"area":return!!fy(s,n[s.type],r)||!!B7(s,n[s.type])}}return!1}run(t,n,i){const{config:r}=n,{params:s,projection:o,mark:a,name:u,encoding:l,...c}=t,f=v1(l,r),d=qr(a)?a:{type:a},h=fy(d,r[d.type],f),p=d.type==="area"&&B7(d,r[d.type]),g=[{name:u,...s?{params:s}:{},mark:qce({...d.type==="area"&&d.opacity===void 0&&d.fillOpacity===void 0?{opacity:.7}:{},...d}),encoding:Yn(f,["shape"])}],m=xN(_N(d,f,r),f);let y=f;if(m){const{fieldChannel:v,offset:b}=m;y={...f,[v]:{...f[v],...b?{stack:b}:{}}}}return y=Yn(y,["y2","x2"]),p&&g.push({...o?{projection:o}:{},mark:{type:"line",...vl(d,["clip","interpolate","tension","tooltip"]),...p},encoding:y}),h&&g.push({...o?{projection:o}:{},mark:{type:"point",opacity:1,filled:!0,...vl(d,["clip","tooltip"]),...h},encoding:y}),i({...c,layer:g},{...n,config:Vce(r)})}}function Gce(e,t){return t?Ld(e)?EN(e,t):wN(e,t):e}function dy(e,t){return t?EN(e,t):e}function Vv(e,t,n){const i=t[e];if(Mle(i)){if(i.repeat in n)return{...t,[e]:n[i.repeat]};Y(Sae(i.repeat));return}return t}function wN(e,t){if(e=Vv("field",e,t),e!==void 0){if(e===null)return null;if(b4(e)&&Ts(e.sort)){const n=Vv("field",e.sort,t);e={...e,...n?{sort:n}:{}}}return e}}function U7(e,t){if(Z(e))return wN(e,t);{const n=Vv("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function j7(e,t){if(ke(e)){const n=U7(e,t);if(n)return n;if(Nd(e))return{condition:e.condition}}else{if(Dd(e)){const n=U7(e.condition,t);if(n)return{...e,condition:n};{const{condition:i,...r}=e;return r}}return e}}function EN(e,t){const n={};for(const i in e)if(G(e,i)){const r=e[i];if(V(r))n[i]=r.map(s=>j7(s,t)).filter(s=>s);else{const s=j7(r,t);s!==void 0&&(n[i]=s)}}return n}class Yce{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(Ks(t)){const{encoding:n,mark:i}=t;if(i==="line"||qr(i)&&i.type==="line")for(const r of Hoe){const s=gu(r),o=n[s];if(n[r]&&(Z(o)&&!Gt(o.bin)||is(o)))return!0}}return!1}run(t,n,i){const{encoding:r,mark:s}=t;return Y(Gae(!!r.x2,!!r.y2)),i({...t,mark:_e(s)?{...s,type:"rule"}:"rule"},n)}}class Zce extends N4{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[Kle,ece,ace,new Wce,new Yce]}map(t,n){if(Ks(t)){const i=Ra(t.encoding,$s),r=Ra(t.encoding,Ms),s=Ra(t.encoding,Jg);if(i||r||s)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:i,parentProjection:r}=n,s=dy(t.encoding,n.repeater),o={...t,...t.name?{name:[n.repeaterPrefix,t.name].filter(u=>u).join("_")}:{},...s?{encoding:s}:{}};if(i||r)return this.mapUnitWithParentEncodingOrProjection(o,n);const a=this.mapLayerOrUnit.bind(this);for(const u of this.nonFacetUnitNormalizers)if(u.hasMatchingType(o,n.config))return u.run(o,n,a);return o}mapRepeat(t,n){return Dce(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:i,spec:r,...s}=t,{row:o,column:a,layer:u}=i,{repeater:l={},repeaterPrefix:c=""}=n;return o||a?this.mapRepeat({...t,repeat:{...o?{row:o}:{},...a?{column:a}:{}},spec:{repeat:{layer:u},spec:r}},n):{...s,layer:u.map(f=>{const d={...l,layer:f},h=`${(r.name?`${r.name}_`:"")+c}child__layer_${pt(f)}`,p=this.mapLayerOrUnit(r,{...n,repeater:d,repeaterPrefix:h});return p.name=h,p})}}mapNonLayerRepeat(t,n){const{repeat:i,spec:r,data:s,...o}=t;!V(i)&&t.columns&&(t=Yn(t,["columns"]),Y(_7("repeat")));const a=[],{repeater:u={},repeaterPrefix:l=""}=n,c=!V(i)&&i.row||[u?u.row:null],f=!V(i)&&i.column||[u?u.column:null],d=V(i)&&i||[u?u.repeat:null];for(const p of d)for(const g of c)for(const m of f){const y={repeat:p,row:g,column:m,layer:u.layer},v=(r.name?`${r.name}_`:"")+l+"child__"+(V(i)?`${pt(p)}`:(i.row?`row_${pt(g)}`:"")+(i.column?`column_${pt(m)}`:"")),b=this.map(r,{...n,repeater:y,repeaterPrefix:v});b.name=v,a.push(Yn(b,["data"]))}const h=V(i)?t.columns:i.column?i.column.length:1;return{data:r.data??s,align:"all",...o,columns:h,concat:a}}mapFacet(t,n){const{facet:i}=t;return Ld(i)&&t.columns&&(t=Yn(t,["columns"]),Y(_7("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:i,projection:r}=t,{parentEncoding:s,parentProjection:o,config:a}=n,u=q7({parentProjection:o,projection:r}),l=H7({parentEncoding:s,encoding:dy(i,n.repeater)});return this.mapUnit({...t,...u?{projection:u}:{},...l?{encoding:l}:{}},{config:a})}mapFacetedUnit(t,n){const{row:i,column:r,facet:s,...o}=t.encoding,{mark:a,width:u,projection:l,height:c,view:f,params:d,encoding:h,...p}=t,{facetMapping:g,layout:m}=this.getFacetMappingAndLayout({row:i,column:r,facet:s},n),y=dy(o,n.repeater);return this.mapFacet({...p,...m,facet:g,spec:{...u?{width:u}:{},...c?{height:c}:{},...f?{view:f}:{},...l?{projection:l}:{},mark:a,encoding:y,...d?{params:d}:{}}},n)}getFacetMappingAndLayout(t,n){const{row:i,column:r,facet:s}=t;if(i||r){s&&Y(Vae([...i?[$s]:[],...r?[Ms]:[]]));const o={},a={};for(const u of[$s,Ms]){const l=t[u];if(l){const{align:c,center:f,spacing:d,columns:h,...p}=l;o[u]=p;for(const g of["align","center","spacing"])l[g]!==void 0&&(a[g]??(a[g]={}),a[g][u]=l[g])}}return{facetMapping:o,layout:a}}else{const{align:o,center:a,spacing:u,columns:l,...c}=s;return{facetMapping:Gce(c,n.repeater),layout:{...o?{align:o}:{},...a?{center:a}:{},...u?{spacing:u}:{},...l?{columns:l}:{}}}}}mapLayer(t,{parentEncoding:n,parentProjection:i,...r}){const{encoding:s,projection:o,...a}=t,u={...r,parentEncoding:H7({parentEncoding:n,encoding:s,layer:!0}),parentProjection:q7({parentProjection:i,projection:o})};return super.mapLayer({...a,...t.name?{name:[u.repeaterPrefix,t.name].filter(l=>l).join("_")}:{}},u)}}function H7({parentEncoding:e,encoding:t={},layer:n}){let i={};if(e){const r=new Set([...W(e),...W(t)]);for(const s of r){const o=t[s],a=e[s];if(ke(o)){const u={...a,...o};i[s]=u}else Dd(o)?i[s]={...o,condition:{...a,...o.condition}}:o||o===null?i[s]=o:(n||nr(a)||ue(a)||ke(a)||V(a))&&(i[s]=a)}}else i=t;return!i||et(i)?void 0:i}function q7(e){const{parentProjection:t,projection:n}=e;return t&&n&&Y(Dae({parentProjection:t,projection:n})),n??t}function D4(e){return G(e,"filter")}function Xce(e){return G(e,"stop")}function CN(e){return G(e,"lookup")}function Kce(e){return G(e,"data")}function Jce(e){return G(e,"param")}function Qce(e){return G(e,"pivot")}function efe(e){return G(e,"density")}function tfe(e){return G(e,"quantile")}function nfe(e){return G(e,"regression")}function ife(e){return G(e,"loess")}function rfe(e){return G(e,"sample")}function sfe(e){return G(e,"window")}function ofe(e){return G(e,"joinaggregate")}function afe(e){return G(e,"flatten")}function ufe(e){return G(e,"calculate")}function SN(e){return G(e,"bin")}function lfe(e){return G(e,"impute")}function cfe(e){return G(e,"timeUnit")}function ffe(e){return G(e,"aggregate")}function dfe(e){return G(e,"stack")}function hfe(e){return G(e,"fold")}function pfe(e){return G(e,"extent")&&!G(e,"density")&&!G(e,"regression")}function gfe(e){return e.map(t=>D4(t)?{filter:Zu(t.filter,Bue)}:t)}class mfe extends N4{map(t,n){return n.emptySelections??(n.emptySelections={}),n.selectionPredicates??(n.selectionPredicates={}),t=V7(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=V7(t,n),t.encoding){const i={};for(const[r,s]of No(t.encoding))i[r]=kN(s,n);t={...t,encoding:i}}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const{selection:i,...r}=t;return i?{...r,params:No(i).map(([s,o])=>{const{init:a,bind:u,empty:l,...c}=o;c.type==="single"?(c.type="point",c.toggle=!1):c.type==="multi"&&(c.type="point"),n.emptySelections[s]=l!=="none";for(const f of Qt(n.selectionPredicates[s]??{}))f.empty=l!=="none";return{name:s,value:a,select:c,bind:u}})}:t}}function V7(e,t){const{transform:n,...i}=e;if(n){const r=n.map(s=>{if(D4(s))return{filter:Wv(s,t)};if(SN(s)&&mu(s.bin))return{...s,bin:AN(s.bin)};if(CN(s)){const{selection:o,...a}=s.from;return o?{...s,from:{param:o,...a}}:s}return s});return{...i,transform:r}}return e}function kN(e,t){var i,r;const n=Ce(e);if(Z(n)&&mu(n.bin)&&(n.bin=AN(n.bin)),xu(n)&&((r=(i=n.scale)==null?void 0:i.domain)!=null&&r.selection)){const{selection:s,...o}=n.scale.domain;n.scale.domain={...o,...s?{param:s}:{}}}if(Nd(n))if(V(n.condition))n.condition=n.condition.map(s=>{const{selection:o,param:a,test:u,...l}=s;return a?s:{...l,test:Wv(s,t)}});else{const{selection:s,param:o,test:a,...u}=kN(n.condition,t);n.condition=o?n.condition:{...u,test:Wv(n.condition,t)}}return n}function AN(e){const t=e.extent;if(t!=null&&t.selection){const{selection:n,...i}=t;return{...e,extent:{...i,param:n}}}return e}function Wv(e,t){const n=i=>Zu(i,r=>{var s;const o=t.emptySelections[r]??!0,a={param:r,empty:o};return(s=t.selectionPredicates)[r]??(s[r]=[]),t.selectionPredicates[r].push(a),a});return e.selection?n(e.selection):Zu(e.test||e.filter,i=>i.selection?n(i.selection):i)}class Gv extends N4{map(t,n){const i=n.selections??[];if(t.params&&!Ks(t)){const r=[];for(const s of t.params)T4(s)?i.push(s):r.push(s);t.params=r}return n.selections=i,super.map(t,n)}mapUnit(t,n){const i=n.selections;if(!i||!i.length)return t;const r=(n.path??[]).concat(t.name),s=[];for(const o of i)if(!o.views||!o.views.length)s.push(o);else for(const a of o.views)(le(a)&&(a===t.name||r.includes(a))||V(a)&&a.map(u=>r.indexOf(u)).every((u,l,c)=>u!==-1&&(l===0||u>c[l-1])))&&s.push(o);return s.length&&(t.params=s),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=Gv.prototype[e];Gv.prototype[e]=function(n,i){return t.call(this,n,yfe(n,i))}}function yfe(e,t){return e.name?{...t,path:(t.path??[]).concat(e.name)}:t}function $N(e,t){t===void 0&&(t=bN(e.config));const n=_fe(e,t),{width:i,height:r}=e,s=wfe(n,{width:i,height:r,autosize:e.autosize},t);return{...n,...s?{autosize:s}:{}}}const vfe=new Zce,bfe=new mfe,xfe=new Gv;function _fe(e,t={}){const n={config:t};return xfe.map(vfe.map(bfe.map(e,n),n),n)}function W7(e){return le(e)?{type:e}:e??{}}function wfe(e,t,n){let{width:i,height:r}=t;const s=Ks(e)||x1(e),o={};s?i=="container"&&r=="container"?(o.type="fit",o.contains="padding"):i=="container"?(o.type="fit-x",o.contains="padding"):r=="container"&&(o.type="fit-y",o.contains="padding"):(i=="container"&&(Y(y7("width")),i=void 0),r=="container"&&(Y(y7("height")),r=void 0));const a={type:"pad",...o,...n?W7(n.autosize):{},...W7(e.autosize)};if(a.type==="fit"&&!s&&(Y(pae),a.type="pad"),i=="container"&&!(a.type=="fit"||a.type=="fit-x")&&Y(v7("width")),r=="container"&&!(a.type=="fit"||a.type=="fit-y")&&Y(v7("height")),!ci(a,{type:"pad"}))return a}function Efe(e){return["fit","fit-x","fit-y"].includes(e)}function Cfe(e){return e?`fit-${n1(e)}`:"fit"}const Sfe=["background","padding"];function G7(e,t){const n={};for(const i of Sfe)e&&e[i]!==void 0&&(n[i]=oi(e[i]));return t&&(n.params=e.params),n}class Js{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new Js(Ce(this.explicit),Ce(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(t){return At(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:i}){n!==void 0&&this.set(t,n,i)}set(t,n,i){return delete this[i?"implicit":"explicit"][t],this[i?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:i}){n[t]!==void 0?this.set(t,n[t],!0):i[t]!==void 0&&this.set(t,i[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of W(t.combine())){const i=t.getWithExplicit(n);this.setWithExplicit(n,i)}}}function _r(e){return{explicit:!0,value:e}}function ii(e){return{explicit:!1,value:e}}function MN(e){return(t,n,i,r)=>{const s=e(t.value,n.value);return s>0?t:s<0?n:_1(t,n,i,r)}}function _1(e,t,n,i){return e.explicit&&t.explicit&&Y(iue(n,i,e.value,t.value)),e}function Oo(e,t,n,i,r=_1){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:ci(e.value,t.value)?e:r(e,t,n,i)}class kfe extends Js{constructor(t={},n={},i=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=i}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function Al(e){return G(e,"url")}function Vf(e){return G(e,"values")}function TN(e){return G(e,"name")&&!Al(e)&&!Vf(e)&&!Eo(e)}function Eo(e){return e&&(FN(e)||LN(e)||R4(e))}function FN(e){return G(e,"sequence")}function LN(e){return G(e,"sphere")}function R4(e){return G(e,"graticule")}var vt;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup",e[e.PreFilterInvalid=5]="PreFilterInvalid",e[e.PostFilterInvalid=6]="PostFilterInvalid"})(vt||(vt={}));function NN({invalid:e,isPath:t}){switch($L(e,{isPath:t})){case"filter":return{marks:"exclude-invalid-values",scales:"exclude-invalid-values"};case"break-paths-show-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"include-invalid-values"};case"break-paths-filter-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"exclude-invalid-values"};case"show":return{marks:"include-invalid-values",scales:"include-invalid-values"}}}function Afe(e){const{marks:t,scales:n}=NN(e);return t===n?vt.Main:n==="include-invalid-values"?vt.PreFilterInvalid:vt.PostFilterInvalid}class Je{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){Y(Fae);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this);const i=t.parent.removeChild(t);this._parent=n,n.addChild(this,i),t.parent=this}}class Zn extends Je{clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}constructor(t,n,i,r){super(t,n),this.type=i,this.refCounts=r,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${MF()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}function hy(e){return e.as!==void 0}function Y7(e){return`${e}_end`}class Nr extends Je{clone(){return new Nr(null,Ce(this.timeUnits))}constructor(t,n){super(t),this.timeUnits=n}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s,o)=>{const{field:a,timeUnit:u}=s;if(u){let l;if(bu(u)){if(yt(n)){const{mark:c,markDef:f,config:d}=n,h=Ro({fieldDef:s,markDef:f,config:d});(qf(c)||h)&&(l={timeUnit:jt(u),field:a})}}else l={as:ee(s,{forAs:!0}),field:a,timeUnit:u};if(yt(n)){const{mark:c,markDef:f,config:d}=n,h=Ro({fieldDef:s,markDef:f,config:d});qf(c)&&$t(o)&&h!==.5&&(l.rectBandPosition=h)}l&&(r[De(l)]=l)}return r},{});return et(i)?null:new Nr(t,i)}static makeFromTransform(t,n){const{timeUnit:i,...r}={...n},s=jt(i),o={...r,timeUnit:s};return new Nr(t,{[De(o)]:o})}merge(t){this.timeUnits={...this.timeUnits};for(const n in t.timeUnits)this.timeUnits[n]||(this.timeUnits[n]=t.timeUnits[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[i,r]of No(this.timeUnits)){const s=hy(r)?r.as:`${r.field}_end`;t.has(s)||(n[i]=r)}this.timeUnits=n}producedFields(){return new Set(Qt(this.timeUnits).map(t=>hy(t)?t.as:Y7(t.field)))}dependentFields(){return new Set(Qt(this.timeUnits).map(t=>t.field))}hash(){return`TimeUnit ${De(this.timeUnits)}`}assemble(){const t=[];for(const n of Qt(this.timeUnits)){const{rectBandPosition:i}=n,r=jt(n.timeUnit);if(hy(n)){const{field:s,as:o}=n,{unit:a,utc:u,...l}=r,c=[o,`${o}_end`];t.push({field:Li(s),type:"timeunit",...a?{units:o1(a)}:{},...u?{timezone:"utc"}:{},...l,as:c}),t.push(...Z7(c,i,r))}else if(n){const{field:s}=n,o=s.replaceAll("\\.","."),a=DN({timeUnit:r,field:o}),u=Y7(o);t.push({type:"formula",expr:a,as:u}),t.push(...Z7([o,u],i,r))}}return t}}const w1="offsetted_rect_start",E1="offsetted_rect_end";function DN({timeUnit:e,field:t,reverse:n}){const{unit:i,utc:r}=e,s=cL(i),{part:o,step:a}=pL(s,e.step);return`${r?"utcOffset":"timeOffset"}('${o}', ${Ye(t)}, ${n?-a:a})`}function Z7([e,t],n,i){if(n!==void 0&&n!==.5){const r=Ye(e),s=Ye(t);return[{type:"formula",expr:X7([DN({timeUnit:i,field:e,reverse:!0}),r],n+.5),as:`${e}_${w1}`},{type:"formula",expr:X7([r,s],n+.5),as:`${e}_${E1}`}]}return[]}function X7([e,t],n){return`${1-n} * ${e} + ${n} * ${t}`}const Id="_tuple_fields";class $fe{constructor(...t){this.items=t,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const Mfe={defined:()=>!0,parse:(e,t,n)=>{const i=t.name,r=t.project??(t.project=new $fe),s={},o={},a=new Set,u=(p,g)=>{const m=g==="visual"?p.channel:p.field;let y=pt(`${i}_${m}`);for(let v=1;a.has(y);v++)y=pt(`${i}_${m}_${v}`);return a.add(y),{[g]:y}},l=t.type,c=e.config.selection[l],f=n.value!==void 0?ce(n.value):null;let{fields:d,encodings:h}=_e(n.select)?n.select:{};if(!d&&!h&&f){for(const p of f)if(_e(p))for(const g of W(p))joe(g)?(h||(h=[])).push(g):l==="interval"?(Y(Cae),h=c.encodings):(d??(d=[])).push(g)}!d&&!h&&(h=c.encodings,"fields"in c&&(d=c.fields));for(const p of h??[]){const g=e.fieldDef(p);if(g){let m=g.field;if(g.aggregate){Y(gae(p,g.aggregate));continue}else if(!m){Y(x7(p));continue}if(g.timeUnit&&!bu(g.timeUnit)){m=e.vgField(p);const y={timeUnit:g.timeUnit,as:m,field:g.field};o[De(y)]=y}if(!s[m]){const y=l==="interval"&&ns(p)&&tr(e.getScaleComponent(p).get("type"))?"R":g.bin?"R-RE":"E",v={field:m,channel:p,type:y,index:r.items.length};v.signals={...u(v,"data"),...u(v,"visual")},r.items.push(s[m]=v),r.hasField[m]=s[m],r.hasSelectionId=r.hasSelectionId||m===rr,RF(p)?(v.geoChannel=p,v.channel=DF(p),r.hasChannel[v.channel]=s[m]):r.hasChannel[p]=s[m]}}else Y(x7(p))}for(const p of d??[]){if(r.hasField[p])continue;const g={type:"E",field:p,index:r.items.length};g.signals={...u(g,"data")},r.items.push(g),r.hasField[p]=g,r.hasSelectionId=r.hasSelectionId||p===rr}f&&(t.init=f.map(p=>r.items.map(g=>_e(p)?p[g.geoChannel||g.channel]!==void 0?p[g.geoChannel||g.channel]:p[g.field]:p))),et(o)||(r.timeUnit=new Nr(null,o))},signals:(e,t,n)=>{const i=t.name+Id;return n.filter(s=>s.name===i).length>0||t.project.hasSelectionId?n:n.concat({name:i,value:t.project.items.map(PN)})}},RN="_curr",t0="anim_value",Pu="anim_clock",Yv="eased_anim_clock",ON="min_extent",IN="max_range_extent",py="last_tick_at",gy="is_playing",Tfe=1/60*1e3,Ffe=(e,t)=>[{name:Yv,update:Pu},{name:`${e}_domain`,init:`domain('${t}')`},{name:ON,init:`extent(${e}_domain)[0]`},{name:IN,init:`extent(range('${t}'))[1]`},{name:t0,update:`invert('${t}', ${Yv})`}],Lfe={defined:e=>e.type==="point",topLevelSignals:(e,t,n)=>(Dr(t)&&(n=n.concat([{name:Pu,init:"0",on:[{events:{type:"timer",throttle:Tfe},update:`${gy} ? (${Pu} + (now() - ${py}) > ${IN} ? 0 : ${Pu} + (now() - ${py})) : ${Pu}`}]},{name:py,init:"now()",on:[{events:[{signal:Pu},{signal:gy}],update:"now()"}]},{name:gy,init:"true"}])),n),signals:(e,t,n)=>{const i=t.name,r=i+Id,s=t.project,o="(item().isVoronoi ? datum.datum : datum)",a=Qt(e.component.selection??{}).reduce((c,f)=>f.type==="interval"?c.concat(f.name+Ju):c,[]).map(c=>`indexof(item().mark.name, '${c}') < 0`).join(" && "),u=`datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0${a?` && ${a}`:""}`;let l=`unit: ${Oa(e)}, `;if(t.project.hasSelectionId)l+=`${rr}: ${o}[${xe(rr)}]`;else if(Dr(t))l+=`fields: ${r}, values: [${t0} ? ${t0} : ${ON}]`;else{const c=s.items.map(f=>{const d=e.fieldDef(f.channel);return d!=null&&d.bin?`[${o}[${xe(e.vgField(f.channel,{}))}], ${o}[${xe(e.vgField(f.channel,{binSuffix:"end"}))}]]`:`${o}[${xe(f.field)}]`}).join(", ");l+=`fields: ${r}, values: [${c}]`}if(Dr(t))return n.concat(Ffe(t.name,e.scaleName(Yo)),[{name:i+js,on:[{events:[{signal:Yv},{signal:t0}],update:`{${l}}`,force:!0}]}]);{const c=t.events;return n.concat([{name:i+js,on:c?[{events:c,update:`${u} ? {${l}} : null`,force:!0}]:[]}])}}};function PN(e){const{signals:t,hasLegend:n,index:i,...r}=e;return r.field=Li(r.field),r}function ru(e,t=!0,n=In){if(V(e)){const i=e.map(r=>ru(r,t,n));return t?`[${i.join(", ")}]`:i}else if(vu(e))return n(t?eu(e):$ue(e));return t?n(tt(e)):e}function Nfe(e,t){for(const n of Qt(e.component.selection??{})){const i=n.name;let r=`${i}${js}, ${n.resolve==="global"?"true":`{unit: ${Oa(e)}}`}`;for(const s of S1)s.defined(n)&&(s.signals&&(t=s.signals(e,n,t)),s.modifyExpr&&(r=s.modifyExpr(e,n,r)));t.push({name:i+ode,on:[{events:{signal:n.name+js},update:`modify(${xe(n.name+su)}, ${r})`}]})}return O4(t)}function Dfe(e,t){if(e.component.selection&&W(e.component.selection).length){const n=xe(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:ql("pointermove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return O4(t)}function Rfe(e,t){let n=!1;for(const i of Qt(e.component.selection??{})){const r=i.name,s=xe(r+su);if(t.filter(a=>a.name===r).length===0){const a=i.resolve==="global"?"union":i.resolve,u=i.type==="point"?", true, true)":")";t.push({name:i.name,update:`${tD}(${s}, ${xe(a)}${u}`})}n=!0;for(const a of S1)a.defined(i)&&a.topLevelSignals&&(t=a.topLevelSignals(e,i,t))}return n&&t.filter(r=>r.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"pointermove",update:"isTuple(group()) ? group() : unit"}]}),O4(t)}function Ofe(e,t){const n=[],i=[],r=Oa(e,{escape:!1});for(const s of Qt(e.component.selection??{})){const o={name:s.name+su};if(s.project.hasSelectionId&&(o.transform=[{type:"collect",sort:{field:rr}}]),s.init){const u=s.project.items.map(PN);o.values=s.project.hasSelectionId?s.init.map(l=>({unit:r,[rr]:ru(l,!1)[0]})):s.init.map(l=>({unit:r,fields:u,values:ru(l,!1)}))}if([...n,...t].filter(u=>u.name===s.name+su).length||n.push(o),Dr(s)&&t.length){const u=e.lookupDataSource(e.getDataName(vt.Main)),l=t.find(f=>f.name===u),c=l.transform.find(f=>f.type==="filter"&&f.expr.includes("vlSelectionTest"));if(c){l.transform=l.transform.filter(d=>d!==c);const f={name:l.name+RN,source:l.name,transform:[c]};i.push(f)}}}return n.concat(t,i)}function zN(e,t){for(const n of Qt(e.component.selection??{}))for(const i of S1)i.defined(n)&&i.marks&&(t=i.marks(e,n,t));return t}function Ife(e,t){for(const n of e.children)yt(n)&&(t=zN(n,t));return t}function Pfe(e,t,n,i){const r=dD(e,t.param,t);return{signal:tr(n.get("type"))&&V(i)&&i[0]>i[1]?`isValid(${r}) && reverse(${r})`:r}}function O4(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}const Fs={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const i of t.project.items){const r=i.channel;if(!ns(r))continue;const s=e.getScaleComponent(r),o=s?s.get("type"):void 0;if(o=="sequential"&&Y(bae),!s||!tr(o)){Y(vae);continue}s.set("selectionExtent",{param:t.name,field:i.field},!0),n.push(i)}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(o=>n.filter(a=>a.name===o.signals.data).length===0);if(!e.parent||Xv(e)||i.length===0)return n;const r=n.find(o=>o.name===t.name);let s=r.update;if(s.includes(tD))r.update=`{${i.map(o=>`${xe(Li(o.field))}: ${o.signals.data}`).join(", ")}}`;else{for(const o of i){const a=`${xe(Li(o.field))}: ${o.signals.data}`;s.includes(a)||(s=`${s.substring(0,s.length-1)}, ${a}}`)}r.update=s}return n.concat(i.map(o=>({name:o.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!Xv(e))for(const i of t.scales){const r=n.find(s=>s.name===i.signals.data);r.push="outer",delete r.value,delete r.update}return n}};function Zv(e,t){return`domain(${xe(e.scaleName(t))})`}function Xv(e){return e.parent&&Ql(e.parent)&&(!e.parent.parent||Xv(e.parent.parent))}const Ju="_brush",BN="_scale_trigger",Ec="geo_interval_init_tick",UN="_init",zfe="_center",Bfe={defined:e=>e.type==="interval",parse:(e,t,n)=>{var i;if(e.hasProjection){const r={..._e(n.select)?n.select:{}};r.fields=[rr],r.encodings||(r.encodings=n.value?W(n.value):[lr,ur]),n.select={type:"interval",...r}}if(t.translate&&!Fs.defined(t)){const r=`!event.item || event.item.mark.name !== ${xe(t.name+Ju)}`;for(const s of t.events){if(!s.between){Y(`${s} is not an ordered event stream for interval selections.`);continue}const o=ce((i=s.between[0]).filter??(i.filter=[]));o.includes(r)||o.push(r)}}},signals:(e,t,n)=>{const i=t.name,r=i+js,s=Qt(t.project.hasChannel).filter(a=>a.channel===gt||a.channel===Wt),o=t.init?t.init[0]:null;if(n.push(...s.reduce((a,u)=>a.concat(Ufe(e,t,u,o&&o[u.index])),[])),e.hasProjection){const a=xe(e.projectionName()),u=e.projectionName()+zfe,{x:l,y:c}=t.project.hasChannel,f=l&&l.signals.visual,d=c&&c.signals.visual,h=l?o&&o[l.index]:`${u}[0]`,p=c?o&&o[c.index]:`${u}[1]`,g=_=>e.getSizeSignalRef(_).signal,m=`[[${f?f+"[0]":"0"}, ${d?d+"[0]":"0"}],[${f?f+"[1]":g("width")}, ${d?d+"[1]":g("height")}]]`;o&&(n.unshift({name:i+UN,init:`[scale(${a}, [${l?h[0]:h}, ${c?p[0]:p}]), scale(${a}, [${l?h[1]:h}, ${c?p[1]:p}])]`}),(!l||!c)&&(n.find(E=>E.name===u)||n.unshift({name:u,update:`invert(${a}, [${g("width")}/2, ${g("height")}/2])`})));const y=`intersect(${m}, {markname: ${xe(e.getName("marks"))}}, unit.mark)`,v=`{unit: ${Oa(e)}}`,b=`vlSelectionTuples(${y}, ${v})`,x=s.map(_=>_.signals.visual);return n.concat({name:r,on:[{events:[...x.length?[{signal:x.join(" || ")}]:[],...o?[{signal:Ec}]:[]],update:b}]})}else{if(!Fs.defined(t)){const l=i+BN,c=s.map(f=>{const d=f.channel,{data:h,visual:p}=f.signals,g=xe(e.scaleName(d)),m=e.getScaleComponent(d).get("type"),y=tr(m)?"+":"";return`(!isArray(${h}) || (${y}invert(${g}, ${p})[0] === ${y}${h}[0] && ${y}invert(${g}, ${p})[1] === ${y}${h}[1]))`});c.length&&n.push({name:l,value:{},on:[{events:s.map(f=>({scale:e.scaleName(f.channel)})),update:c.join(" && ")+` ? ${l} : {}`}]})}const a=s.map(l=>l.signals.data),u=`unit: ${Oa(e)}, fields: ${i+Id}, values`;return n.concat({name:r,...o?{init:`{${u}: ${ru(o)}}`}:{},...a.length?{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${u}: [${a}]} : null`}]}:{}})}},topLevelSignals:(e,t,n)=>(yt(e)&&e.hasProjection&&t.init&&(n.filter(r=>r.name===Ec).length||n.unshift({name:Ec,value:null,on:[{events:"timer{1}",update:`${Ec} === null ? {} : ${Ec}`}]})),n),marks:(e,t,n)=>{const i=t.name,{x:r,y:s}=t.project.hasChannel,o=r==null?void 0:r.signals.visual,a=s==null?void 0:s.signals.visual,u=`data(${xe(t.name+su)})`;if(Fs.defined(t)||!r&&!s)return n;const l={x:r!==void 0?{signal:`${o}[0]`}:{value:0},y:s!==void 0?{signal:`${a}[0]`}:{value:0},x2:r!==void 0?{signal:`${o}[1]`}:{field:{group:"width"}},y2:s!==void 0?{signal:`${a}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of W(l))l[m]=[{test:`${u}.length && ${u}[0].unit === ${Oa(e)}`,...l[m]},{value:0}];const{fill:c,fillOpacity:f,cursor:d,...h}=t.mark,p=W(h).reduce((m,y)=>(m[y]=[{test:[r!==void 0&&`${o}[0] !== ${o}[1]`,s!==void 0&&`${a}[0] !== ${a}[1]`].filter(v=>v).join(" && "),value:h[y]},{value:null}],m),{}),g=d??(t.translate?"move":null);return[{name:`${i+Ju}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:f}},update:l}},...n,{name:i+Ju,type:"rect",clip:!0,encode:{enter:{...g?{cursor:{value:g}}:{},fill:{value:"transparent"}},update:{...l,...p}}}]}};function Ufe(e,t,n,i){const r=!e.hasProjection,s=n.channel,o=n.signals.visual,a=xe(r?e.scaleName(s):e.projectionName()),u=d=>`scale(${a}, ${d})`,l=e.getSizeSignalRef(s===gt?"width":"height").signal,c=`${s}(unit)`,f=t.events.reduce((d,h)=>[...d,{events:h.between[0],update:`[${c}, ${c}]`},{events:h,update:`[${o}[0], clamp(${c}, 0, ${l})]`}],[]);if(r){const d=n.signals.data,h=Fs.defined(t),p=e.getScaleComponent(s),g=p?p.get("type"):void 0,m=i?{init:ru(i,!0,u)}:{value:[]};return f.push({events:{signal:t.name+BN},update:tr(g)?`[${u(`${d}[0]`)}, ${u(`${d}[1]`)}]`:"[0, 0]"}),h?[{name:d,on:[]}]:[{name:o,...m,on:f},{name:d,...i?{init:ru(i)}:{},on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${a}, ${o})`}]}]}else{const d=s===gt?0:1,h=t.name+UN,p=i?{init:`[${h}[0][${d}], ${h}[1][${d}]]`}:{value:[]};return[{name:o,...p,on:f}]}}function Zl({model:e,channelDef:t,vgChannel:n,invalidValueRef:i,mainRefFn:r}){const s=Nd(t)&&t.condition;let o=[];s&&(o=ce(s).map(l=>{const c=r(l);if($le(l)){const{param:f,empty:d}=l;return{test:fD(e,{param:f,empty:d}),...c}}else return{test:Rp(e,l.test),...c}})),i!==void 0&&o.push(i);const a=r(t);return a!==void 0&&o.push(a),o.length>1||o.length===1&&o[0].test?{[n]:o}:o.length===1?{[n]:o[0]}:{}}function I4(e,t="text"){const n=e.encoding[t];return Zl({model:e,channelDef:n,vgChannel:t,mainRefFn:i=>C1(i,e.config),invalidValueRef:void 0})}function C1(e,t,n="datum"){if(e){if(nr(e))return ct(e.value);if(ke(e)){const{format:i,formatType:r}=$p(e);return y4({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}}function jN(e,t={}){const{encoding:n,markDef:i,config:r,stack:s}=e,o=n.tooltip;if(V(o))return{tooltip:K7({tooltip:o},s,r,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return Zl({model:e,channelDef:o,vgChannel:"tooltip",mainRefFn:l=>{const c=C1(l,r,a);if(c)return c;if(l===null)return;let f=Qe("tooltip",i,r);if(f===!0&&(f={content:"encoding"}),le(f))return{value:f};if(_e(f))return ue(f)?f:f.content==="encoding"?K7(n,s,r,t):{signal:a}},invalidValueRef:void 0})}}function HN(e,t,n,{reactiveGeom:i}={}){const r={...n,...n.tooltipFormat},s=new Set,o=i?"datum.datum":"datum",a=[];function u(c,f){const d=gu(f),h=zn(c)?c:{...c,type:e[d].type},p=h.title||_4(h,r),g=ce(p).join(", ").replaceAll(/"/g,'\\"');let m;if($t(f)){const y=f==="x"?"x2":"y2",v=ir(e[y]);if(Gt(h.bin)&&v){const b=ee(h,{expr:o}),x=ee(v,{expr:o}),{format:_,formatType:E}=$p(h);m=Fd(b,x,_,E,r),s.add(y)}}if(($t(f)||f===Ri||f===ar)&&t&&t.fieldChannel===f&&t.offset==="normalize"){const{format:y,formatType:v}=$p(h);m=y4({fieldOrDatumDef:h,format:y,formatType:v,expr:o,config:r,normalizeStack:!0}).signal}m??(m=C1(h,r,o).signal),a.push({channel:f,key:g,value:m})}E4(e,(c,f)=>{Z(c)?u(c,f):p1(c)&&u(c.condition,f)});const l={};for(const{channel:c,key:f,value:d}of a)!s.has(c)&&!l[f]&&(l[f]=d);return l}function K7(e,t,n,{reactiveGeom:i}={}){const r=HN(e,t,n,{reactiveGeom:i}),s=No(r).map(([o,a])=>`"${o}": ${a}`);return s.length>0?{signal:`{${s.join(", ")}}`}:void 0}function jfe(e){const{markDef:t,config:n}=e,i=Qe("aria",t,n);return i===!1?{}:{...i?{aria:i}:{},...Hfe(e),...qfe(e)}}function Hfe(e){const{mark:t,markDef:n,config:i}=e;if(i.aria===!1)return{};const r=Qe("ariaRoleDescription",n,i);return r!=null?{ariaRoleDescription:{value:r}}:pe(fae,t)?{}:{ariaRoleDescription:{value:t}}}function qfe(e){const{encoding:t,markDef:n,config:i,stack:r}=e,s=t.description;if(s)return Zl({model:e,channelDef:s,vgChannel:"description",mainRefFn:u=>C1(u,e.config),invalidValueRef:void 0});const o=Qe("description",n,i);if(o!=null)return{description:ct(o)};if(i.aria===!1)return{};const a=HN(t,r,i);if(!et(a))return{description:{signal:No(a).map(([u,l],c)=>`"${c>0?"; ":""}${u}: " + (${l})`).join(" + ")}}}function Xt(e,t,n={}){const{markDef:i,encoding:r,config:s}=t,{vgChannel:o}=n;let{defaultRef:a,defaultValue:u}=n;const l=r[e];a===void 0&&(u??(u=Qe(e,i,s,{vgChannel:o,ignoreVgConfig:!Nd(l)})),u!==void 0&&(a=ct(u)));const c={markDef:i,config:s,scaleName:t.scaleName(e),scale:t.getScaleComponent(e)},f=TL({...c,scaleChannel:e,channelDef:l});return Zl({model:t,channelDef:l,vgChannel:o??e,invalidValueRef:f,mainRefFn:h=>m4({...c,channel:e,channelDef:h,stack:null,defaultRef:a})})}function qN(e,t={filled:void 0}){const{markDef:n,encoding:i,config:r}=e,{type:s}=n,o=t.filled??Qe("filled",n,r),a=Ne(["bar","point","circle","square","geoshape"],s)?"transparent":void 0,u=Qe(o===!0?"color":void 0,n,r,{vgChannel:"fill"})??r.mark[o===!0&&"color"]??a,l=Qe(o===!1?"color":void 0,n,r,{vgChannel:"stroke"})??r.mark[o===!1&&"color"],c=o?"fill":"stroke",f={...u?{fill:ct(u)}:{},...l?{stroke:ct(l)}:{}};return n.color&&(o?n.fill:n.stroke)&&Y(tL("property",{fill:"fill"in n,stroke:"stroke"in n})),{...f,...Xt("color",e,{vgChannel:c,defaultValue:o?u:l}),...Xt("fill",e,{defaultValue:i.fill?u:void 0}),...Xt("stroke",e,{defaultValue:i.stroke?l:void 0})}}function Vfe(e){const{encoding:t,mark:n}=e,i=t.order;return!ea(n)&&nr(i)?Zl({model:e,channelDef:i,vgChannel:"zindex",mainRefFn:r=>ct(r.value),invalidValueRef:void 0}):{}}function $l({channel:e,markDef:t,encoding:n={},model:i,bandPosition:r}){const s=`${e}Offset`,o=t[s],a=n[s];if((s==="xOffset"||s==="yOffset")&&a)return{offsetType:"encoding",offset:m4({channel:s,channelDef:a,markDef:t,config:i==null?void 0:i.config,scaleName:i.scaleName(s),scale:i.getScaleComponent(s),stack:null,defaultRef:ct(o),bandPosition:r})};const u=t[s];return u?{offsetType:"visual",offset:u}:{}}function Mn(e,t,{defaultPos:n,vgChannel:i}){const{encoding:r,markDef:s,config:o,stack:a}=t,u=r[e],l=r[ts(e)],c=t.scaleName(e),f=t.getScaleComponent(e),{offset:d,offsetType:h}=$l({channel:e,markDef:s,encoding:r,model:t,bandPosition:.5}),p=P4({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),g=!u&&$t(e)&&(r.latitude||r.longitude)?{field:t.getName(e)}:Wfe({channel:e,channelDef:u,channel2Def:l,markDef:s,config:o,scaleName:c,scale:f,stack:a,offset:d,defaultRef:p,bandPosition:h==="encoding"?0:void 0});return g?{[i||e]:g}:void 0}function Wfe(e){const{channel:t,channelDef:n,scaleName:i,stack:r,offset:s,markDef:o}=e;if(ke(n)&&r&&t===r.fieldChannel){if(Z(n)){let a=n.bandPosition;if(a===void 0&&o.type==="text"&&(t==="radius"||t==="theta")&&(a=.5),a!==void 0)return Sp({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",bandPosition:a,offset:s})}return Da(n,i,{suffix:"end"},{offset:s})}return g4(e)}function P4({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:s,config:o}=e;return()=>{const a=gu(n),u=Do(n),l=Qe(n,s,o,{vgChannel:u});if(l!==void 0)return mf(n,l);switch(t){case"zeroOrMin":return J7({scaleName:i,scale:r,mode:"zeroOrMin",mainChannel:a,config:o});case"zeroOrMax":return J7({scaleName:i,scale:r,mode:{zeroOrMax:{widthSignal:e.width.signal,heightSignal:e.height.signal}},mainChannel:a,config:o});case"mid":return{...e[Qn(n)],mult:.5}}}}function J7({mainChannel:e,config:t,...n}){const i=ML(n),{mode:r}=n;if(i)return i;switch(e){case"radius":{if(r==="zeroOrMin")return{value:0};const{widthSignal:s,heightSignal:o}=r.zeroOrMax;return{signal:`min(${s},${o})/2`}}case"theta":return r==="zeroOrMin"?{value:0}:{signal:"2*PI"};case"x":return r==="zeroOrMin"?{value:0}:{field:{group:"width"}};case"y":return r==="zeroOrMin"?{field:{group:"height"}}:{value:0}}}const Gfe={left:"x",center:"xc",right:"x2"},Yfe={top:"y",middle:"yc",bottom:"y2"};function VN(e,t,n,i="middle"){if(e==="radius"||e==="theta")return Do(e);const r=e==="x"?"align":"baseline",s=Qe(r,t,n);let o;return ue(s)?(Y(Wae(r)),o=void 0):o=s,e==="x"?Gfe[o||(i==="top"?"left":"center")]:Yfe[o||i]}function Lp(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?WN(e,t,{defaultPos:n,defaultPos2:i}):Mn(e,t,{defaultPos:n})}function WN(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:s}=t,o=ts(e),a=Qn(e),u=Zfe(t,i,o),l=u[a]?VN(e,r,s):Do(e);return{...Mn(e,t,{defaultPos:n,vgChannel:l}),...u}}function Zfe(e,t,n){const{encoding:i,mark:r,markDef:s,stack:o,config:a}=e,u=gu(n),l=Qn(n),c=Do(n),f=i[u],d=e.scaleName(u),h=e.getScaleComponent(u),{offset:p}=n in i||n in s?$l({channel:n,markDef:s,encoding:i,model:e}):$l({channel:u,markDef:s,encoding:i,model:e});if(!f&&(n==="x2"||n==="y2")&&(i.latitude||i.longitude)){const m=Qn(n),y=e.markDef[m];return y!=null?{[m]:{value:y}}:{[c]:{field:e.getName(n)}}}const g=Xfe({channel:n,channelDef:f,channel2Def:i[n],markDef:s,config:a,scaleName:d,scale:h,stack:o,offset:p,defaultRef:void 0});return g!==void 0?{[c]:g}:Ch(n,s)||Ch(n,{[n]:Iv(n,s,a.style),[l]:Iv(l,s,a.style)})||Ch(n,a[r])||Ch(n,a.mark)||{[c]:P4({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function Xfe({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:u,defaultRef:l}){return ke(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?Da(t,s,{suffix:"start"},{offset:u}):g4({channel:e,channelDef:n,scaleName:s,scale:o,stack:a,markDef:i,config:r,offset:u,defaultRef:l})}function Ch(e,t){const n=Qn(e),i=Do(e);if(t[i]!==void 0)return{[i]:mf(e,t[i])};if(t[e]!==void 0)return{[i]:mf(e,t[e])};if(t[n]){const r=t[n];if(nu(r))Y(Bae(n));else return{[n]:mf(e,r)}}}function Us(e,t){const{config:n,encoding:i,markDef:r}=e,s=r.type,o=ts(t),a=Qn(t),u=i[t],l=i[o],c=e.getScaleComponent(t),f=c?c.get("type"):void 0,d=r.orient,h=i[a]??i.size??Qe("size",r,n,{vgChannel:a}),p=zF(t),g=s==="bar"&&(t==="x"?d==="vertical":d==="horizontal")||s==="tick"&&(t==="y"?d==="vertical":d==="horizontal");return Z(u)&&(lt(u.bin)||Gt(u.bin)||u.timeUnit&&!l)&&!(h&&!nu(h))&&!i[p]&&!qt(f)?Qfe({fieldDef:u,fieldDef2:l,channel:t,model:e}):(ke(u)&&qt(f)||g)&&!l?Jfe(u,t,e):WN(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function Kfe(e,t,n,i,r,s,o){if(nu(r))if(n){const u=n.get("type");if(u==="band"){let l=`bandwidth('${t}')`;r.band!==1&&(l=`${r.band} * ${l}`);const c=Hr("minBandSize",{type:o},i);return{signal:c?`max(${Gi(c)}, ${l})`:l}}else r.band!==1&&(Y(Xae(u)),r=void 0)}else return{mult:r.band,field:{group:e}};else{if(ue(r))return r;if(r)return{value:r}}if(n){const u=n.get("range");if(yu(u)&&Ke(u.step))return{value:u.step-2}}if(!s){const{bandPaddingInner:u,barBandPaddingInner:l,rectBandPaddingInner:c,tickBandPaddingInner:f}=i.scale,d=At(u,o==="tick"?f:o==="bar"?l:c);if(ue(d))return{signal:`(1 - (${d.signal})) * ${e}`};if(Ke(d))return{signal:`${1-d} * ${e}`}}return{value:qv(i.view,e)-2}}function Jfe(e,t,n){var $,F;const{markDef:i,encoding:r,config:s,stack:o}=n,a=i.orient,u=n.scaleName(t),l=n.getScaleComponent(t),c=Qn(t),f=ts(t),d=zF(t),h=n.scaleName(d),p=n.getScaleComponent(jx(t)),g=i.type==="tick"||a==="horizontal"&&t==="y"||a==="vertical"&&t==="x";let m;(r.size||i.size)&&(g?m=Xt("size",n,{vgChannel:c,defaultRef:ct(i.size)}):Y(eue(i.type)));const y=!!m,v=IL({channel:t,fieldDef:e,markDef:i,config:s,scaleType:($=l||p)==null?void 0:$.get("type"),useVlSizeChannel:g});m=m||{[c]:Kfe(c,h||u,p||l,s,v,!!e,i.type)};const b=((F=l||p)==null?void 0:F.get("type"))==="band"&&nu(v)&&!y?"top":"middle",x=VN(t,i,s,b),_=x==="xc"||x==="yc",{offset:E,offsetType:w}=$l({channel:t,markDef:i,encoding:r,model:n,bandPosition:_?.5:0}),S=g4({channel:t,channelDef:e,markDef:i,config:s,scaleName:u,scale:l,stack:o,offset:E,defaultRef:P4({model:n,defaultPos:"mid",channel:t,scaleName:u,scale:l}),bandPosition:_?w==="encoding"?0:.5:ue(v)?{signal:`(1-${v})/2`}:nu(v)?(1-v.band)/2:0});if(c)return{[x]:S,...m};{const T=Do(f),P=m[c],R=E?{...P,offset:E}:P;return{[x]:S,[T]:V(S)?[S[0],{...S[1],offset:R}]:{...S,offset:R}}}}function Q7(e,t,n,i,r,s,o){if(NF(e))return 0;const a=e==="x"||e==="y2",u=a?-t/2:t/2;if(ue(n)||ue(r)||ue(i)||s){const l=Gi(n),c=Gi(r),f=Gi(i),d=Gi(s),p=s?`(${o} < ${d} ? ${a?"":"-"}0.5 * (${d} - (${o})) : ${u})`:u,g=f?`${f} + `:"",m=l?`(${l} ? -1 : 1) * `:"",y=c?`(${c} + ${p})`:p;return{signal:g+m+y}}else return r=r||0,i+(n?-r-u:+r+u)}function Qfe({fieldDef:e,fieldDef2:t,channel:n,model:i}){var F;const{config:r,markDef:s,encoding:o}=i,a=i.getScaleComponent(n),u=i.scaleName(n),l=a?a.get("type"):void 0,c=a.get("reverse"),f=IL({channel:n,fieldDef:e,markDef:s,config:r,scaleType:l}),d=(F=i.component.axes[n])==null?void 0:F[0],h=(d==null?void 0:d.get("translate"))??.5,p=$t(n)?Qe("binSpacing",s,r)??0:0,g=ts(n),m=Do(n),y=Do(g),v=Hr("minBandSize",s,r),{offset:b}=$l({channel:n,markDef:s,encoding:o,model:i,bandPosition:0}),{offset:x}=$l({channel:g,markDef:s,encoding:o,model:i,bandPosition:0}),_=wle({fieldDef:e,scaleName:u}),E=Q7(n,p,c,h,b,v,_),w=Q7(g,p,c,h,x??b,v,_),S=ue(f)?{signal:`(1-${f.signal})/2`}:nu(f)?(1-f.band)/2:.5,$=Ro({fieldDef:e,fieldDef2:t,markDef:s,config:r});if(lt(e.bin)||e.timeUnit){const T=e.timeUnit&&$!==.5;return{[y]:ew({fieldDef:e,scaleName:u,bandPosition:S,offset:w,useRectOffsetField:T}),[m]:ew({fieldDef:e,scaleName:u,bandPosition:ue(S)?{signal:`1-${S.signal}`}:1-S,offset:E,useRectOffsetField:T})}}else if(Gt(e.bin)){const T=Da(e,u,{},{offset:w});if(Z(t))return{[y]:T,[m]:Da(t,u,{},{offset:E})};if(mu(e.bin)&&e.bin.step)return{[y]:T,[m]:{signal:`scale("${u}", ${ee(e,{expr:"datum"})} + ${e.bin.step})`,offset:E}}}Y(rL(g))}function ew({fieldDef:e,scaleName:t,bandPosition:n,offset:i,useRectOffsetField:r}){return Sp({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:i,...r?{startSuffix:w1,endSuffix:E1}:{}})}const ede=new Set(["aria","width","height"]);function Oi(e,t){const{fill:n=void 0,stroke:i=void 0}=t.color==="include"?qN(e):{};return{...tde(e.markDef,t),...tw("fill",n),...tw("stroke",i),...Xt("opacity",e),...Xt("fillOpacity",e),...Xt("strokeOpacity",e),...Xt("strokeWidth",e),...Xt("strokeDash",e),...Vfe(e),...jN(e),...I4(e,"href"),...jfe(e)}}function tw(e,t){return t?{[e]:t}:{}}function tde(e,t){return cae.reduce((n,i)=>(!ede.has(i)&&G(e,i)&&t[i]!=="ignore"&&(n[i]=ct(e[i])),n),{})}function z4(e){const{config:t,markDef:n}=e,i=new Set;if(e.forEachFieldDef((r,s)=>{var l;let o;if(!ns(s)||!(o=e.getScaleType(s)))return;const a=i1(r.aggregate),u=p4({scaleChannel:s,markDef:n,config:t,scaleType:o,isCountAggregate:a});if(ble(u)){const c=e.vgField(s,{expr:"datum",binSuffix:(l=e.stack)!=null&&l.impute?"mid":void 0});c&&i.add(c)}}),i.size>0)return{defined:{signal:[...i].map(s=>a1(s,!0)).join(" && ")}}}function nw(e,t){if(t!==void 0)return{[e]:ct(t)}}const my="voronoi",GN={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(my)},marks:(e,t,n)=>{const{x:i,y:r}=t.project.hasChannel,s=e.mark;if(ea(s))return Y(mae(s)),n;const o={name:e.getName(my),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...jN(e,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:i||!r?"datum.datum.x || 0":"0"},y:{expr:r||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,u=!1;return n.forEach((l,c)=>{const f=l.name??"";f===e.component.mark[0].name?a=c:f.includes(my)&&(u=!0)}),u||n.splice(a+1,0,o),n}},YN={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!M4(e.bind),parse:(e,t,n)=>nD(t,n),topLevelSignals:(e,t,n)=>{const i=t.name,r=t.project,s=t.bind,o=t.init&&t.init[0],a=GN.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((u,l)=>{const c=pt(`${i}_${u.field}`);n.filter(d=>d.name===c).length||n.unshift({name:c,...o?{init:ru(o[l])}:{value:null},on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${xe(u.field)}] : null`}]:[],bind:s[u.field]??s[u.channel]??s})}),n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.find(l=>l.name===i+js),o=i+Id,a=r.items.map(l=>pt(`${i}_${l.field}`)),u=a.map(l=>`${l} !== null`).join(" && ");return a.length&&(s.update=`${u} ? {fields: ${o}, values: [${a.join(", ")}]} : null`),delete s.value,delete s.on,n}},Np="_toggle",ZN={defined:e=>e.type==="point"&&!Dr(e)&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+Np,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+js,i=t.name+Np;return`${i} ? null : ${n}, `+(t.resolve==="global"?`${i} ? null : true, `:`${i} ? null : {unit: ${Oa(e)}}, `)+`${i} ? ${n} : null`}},nde={defined:e=>e.clear!==void 0&&e.clear!==!1&&!Dr(e),parse:(e,t)=>{t.clear&&(t.clear=le(t.clear)?ql(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(YN.defined(t))for(const i of t.project.items){const r=n.findIndex(s=>s.name===pt(`${t.name}_${i.field}`));r!==-1&&n[r].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function i(r,s){r!==-1&&n[r].on&&n[r].on.push({events:t.clear,update:s})}if(t.type==="interval")for(const r of t.project.items){const s=n.findIndex(o=>o.name===r.signals.visual);if(i(s,"[0, 0]"),s===-1){const o=n.findIndex(a=>a.name===r.signals.data);i(o,"null")}}else{let r=n.findIndex(s=>s.name===t.name+js);i(r,"null"),ZN.defined(t)&&(r=n.findIndex(s=>s.name===t.name+Np),i(r,"false"))}return n}},XN={defined:e=>{const t=e.resolve==="global"&&e.bind&&M4(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==rr;return t&&!n&&Y(xae),t&&n},parse:(e,t,n)=>{const i=Ce(n);if(i.select=le(i.select)?{type:i.select,toggle:t.toggle}:{...i.select,toggle:t.toggle},nD(t,i),_e(n.select)&&(n.select.on||n.select.clear)){const o='event.item && indexof(event.item.mark.role, "legend") < 0';for(const a of t.events)a.filter=ce(a.filter??[]),a.filter.includes(o)||a.filter.push(o)}const r=cy(t.bind)?t.bind.legend:"click",s=le(r)?ql(r,"view"):ce(r);t.bind={legend:{merge:s}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=cy(t.bind)&&t.bind.legend,s=o=>a=>{const u=Ce(a);return u.markname=o,u};for(const o of t.project.items){if(!o.hasLegend)continue;const a=`${pt(o.field)}_legend`,u=`${i}_${a}`;if(n.filter(c=>c.name===u).length===0){const c=r.merge.map(s(`${a}_symbols`)).concat(r.merge.map(s(`${a}_labels`))).concat(r.merge.map(s(`${a}_entries`)));n.unshift({name:u,...t.init?{}:{value:null},on:[{events:c,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]})}}return n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.find(d=>d.name===i+js),o=i+Id,a=r.items.filter(d=>d.hasLegend).map(d=>pt(`${i}_${pt(d.field)}_legend`)),l=`${a.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${o}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?s.on.push({events:a.map(d=>({signal:d})),update:l}):a.length>0&&(s.update=l,delete s.value,delete s.on);const c=n.find(d=>d.name===i+Np),f=cy(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push({...c.on[0],events:f}):c.on[0].events=f),n}};function ide(e,t,n){var r;const i=(r=e.fieldDef(t))==null?void 0:r.field;for(const s of Qt(e.component.selection??{})){const o=s.project.hasField[i]??s.project.hasChannel[t];if(o&&XN.defined(s)){const a=n.get("selections")??[];a.push(s.name),n.set("selections",a,!1),o.hasLegend=!0}}}const KN="_translate_anchor",JN="_translate_delta",rde={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const i=t.name,r=Fs.defined(t),s=i+KN,{x:o,y:a}=t.project.hasChannel;let u=ql(t.translate,"scope");return r||(u=u.map(l=>(l.between[0].markname=i+Ju,l))),n.push({name:s,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(o!==void 0?`, extent_x: ${r?Zv(e,gt):`slice(${o.signals.visual})`}`:"")+(a!==void 0?`, extent_y: ${r?Zv(e,Wt):`slice(${a.signals.visual})`}`:"")+"}"}]},{name:i+JN,value:{},on:[{events:u,update:`{x: ${s}.x - x(unit), y: ${s}.y - y(unit)}`}]}),o!==void 0&&iw(e,t,o,"width",n),a!==void 0&&iw(e,t,a,"height",n),n}};function iw(e,t,n,i,r){const s=t.name,o=s+KN,a=s+JN,u=n.channel,l=Fs.defined(t),c=r.find(_=>_.name===n.signals[l?"data":"visual"]),f=e.getSizeSignalRef(i).signal,d=e.getScaleComponent(u),h=d&&d.get("type"),p=d&&d.get("reverse"),g=l?u===gt?p?"":"-":p?"-":"":"",m=`${o}.extent_${u}`,y=`${g}${a}.${u} / ${l?`${f}`:`span(${m})`}`,v=!l||!d?"panLinear":h==="log"?"panLog":h==="symlog"?"panSymlog":h==="pow"?"panPow":"panLinear",b=l?h==="pow"?`, ${d.get("exponent")??1}`:h==="symlog"?`, ${d.get("constant")??1}`:"":"",x=`${v}(${m}, ${y}${b})`;c.on.push({events:{signal:a},update:l?x:`clampRange(${x}, 0, ${f})`})}const QN="_zoom_anchor",eD="_zoom_delta",sde={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=Fs.defined(t),s=i+eD,{x:o,y:a}=t.project.hasChannel,u=xe(e.scaleName(gt)),l=xe(e.scaleName(Wt));let c=ql(t.zoom,"scope");return r||(c=c.map(f=>(f.markname=i+Ju,f))),n.push({name:i+QN,on:[{events:c,update:r?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:s,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),o!==void 0&&rw(e,t,o,"width",n),a!==void 0&&rw(e,t,a,"height",n),n}};function rw(e,t,n,i,r){const s=t.name,o=n.channel,a=Fs.defined(t),u=r.find(v=>v.name===n.signals[a?"data":"visual"]),l=e.getSizeSignalRef(i).signal,c=e.getScaleComponent(o),f=c&&c.get("type"),d=a?Zv(e,o):u.name,h=s+eD,p=`${s}${QN}.${o}`,g=!a||!c?"zoomLinear":f==="log"?"zoomLog":f==="symlog"?"zoomSymlog":f==="pow"?"zoomPow":"zoomLinear",m=a?f==="pow"?`, ${c.get("exponent")??1}`:f==="symlog"?`, ${c.get("constant")??1}`:"":"",y=`${g}(${d}, ${p}, ${h}${m})`;u.on.push({events:{signal:h},update:a?y:`clampRange(${y}, 0, ${l})`})}const su="_store",js="_tuple",ode="_modify",tD="vlSelectionResolve",S1=[Lfe,Bfe,Mfe,ZN,YN,Fs,XN,nde,rde,sde,GN];function ade(e){let t=e.parent;for(;t&&!hi(t);)t=t.parent;return t}function Oa(e,{escape:t}={escape:!0}){let n=t?xe(e.name):e.name;const i=ade(e);if(i){const{facet:r}=i;for(const s of Si)r[s]&&(n+=` + '__facet_${s}_' + (facet[${xe(i.vgField(s))}])`)}return n}function B4(e){return Qt(e.component.selection??{}).reduce((t,n)=>t||n.project.hasSelectionId,!1)}function nD(e,t){(le(t.select)||!t.select.on)&&delete e.events,(le(t.select)||!t.select.clear)&&delete e.clear,(le(t.select)||!t.select.toggle)&&delete e.toggle}function Dr(e){var t;return(t=e.events)==null?void 0:t.find(n=>"type"in n&&n.type==="timer")}const ude="RawCode",lde="Literal",cde="Property",fde="Identifier",dde="ArrayExpression",hde="BinaryExpression",pde="CallExpression",gde="ConditionalExpression",mde="LogicalExpression",yde="MemberExpression",vde="ObjectExpression",bde="UnaryExpression";function fr(e){this.type=e}fr.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=xde(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};function xde(e){switch(e.type){case dde:return e.elements;case hde:case mde:return[e.left,e.right];case pde:return[e.callee].concat(e.arguments);case gde:return[e.test,e.consequent,e.alternate];case yde:return[e.object,e.property];case vde:return e.properties;case cde:return[e.key,e.value];case bde:return[e.argument];case fde:case lde:case ude:default:return[]}}var rs,ae,B,hn,Ze,k1=1,Pd=2,ou=3,ta=4,A1=5,_u=6,qn=7,zd=8,_de=9;rs={};rs[k1]="Boolean";rs[Pd]="<end>";rs[ou]="Identifier";rs[ta]="Keyword";rs[A1]="Null";rs[_u]="Numeric";rs[qn]="Punctuator";rs[zd]="String";rs[_de]="RegularExpression";var wde="ArrayExpression",Ede="BinaryExpression",Cde="CallExpression",Sde="ConditionalExpression",iD="Identifier",kde="Literal",Ade="LogicalExpression",$de="MemberExpression",Mde="ObjectExpression",Tde="Property",Fde="UnaryExpression",Ut="Unexpected token %0",Lde="Unexpected number",Nde="Unexpected string",Dde="Unexpected identifier",Rde="Unexpected reserved word",Ode="Unexpected end of input",Kv="Invalid regular expression",yy="Invalid regular expression: missing /",rD="Octal literals are not allowed in strict mode.",Ide="Duplicate data property in object literal not allowed in strict mode",Jt="ILLEGAL",Wf="Disabled.",Pde=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),zde=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function $1(e,t){if(!e)throw new Error("ASSERT: "+t)}function ps(e){return e>=48&&e<=57}function U4(e){return"0123456789abcdefABCDEF".includes(e)}function yf(e){return"01234567".includes(e)}function Bde(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e)}function Gf(e){return e===10||e===13||e===8232||e===8233}function Bd(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&Pde.test(String.fromCharCode(e))}function Dp(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&zde.test(String.fromCharCode(e))}const Ude={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function sD(){for(;B<hn;){const e=ae.charCodeAt(B);if(Bde(e)||Gf(e))++B;else break}}function Jv(e){var t,n,i,r=0;for(n=e==="u"?4:2,t=0;t<n;++t)B<hn&&U4(ae[B])?(i=ae[B++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):Be({},Ut,Jt);return String.fromCharCode(r)}function jde(){var e,t,n,i;for(e=ae[B],t=0,e==="}"&&Be({},Ut,Jt);B<hn&&(e=ae[B++],!!U4(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Be({},Ut,Jt),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,i=(t-65536&1023)+56320,String.fromCharCode(n,i))}function oD(){var e,t;for(e=ae.charCodeAt(B++),t=String.fromCharCode(e),e===92&&(ae.charCodeAt(B)!==117&&Be({},Ut,Jt),++B,e=Jv("u"),(!e||e==="\\"||!Bd(e.charCodeAt(0)))&&Be({},Ut,Jt),t=e);B<hn&&(e=ae.charCodeAt(B),!!Dp(e));)++B,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),ae.charCodeAt(B)!==117&&Be({},Ut,Jt),++B,e=Jv("u"),(!e||e==="\\"||!Dp(e.charCodeAt(0)))&&Be({},Ut,Jt),t+=e);return t}function Hde(){var e,t;for(e=B++;B<hn;){if(t=ae.charCodeAt(B),t===92)return B=e,oD();if(Dp(t))++B;else break}return ae.slice(e,B)}function qde(){var e,t,n;return e=B,t=ae.charCodeAt(B)===92?oD():Hde(),t.length===1?n=ou:Ude.hasOwnProperty(t)?n=ta:t==="null"?n=A1:t==="true"||t==="false"?n=k1:n=ou,{type:n,value:t,start:e,end:B}}function vy(){var e=B,t=ae.charCodeAt(B),n,i=ae[B],r,s,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++B,{type:qn,value:String.fromCharCode(t),start:e,end:B};default:if(n=ae.charCodeAt(B+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return B+=2,{type:qn,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:B};case 33:case 61:return B+=2,ae.charCodeAt(B)===61&&++B,{type:qn,value:ae.slice(e,B),start:e,end:B}}}if(o=ae.substr(B,4),o===">>>=")return B+=4,{type:qn,value:o,start:e,end:B};if(s=o.substr(0,3),s===">>>"||s==="<<="||s===">>=")return B+=3,{type:qn,value:s,start:e,end:B};if(r=s.substr(0,2),i===r[1]&&"+-<>&|".includes(i)||r==="=>")return B+=2,{type:qn,value:r,start:e,end:B};if(r==="//"&&Be({},Ut,Jt),"<>=!+-*%&|^/".includes(i))return++B,{type:qn,value:i,start:e,end:B};Be({},Ut,Jt)}function Vde(e){let t="";for(;B<hn&&U4(ae[B]);)t+=ae[B++];return t.length===0&&Be({},Ut,Jt),Bd(ae.charCodeAt(B))&&Be({},Ut,Jt),{type:_u,value:parseInt("0x"+t,16),start:e,end:B}}function Wde(e){let t="0"+ae[B++];for(;B<hn&&yf(ae[B]);)t+=ae[B++];return(Bd(ae.charCodeAt(B))||ps(ae.charCodeAt(B)))&&Be({},Ut,Jt),{type:_u,value:parseInt(t,8),octal:!0,start:e,end:B}}function sw(){var e,t,n;if(n=ae[B],$1(ps(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=B,e="",n!=="."){if(e=ae[B++],n=ae[B],e==="0"){if(n==="x"||n==="X")return++B,Vde(t);if(yf(n))return Wde(t);n&&ps(n.charCodeAt(0))&&Be({},Ut,Jt)}for(;ps(ae.charCodeAt(B));)e+=ae[B++];n=ae[B]}if(n==="."){for(e+=ae[B++];ps(ae.charCodeAt(B));)e+=ae[B++];n=ae[B]}if(n==="e"||n==="E")if(e+=ae[B++],n=ae[B],(n==="+"||n==="-")&&(e+=ae[B++]),ps(ae.charCodeAt(B)))for(;ps(ae.charCodeAt(B));)e+=ae[B++];else Be({},Ut,Jt);return Bd(ae.charCodeAt(B))&&Be({},Ut,Jt),{type:_u,value:parseFloat(e),start:t,end:B}}function Gde(){var e="",t,n,i,r,s=!1;for(t=ae[B],$1(t==="'"||t==='"',"String literal must starts with a quote"),n=B,++B;B<hn;)if(i=ae[B++],i===t){t="";break}else if(i==="\\")if(i=ae[B++],!i||!Gf(i.charCodeAt(0)))switch(i){case"u":case"x":ae[B]==="{"?(++B,e+=jde()):e+=Jv(i);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:yf(i)?(r="01234567".indexOf(i),r!==0&&(s=!0),B<hn&&yf(ae[B])&&(s=!0,r=r*8+"01234567".indexOf(ae[B++]),"0123".includes(i)&&B<hn&&yf(ae[B])&&(r=r*8+"01234567".indexOf(ae[B++]))),e+=String.fromCharCode(r)):e+=i;break}else i==="\r"&&ae[B]===`
`&&++B;else{if(Gf(i.charCodeAt(0)))break;e+=i}return t!==""&&Be({},Ut,Jt),{type:zd,value:e,octal:s,start:n,end:B}}function Yde(e,t){let n=e;t.includes("u")&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";Be({},Kv)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{Be({},Kv)}try{return new RegExp(e,t)}catch{return null}}function Zde(){var e,t,n,i,r;for(e=ae[B],$1(e==="/","Regular expression literal must start with a slash"),t=ae[B++],n=!1,i=!1;B<hn;)if(e=ae[B++],t+=e,e==="\\")e=ae[B++],Gf(e.charCodeAt(0))&&Be({},yy),t+=e;else if(Gf(e.charCodeAt(0)))Be({},yy);else if(n)e==="]"&&(n=!1);else if(e==="/"){i=!0;break}else e==="["&&(n=!0);return i||Be({},yy),r=t.substr(1,t.length-2),{value:r,literal:t}}function Xde(){var e,t,n;for(t="",n="";B<hn&&(e=ae[B],!!Dp(e.charCodeAt(0)));)++B,e==="\\"&&B<hn?Be({},Ut,Jt):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Be({},Kv,n),{value:n,literal:t}}function Kde(){var e,t,n,i;return Ze=null,sD(),e=B,t=Zde(),n=Xde(),i=Yde(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:B}}function Jde(e){return e.type===ou||e.type===ta||e.type===k1||e.type===A1}function aD(){if(sD(),B>=hn)return{type:Pd,start:B,end:B};const e=ae.charCodeAt(B);return Bd(e)?qde():e===40||e===41||e===59?vy():e===39||e===34?Gde():e===46?ps(ae.charCodeAt(B+1))?sw():vy():ps(e)?sw():vy()}function Wn(){const e=Ze;return B=e.end,Ze=aD(),B=e.end,e}function uD(){const e=B;Ze=aD(),B=e}function Qde(e){const t=new fr(wde);return t.elements=e,t}function ow(e,t,n){const i=new fr(e==="||"||e==="&&"?Ade:Ede);return i.operator=e,i.left=t,i.right=n,i}function ehe(e,t){const n=new fr(Cde);return n.callee=e,n.arguments=t,n}function the(e,t,n){const i=new fr(Sde);return i.test=e,i.consequent=t,i.alternate=n,i}function j4(e){const t=new fr(iD);return t.name=e,t}function Vc(e){const t=new fr(kde);return t.value=e.value,t.raw=ae.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function aw(e,t,n){const i=new fr($de);return i.computed=e==="[",i.object=t,i.property=n,i.computed||(n.member=!0),i}function nhe(e){const t=new fr(Mde);return t.properties=e,t}function uw(e,t,n){const i=new fr(Tde);return i.key=t,i.value=n,i.kind=e,i}function ihe(e,t){const n=new fr(Fde);return n.operator=e,n.argument=t,n.prefix=!0,n}function Be(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(s,o)=>($1(o<i.length,"Message reference must be in range"),i[o]));throw n=new Error(r),n.index=B,n.description=r,n}function M1(e){e.type===Pd&&Be(e,Ode),e.type===_u&&Be(e,Lde),e.type===zd&&Be(e,Nde),e.type===ou&&Be(e,Dde),e.type===ta&&Be(e,Rde),Be(e,Ut,e.value)}function pn(e){const t=Wn();(t.type!==qn||t.value!==e)&&M1(t)}function ft(e){return Ze.type===qn&&Ze.value===e}function by(e){return Ze.type===ta&&Ze.value===e}function rhe(){const e=[];for(B=Ze.start,pn("[");!ft("]");)ft(",")?(Wn(),e.push(null)):(e.push(au()),ft("]")||pn(","));return Wn(),Qde(e)}function lw(){B=Ze.start;const e=Wn();return e.type===zd||e.type===_u?(e.octal&&Be(e,rD),Vc(e)):j4(e.value)}function she(){var e,t,n,i;if(B=Ze.start,e=Ze,e.type===ou)return n=lw(),pn(":"),i=au(),uw("init",n,i);if(e.type===Pd||e.type===qn)M1(e);else return t=lw(),pn(":"),i=au(),uw("init",t,i)}function ohe(){var e=[],t,n,i,r={},s=String;for(B=Ze.start,pn("{");!ft("}");)t=she(),t.key.type===iD?n=t.key.name:n=s(t.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?Be({},Ide):r[i]=!0,e.push(t),ft("}")||pn(",");return pn("}"),nhe(e)}function ahe(){pn("(");const e=H4();return pn(")"),e}const uhe={if:1};function lhe(){var e,t,n;if(ft("("))return ahe();if(ft("["))return rhe();if(ft("{"))return ohe();if(e=Ze.type,B=Ze.start,e===ou||uhe[Ze.value])n=j4(Wn().value);else if(e===zd||e===_u)Ze.octal&&Be(Ze,rD),n=Vc(Wn());else{if(e===ta)throw new Error(Wf);e===k1?(t=Wn(),t.value=t.value==="true",n=Vc(t)):e===A1?(t=Wn(),t.value=null,n=Vc(t)):ft("/")||ft("/=")?(n=Vc(Kde()),uD()):M1(Wn())}return n}function che(){const e=[];if(pn("("),!ft(")"))for(;B<hn&&(e.push(au()),!ft(")"));)pn(",");return pn(")"),e}function fhe(){B=Ze.start;const e=Wn();return Jde(e)||M1(e),j4(e.value)}function dhe(){return pn("."),fhe()}function hhe(){pn("[");const e=H4();return pn("]"),e}function phe(){var e,t,n;for(e=lhe();;)if(ft("."))n=dhe(),e=aw(".",e,n);else if(ft("("))t=che(),e=ehe(e,t);else if(ft("["))n=hhe(),e=aw("[",e,n);else break;return e}function cw(){const e=phe();if(Ze.type===qn&&(ft("++")||ft("--")))throw new Error(Wf);return e}function n0(){var e,t;if(Ze.type!==qn&&Ze.type!==ta)t=cw();else{if(ft("++")||ft("--"))throw new Error(Wf);if(ft("+")||ft("-")||ft("~")||ft("!"))e=Wn(),t=n0(),t=ihe(e.value,t);else{if(by("delete")||by("void")||by("typeof"))throw new Error(Wf);t=cw()}}return t}function fw(e){let t=0;if(e.type!==qn&&e.type!==ta)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function ghe(){var e,t,n,i,r,s,o,a,u,l;if(e=Ze,u=n0(),i=Ze,r=fw(i),r===0)return u;for(i.prec=r,Wn(),t=[e,Ze],o=n0(),s=[u,i,o];(r=fw(Ze))>0;){for(;s.length>2&&r<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,u=s.pop(),t.pop(),n=ow(a,u,o),s.push(n);i=Wn(),i.prec=r,s.push(i),t.push(Ze),n=n0(),s.push(n)}for(l=s.length-1,n=s[l],t.pop();l>1;)t.pop(),n=ow(s[l-1].value,s[l-2],n),l-=2;return n}function au(){var e,t,n;return e=ghe(),ft("?")&&(Wn(),t=au(),pn(":"),n=au(),e=the(e,t,n)),e}function H4(){const e=au();if(ft(","))throw new Error(Wf);return e}function mhe(e){ae=e,B=0,hn=ae.length,Ze=null,uD();const t=H4();if(Ze.type!==Pd)throw new Error("Unexpect token after expression.");return t}function Qv(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...Qv(e.object)),t.push(...Qv(e.property))),t)}function lD(e){return e.object.type==="MemberExpression"?lD(e.object):e.object.name==="datum"}function cD(e){const t=mhe(e),n=new Set;return t.visit(i=>{i.type==="MemberExpression"&&lD(i)&&n.add(Qv(i).slice(1).join("."))}),n}class Xl extends Je{clone(){return new Xl(null,this.model,Ce(this.filter))}constructor(t,n,i){super(t),this.model=n,this.filter=i,this.expr=Rp(this.model,this.filter,this),this._dependentFields=cD(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function yhe(e,t){const n={},i=e.config.selection;if(!t||!t.length)return n;let r=0;for(const s of t){const o=pt(s.name),a=s.select,u=le(a)?a:a.type,l=_e(a)?Ce(a):{type:u},c=i[u];for(const h in c)h==="fields"||h==="encodings"||(h==="mark"&&(l.mark={...c.mark,...l.mark}),(l[h]===void 0||l[h]===!0)&&(l[h]=Ce(c[h]??l[h])));const f=n[o]={...l,name:o,type:u,init:s.value,bind:s.bind,events:le(l.on)?ql(l.on,"scope"):ce(Ce(l.on))};if(Dr(f)&&(r++,r>1)){delete n[o];continue}const d=Ce(s);for(const h of S1)h.defined(f)&&h.parse&&h.parse(e,f,d)}return r>1&&Y(kae),n}function fD(e,t,n,i="datum"){const r=le(t)?t:t.param,s=pt(r),o=xe(s+su);let a;try{a=e.getSelectionComponent(s,r)}catch{return`!!${s}`}if(a.project.timeUnit){const d=n??e.component.data.raw,h=a.project.timeUnit.clone();d.parent?h.insertAsParentOf(d):d.parent=h}const u=a.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest(",l=a.resolve==="global"?")":`, ${xe(a.resolve)})`,c=`${u}${o}, ${i}${l}`,f=`length(data(${o}))`;return t.empty===!1?`${f} && ${c}`:`!${f} || ${c}`}function dD(e,t,n){const i=pt(t),r=n.encoding;let s=n.field,o;try{o=e.getSelectionComponent(i,t)}catch{return i}if(!r&&!s)s=o.project.items[0].field,o.project.items.length>1&&Y(Aae(s));else if(r&&!s){const a=o.project.items.filter(u=>u.channel===r);!a.length||a.length>1?(s=o.project.items[0].field,Y($ae(a,r,n,s))):s=a[0].field}return`${o.name}[${xe(Li(s))}]`}function vhe(e,t){for(const[n,i]of No(e.component.selection??{})){const r=e.getName(`lookup_${n}`);e.component.data.outputNodes[r]=i.materialized=new Zn(new Xl(t,e,{param:n}),r,vt.Lookup,e.component.data.outputNodeRefCounts)}}function Rp(e,t,n){return gf(t,i=>le(i)?i:Iue(i)?fD(e,i,n):mL(i))}function bhe(e,t){if(e)return V(e)&&!lo(e)?e.map(n=>_4(n,t)).join(", "):e}function xy(e,t,n,i){var r,s;e.encode??(e.encode={}),(r=e.encode)[t]??(r[t]={}),(s=e.encode[t]).update??(s.update={}),e.encode[t].update[n]=i}function Wc(e,t,n,i={header:!1}){var f,d;const{disable:r,orient:s,scale:o,labelExpr:a,title:u,zindex:l,...c}=e.combine();if(!r){for(const h in c){const p=h,g=jle[p],m=c[p];if(g&&g!==t&&g!=="both")delete c[p];else if(Od(m)){const{condition:y,...v}=m,b=ce(y),x=L7[p];if(x){const{vgProp:_,part:E}=x,w=[...b.map(S=>{const{test:$,...F}=S;return{test:Rp(null,$),...F}}),v];xy(c,E,_,w),delete c[p]}else if(x===null){const _={signal:b.map(E=>{const{test:w,...S}=E;return`${Rp(null,w)} ? ${m7(S)} : `}).join("")+m7(v)};c[p]=_}}else if(ue(m)){const y=L7[p];if(y){const{vgProp:v,part:b}=y;xy(c,b,v,m),delete c[p]}}Ne(["labelAlign","labelBaseline"],p)&&c[p]===null&&delete c[p]}if(t==="grid"){if(!c.grid)return;if(c.encode){const{grid:h}=c.encode;c.encode={...h?{grid:h}:{}},et(c.encode)&&delete c.encode}return{scale:o,orient:s,...c,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:At(l,0)}}else{if(!i.header&&e.mainExtracted)return;if(a!==void 0){let p=a;(d=(f=c.encode)==null?void 0:f.labels)!=null&&d.update&&ue(c.encode.labels.update.text)&&(p=Ka(a,"datum.label",c.encode.labels.update.text.signal)),xy(c,"labels","text",{signal:p})}if(c.labelAlign===null&&delete c.labelAlign,c.encode){for(const p of GL)e.hasAxisPart(p)||delete c.encode[p];et(c.encode)&&delete c.encode}const h=bhe(u,n);return{scale:o,orient:s,grid:!1,...h?{title:h}:{},...c,...n.aria===!1?{aria:!1}:{},zindex:At(l,0)}}}}function hD(e){const{axes:t}=e.component,n=[];for(const i of Xs)if(t[i]){for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const s=i==="x"?"height":"width",o=e.getSizeSignalRef(s).signal;s!==o&&n.push({name:s,update:o})}}return n}function xhe(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(r=>Wc(r,"grid",t)),...i.map(r=>Wc(r,"grid",t)),...n.map(r=>Wc(r,"main",t)),...i.map(r=>Wc(r,"main",t))].filter(r=>r)}function dw(e,t,n,i){return Object.assign.apply(null,[{},...e.map(r=>{if(r==="axisOrient"){const s=n==="x"?"bottom":"left",o=t[n==="x"?"axisBottom":"axisLeft"]||{},a=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...W(o),...W(a)]),l={};for(const c of u.values())l[c]={signal:`${i.signal} === "${s}" ? ${Gi(o[c])} : ${Gi(a[c])}`};return l}return t[r]})])}function _he(e,t,n,i){const r=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:xL(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],s=e==="x"?"axisX":"axisY",o=ue(n)?"axisOrient":`axis${Sd(n)}`,a=[...r,...r.map(l=>s+l.substr(4))],u=["axis",o,s];return{vlOnlyAxisConfig:dw(a,i,e,n),vgAxisConfig:dw(u,i,e,n),axisConfigStyle:whe([...u,...a],i)}}function whe(e,t){var i;const n=[{}];for(const r of e){let s=(i=t[r])==null?void 0:i.style;if(s){s=ce(s);for(const o of s)n.push(t.style[o])}}return Object.assign.apply(null,n)}function e3(e,t,n,i={}){var s;const r=YF(e,n,t);if(r!==void 0)return{configFrom:"style",configValue:r};for(const o of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((s=i[o])==null?void 0:s[e])!==void 0)return{configFrom:o,configValue:i[o][e]};return{}}const hw={scale:({model:e,channel:t})=>e.scaleName(t),format:({format:e})=>e,formatType:({formatType:e})=>e,grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>t.grid??Ehe(n,e),gridScale:({model:e,channel:t})=>Che(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||gD(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||pD(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>e.labelFlush??khe(t.type,n),labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>e.labelOverlap??Ahe(t.type,n,Z(t)&&!!t.timeUnit,Z(t)?t.sort:void 0),orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{const s=e==="x"?"width":e==="y"?"height":void 0,o=s?t.getSizeSignalRef(s):void 0;return n.tickCount??Mhe({fieldOrDatumDef:i,scaleType:r,size:o,values:n.values})},tickMinStep:The,title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const i=mD(t,n);if(i!==void 0)return i;const r=t.typedFieldDef(n),s=n==="x"?"x2":"y2",o=t.fieldDef(s);return XF(r?[T7(r)]:[],Z(o)?[T7(o)]:[])},values:({axis:e,fieldOrDatumDef:t})=>Fhe(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>e.zindex??Lhe(n,t)};function Ehe(e,t){return!qt(e)&&Z(t)&&!lt(t==null?void 0:t.bin)&&!Gt(t==null?void 0:t.bin)}function Che(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function She(e,t,n,i,r){const s=t==null?void 0:t.labelAngle;if(s!==void 0)return ue(s)?s:Hf(s);{const{configValue:o}=e3("labelAngle",i,t==null?void 0:t.style,r);return o!==void 0?Hf(o):n===gt&&Ne([l4,u4],e.type)&&!(Z(e)&&e.timeUnit)?270:void 0}}function t3(e){return`(((${e.signal} % 360) + 360) % 360)`}function pD(e,t,n,i){if(e!==void 0)if(n==="x"){if(ue(e)){const r=t3(e),s=ue(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${r} && ${r} < 135) || (225 < ${r} && ${r} < 315) ? "middle" :(${r} <= 45 || 315 <= ${r}) === ${s} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(ue(t)){const r=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${r} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(ue(e)){const r=t3(e),s=ue(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${r} <= 45 || 315 <= ${r} || (135 <= ${r} && ${r} <= 225) ? ${i?'"middle"':"null"} : (45 <= ${r} && ${r} <= 135) === ${s} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return i?"middle":null;if(ue(t)){const r=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${r} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function gD(e,t,n){if(e===void 0)return;const i=n==="x",r=i?0:90,s=i?"bottom":"left";if(ue(e)){const o=t3(e),a=ue(t)?`(${t.signal} === "${s}")`:t===s;return{signal:`(${r?`(${o} + 90)`:o} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${o} && ${o} < ${180+r}) === ${a} ? "left" : "right"`}}if((e+r)%180===0)return i?null:"center";if(ue(t)){const o=r<e&&e<180+r?"===":"!==";return{signal:`${`${t.signal} ${o} "${s}"`} ? "left" : "right"`}}return(r<e&&e<180+r)==(t===s)?"left":"right"}function khe(e,t){if(t==="x"&&Ne(["quantitative","temporal"],e))return!0}function Ahe(e,t,n,i){if(n&&!_e(i)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function $he(e){return e==="x"?"bottom":"left"}function Mhe({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){var r;if(!i&&!qt(t)&&t!=="log"){if(Z(e)){if(lt(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&Ne(["month","hours","day","quarter"],(r=jt(e.timeUnit))==null?void 0:r.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function The({format:e,fieldOrDatumDef:t}){if(e==="d")return 1;if(Z(t)){const{timeUnit:n}=t;if(n){const i=hL(n);if(i)return{signal:i}}}}function mD(e,t){const n=t==="x"?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),s=i?i.title:void 0,o=r?r.title:void 0;if(s&&o)return KF(s,o);if(s)return s;if(o)return o;if(s!==void 0)return s;if(o!==void 0)return o}function Fhe(e,t){const n=e.values;if(V(n))return WL(t,n);if(ue(n))return n}function Lhe(e,t){return e==="rect"&&Ap(t)?1:0}class Ml extends Je{clone(){return new Ml(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n,this._dependentFields=cD(this.transform.calculate)}static parseAllForSortIndex(t,n){return n.forEachFieldDef((i,r)=>{if(xu(i)&&OL(i.sort)){const{field:s,timeUnit:o}=i,a=i.sort,u=a.map((l,c)=>`${mL({field:s,timeUnit:o,equal:l})} ? ${c} : `).join("")+a.length;t=new Ml(t,{calculate:u,as:Tl(i,r,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${De(this.transform)}`}}function Tl(e,t,n){return ee(e,{prefix:t,suffix:"sort_index",...n})}function T1(e,t){return Ne(["top","bottom"],t)?"column":Ne(["left","right"],t)||e==="row"?"row":"column"}function Fl(e,t,n,i){const r=i==="row"?n.headerRow:i==="column"?n.headerColumn:n.headerFacet;return At((t||{})[e],r[e],n.header[e])}function F1(e,t,n,i){const r={};for(const s of e){const o=Fl(s,t||{},n,i);o!==void 0&&(r[s]=o)}return r}const q4=["row","column"],V4=["header","footer"];function Nhe(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:s,titleAngle:o,titleOrient:a}=F1(["titleAnchor","titleAngle","titleOrient"],r.header,i,t),u=T1(t,a),l=Hf(o);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:{text:n,...t==="row"?{orient:"left"}:{},style:"guide-title",...vD(l,u),...yD(u,l,s),...bD(i,r,t,cce,fN)}}}function yD(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=gD(t,e==="row"?"left":"top",e==="row"?"y":"x");return i?{align:i}:{}}function vD(e,t){const n=pD(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function Dhe(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of V4)if(n[r])for(const s of n[r]){const o=Ohe(e,t,r,n,s);o!=null&&i.push(o)}return i}function Rhe(e,t){const{sort:n}=e;return Ts(n)?{field:ee(n,{expr:"datum"}),order:n.order??"ascending"}:V(n)?{field:Tl(e,t,{expr:"datum"}),order:"ascending"}:{field:ee(e,{expr:"datum"}),order:n??"ascending"}}function n3(e,t,n){const{format:i,formatType:r,labelAngle:s,labelAnchor:o,labelOrient:a,labelExpr:u}=F1(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),l=y4({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,c=T1(t,a);return{text:{signal:u?Ka(Ka(u,"datum.label",l),"datum.value",ee(e,{expr:"parent"})):l},...t==="row"?{orient:"left"}:{},style:"guide-label",frame:"group",...vD(s,c),...yD(c,s,o),...bD(n,e,t,fce,dN)}}function Ohe(e,t,n,i,r){if(r){let s=null;const{facetFieldDef:o}=i,a=e.config?e.config:void 0;if(o&&r.labels){const{labelOrient:f}=F1(["labelOrient"],o.header,a,t);(t==="row"&&!Ne(["top","bottom"],f)||t==="column"&&!Ne(["left","right"],f))&&(s=n3(o,t,a))}const u=hi(e)&&!Ld(e.facet),l=r.axes,c=(l==null?void 0:l.length)>0;if(s||c){const f=t==="row"?"height":"width";return{name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`,...i.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:Rhe(o,t)}:{},...c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{},...s?{title:s}:{},...r.sizeSignal?{encode:{update:{[f]:r.sizeSignal}}}:{},...c?{axes:l}:{}}}}return null}const Ihe={column:{start:0,end:1},row:{start:1,end:0}};function Phe(e,t){return Ihe[t][e]}function zhe(e,t){const n={};for(const i of Si){const r=e[i];if(r!=null&&r.facetFieldDef){const{titleAnchor:s,titleOrient:o}=F1(["titleAnchor","titleOrient"],r.facetFieldDef.header,t,i),a=T1(i,o),u=Phe(s,a);u!==void 0&&(n[a]=u)}}return et(n)?void 0:n}function bD(e,t,n,i,r){const s={};for(const o of i){if(!r[o])continue;const a=Fl(o,t==null?void 0:t.header,e,n);a!==void 0&&(s[r[o]]=a)}return s}function W4(e){return[...Sh(e,"width"),...Sh(e,"height"),...Sh(e,"childWidth"),...Sh(e,"childHeight")]}function Sh(e,t){const n=t==="width"?"x":"y",i=e.component.layoutSize.get(t);if(!i||i==="merged")return[];const r=e.getSizeSignalRef(t).signal;if(i==="step"){const s=e.getScaleComponent(n);if(s){const o=s.get("type"),a=s.get("range");if(qt(o)&&yu(a)){const u=e.scaleName(n);return hi(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[pw(u,a)]:[pw(u,a),{name:r,update:xD(u,s,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(i=="container"){const s=r.endsWith("width"),o=s?"containerSize()[0]":"containerSize()[1]",a=Hv(e.config.view,s?"width":"height"),u=`isFinite(${o}) ? ${o} : ${a}`;return[{name:r,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:r,value:i}]}function pw(e,t){const n=`${e}_step`;return ue(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function xD(e,t,n){const i=t.get("type"),r=t.get("padding"),s=At(t.get("paddingOuter"),r);let o=t.get("paddingInner");return o=i==="band"?o!==void 0?o:r:1,`bandspace(${n}, ${Gi(o)}, ${Gi(s)}) * ${e}_step`}function _D(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function wD(e,t){return W(e).reduce((n,i)=>({...n,...Zl({model:t,channelDef:e[i],vgChannel:i,mainRefFn:r=>ct(r.value),invalidValueRef:void 0})}),{})}function ED(e,t){if(hi(t))return e==="theta"?"independent":"shared";if(Ql(t))return"shared";if(Q4(t))return $t(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function G4(e,t){const n=e.scale[t],i=$t(t)?"axis":"legend";return n==="independent"?(e[i][t]==="shared"&&Y(sue(t)),"independent"):e[i][t]||"shared"}const Bhe={...pce,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},CD=W(Bhe);class Uhe extends Js{}const gw={symbols:jhe,gradient:Hhe,labels:qhe,entries:Vhe};function jhe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:s}){if(s!=="symbol")return;const{markDef:o,encoding:a,config:u,mark:l}=n,c=o.filled&&l!=="trail";let f={...hae({},n,lle),...qN(n,{filled:c})};const d=r.get("symbolOpacity")??u.legend.symbolOpacity,h=r.get("symbolFillColor")??u.legend.symbolFillColor,p=r.get("symbolStrokeColor")??u.legend.symbolStrokeColor,g=d===void 0?SD(a.opacity)??o.opacity:void 0;if(f.fill){if(i==="fill"||c&&i===Kn)delete f.fill;else if(G(f.fill,"field"))h?delete f.fill:(f.fill=ct(u.legend.symbolBaseFillColor??"black"),f.fillOpacity=ct(g??1));else if(V(f.fill)){const m=i3(a.fill??a.color)??o.fill??(c&&o.color);m&&(f.fill=ct(m))}}if(f.stroke){if(i==="stroke"||!c&&i===Kn)delete f.stroke;else if(G(f.stroke,"field")||p)delete f.stroke;else if(V(f.stroke)){const m=At(i3(a.stroke||a.color),o.stroke,c?o.color:void 0);m&&(f.stroke={value:m})}}if(i!==Zs){const m=Z(t)&&AD(n,r,t);m?f.opacity=[{test:m,...ct(g??1)},ct(u.legend.unselectedOpacity)]:g&&(f.opacity=ct(g))}return f={...f,...e},et(f)?void 0:f}function Hhe(e,{model:t,legendType:n,legendCmpt:i}){if(n!=="gradient")return;const{config:r,markDef:s,encoding:o}=t;let a={};const l=(i.get("gradientOpacity")??r.legend.gradientOpacity)===void 0?SD(o.opacity)||s.opacity:void 0;return l&&(a.opacity=ct(l)),a={...a,...e},et(a)?void 0:a}function qhe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const s=n.legend(i)||{},o=n.config,a=Z(t)?AD(n,r,t):void 0,u=a?[{test:a,value:1},{value:o.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=s;let f;iu(c)?f=Yi({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:o}):l===void 0&&c===void 0&&o.customFormatTypes&&(t.type==="quantitative"&&o.numberFormatType?f=Yi({fieldOrDatumDef:t,field:"datum.value",format:o.numberFormat,formatType:o.numberFormatType,config:o}):t.type==="temporal"&&o.timeFormatType&&Z(t)&&t.timeUnit===void 0&&(f=Yi({fieldOrDatumDef:t,field:"datum.value",format:o.timeFormat,formatType:o.timeFormatType,config:o})));const d={...u?{opacity:u}:{},...f?{text:f}:{},...e};return et(d)?void 0:d}function Vhe(e,{legendCmpt:t}){const n=t.get("selections");return n!=null&&n.length?{...e,fill:{value:"transparent"}}:e}function SD(e){return kD(e,(t,n)=>Math.max(t,n.value))}function i3(e){return kD(e,(t,n)=>At(t,n.value))}function kD(e,t){if(Tle(e))return ce(e.condition).reduce(t,e.value);if(nr(e))return e.value}function AD(e,t,n){const i=t.get("selections");if(!(i!=null&&i.length))return;const r=xe(n.field);return i.map(s=>`(!length(data(${xe(pt(s)+su)})) || (${s}[${r}] && indexof(${s}[${r}], datum.value) >= 0))`).join(" || ")}const mw={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return NL(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return DL(i,t,n)},gradientLength:e=>{const{legend:t,legendConfig:n}=e;return t.gradientLength??n.gradientLength??Jhe(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>e.labelOverlap??t.labelOverlap??Qhe(n),symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>e.symbolType??Ghe(t.type,n,i.shape,t.shape),title:({fieldOrDatumDef:e,config:t})=>Ku(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(Xu(n)&&$r(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>Whe(t,e)};function Whe(e,t){const n=e.values;if(V(n))return WL(t,n);if(ue(n))return n}function Ghe(e,t,n,i){if(t!=="shape"){const r=i3(n)??i;if(r)return r}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function Yhe(e){const{legend:t}=e;return At(t.type,Zhe(e))}function Zhe({channel:e,timeUnit:t,scaleType:n}){if(Xu(e)){if(Ne(["quarter","month","day"],t))return"symbol";if($r(n))return"gradient"}return"symbol"}function Xhe({legendConfig:e,legendType:t,orient:n,legend:i}){return i.direction??e[t?"gradientDirection":"symbolDirection"]??Khe(n,t)}function Khe(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function Jhe({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:s,gradientHorizontalMinLength:o,gradientVerticalMaxLength:a,gradientVerticalMinLength:u}=e;if($r(r))return n==="horizontal"?i==="top"||i==="bottom"?yw(t,"width",o,s):o:yw(t,"height",u,a)}function yw(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function Qhe(e){if(Ne(["quantile","threshold","log","symlog"],e))return"greedy"}function $D(e){const t=yt(e)?e0e(e):r0e(e);return e.component.legends=t,t}function e0e(e){const{encoding:t}=e,n={};for(const i of[Kn,...pN]){const r=Lt(t[i]);!r||!e.getScaleComponent(i)||i===Jn&&Z(r)&&r.type===Yl||(n[i]=i0e(e,i))}return n}function t0e(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function n0e(e,t,n,i){switch(t){case"disable":return n!==void 0;case"values":return!!(n!=null&&n.values);case"title":if(t==="title"&&e===(i==null?void 0:i.title))return!0}return e===(n||{})[t]}function i0e(e,t){var x;let n=e.legend(t);const{markDef:i,encoding:r,config:s}=e,o=s.legend,a=new Uhe({},t0e(e,t));ide(e,t,a);const u=n!==void 0?!n:o.disable;if(a.set("disable",u,n!==void 0),u)return a;n=n||{};const l=e.getScaleComponent(t).get("type"),c=Lt(r[t]),f=Z(c)?(x=jt(c.timeUnit))==null?void 0:x.unit:void 0,d=n.orient||s.legend.orient||"right",h=Yhe({legend:n,channel:t,timeUnit:f,scaleType:l}),p=Xhe({legend:n,legendType:h,orient:d,legendConfig:o}),g={legend:n,channel:t,model:e,markDef:i,encoding:r,fieldOrDatumDef:c,legendConfig:o,config:s,scaleType:l,orient:d,legendType:h,direction:p};for(const _ of CD){if(h==="gradient"&&_.startsWith("symbol")||h==="symbol"&&_.startsWith("gradient"))continue;const E=_ in mw?mw[_](g):n[_];if(E!==void 0){const w=n0e(E,_,n,e.fieldDef(t));(w||s.legend[_]===void 0)&&a.set(_,E,w)}}const m=(n==null?void 0:n.encoding)??{},y=a.get("selections"),v={},b={fieldOrDatumDef:c,model:e,channel:t,legendCmpt:a,legendType:h};for(const _ of["labels","legend","title","symbols","gradient","entries"]){const E=wD(m[_]??{},e),w=_ in gw?gw[_](E,b):E;w!==void 0&&!et(w)&&(v[_]={...y!=null&&y.length&&Z(c)?{name:`${pt(c.field)}_legend_${_}`}:{},...y!=null&&y.length?{interactive:!!y}:{},update:w})}return et(v)||a.set("encode",v,!!(n!=null&&n.encoding)),a}function r0e(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){$D(i);for(const r of W(i.component.legends))n.legend[r]=G4(e.component.resolve,r),n.legend[r]==="shared"&&(t[r]=MD(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))}for(const i of W(t))for(const r of e.children)r.component.legends[i]&&n.legend[i]==="shared"&&delete r.component.legends[i];return t}function MD(e,t){var s,o,a,u;if(!e)return t.clone();const n=e.getWithExplicit("orient"),i=t.getWithExplicit("orient");if(n.explicit&&i.explicit&&n.value!==i.value)return;let r=!1;for(const l of CD){const c=Oo(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return s0e(f,d);case"title":return JF(f,d);case"type":return r=!0,ii("symbol")}return _1(f,d,l,"legend")});e.setWithExplicit(l,c)}return r&&((o=(s=e.implicit)==null?void 0:s.encode)!=null&&o.gradient&&wp(e.implicit,["encode","gradient"]),(u=(a=e.explicit)==null?void 0:a.encode)!=null&&u.gradient&&wp(e.explicit,["encode","gradient"])),e}function s0e(e,t){return t.value==="circle"?t:e}function o0e(e,t,n,i){var r,s;e.encode??(e.encode={}),(r=e.encode)[t]??(r[t]={}),(s=e.encode[t]).update??(s.update={}),e.encode[t].update[n]=i}function TD(e){const t=e.component.legends,n={};for(const r of W(t)){const s=e.getScaleComponent(r),o=tt(s.get("domains"));if(n[o])for(const a of n[o])MD(a,t[r])||n[o].push(t[r]);else n[o]=[t[r].clone()]}return Qt(n).flat().map(r=>a0e(r,e.config)).filter(r=>r!==void 0)}function a0e(e,t){var o,a,u;const{disable:n,labelExpr:i,selections:r,...s}=e.combine();if(!n){if(t.aria===!1&&s.aria==null&&(s.aria=!1),(o=s.encode)!=null&&o.symbols){const l=s.encode.symbols.update;l.fill&&l.fill.value!=="transparent"&&!l.stroke&&!s.stroke&&(l.stroke={value:"transparent"});for(const c of pN)s[c]&&delete l[c]}if(s.title||delete s.title,i!==void 0){let l=i;(u=(a=s.encode)==null?void 0:a.labels)!=null&&u.update&&ue(s.encode.labels.update.text)&&(l=Ka(i,"datum.label",s.encode.labels.update.text.signal)),o0e(s,"labels","text",{signal:l})}return s}}function u0e(e){return Ql(e)||Q4(e)?l0e(e):FD(e)}function l0e(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),FD(e))}function FD(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(o=>o.signal).join(", ")}]`},s=t.data.reduce((o,a)=>{const u=ue(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return Ne(o,u)||o.push(u),o},[]);if(s.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:i,size:r,fit:{signal:s.length>1?`[${s.join(", ")}]`:s[0]},...n}]}else return[{name:i,translate:{signal:"[width / 2, height / 2]"},...n}]}const c0e=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class LD extends Js{constructor(t,n,i,r){super({...n},{name:t}),this.specifiedProjection=n,this.size=i,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function ND(e){e.component.projection=yt(e)?f0e(e):p0e(e)}function f0e(e){if(e.hasProjection){const t=Yt(e.specifiedProjection),n=!(t&&(t.scale!=null||t.translate!=null)),i=n?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,r=n?d0e(e):void 0,s=new LD(e.projectionName(!0),{...Yt(e.config.projection),...t},i,r);return s.get("type")||s.set("type","equalEarth",!1),s}}function d0e(e){const t=[],{encoding:n}=e;for(const i of[[lr,ur],[Ni,cr]])(Lt(n[i[0]])||Lt(n[i[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(Jn)&&e.typedFieldDef(Jn).type===Yl&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(vt.Main)),t}function h0e(e,t){const n=Rx(c0e,r=>!!(!pe(e.explicit,r)&&!pe(t.explicit,r)||pe(e.explicit,r)&&pe(t.explicit,r)&&ci(e.get(r),t.get(r))));if(ci(e.size,t.size)){if(n)return e;if(ci(e.explicit,{}))return t;if(ci(t.explicit,{}))return e}return null}function p0e(e){if(e.children.length===0)return;let t;for(const i of e.children)ND(i);const n=Rx(e.children,i=>{const r=i.component.projection;if(r)if(t){const s=h0e(t,r);return s&&(t=s),!!s}else return t=r,!0;else return!0});if(t&&n){const i=e.projectionName(!0),r=new LD(i,t.specifiedProjection,t.size,Ce(t.data));for(const s of e.children){const o=s.component.projection;o&&(o.isFit&&r.data.push(...s.component.projection.data),s.renameProjection(o.get("name"),i),o.merged=!0)}return r}}function g0e(e,t,n,i){if(Rd(t,n)){const r=yt(e)?e.axis(n)??e.legend(n)??{}:{},s=ee(t,{expr:"datum"}),o=ee(t,{expr:"datum",binSuffix:"end"});return{formulaAs:ee(t,{binSuffix:"range",forAs:!0}),formula:Fd(s,o,r.format,r.formatType,i)}}return{}}function DD(e,t){return`${qF(e)}_${t}`}function m0e(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function Y4(e,t,n){const i=g1(n,void 0)??{},r=DD(i,t);return e.getName(`${r}_bins`)}function y0e(e){return"as"in e}function vw(e,t,n){let i,r;y0e(e)?i=le(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:i=[ee(e,{forAs:!0}),ee(e,{binSuffix:"end",forAs:!0})];const s={...g1(t,void 0)},o=DD(s,e.field),{signal:a,extentSignal:u}=m0e(n,o);if(r1(s.extent)){const c=s.extent;r=dD(n,c.param,c),delete s.extent}const l={bin:s,field:e.field,as:[i],...a?{signal:a}:{},...u?{extentSignal:u}:{},...r?{span:r}:{}};return{key:o,binComponent:l}}class Rr extends Je{clone(){return new Rr(null,Ce(this.bins))}constructor(t,n){super(t),this.bins=n}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s,o)=>{if(zn(s)&&lt(s.bin)){const{key:a,binComponent:u}=vw(s,s.bin,n);r[a]={...u,...r[a],...g0e(n,s,o,n.config)}}return r},{});return et(i)?null:new Rr(t,i)}static makeFromTransform(t,n,i){const{key:r,binComponent:s}=vw(n,n.bin,i);return new Rr(t,{[r]:s})}merge(t,n){for(const i of W(t.bins))i in this.bins?(n(t.bins[i].signal,this.bins[i].signal),this.bins[i].as=Ar([...this.bins[i].as,...t.bins[i].as],De)):this.bins[i]=t.bins[i];for(const i of t.children)t.removeChild(i),i.parent=this;t.remove()}producedFields(){return new Set(Qt(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(Qt(this.bins).map(t=>t.field))}hash(){return`Bin ${De(this.bins)}`}assemble(){return Qt(this.bins).flatMap(t=>{const n=[],[i,...r]=t.as,{extent:s,...o}=t.bin,a={type:"bin",field:Li(t.field),as:i,signal:t.signal,...r1(s)?{extent:null}:{extent:s},...t.span?{span:{signal:`span(${t.span})`}}:{},...o};!s&&t.extentSignal&&(n.push({type:"extent",field:Li(t.field),signal:t.extentSignal}),a.extent={signal:t.extentSignal}),n.push(a);for(const u of r)for(let l=0;l<2;l++)n.push({type:"formula",expr:ee({field:i[l]},{expr:"datum"}),as:u[l]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function v0e(e,t,n,i){var s;const r=yt(i)?i.encoding[ts(t)]:void 0;if(zn(n)&&yt(i)&&PL(n,r,i.markDef,i.config)){e.add(ee(n,{})),e.add(ee(n,{suffix:"end"}));const{mark:o,markDef:a,config:u}=i,l=Ro({fieldDef:n,markDef:a,config:u});qf(o)&&l!==.5&&$t(t)&&(e.add(ee(n,{suffix:w1})),e.add(ee(n,{suffix:E1}))),n.bin&&Rd(n,t)&&e.add(ee(n,{binSuffix:"range"}))}else if(RF(t)){const o=DF(t);e.add(i.getName(o))}else e.add(ee(n));return xu(n)&&Xue((s=n.scale)==null?void 0:s.range)&&e.add(n.scale.range.field),e}function b0e(e,t){for(const n of W(t)){const i=t[n];for(const r of W(i))n in e?e[n][r]=new Set([...e[n][r]??[],...i[r]]):e[n]={[r]:i[r]}}}class Ki extends Je{clone(){return new Ki(null,new Set(this.dimensions),Ce(this.measures))}constructor(t,n,i){super(t),this.dimensions=n,this.measures=i}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let i=!1;n.forEachFieldDef(o=>{o.aggregate&&(i=!0)});const r={},s=new Set;return!i||(n.forEachFieldDef((o,a)=>{const{aggregate:u,field:l}=o;if(u)if(u==="count")r["*"]??(r["*"]={}),r["*"].count=new Set([ee(o,{forAs:!0})]);else{if(Bs(u)||Qo(u)){const c=Bs(u)?"argmin":"argmax",f=u[c];r[f]??(r[f]={}),r[f][c]=new Set([ee({op:c,field:f},{forAs:!0})])}else r[l]??(r[l]={}),r[l][u]=new Set([ee(o,{forAs:!0})]);ns(a)&&n.scaleDomain(a)==="unaggregated"&&(r[l]??(r[l]={}),r[l].min=new Set([ee({field:l,aggregate:"min"},{forAs:!0})]),r[l].max=new Set([ee({field:l,aggregate:"max"},{forAs:!0})]))}else v0e(s,a,o,n)}),s.size+W(r).length===0)?null:new Ki(t,s,r)}static makeFromTransform(t,n){var i;const r=new Set,s={};for(const o of n.aggregate){const{op:a,field:u,as:l}=o;a&&(a==="count"?(s["*"]??(s["*"]={}),s["*"].count=new Set([l||ee(o,{forAs:!0})])):(s[u]??(s[u]={}),(i=s[u])[a]??(i[a]=new Set),s[u][a].add(l||ee(o,{forAs:!0}))))}for(const o of n.groupby??[])r.add(o);return r.size+W(s).length===0?null:new Ki(t,r,s)}merge(t){return kF(this.dimensions,t.dimensions)?(b0e(this.measures,t.measures),!0):(_ue("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...W(this.measures)])}producedFields(){const t=new Set;for(const n of W(this.measures))for(const i of W(this.measures[n])){const r=this.measures[n][i];r.size===0?t.add(`${i}_${n}`):r.forEach(t.add,t)}return t}hash(){return`Aggregate ${De({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],i=[];for(const s of W(this.measures))for(const o of W(this.measures[s]))for(const a of this.measures[s][o])i.push(a),t.push(o),n.push(s==="*"?null:Li(s));return{type:"aggregate",groupby:[...this.dimensions].map(Li),ops:t,fields:n,as:i}}}class Kl extends Je{constructor(t,n,i,r){super(t),this.model=n,this.name=i,this.data=r;for(const s of Si){const o=n.facet[s];if(o){const{bin:a,sort:u}=o;this[s]={name:n.getName(`${s}_domain`),fields:[ee(o),...lt(a)?[ee(o,{binSuffix:"end"})]:[]],...Ts(u)?{sortField:u}:V(u)?{sortIndexField:Tl(o,s)}:{}}}}this.childModel=n.child}hash(){let t="Facet";for(const n of Si)this[n]&&(t+=` ${n.charAt(0)}:${De(this[n])}`);return t}get fields(){var n;const t=[];for(const i of Si)(n=this[i])!=null&&n.fields&&t.push(...this[i].fields);return t}dependentFields(){const t=new Set(this.fields);for(const n of Si)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Xs){const i=this.childModel.component.scales[n];if(i&&!i.merged){const r=i.get("type"),s=i.get("range");if(qt(r)&&yu(s)){const o=L1(this.childModel,n),a=J4(o);a?t[n]=a:Y(Zx(n))}}}return t}assembleRowColumnHeaderData(t,n,i){const r={row:"y",column:"x",facet:void 0}[t],s=[],o=[],a=[];r&&i&&i[r]&&(n?(s.push(`distinct_${i[r]}`),o.push("max")):(s.push(i[r]),o.push("distinct")),a.push(`distinct_${i[r]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=d1,field:f}=u;s.push(f),o.push(c),a.push(ee(u,{forAs:!0}))}else l&&(s.push(l),o.push("max"),a.push(l));return{name:this[t].name,source:n??this.data,transform:[{type:"aggregate",groupby:this[t].fields,...s.length?{fields:s,ops:o,as:a}:{}}]}}assembleFacetHeaderData(t){var u;const{columns:n}=this.model.layout,{layoutHeaders:i}=this.model.component,r=[],s={};for(const l of q4){for(const c of V4){const f=(i[l]&&i[l][c])??[];for(const d of f)if(((u=d.axes)==null?void 0:u.length)>0){s[l]=!0;break}}if(s[l]){const c=`length(data("${this.facet.name}"))`,f=l==="row"?n?{signal:`ceil(${c} / ${n})`}:1:n?{signal:`min(${c}, ${n})`}:{signal:c};r.push({name:`${this.facet.name}_${l}`,transform:[{type:"sequence",start:0,stop:f}]})}}const{row:o,column:a}=s;return(o||a)&&r.unshift(this.assembleRowColumnHeaderData("facet",null,t)),r}assemble(){const t=[];let n=null;const i=this.getChildIndependentFieldsWithStep(),{column:r,row:s,facet:o}=this;if(r&&s&&(i.x||i.y)){n=`cross_${this.column.name}_${this.row.name}`;const a=[].concat(i.x??[],i.y??[]),u=a.map(()=>"distinct");t.push({name:n,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:a,ops:u}]})}for(const a of[Ms,$s])this[a]&&t.push(this.assembleRowColumnHeaderData(a,n,i));if(o){const a=this.assembleFacetHeaderData(i);a&&t.push(...a)}return t}}function bw(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function x0e(e,t){const n=Px(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const i=bw(t.slice(5,t.length));return`timeParse(${n},'${i}')`}else if(t.startsWith("utc:")){const i=bw(t.slice(4,t.length));return`utcParse(${n},'${i}')`}else return Y(Tae(t)),null}function _0e(e){const t={};return e0(e.filter,n=>{if(gL(n)){let i=null;t4(n)?i=oi(n.equal):i4(n)?i=oi(n.lte):n4(n)?i=oi(n.lt):r4(n)?i=oi(n.gt):s4(n)?i=oi(n.gte):o4(n)?i=n.range[0]:a4(n)&&(i=(n.oneOf??n.in)[0]),i&&(vu(i)?t[n.field]="date":Ke(i)?t[n.field]="number":le(i)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function w0e(e){const t={};function n(i){kl(i)?t[i.field]="date":i.type==="quantitative"&&rae(i.aggregate)?t[i.field]="number":xl(i.field)>1?i.field in t||(t[i.field]="flatten"):xu(i)&&Ts(i.sort)&&xl(i.sort.field)>1&&(i.sort.field in t||(t[i.sort.field]="flatten"))}if((yt(e)||hi(e))&&e.forEachFieldDef((i,r)=>{if(zn(i))n(i);else{const s=gu(r),o=e.fieldDef(s);n({...i,type:o.type})}}),yt(e)){const{mark:i,markDef:r,encoding:s}=e;if(ea(i)&&!e.encoding.order){const o=r.orient==="horizontal"?"y":"x",a=s[o];Z(a)&&a.type==="quantitative"&&!(a.field in t)&&(t[a.field]="number")}}return t}function E0e(e){const t={};if(yt(e)&&e.component.selection)for(const n of W(e.component.selection)){const i=e.component.selection[n];for(const r of i.project.items)!r.channel&&xl(r.field)>1&&(t[r.field]="flatten")}return t}class fn extends Je{clone(){return new fn(null,Ce(this._parse))}constructor(t,n){super(t),this._parse=n}hash(){return`Parse ${De(this._parse)}`}static makeExplicit(t,n,i){var o;let r={};const s=n.data;return!Eo(s)&&((o=s==null?void 0:s.format)!=null&&o.parse)&&(r=s.format.parse),this.makeWithAncestors(t,r,{},i)}static makeWithAncestors(t,n,i,r){for(const a of W(i)){const u=r.getWithExplicit(a);u.value!==void 0&&(u.explicit||u.value===i[a]||u.value==="derived"||i[a]==="flatten"?delete i[a]:Y(w7(a,i[a],u.value)))}for(const a of W(n)){const u=r.get(a);u!==void 0&&(u===n[a]?delete n[a]:Y(w7(a,n[a],u)))}const s=new Js(n,i);r.copyAll(s);const o={};for(const a of W(s.combine())){const u=s.get(a);u!==null&&(o[a]=u)}return W(o).length===0||r.parseNothing?null:new fn(t,o)}get parse(){return this._parse}merge(t){this._parse={...this._parse,...t.parse},t.remove()}assembleFormatParse(){const t={};for(const n of W(this._parse)){const i=this._parse[n];xl(n)===1&&(t[n]=i)}return t}producedFields(){return new Set(W(this._parse))}dependentFields(){return new Set(W(this._parse))}assembleTransforms(t=!1){return W(this._parse).filter(n=>t?xl(n)>1:!0).map(n=>{const i=x0e(n,this._parse[n]);return i?{type:"formula",expr:i,as:Vl(n)}:null}).filter(n=>n!==null)}}class Io extends Je{clone(){return new Io(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([rr])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:rr}}}class Ud extends Je{clone(){return new Ud(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${De(this.params)}`}assemble(){return{type:"graticule",...this.params===!0?{}:this.params}}}class jd extends Je{clone(){return new jd(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${De(this.params)}`}assemble(){return{type:"sequence",...this.params}}}class uu extends Je{constructor(t){super(null),t??(t={name:"source"});let n;if(Eo(t)||(n=t.format?{...Yn(t.format,["parse"])}:{}),Vf(t))this._data={values:t.values};else if(Al(t)){if(this._data={url:t.url},!n.type){let i=/(?:\.([^.]+))?$/.exec(t.url)[1];Ne(["json","csv","tsv","dsv","topojson"],i)||(i="json"),n.type=i}}else LN(t)?this._data={values:[{type:"Sphere"}]}:(TN(t)||Eo(t))&&(this._data={});this._generator=Eo(t),t.name&&(this._name=t.name),n&&!et(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}var xw=function(e,t,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(e,n):r?r.value=n:t.set(e,n),n},C0e=function(e,t,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(e):i?i.value:t.get(e)},Gc;function Z4(e){return e instanceof uu||e instanceof Ud||e instanceof jd}class X4{constructor(){Gc.set(this,void 0),xw(this,Gc,!1,"f")}setModified(){xw(this,Gc,!0,"f")}get modifiedFlag(){return C0e(this,Gc,"f")}}Gc=new WeakMap;class wu extends X4{getNodeDepths(t,n,i){i.set(t,n);for(const r of t.children)this.getNodeDepths(r,n+1,i);return i}optimize(t){const i=[...this.getNodeDepths(t,0,new Map).entries()].sort((r,s)=>s[1]-r[1]);for(const r of i)this.run(r[0]);return this.modifiedFlag}}class K4 extends X4{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class S0e extends K4{mergeNodes(t,n){const i=n.shift();for(const r of n)t.removeChild(r),r.parent=i,r.remove()}run(t){const n=t.children.map(r=>r.hash()),i={};for(let r=0;r<n.length;r++)i[n[r]]===void 0?i[n[r]]=[t.children[r]]:i[n[r]].push(t.children[r]);for(const r of W(i))i[r].length>1&&(this.setModified(),this.mergeNodes(t,i[r]))}}class k0e extends K4{constructor(t){super(),this.requiresSelectionId=t&&B4(t)}run(t){t instanceof Io&&(this.requiresSelectionId&&(Z4(t.parent)||t.parent instanceof Ki||t.parent instanceof fn)||(this.setModified(),t.remove()))}}class A0e extends X4{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let i=new Set;t instanceof Nr&&(i=t.producedFields(),Ox(i,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const r of t.children)this.run(r,new Set([...n,...i]))}}class $0e extends K4{constructor(){super()}run(t){t instanceof Zn&&!t.isRequired()&&(this.setModified(),t.remove())}}class M0e extends wu{run(t){if(!Z4(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof fn)if(t instanceof fn)this.setModified(),t.merge(n);else{if(Ix(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class T0e extends wu{run(t){const n=[...t.children],i=t.children.filter(r=>r instanceof fn);if(t.numChildren()>1&&i.length>=1){const r={},s=new Set;for(const o of i){const a=o.parse;for(const u of W(a))u in r?r[u]!==a[u]&&s.add(u):r[u]=a[u]}for(const o of s)delete r[o];if(!et(r)){this.setModified();const o=new fn(t,r);for(const a of n){if(a instanceof fn)for(const u of W(r))delete a.parse[u];t.removeChild(a),a.parent=o,a instanceof fn&&W(a.parse).length===0&&a.remove()}}}}}class F0e extends wu{run(t){t instanceof Zn||t.numChildren()>0||t instanceof Kl||t instanceof uu||(this.setModified(),t.remove())}}class L0e extends wu{run(t){const n=t.children.filter(r=>r instanceof Nr),i=n.pop();for(const r of n)this.setModified(),i.merge(r)}}class N0e extends wu{run(t){const n=t.children.filter(r=>r instanceof Ki),i={};for(const r of n){const s=De(r.groupBy);s in i||(i[s]=[]),i[s].push(r)}for(const r of W(i)){const s=i[r];if(s.length>1){const o=s.pop();for(const a of s)o.merge(a)&&(t.removeChild(a),a.parent=o,a.remove(),this.setModified())}}}}class D0e extends wu{constructor(t){super(),this.model=t}run(t){const n=!(Z4(t)||t instanceof Xl||t instanceof fn||t instanceof Io),i=[],r=[];for(const s of t.children)s instanceof Rr&&(n&&!Ix(t.producedFields(),s.dependentFields())?i.push(s):r.push(s));if(i.length>0){const s=i.pop();for(const o of i)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof Rr?t.merge(s,this.model.renameSignal.bind(this.model)):s.swapWithParent()}if(r.length>1){const s=r.pop();for(const o of r)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified()}}}class R0e extends wu{run(t){const n=[...t.children];if(!bl(n,o=>o instanceof Zn)||t.numChildren()<=1)return;const r=[];let s;for(const o of n)if(o instanceof Zn){let a=o;for(;a.numChildren()===1;){const[u]=a.children;if(u instanceof Zn)a=u;else break}r.push(...a.children),s?(t.removeChild(o),o.parent=s.parent,s.parent.removeChild(s),s.parent=a,this.setModified()):s=a}else r.push(o);if(r.length){this.setModified();for(const o of r)o.parent.removeChild(o),o.parent=s}}}class Eu extends Je{clone(){return new Eu(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=Ar(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){return t.as??ee(t)}hash(){return`JoinAggregateTransform ${De(this.transform)}`}assemble(){const t=[],n=[],i=[];for(const s of this.transform.joinaggregate)n.push(s.op),i.push(this.getDefaultName(s)),t.push(s.field===void 0?null:s.field);const r=this.transform.groupby;return{type:"joinaggregate",as:i,ops:n,fields:t,...r!==void 0?{groupby:r}:{}}}}class Ll extends Je{clone(){return new Ll(null,{...this.filter})}constructor(t,n){super(t),this.filter=n}static make(t,n,i){const{config:r,markDef:s}=n,{marks:o,scales:a}=i;if(o==="include-invalid-values"&&a==="include-invalid-values")return null;const u=n.reduceFieldDef((l,c,f)=>{const d=ns(f)&&n.getScaleComponent(f);if(d){const h=d.get("type"),{aggregate:p}=c,g=p4({scaleChannel:f,markDef:s,config:r,scaleType:h,isCountAggregate:i1(p)});g!=="show"&&g!=="always-valid"&&(l[c.field]=c)}return l},{});return W(u).length?new Ll(t,u):null}dependentFields(){return new Set(W(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${De(this.filter)}`}assemble(){const t=W(this.filter).reduce((n,i)=>{const r=this.filter[i],s=ee(r,{expr:"datum"});return r!==null&&(r.type==="temporal"?n.push(`(isDate(${s}) || (${r3(s)}))`):r.type==="quantitative"&&n.push(r3(s))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}function r3(e){return`isValid(${e}) && isFinite(+${e})`}function O0e(e){return e.stack.stackBy.reduce((t,n)=>{const i=n.fieldDef,r=ee(i);return r&&t.push(r),t},[])}function I0e(e){return V(e)&&e.every(t=>le(t))&&e.length>1}class Ls extends Je{clone(){return new Ls(null,Ce(this._stack))}constructor(t,n){super(t),this._stack=n}static makeFromTransform(t,n){const{stack:i,groupby:r,as:s,offset:o="zero"}=n,a=[],u=[];if(n.sort!==void 0)for(const f of n.sort)a.push(f.field),u.push(At(f.order,"ascending"));const l={field:a,order:u};let c;return I0e(s)?c=s:le(s)?c=[s,`${s}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new Ls(t,{dimensionFieldDefs:[],stackField:i,groupby:r,offset:o,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const i=n.stack,{encoding:r}=n;if(!i)return null;const{groupbyChannels:s,fieldChannel:o,offset:a,impute:u}=i,l=s.map(h=>{const p=r[h];return ir(p)}).filter(h=>!!h),c=O0e(n),f=n.encoding.order;let d;if(V(f)||Z(f))d=ZF(f);else{const h=zL(f)?f.sort:o==="y"?"descending":"ascending";d=c.reduce((p,g)=>(p.field.includes(g)||(p.field.push(g),p.order.push(h)),p),{field:[],order:[]})}return new Ls(t,{dimensionFieldDefs:l,stackField:n.vgField(o),facetby:[],stackby:c,sort:d,offset:a,impute:u,as:[n.vgField(o,{suffix:"start",forAs:!0}),n.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${De(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:t,impute:n,groupby:i}=this._stack;return t.length>0?t.map(r=>r.bin?n?[ee(r,{binSuffix:"mid"})]:[ee(r,{}),ee(r,{binSuffix:"end"})]:[ee(r)]).flat():i??[]}assemble(){const t=[],{facetby:n,dimensionFieldDefs:i,stackField:r,stackby:s,sort:o,offset:a,impute:u,as:l}=this._stack;if(u)for(const c of i){const{bandPosition:f=.5,bin:d}=c;if(d){const h=ee(c,{expr:"datum"}),p=ee(c,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${r3(h)} ? ${f}*${h}+${1-f}*${p} : ${h}`,as:ee(c,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:r,groupby:[...s,...n],key:ee(c,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:r,sort:o,as:l,offset:a}),t}}class Jl extends Je{clone(){return new Jl(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=Ar(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return(this.transform.groupby??[]).forEach(t.add,t),(this.transform.sort??[]).forEach(n=>t.add(n.field)),this.transform.window.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){return t.as??ee(t)}hash(){return`WindowTransform ${De(this.transform)}`}assemble(){const t=[],n=[],i=[],r=[];for(const f of this.transform.window)n.push(f.op),i.push(this.getDefaultName(f)),r.push(f.param===void 0?null:f.param),t.push(f.field===void 0?null:f.field);const s=this.transform.frame,o=this.transform.groupby;if(s&&s[0]===null&&s[1]===null&&n.every(f=>Gx(f)))return{type:"joinaggregate",as:i,ops:n,fields:t,...o!==void 0?{groupby:o}:{}};const a=[],u=[];if(this.transform.sort!==void 0)for(const f of this.transform.sort)a.push(f.field),u.push(f.order??"ascending");const l={field:a,order:u},c=this.transform.ignorePeers;return{type:"window",params:r,as:i,ops:n,fields:t,sort:l,...c!==void 0?{ignorePeers:c}:{},...o!==void 0?{groupby:o}:{},...s!==void 0?{frame:s}:{}}}}function P0e(e){function t(n){if(!(n instanceof Kl)){const i=n.clone();if(i instanceof Zn){const r=o3+i.getSource();i.setSource(r),e.model.component.data.outputNodes[r]=i}else(i instanceof Ki||i instanceof Ls||i instanceof Jl||i instanceof Eu)&&i.addDimensions(e.fields);for(const r of n.children.flatMap(t))r.parent=i;return[i]}return n.children.flatMap(t)}return t}function s3(e){if(e instanceof Kl)if(e.numChildren()===1&&!(e.children[0]instanceof Zn)){const t=e.children[0];(t instanceof Ki||t instanceof Ls||t instanceof Jl||t instanceof Eu)&&t.addDimensions(e.fields),t.swapWithParent(),s3(e)}else{const t=e.model.component.data.main;RD(t);const n=P0e(e),i=e.children.map(n).flat();for(const r of i)r.parent=t}else e.children.map(s3)}function RD(e){if(e instanceof Zn&&e.type===vt.Main&&e.numChildren()===1){const t=e.children[0];t instanceof Kl||(t.swapWithParent(),RD(e))}}const o3="scale_",kh=5;function a3(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!a3(t.children))return!1}return!0}function Ii(e,t){let n=!1;for(const i of t)n=e.optimize(i)||n;return n}function _w(e,t,n){let i=e.sources,r=!1;return r=Ii(new $0e,i)||r,r=Ii(new k0e(t),i)||r,i=i.filter(s=>s.numChildren()>0),r=Ii(new F0e,i)||r,i=i.filter(s=>s.numChildren()>0),n||(r=Ii(new M0e,i)||r,r=Ii(new D0e(t),i)||r,r=Ii(new A0e,i)||r,r=Ii(new T0e,i)||r,r=Ii(new N0e,i)||r,r=Ii(new L0e,i)||r,r=Ii(new S0e,i)||r,r=Ii(new R0e,i)||r),e.sources=i,r}function z0e(e,t){a3(e.sources);let n=0,i=0;for(let r=0;r<kh&&_w(e,t,!0);r++)n++;e.sources.map(s3);for(let r=0;r<kh&&_w(e,t,!1);r++)i++;a3(e.sources),Math.max(n,i)===kh&&Y(`Maximum optimization runs(${kh}) reached.`)}class Ot{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Ot(()=>t(n))}}function OD(e){yt(e)?B0e(e):U0e(e)}function B0e(e){const t=e.component.scales;for(const n of W(t)){const i=H0e(e,n);if(t[n].setWithExplicit("domains",i),V0e(e,n),e.component.data.isFaceted){let s=e;for(;!hi(s)&&s.parent;)s=s.parent;if(s.component.resolve.scale[n]==="shared")for(const a of i.value)Cs(a)&&(a.data=o3+a.data.replace(o3,""))}}}function U0e(e){for(const n of e.children)OD(n);const t=e.component.scales;for(const n of W(t)){let i,r=null;for(const s of e.children){const o=s.component.scales[n];if(o){i===void 0?i=o.getWithExplicit("domains"):i=Oo(i,o.getWithExplicit("domains"),"domains","scale",u3);const a=o.get("selectionExtent");r&&a&&r.param!==a.param&&Y(Eae),r=a}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0)}}function j0e(e,t,n,i){if(e==="unaggregated"){const{valid:r,reason:s}=ww(t,n);if(!r){Y(s);return}}else if(e===void 0&&i.useUnaggregatedDomain){const{valid:r}=ww(t,n);if(r)return"unaggregated"}return e}function H0e(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=j0e(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]={...e.specifiedScales[t],domain:r}),t==="x"&&Lt(i.x2)?Lt(i.x)?Oo(no(n,r,e,"x"),no(n,r,e,"x2"),"domain","scale",u3):no(n,r,e,"x2"):t==="y"&&Lt(i.y2)?Lt(i.y)?Oo(no(n,r,e,"y"),no(n,r,e,"y2"),"domain","scale",u3):no(n,r,e,"y2"):no(n,r,e,t)}function q0e(e,t,n){return e.map(i=>({signal:`{data: ${m1(i,{timeUnit:n,type:t})}}`}))}function _y(e,t,n){var r;const i=(r=jt(n))==null?void 0:r.unit;return t==="temporal"||i?q0e(e,t,i):[e]}function no(e,t,n,i){const{encoding:r,markDef:s,mark:o,config:a,stack:u}=n,l=Lt(r[i]),{type:c}=l,f=l.timeUnit,d=Afe({invalid:Hr("invalid",s,a),isPath:ea(o)});if(Zue(t)){const g=no(e,void 0,n,i),m=_y(t.unionWith,c,f);return _r([...m,...g.value])}else{if(ue(t))return _r([t]);if(t&&t!=="unaggregated"&&!wL(t))return _r(_y(t,c,f))}if(u&&i===u.fieldChannel){if(u.offset==="normalize")return ii([[0,1]]);const g=n.requestDataName(d);return ii([{data:g,field:n.vgField(i,{suffix:"start"})},{data:g,field:n.vgField(i,{suffix:"end"})}])}const h=ns(i)&&Z(l)?W0e(n,i,e):void 0;if(is(l)){const g=_y([l.datum],c,f);return ii(g)}const p=l;if(t==="unaggregated"){const{field:g}=l;return ii([{data:n.requestDataName(d),field:ee({field:g,aggregate:"min"})},{data:n.requestDataName(d),field:ee({field:g,aggregate:"max"})}])}else if(lt(p.bin)){if(qt(e))return ii(e==="bin-ordinal"?[]:[{data:jf(h)?n.requestDataName(d):n.requestDataName(vt.Raw),field:n.vgField(i,Rd(p,i)?{binSuffix:"range"}:{}),sort:h===!0||!_e(h)?{field:n.vgField(i,{}),op:"min"}:h}]);{const{bin:g}=p;if(lt(g)){const m=Y4(n,p.field,g);return ii([new Ot(()=>{const y=n.getSignalName(m);return`[${y}.start, ${y}.stop]`})])}else return ii([{data:n.requestDataName(d),field:n.vgField(i,{})}])}}else if(p.timeUnit&&Ne(["time","utc"],e)){const g=r[ts(i)];if(PL(p,g,s,a)){const m=n.requestDataName(d),y=Ro({fieldDef:p,fieldDef2:g,markDef:s,config:a}),v=qf(o)&&y!==.5&&$t(i);return ii([{data:m,field:n.vgField(i,v?{suffix:w1}:{})},{data:m,field:n.vgField(i,{suffix:v?E1:"end"})}])}}return ii(h?[{data:jf(h)?n.requestDataName(d):n.requestDataName(vt.Raw),field:n.vgField(i),sort:h}]:[{data:n.requestDataName(d),field:n.vgField(i)}])}function wy(e,t){const{op:n,field:i,order:r}=e;return{op:n??(t?"sum":d1),...i?{field:Li(i)}:{},...r?{order:r}:{}}}function V0e(e,t){var a;const n=e.component.scales[t],i=e.specifiedScales[t].domain,r=(a=e.fieldDef(t))==null?void 0:a.bin,s=wL(i)?i:void 0,o=mu(r)&&r1(r.extent)?r.extent:void 0;(s||o)&&n.set("selectionExtent",s??o,!0)}function W0e(e,t,n){if(!qt(n))return;const i=e.fieldDef(t),r=i.sort;if(OL(r))return{op:"min",field:Tl(i,t),order:"ascending"};const{stack:s}=e,o=s?new Set([...s.groupbyFields,...s.stackBy.map(a=>a.fieldDef.field)]):void 0;if(Ts(r)){const a=s&&!o.has(r.field);return wy(r,a)}else if(Ale(r)){const{encoding:a,order:u}=r,l=e.fieldDef(a),{aggregate:c,field:f}=l,d=s&&!o.has(f);if(Bs(c)||Qo(c))return wy({field:ee(l),order:u},d);if(Gx(c)||!c)return wy({op:c,field:f,order:u},d)}else{if(r==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(Ne(["ascending",void 0],r))return!0}}function ww(e,t){const{aggregate:n,type:i}=e;return n?le(n)&&!oae.has(n)?{valid:!1,reason:Jae(n)}:i==="quantitative"&&t==="log"?{valid:!1,reason:Qae(e)}:{valid:!0}:{valid:!1,reason:Kae(e)}}function u3(e,t,n,i){return e.explicit&&t.explicit&&Y(rue(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function G0e(e){const t=Ar(e.map(o=>{if(Cs(o)){const{sort:a,...u}=o;return u}return o}),De),n=Ar(e.map(o=>{if(Cs(o)){const a=o.sort;return a!==void 0&&!jf(a)&&("op"in a&&a.op==="count"&&delete a.field,a.order==="ascending"&&delete a.order),a}}).filter(o=>o!==void 0),De);if(t.length===0)return;if(t.length===1){const o=e[0];if(Cs(o)&&n.length>0){let a=n[0];if(n.length>1){Y(C7);const u=n.filter(l=>_e(l)&&"op"in l&&l.op!=="min");n.every(l=>_e(l)&&"op"in l)&&u.length===1?a=u[0]:a=!0}else if(_e(a)&&"field"in a){const u=a.field;o.field===u&&(a=a.order?{order:a.order}:!0)}return{...o,sort:a}}return o}const i=Ar(n.map(o=>jf(o)||!("op"in o)||le(o.op)&&pe(nae,o.op)?o:(Y(oue(o)),!0)),De);let r;i.length===1?r=i[0]:i.length>1&&(Y(C7),r=!0);const s=Ar(e.map(o=>Cs(o)?o.data:null),o=>o);return s.length===1&&s[0]!==null?{data:s[0],fields:t.map(a=>a.field),...r?{sort:r}:{}}:{fields:t,...r?{sort:r}:{}}}function J4(e){if(Cs(e)&&le(e.field))return e.field;if(aae(e)){let t;for(const n of e.fields)if(Cs(n)&&le(n.field)){if(!t)t=n.field;else if(t!==n.field)return Y(aue),t}return Y(uue),t}else if(uae(e)){Y(lue);const t=e.fields[0];return le(t)?t:void 0}}function L1(e,t){const i=e.component.scales[t].get("domains").map(r=>(Cs(r)&&(r.data=e.lookupDataSource(r.data)),r));return G0e(i)}function ID(e){return Ql(e)||Q4(e)?e.children.reduce((t,n)=>t.concat(ID(n)),Ew(e)):Ew(e)}function Ew(e){return W(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),{name:s,type:o,selectionExtent:a,domains:u,range:l,reverse:c,...f}=r,d=Y0e(r.range,s,n,e),h=L1(e,n),p=a?Pfe(e,a,i,h):null;return t.push({name:s,type:o,...h?{domain:h}:{},...p?{domainRaw:p}:{},range:d,...c!==void 0?{reverse:c}:{},...f}),t},[])}function Y0e(e,t,n,i){if($t(n)){if(yu(e))return{step:{signal:`${t}_step`}}}else if(_e(e)&&Cs(e))return{...e,data:i.lookupDataSource(e.data)};return e}class PD extends Js{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainHasZero(){const t=this.get("type");if(Ne([Zt.LOG,Zt.TIME,Zt.UTC],t))return"definitely-not";const n=this.get("zero");if(n===!0||n===void 0&&Ne([Zt.LINEAR,Zt.SQRT,Zt.POW],t))return"definitely";const i=this.get("domains");if(i.length>0){let r=!1,s=!1,o=!1;for(const a of i){if(V(a)){const u=a[0],l=a[a.length-1];if(Ke(u)&&Ke(l))if(u<=0&&l>=0){r=!0;continue}else{s=!0;continue}}o=!0}if(r)return"definitely";if(s&&!o)return"definitely-not"}return"maybe"}}const Z0e=["range","scheme"];function X0e(e){const t=e.component.scales;for(const n of Wx){const i=t[n];if(!i)continue;const r=K0e(n,e);i.setWithExplicit("range",r)}}function Cw(e,t){const n=e.fieldDef(t);if(n!=null&&n.bin){const{bin:i,field:r}=n,s=Qn(t),o=e.getName(s);if(_e(i)&&i.binned&&i.step!==void 0)return new Ot(()=>{const a=e.scaleName(t),u=`(domain("${a}")[1] - domain("${a}")[0]) / ${i.step}`;return`${e.getSignalName(o)} / (${u})`});if(lt(i)){const a=Y4(e,r,i);return new Ot(()=>{const u=e.getSignalName(a),l=`(${u}.stop - ${u}.start) / ${u}.step`;return`${e.getSignalName(o)} / (${l})`})}}}function K0e(e,t){const n=t.specifiedScales[e],{size:i}=t,s=t.getScaleComponent(e).get("type");for(const f of Z0e)if(n[f]!==void 0){const d=Bv(s,f),h=EL(e,f);if(!d)Y(nL(s,f,e));else if(h)Y(h);else switch(f){case"range":{const p=n.range;if(V(p)){if($t(e))return _r(p.map(g=>{if(g==="width"||g==="height"){const m=t.getName(g),y=t.getSignalName.bind(t);return Ot.fromName(y,m)}return g}))}else if(_e(p))return _r({data:t.requestDataName(vt.Main),field:p.field,sort:{op:"min",field:t.vgField(e)}});return _r(p)}case"scheme":return _r(J0e(n[f]))}}const o=e===gt||e==="xOffset"?"width":"height",a=i[o];if(Vr(a)){if($t(e))if(qt(s)){const f=BD(a,t,e);if(f)return _r({step:f})}else Y(iL(o));else if($d(e)){const f=e===Go?"x":"y";if(t.getScaleComponent(f).get("type")==="band"){const p=UD(a,s);if(p)return _r(p)}}}const{rangeMin:u,rangeMax:l}=n,c=Q0e(e,t);return(u!==void 0||l!==void 0)&&Bv(s,"rangeMin")&&V(c)&&c.length===2?_r([u??c[0],l??c[1]]):ii(c)}function J0e(e){return Yue(e)?{scheme:e.name,...Yn(e,["name"])}:{scheme:e}}function zD(e,t,n,{center:i}={}){const r=Qn(e),s=t.getName(r),o=t.getSignalName.bind(t);return e===Wt&&tr(n)?i?[Ot.fromName(a=>`${o(a)}/2`,s),Ot.fromName(a=>`-${o(a)}/2`,s)]:[Ot.fromName(o,s),0]:i?[Ot.fromName(a=>`-${o(a)}/2`,s),Ot.fromName(a=>`${o(a)}/2`,s)]:[0,Ot.fromName(o,s)]}function Q0e(e,t){const{size:n,config:i,mark:r,encoding:s}=t,{type:o}=Lt(s[e]),u=t.getScaleComponent(e).get("type"),{domain:l,domainMid:c}=t.specifiedScales[e];switch(e){case gt:case Wt:{if(Ne(["point","band"],u)){const f=jD(e,n,i.view);if(Vr(f))return{step:BD(f,t,e)}}return zD(e,t,u)}case Go:case Wl:return epe(e,t,u);case Ys:{const f=ipe(r,i),d=rpe(r,n,t,i);return El(u)?npe(f,d,tpe(u,i,l,e)):[f,d]}case Ri:return[0,Math.PI*2];case pu:return[0,360];case ar:return[0,new Ot(()=>{const f=t.getSignalName(hi(t.parent)?"child_width":"width"),d=t.getSignalName(hi(t.parent)?"child_height":"height");return`min(${f},${d})/2`})];case Yo:return{step:1e3/i.scale.framesPerSecond};case Ko:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case Jo:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case Jn:return"symbol";case Kn:case Qr:case es:return u==="ordinal"?o==="nominal"?"category":"ordinal":c!==void 0?"diverging":r==="rect"||r==="geoshape"?"heatmap":"ramp";case Zs:case Zo:case Xo:return[i.scale.minOpacity,i.scale.maxOpacity]}}function BD(e,t,n){const{encoding:i}=t,r=t.getScaleComponent(n),s=jx(n),o=i[s];if(mN({step:e,offsetIsDiscrete:ke(o)&&yL(o.type)})==="offset"&&XL(i,s)){const u=t.getScaleComponent(s);let c=`domain('${t.scaleName(s)}').length`;if(u.get("type")==="band"){const d=u.get("paddingInner")??u.get("padding")??0,h=u.get("paddingOuter")??u.get("padding")??0;c=`bandspace(${c}, ${d}, ${h})`}const f=r.get("paddingInner")??r.get("padding");return{signal:`${e.step} * ${c} / (1-${dae(f)})`}}else return e.step}function UD(e,t){if(mN({step:e,offsetIsDiscrete:qt(t)})==="offset")return{step:e.step}}function epe(e,t,n){const i=e===Go?"x":"y",r=t.getScaleComponent(i);if(!r)return zD(i,t,n,{center:!0});const s=r.get("type"),o=t.scaleName(i),{markDef:a,config:u}=t;if(s==="band"){const l=jD(i,t.size,t.config.view);if(Vr(l)){const c=UD(l,n);if(c)return c}return[0,{signal:`bandwidth('${o}')`}]}else{const l=t.encoding[i];if(Z(l)&&l.timeUnit){const c=hL(l.timeUnit,p=>`scale('${o}', ${p})`),f=t.config.scale.bandWithNestedOffsetPaddingInner,d=Ro({fieldDef:l,markDef:a,config:u})-.5,h=d!==0?` + ${d}`:"";if(f){const p=ue(f)?`${f.signal}/2`+h:`${f/2+d}`,g=ue(f)?`(1 - ${f.signal}/2)`+h:`${1-f/2+d}`;return[{signal:`${p} * (${c})`},{signal:`${g} * (${c})`}]}return[0,{signal:c}]}return CF(`Cannot use ${e} scale if ${i} scale is not discrete.`)}}function jD(e,t,n){const i=e===gt?"width":"height",r=t[i];return r||Fp(n,i)}function tpe(e,t,n,i){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&V(n)?n.length+1:(Y(vue(i)),3)}}function npe(e,t,n){const i=()=>{const r=Gi(t),s=Gi(e),o=`(${r} - ${s}) / (${n} - 1)`;return`sequence(${s}, ${r} + ${o}, ${o})`};return ue(t)?new Ot(i):{signal:i()}}function ipe(e,t){switch(e){case"bar":case"tick":return t.scale.minBandSize;case"line":case"trail":case"rule":return t.scale.minStrokeWidth;case"text":return t.scale.minFontSize;case"point":case"square":case"circle":return t.scale.minSize}throw new Error(s1("size",e))}const Sw=.95;function rpe(e,t,n,i){const r={x:Cw(n,"x"),y:Cw(n,"y")};switch(e){case"bar":case"tick":{if(i.scale.maxBandSize!==void 0)return i.scale.maxBandSize;const s=kw(t,r,i.view);return Ke(s)?s-1:new Ot(()=>`${s.signal} - 1`)}case"line":case"trail":case"rule":return i.scale.maxStrokeWidth;case"text":return i.scale.maxFontSize;case"point":case"square":case"circle":{if(i.scale.maxSize)return i.scale.maxSize;const s=kw(t,r,i.view);return Ke(s)?Math.pow(Sw*s,2):new Ot(()=>`pow(${Sw} * ${s.signal}, 2)`)}}throw new Error(s1("size",e))}function kw(e,t,n){const i=Vr(e.width)?e.width.step:qv(n,"width"),r=Vr(e.height)?e.height.step:qv(n,"height");return t.x||t.y?new Ot(()=>`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`):Math.min(i,r)}function HD(e,t){yt(e)?spe(e,t):VD(e,t)}function spe(e,t){const n=e.component.scales,{config:i,encoding:r,markDef:s,specifiedScales:o}=e;for(const a of W(n)){const u=o[a],l=n[a],c=e.getScaleComponent(a),f=Lt(r[a]),d=u[t],h=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),m=Bv(h,t),y=EL(a,t);if(d!==void 0&&(m?y&&Y(y):Y(nL(h,t,a))),m&&y===void 0)if(d!==void 0){const v=f.timeUnit,b=f.type;switch(t){case"domainMax":case"domainMin":vu(u[t])||b==="temporal"||v?l.set(t,{signal:m1(u[t],{type:b,timeUnit:v})},!0):l.set(t,u[t],!0);break;default:l.copyKeyFromObject(t,u)}}else{const v=G(Aw,t)?Aw[t]({model:e,channel:a,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:g,domain:u.domain,domainMin:u.domainMin,domainMax:u.domainMax,markDef:s,config:i,hasNestedOffsetScale:KL(r,a),hasSecondaryRangeChannel:!!r[ts(a)]}):i.scale[t];v!==void 0&&l.set(t,v,!1)}}}const Aw={bins:({model:e,fieldOrDatumDef:t})=>Z(t)?ope(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>ape(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:i,domainMax:r,fieldOrDatumDef:s})=>upe(e,t,n,i,r,s),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>lpe(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:i,config:r,hasNestedOffsetScale:s})=>cpe(e,t,n.type,i,r.scale,s),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:i,config:r,hasNestedOffsetScale:s})=>fpe(e,t,n,i,r.scale,s),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>{const r=Z(e)?e.sort:void 0;return dpe(t,r,n,i.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r,config:s,hasSecondaryRangeChannel:o})=>hpe(e,t,n,i,r,s.scale,o)};function qD(e){yt(e)?X0e(e):VD(e,"range")}function VD(e,t){const n=e.component.scales;for(const i of e.children)t==="range"?qD(i):HD(i,t);for(const i of W(n)){let r;for(const s of e.children){const o=s.component.scales[i];if(o){const a=o.getWithExplicit(t);r=Oo(r,a,t,"scale",MN((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[i].setWithExplicit(t,r)}}function ope(e,t){const n=t.bin;if(lt(n)){const i=Y4(e,t.field,n);return new Ot(()=>e.getSignalName(i))}else if(Gt(n)&&mu(n)&&n.step!==void 0)return{step:n.step}}function ape(e,t){if(Ne([Kn,Qr,es],e)&&t!=="nominal")return"hcl"}function upe(e,t,n,i,r,s){var o;if(!((o=ir(s))!=null&&o.bin||V(n)||r!=null||i!=null||Ne([Zt.TIME,Zt.UTC],e)))return $t(t)?!0:void 0}function lpe(e,t,n,i,r,s){if($t(e)){if($r(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:o,orient:a}=r;if(o==="bar"&&!(Z(i)&&(i.bin||i.timeUnit))&&(a==="vertical"&&e==="x"||a==="horizontal"&&e==="y"))return s.continuousBandSize}if(t===Zt.POINT)return n.pointPadding}}function cpe(e,t,n,i,r,s=!1){if(e===void 0){if($t(t)){const{bandPaddingInner:o,barBandPaddingInner:a,rectBandPaddingInner:u,tickBandPaddingInner:l,bandWithNestedOffsetPaddingInner:c}=r;return s?c:At(o,n==="bar"?a:n==="tick"?l:u)}else if($d(t)&&i===Zt.BAND)return r.offsetBandPaddingInner}}function fpe(e,t,n,i,r,s=!1){if(e===void 0){if($t(t)){const{bandPaddingOuter:o,bandWithNestedOffsetPaddingOuter:a}=r;if(s)return a;if(n===Zt.BAND)return At(o,ue(i)?{signal:`${i.signal}/2`}:i/2)}else if($d(t)){if(n===Zt.POINT)return .5;if(n===Zt.BAND)return r.offsetBandPaddingOuter}}}function dpe(e,t,n,i){if(n==="x"&&i.xReverse!==void 0)return tr(e)&&t==="descending"?ue(i.xReverse)?{signal:`!${i.xReverse.signal}`}:!i.xReverse:i.xReverse;if(tr(e)&&t==="descending")return!0}function hpe(e,t,n,i,r,s,o){if(!!n&&n!=="unaggregated"&&tr(r)){if(V(n)){const u=n[0],l=n[n.length-1];if(Ke(u)&&u<=0&&Ke(l)&&l>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!El(r))return!0;if(!(Z(t)&&t.bin)&&Ne([...Xs,...Goe],e)){const{orient:u,type:l}=i;return Ne(["bar","area","line","trail"],l)&&(u==="horizontal"&&e==="y"||u==="vertical"&&e==="x")?!1:Ne(["bar","area"],l)&&!o?!0:s==null?void 0:s.zero}return!1}function ppe(e,t,n,i,r=!1){const s=gpe(t,n,i,r),{type:o}=e;return ns(t)?o!==void 0?tle(t,o)?Z(n)&&!ele(o,n.type)?(Y(nue(o,s)),s):o:(Y(tue(t,o,s)),s):s:null}function gpe(e,t,n,i){var r;switch(t.type){case"nominal":case"ordinal":{if(Xu(e)||ay(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&Y(uy(e,"ordinal")),"ordinal";if(oy(e))return"band";if($t(e)||$d(e)){if(Ne(["rect","bar","image","rule","tick"],n.type)||i)return"band"}else if(n.type==="arc"&&e in Vx)return"band";const s=n[Qn(e)];return nu(s)||Sl(t)&&((r=t.axis)!=null&&r.tickBand)?"band":"point"}case"temporal":return Xu(e)?"time":ay(e)==="discrete"?(Y(uy(e,"temporal")),"ordinal"):Z(t)&&t.timeUnit&&jt(t.timeUnit).utc?"utc":oy(e)?"band":"time";case"quantitative":return Xu(e)?Z(t)&&lt(t.bin)?"bin-ordinal":"linear":ay(e)==="discrete"?(Y(uy(e,"quantitative")),"ordinal"):oy(e)?"band":"linear";case"geojson":return}throw new Error(eL(t.type))}function mpe(e,{ignoreRange:t}={}){WD(e),OD(e);for(const n of Que)HD(e,n);t||qD(e)}function WD(e){yt(e)?e.component.scales=ype(e):e.component.scales=bpe(e)}function ype(e){const{encoding:t,mark:n,markDef:i}=e,r={};for(const s of Wx){const o=Lt(t[s]);if(o&&n===kL&&s===Jn&&o.type===Yl)continue;let a=o&&o.scale;if(o&&a!==null&&a!==!1){a??(a={});const u=KL(t,s),l=ppe(a,s,o,i,u);r[s]=new PD(e.scaleName(`${s}`,!0),{value:l,explicit:a.type===l})}}return r}const vpe=MN((e,t)=>k7(e)-k7(t));function bpe(e){var t;const n=e.component.scales={},i={},r=e.component.resolve;for(const s of e.children){WD(s);for(const o of W(s.component.scales))if((t=r.scale)[o]??(t[o]=ED(o,e)),r.scale[o]==="shared"){const a=i[o],u=s.component.scales[o].getWithExplicit("type");a?Hue(a.value,u.value)?i[o]=Oo(a,u,"type","scale",vpe):(r.scale[o]="independent",delete i[o]):i[o]=u}}for(const s of W(i)){const o=e.scaleName(s,!0),a=i[s];n[s]=new PD(o,a);for(const u of e.children){const l=u.component.scales[s];l&&(u.renameScale(l.get("name"),o),l.merged=!0)}}return n}class Ey{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function yt(e){return(e==null?void 0:e.type)==="unit"}function hi(e){return(e==null?void 0:e.type)==="facet"}function Q4(e){return(e==null?void 0:e.type)==="concat"}function Ql(e){return(e==null?void 0:e.type)==="layer"}class e9{constructor(t,n,i,r,s,o,a){this.type=n,this.parent=i,this.config=s,this.parent=i,this.config=s,this.view=Yt(a),this.name=t.name??r,this.title=lo(t.title)?{text:t.title}:t.title?Yt(t.title):void 0,this.scaleNameMap=i?i.scaleNameMap:new Ey,this.projectionNameMap=i?i.projectionNameMap:new Ey,this.signalNameMap=i?i.signalNameMap:new Ey,this.data=t.data,this.description=t.description,this.transforms=gfe(t.transform??[]),this.layout=n==="layer"||n==="unit"?{}:bce(t,n,s),this.component={data:{sources:i?i.component.data.sources:[],outputNodes:i?i.component.data.outputNodes:{},outputNodeRefCounts:i?i.component.data.outputNodeRefCounts:{},isFaceted:h1(t)||(i==null?void 0:i.component.data.isFaceted)&&t.data===void 0},layoutSize:new Js,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...o?Ce(o):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){mpe(this)}parseProjection(){ND(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){$D(this)}assembleEncodeFromView(t){const{style:n,...i}=t,r={};for(const s of W(i)){const o=i[s];o!==void 0&&(r[s]=ct(o))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=ct(this.description)),this.type==="unit"||this.type==="layer")?{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...n}:et(n)?void 0:n}assembleLayout(){if(!this.layout)return;const{spacing:t,...n}=this.layout,{component:i,config:r}=this,s=zhe(i.layoutHeaders,r);return{padding:t,...this.assembleDefaultLayout(),...n,...s?{titleBand:s}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const i of Si)t[i].title&&n.push(Nhe(this,i));for(const i of q4)n=n.concat(Dhe(this,i));return n}assembleAxes(){return xhe(this.component.axes,this.config)}assembleLegends(){return TD(this)}assembleProjections(){return u0e(this)}assembleTitle(){const{encoding:t,...n}=this.title??{},i={...VF(this.config.title).nonMarkTitleProperties,...n,...t?{encode:{update:t}}:{}};if(i.text)return Ne(["unit","layer"],this.type)?Ne(["middle",void 0],i.anchor)&&(i.frame??(i.frame="group")):i.anchor??(i.anchor="start"),et(i)?void 0:i}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const i=this.assembleLayout();i&&(n.layout=i),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||hi(this.parent)?ID(this):[];r.length>0&&(n.scales=r);const s=this.assembleAxes();s.length>0&&(n.axes=s);const o=this.assembleLegends();return o.length>0&&(n.legends=o),n}getName(t){return pt((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(vt[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),i=this.component.data.outputNodeRefCounts;return i[n]=(i[n]||0)+1,n}getSizeSignalRef(t){if(hi(this.parent)){const n=_D(t),i=n1(n),r=this.component.scales[i];if(r&&!r.merged){const s=r.get("type"),o=r.get("range");if(qt(s)&&yu(o)){const a=r.get("name"),u=L1(this,i),l=J4(u);if(l){const c=ee({aggregate:"distinct",field:l},{expr:"datum"});return{signal:xD(a,r,c)}}else return Y(Zx(i)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(IF(t)&&ns(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getScaleType(t){const n=this.getScaleComponent(t);return n?n.get("type"):void 0}getSelectionComponent(t,n){let i=this.component.selection[t];if(!i&&this.parent&&(i=this.parent.getSelectionComponent(t,n)),!i)throw new Error(yae(n));return i}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)==null?void 0:t.some(i=>i.hasOrientSignalRef()))||((n=this.component.axes.y)==null?void 0:n.some(i=>i.hasOrientSignalRef()))}}class GD extends e9{vgField(t,n={}){const i=this.fieldDef(t);if(i)return ee(i,n)}reduceFieldDef(t,n){return Yle(this.getMapping(),(i,r,s)=>{const o=ir(r);return o?t(i,o,s):i},n)}forEachFieldDef(t,n){E4(this.getMapping(),(i,r)=>{const s=ir(i);s&&t(s,r)},n)}}class N1 extends Je{clone(){return new N1(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ce(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??"value",i[1]??"density"];const r=this.transform.resolve??"shared";this.transform.resolve=r}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${De(this.transform)}`}assemble(){const{density:t,...n}=this.transform,i={type:"kde",field:t,...n};return i.resolve=this.transform.resolve,i}}class D1 extends Je{clone(){return new D1(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ce(n)}dependentFields(){return new Set([this.transform.extent])}producedFields(){return new Set([])}hash(){return`ExtentTransform ${De(this.transform)}`}assemble(){const{extent:t,param:n}=this.transform;return{type:"extent",field:t,signal:n}}}class R1 extends Je{clone(){return new R1(this.parent,Ce(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ce(n);const{flatten:i,as:r=[]}=this.transform;this.transform.as=i.map((s,o)=>r[o]??s)}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${De(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class O1 extends Je{clone(){return new O1(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ce(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??"key",i[1]??"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${De(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class Qu extends Je{clone(){return new Qu(null,Ce(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let i=0;for(const r of[[lr,ur],[Ni,cr]]){const s=r.map(o=>{const a=Lt(n.encoding[o]);return Z(a)?a.field:is(a)?{expr:`${a.datum}`}:nr(a)?{expr:`${a.value}`}:void 0});(s[0]||s[1])&&(t=new Qu(t,s,null,n.getName(`geojson_${i++}`)))}if(n.channelHasField(Jn)){const r=n.typedFieldDef(Jn);r.type===Yl&&(t=new Qu(t,null,r.field,n.getName(`geojson_${i++}`)))}return t}constructor(t,n,i,r){super(t),this.fields=n,this.geojson=i,this.signal=r}dependentFields(){const t=(this.fields??[]).filter(le);return new Set([...this.geojson?[this.geojson]:[],...t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${De(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class Yf extends Je{clone(){return new Yf(null,this.projection,Ce(this.fields),Ce(this.as))}constructor(t,n,i,r){super(t),this.projection=n,this.fields=i,this.as=r}static parseAll(t,n){if(!n.projectionName())return t;for(const i of[[lr,ur],[Ni,cr]]){const r=i.map(o=>{const a=Lt(n.encoding[o]);return Z(a)?a.field:is(a)?{expr:`${a.datum}`}:nr(a)?{expr:`${a.value}`}:void 0}),s=i[0]===Ni?"2":"";(r[0]||r[1])&&(t=new Yf(t,n.projectionName(),r,[n.getName(`x${s}`),n.getName(`y${s}`)]))}return t}dependentFields(){return new Set(this.fields.filter(le))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${De(this.fields)} ${De(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Ia extends Je{clone(){return new Ia(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:i,step:r}=t;return{signal:`sequence(${[n,i,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,n){return new Ia(t,n)}static makeFromEncoding(t,n){const i=n.encoding,r=i.x,s=i.y;if(Z(r)&&Z(s)){const o=r.impute?r:s.impute?s:void 0;if(o===void 0)return;const a=r.impute?s:s.impute?r:void 0,{method:u,value:l,frame:c,keyvals:f}=o.impute,d=eN(n.mark,i);return new Ia(t,{impute:o.field,key:a.field,...u?{method:u}:{},...l!==void 0?{value:l}:{},...c?{frame:c}:{},...f!==void 0?{keyvals:f}:{},...d.length?{groupby:d}:{}})}return null}hash(){return`Impute ${De(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:i,method:r,groupby:s,value:o,frame:a=[null,null]}=this.transform,u={type:"impute",field:t,key:n,...i?{keyvals:Xce(i)?this.processSequence(i):i}:{},method:"value",...s?{groupby:s}:{},value:!r||r==="value"?o:null};if(r&&r!=="value"){const l={type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:a,ignorePeers:!1,...s?{groupby:s}:{}},c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}class I1 extends Je{clone(){return new I1(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ce(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??n.on,i[1]??n.loess]}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${De(this.transform)}`}assemble(){const{loess:t,on:n,...i}=this.transform;return{type:"loess",x:n,y:t,...i}}}class Zf extends Je{clone(){return new Zf(null,Ce(this.transform),this.secondary)}constructor(t,n,i){super(t),this.transform=n,this.secondary=i}static make(t,n,i,r){const s=n.component.data.sources,{from:o}=i;let a=null;if(Kce(o)){let u=XD(o.data,s);u||(u=new uu(o.data),s.push(u));const l=n.getName(`lookup_${r}`);a=new Zn(u,l,vt.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=a}else if(Jce(o)){const u=o.param;i={as:u,...i};let l;try{l=n.getSelectionComponent(pt(u),u)}catch{throw new Error(_ae(u))}if(a=l.materialized,!a)throw new Error(wae(u))}return new Zf(t,i,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?ce(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${De({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t={values:this.transform.from.fields,...this.transform.as?{as:ce(this.transform.as)}:{}};else{let n=this.transform.as;le(n)||(Y(Nae),n="_lookup"),t={as:[n]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...t,...this.transform.default?{default:this.transform.default}:{}}}}class P1 extends Je{clone(){return new P1(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ce(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??"prob",i[1]??"value"]}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${De(this.transform)}`}assemble(){const{quantile:t,...n}=this.transform;return{type:"quantile",field:t,...n}}}class z1 extends Je{clone(){return new z1(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ce(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??n.on,i[1]??n.regression]}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${De(this.transform)}`}assemble(){const{regression:t,on:n,...i}=this.transform;return{type:"regression",x:n,y:t,...i}}}class B1 extends Je{clone(){return new B1(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=Ar((this.transform.groupby??[]).concat(t),n=>n)}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${De(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:i,limit:r,op:s}=this.transform;return{type:"pivot",field:t,value:n,...r!==void 0?{limit:r}:{},...s!==void 0?{op:s}:{},...i!==void 0?{groupby:i}:{}}}}class U1 extends Je{clone(){return new U1(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${De(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function YD(e){let t=0;function n(i,r){if(i instanceof uu&&!i.isGenerator&&!Al(i.data)&&(e.push(r),r={name:null,source:r.name,transform:[]}),i instanceof fn&&(i.parent instanceof uu&&!r.source?(r.format={...r.format,parse:i.assembleFormatParse()},r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof Kl){r.name||(r.name=`data_${t++}`),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source,e.push(...i.assemble());return}switch((i instanceof Ud||i instanceof jd||i instanceof Ll||i instanceof Xl||i instanceof Ml||i instanceof Yf||i instanceof Ki||i instanceof Zf||i instanceof Jl||i instanceof Eu||i instanceof O1||i instanceof R1||i instanceof N1||i instanceof I1||i instanceof P1||i instanceof z1||i instanceof Io||i instanceof U1||i instanceof B1||i instanceof D1)&&r.transform.push(i.assemble()),(i instanceof Rr||i instanceof Nr||i instanceof Ia||i instanceof Ls||i instanceof Qu)&&r.transform.push(...i.assemble()),i instanceof Zn&&(r.source&&r.transform.length===0?i.setSource(r.source):i.parent instanceof Zn?i.setSource(r.name):(r.name||(r.name=`data_${t++}`),i.setSource(r.name),i.numChildren()===1&&(e.push(r),r={name:null,source:r.name,transform:[]}))),i.numChildren()){case 0:i instanceof Zn&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name=`data_${t++}`);let s=r.name;!r.source||r.transform.length>0?e.push(r):s=r.source;for(const o of i.children)n(o,{name:null,source:s,transform:[]});break}}}return n}function xpe(e){const t=[],n=YD(t);for(const i of e.children)n(i,{source:e.name,name:null,transform:[]});return t}function _pe(e,t){const n=[],i=YD(n);let r=0;for(const o of e.sources){o.hasName()||(o.dataName=`source_${r++}`);const a=o.assemble();i(o,a)}for(const o of n)o.transform.length===0&&delete o.transform;let s=0;for(const[o,a]of n.entries())(a.transform??[]).length===0&&!a.source&&n.splice(s++,0,n.splice(o,1)[0]);for(const o of n)for(const a of o.transform??[])a.type==="lookup"&&(a.from=e.outputNodes[a.from].getSource());for(const o of n)o.name in t&&(o.values=t[o.name]);return n}function wpe(e){return e==="top"||e==="left"||ue(e)?"header":"footer"}function Epe(e){for(const t of Si)Cpe(e,t);$w(e,"x"),$w(e,"y")}function Cpe(e,t){var o;const{facet:n,config:i,child:r,component:s}=e;if(e.channelHasField(t)){const a=n[t],u=Fl("title",null,i,t);let l=Ku(a,i,{allowDisabling:!0,includeDefault:u===void 0||!!u});r.component.layoutHeaders[t].title&&(l=V(l)?l.join(", "):l,l+=` / ${r.component.layoutHeaders[t].title}`,r.component.layoutHeaders[t].title=null);const c=Fl("labelOrient",a.header,i,t),f=a.header!==null?At((o=a.header)==null?void 0:o.labels,i.header.labels,!0):!1,d=Ne(["bottom","right"],c)?"footer":"header";s.layoutHeaders[t]={title:a.header!==null?l:null,facetFieldDef:a,[d]:t==="facet"?[]:[ZD(e,t,f)]}}}function ZD(e,t,n){const i=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function $w(e,t){const{child:n}=e;if(n.component.axes[t]){const{layoutHeaders:i,resolve:r}=e.component;if(r.axis[t]=G4(r,t),r.axis[t]==="shared"){const s=t==="x"?"column":"row",o=i[s];for(const a of n.component.axes[t]){const u=wpe(a.get("orient"));o[u]??(o[u]=[ZD(e,s,!1)]);const l=Wc(a,"main",e.config,{header:!0});l&&o[u][0].axes.push(l),a.mainExtracted=!0}}}}function Spe(e){t9(e),Op(e,"width"),Op(e,"height")}function kpe(e){t9(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";Op(e,t),Op(e,n)}function t9(e){for(const t of e.children)t.parseLayoutSize()}function Op(e,t){const n=_D(t),i=n1(n),r=e.component.resolve,s=e.component.layoutSize;let o;for(const a of e.children){const u=a.component.layoutSize.getWithExplicit(n),l=r.scale[i]??ED(i,e);if(l==="independent"&&u.value==="step"){o=void 0;break}if(o){if(l==="independent"&&o.value!==u.value){o=void 0;break}o=Oo(o,u,n,"")}else o=u}if(o){for(const a of e.children)e.renameSignal(a.getName(n),e.getName(t)),a.component.layoutSize.set(n,"merged",!1);s.setWithExplicit(t,o)}else s.setWithExplicit(t,{explicit:!1,value:void 0})}function Ape(e){const{size:t,component:n}=e;for(const i of Xs){const r=Qn(i);if(t[r]){const s=t[r];n.layoutSize.set(r,Vr(s)?"step":s,!0)}else{const s=$pe(e,r);n.layoutSize.set(r,s,!1)}}}function $pe(e,t){const n=t==="width"?"x":"y",i=e.config,r=e.getScaleComponent(n);if(r){const s=r.get("type"),o=r.get("range");if(qt(s)){const a=Fp(i.view,t);return yu(o)||Vr(a)?"step":a}else return Hv(i.view,t)}else{if(e.hasProjection||e.mark==="arc")return Hv(i.view,t);{const s=Fp(i.view,t);return Vr(s)?s.step:s}}}function l3(e,t,n){return ee(t,{suffix:`by_${ee(e)}`,...n})}class vf extends GD{constructor(t,n,i,r){super(t,"facet",n,i,r,t.resolve),this.child=o9(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!Ld(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=W(t),i={};for(const r of n){if(![$s,Ms].includes(r)){Y(s1(r,"facet"));break}const s=t[r];if(s.field===void 0){Y(Pv(s,r));break}i[r]=this.initFacetFieldDef(s,r)}return i}initFacetFieldDef(t,n){const i=w4(t,n);return i.header?i.header=Yt(i.header):i.header===null&&(i.header=null),i}channelHasField(t){return G(this.facet,t)}fieldDef(t){return this.facet[t]}parseData(){this.component.data=j1(this),this.child.parseData()}parseLayoutSize(){t9(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection,Object.values(this.component.selection).some(t=>Dr(t))&&Kx(Xx)}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),Epe(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){const t={};for(const n of Si)for(const i of V4){const r=this.component.layoutHeaders[n],s=r[i],{facetFieldDef:o}=r;if(o){const a=Fl("titleOrient",o.header,this.config,n);if(["right","bottom"].includes(a)){const u=T1(n,a);t.titleAnchor??(t.titleAnchor={}),t.titleAnchor[u]="end"}}if(s!=null&&s[0]){const a=n==="row"?"height":"width",u=i==="header"?"headerBand":"footerBand";n!=="facet"&&!this.child.component.layoutSize.get(a)&&(t[u]??(t[u]={}),t[u][n]=.5),r.title&&(t.offset??(t.offset={}),t.offset[n==="row"?"rowTitle":"columnTitle"]=10)}}return t}assembleDefaultLayout(){const{column:t,row:n}=this.facet,i=t?this.columnDistinctSignal():n?1:void 0;let r="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(r="none"),{...this.getHeaderLayoutMixins(),...i?{columns:i}:{},bounds:"full",align:r}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof vf))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof vf?{...this.channelHasField("column")?{encode:{update:{columns:{field:ee(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(t)}:super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],i=[];if(this.child instanceof vf){if(this.child.channelHasField("column")){const r=ee(this.child.facet.column);t.push(r),n.push("distinct"),i.push(`distinct_${r}`)}}else for(const r of Xs){const s=this.child.component.scales[r];if(s&&!s.merged){const o=s.get("type"),a=s.get("range");if(qt(o)&&yu(a)){const u=L1(this.child,r),l=J4(u);l?(t.push(l),n.push("distinct"),i.push(`distinct_${l}`)):Y(Zx(r))}}}return{fields:t,ops:n,as:i}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:i,column:r}=this.facet,{fields:s,ops:o,as:a}=this.getCardinalityAggregateForChild(),u=[];for(const c of Si){const f=this.facet[c];if(f){u.push(ee(f));const{bin:d,sort:h}=f;if(lt(d)&&u.push(ee(f,{binSuffix:"end"})),Ts(h)){const{field:p,op:g=d1}=h,m=l3(f,h);i&&r?(s.push(m),o.push("max"),a.push(m)):(s.push(p),o.push(g),a.push(m))}else if(V(h)){const p=Tl(f,c);s.push(p),o.push("max"),a.push(p)}}}const l=!!i&&!!r;return{name:t,data:n,groupby:u,...l||s.length>0?{aggregate:{...l?{cross:l}:{},...s.length?{fields:s,ops:o,as:a}:{}}}:{}}}facetSortFields(t){const{facet:n}=this,i=n[t];return i?Ts(i.sort)?[l3(i,i.sort,{expr:"datum"})]:V(i.sort)?[Tl(i,t,{expr:"datum"})]:[ee(i,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,i=n[t];if(i){const{sort:r}=i;return[(Ts(r)?r.order:!V(r)&&r)||"ascending"]}return[]}assembleLabelTitle(){var r;const{facet:t,config:n}=this;if(t.facet)return n3(t.facet,"facet",n);const i={row:["top","bottom"],column:["left","right"]};for(const s of q4)if(t[s]){const o=Fl("labelOrient",(r=t[s])==null?void 0:r.header,n,s);if(i[s].includes(o))return n3(t[s],s,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,i=xpe(n),r=t.assembleGroupEncodeEntry(!1),s=this.assembleLabelTitle()||t.assembleTitle(),o=t.assembleGroupStyle();return[{name:this.getName("cell"),type:"group",...s?{title:s}:{},...o?{style:o}:{},from:{facet:this.assembleFacet()},sort:{field:Si.map(u=>this.facetSortFields(u)).flat(),order:Si.map(u=>this.facetSortOrder(u)).flat()},...i.length>0?{data:i}:{},...r?{encode:{update:r}}:{},...t.assembleGroup(Dfe(this,[]))}]}getMapping(){return this.facet}}function Mpe(e,t){const{row:n,column:i}=t;if(n&&i){let r=null;for(const s of[n,i])if(Ts(s.sort)){const{field:o,op:a=d1}=s.sort;e=r=new Eu(e,{joinaggregate:[{op:a,field:o,as:l3(s,s.sort,{forAs:!0})}],groupby:[ee(s)]})}return r}return null}function XD(e,t){var n,i,r,s;for(const o of t){const a=o.data;if(e.name&&o.hasName()&&e.name!==o.dataName)continue;const u=(n=e.format)==null?void 0:n.mesh,l=(i=a.format)==null?void 0:i.feature;if(u&&l)continue;const c=(r=e.format)==null?void 0:r.feature;if((c||l)&&c!==l)continue;const f=(s=a.format)==null?void 0:s.mesh;if(!((u||f)&&u!==f)){if(Vf(e)&&Vf(a)){if(ci(e.values,a.values))return o}else if(Al(e)&&Al(a)){if(e.url===a.url)return o}else if(TN(e)&&e.name===o.dataName)return o}}return null}function Tpe(e,t){if(e.data||!e.parent){if(e.data===null){const i=new uu({values:[]});return t.push(i),i}const n=XD(e.data,t);if(n)return Eo(e.data)||(n.data.format=SF({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const i=new uu(e.data);return t.push(i),i}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function Fpe(e,t,n){let i=0;for(const r of t.transforms){let s,o;if(ufe(r))o=e=new Ml(e,r),s="derived";else if(D4(r)){const a=_0e(r);o=e=fn.makeWithAncestors(e,{},a,n)??e,e=new Xl(e,t,r.filter)}else if(SN(r))o=e=Rr.makeFromTransform(e,r,t),s="number";else if(cfe(r))s="date",n.getWithExplicit(r.field).value===void 0&&(e=new fn(e,{[r.field]:s}),n.set(r.field,s,!1)),o=e=Nr.makeFromTransform(e,r);else if(ffe(r))o=e=Ki.makeFromTransform(e,r),s="number",B4(t)&&(e=new Io(e));else if(CN(r))o=e=Zf.make(e,t,r,i++),s="derived";else if(sfe(r))o=e=new Jl(e,r),s="number";else if(ofe(r))o=e=new Eu(e,r),s="number";else if(dfe(r))o=e=Ls.makeFromTransform(e,r),s="derived";else if(hfe(r))o=e=new O1(e,r),s="derived";else if(pfe(r))o=e=new D1(e,r),s="derived";else if(afe(r))o=e=new R1(e,r),s="derived";else if(Qce(r))o=e=new B1(e,r),s="derived";else if(rfe(r))e=new U1(e,r);else if(lfe(r))o=e=Ia.makeFromTransform(e,r),s="derived";else if(efe(r))o=e=new N1(e,r),s="derived";else if(tfe(r))o=e=new P1(e,r),s="derived";else if(nfe(r))o=e=new z1(e,r),s="derived";else if(ife(r))o=e=new I1(e,r),s="derived";else{Y(Lae(r));continue}if(o&&s!==void 0)for(const a of o.producedFields()??[])n.set(a,s,!1)}return e}function j1(e){var m;let t=Tpe(e,e.component.data.sources);const{outputNodes:n,outputNodeRefCounts:i}=e.component.data,r=e.data,o=!(r&&(Eo(r)||Al(r)||Vf(r)))&&e.parent?e.parent.component.data.ancestorParse.clone():new kfe;Eo(r)?(FN(r)?t=new jd(t,r.sequence):R4(r)&&(t=new Ud(t,r.graticule)),o.parseNothing=!0):((m=r==null?void 0:r.format)==null?void 0:m.parse)===null&&(o.parseNothing=!0),t=fn.makeExplicit(t,e,o)??t,t=new Io(t);const a=e.parent&&Ql(e.parent);(yt(e)||hi(e))&&a&&(t=Rr.makeFromEncoding(t,e)??t),e.transforms.length>0&&(t=Fpe(t,e,o));const u=E0e(e),l=w0e(e);t=fn.makeWithAncestors(t,{},{...u,...l},o)??t,yt(e)&&(t=Qu.parseAll(t,e),t=Yf.parseAll(t,e)),(yt(e)||hi(e))&&(a||(t=Rr.makeFromEncoding(t,e)??t),t=Nr.makeFromEncoding(t,e)??t,t=Ml.parseAllForSortIndex(t,e));const c=t=Ah(vt.Raw,e,t);if(yt(e)){const y=Ki.makeFromEncoding(t,e);y&&(t=y,B4(e)&&(t=new Io(t))),t=Ia.makeFromEncoding(t,e)??t,t=Ls.makeFromEncoding(t,e)??t}let f,d;if(yt(e)){const{markDef:y,mark:v,config:b}=e,x=Qe("invalid",y,b),{marks:_,scales:E}=d=NN({invalid:x,isPath:ea(v)});_!==E&&E==="include-invalid-values"&&(f=t=Ah(vt.PreFilterInvalid,e,t)),_==="exclude-invalid-values"&&(t=Ll.make(t,e,d)??t)}const h=t=Ah(vt.Main,e,t);let p;if(yt(e)&&d){const{marks:y,scales:v}=d;y==="include-invalid-values"&&v==="exclude-invalid-values"&&(t=Ll.make(t,e,d)??t,p=t=Ah(vt.PostFilterInvalid,e,t))}yt(e)&&vhe(e,h);let g=null;if(hi(e)){const y=e.getName("facet");t=Mpe(t,e.facet)??t,g=new Kl(t,e,y,h.getSource()),n[y]=g}return{...e.component.data,outputNodes:n,outputNodeRefCounts:i,raw:c,main:h,facetRoot:g,ancestorParse:o,preFilterInvalid:f,postFilterInvalid:p}}function Ah(e,t,n){const{outputNodes:i,outputNodeRefCounts:r}=t.component.data,s=t.getDataName(e),o=new Zn(n,s,e,r);return i[s]=o,o}class Lpe extends e9{constructor(t,n,i,r){var s,o,a,u;super(t,"concat",n,i,r,t.resolve),(((o=(s=t.resolve)==null?void 0:s.axis)==null?void 0:o.x)==="shared"||((u=(a=t.resolve)==null?void 0:a.axis)==null?void 0:u.y)==="shared")&&Y(Mae),this.children=this.getChildren(t).map((l,c)=>o9(l,this,this.getName(`concat_${c}`),void 0,r))}parseData(){this.component.data=j1(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of W(t.component.selection))this.component.selection[n]=t.component.selection[n]}Object.values(this.component.selection).some(t=>Dr(t))&&Kx(Xx)}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return b1(t)?t.vconcat:L4(t)?t.hconcat:t.concat}parseLayoutSize(){kpe(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=W4(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),i=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return{type:"group",name:t.getName("group"),...n?{title:n}:{},...i?{style:i}:{},...r?{encode:{update:r}}:{},...t.assembleGroup()}})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return{...t!=null?{columns:t}:{},bounds:"full",align:"each"}}}function Npe(e){return e===!1||e===null}const Dpe={disable:1,gridScale:1,scale:1,...YL,labelExpr:1,encode:1},KD=W(Dpe);class n9 extends Js{constructor(t={},n={},i=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=i}clone(){return new n9(Ce(this.explicit),Ce(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!Npe(this.get(t))}hasOrientSignalRef(){return ue(this.explicit.orient)}}function Rpe(e,t,n){const{encoding:i,config:r}=e,s=Lt(i[t])??Lt(i[ts(t)]),o=e.axis(t)||{},{format:a,formatType:u}=o;if(iu(u))return{text:Yi({fieldOrDatumDef:s,field:"datum.value",format:a,formatType:u,config:r}),...n};if(a===void 0&&u===void 0&&r.customFormatTypes){if(Cl(s)==="quantitative"){if(Sl(s)&&s.stack==="normalize"&&r.normalizedNumberFormatType)return{text:Yi({fieldOrDatumDef:s,field:"datum.value",format:r.normalizedNumberFormat,formatType:r.normalizedNumberFormatType,config:r}),...n};if(r.numberFormatType)return{text:Yi({fieldOrDatumDef:s,field:"datum.value",format:r.numberFormat,formatType:r.numberFormatType,config:r}),...n}}if(Cl(s)==="temporal"&&r.timeFormatType&&Z(s)&&!s.timeUnit)return{text:Yi({fieldOrDatumDef:s,field:"datum.value",format:r.timeFormat,formatType:r.timeFormatType,config:r}),...n}}return n}function Ope(e){return Xs.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[Hpe(n,e)]),t),{})}const Ipe={bottom:"top",top:"bottom",left:"right",right:"left"};function Ppe(e){const{axes:t,resolve:n}=e.component,i={top:0,bottom:0,right:0,left:0};for(const r of e.children){r.parseAxesAndHeaders();for(const s of W(r.component.axes))n.axis[s]=G4(e.component.resolve,s),n.axis[s]==="shared"&&(t[s]=zpe(t[s],r.component.axes[s]),t[s]||(n.axis[s]="independent",delete t[s]))}for(const r of Xs){for(const s of e.children)if(s.component.axes[r]){if(n.axis[r]==="independent"){t[r]=(t[r]??[]).concat(s.component.axes[r]);for(const o of s.component.axes[r]){const{value:a,explicit:u}=o.getWithExplicit("orient");if(!ue(a)){if(i[a]>0&&!u){const l=Ipe[a];i[a]>i[l]&&o.set("orient",l,!1)}i[a]++}}}delete s.component.axes[r]}if(n.axis[r]==="independent"&&t[r]&&t[r].length>1)for(const[s,o]of(t[r]||[]).entries())s>0&&o.get("grid")&&!o.explicit.grid&&(o.implicit.grid=!1)}}function zpe(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const r=e[i],s=t[i];if(!!r!=!!s)return;if(r&&s){const o=r.getWithExplicit("orient"),a=s.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;e[i]=Bpe(r,s)}}}else return t.map(n=>n.clone());return e}function Bpe(e,t){for(const n of KD){const i=Oo(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(r,s)=>{switch(n){case"title":return JF(r,s);case"gridScale":return{explicit:r.explicit,value:At(r.value,s.value)}}return _1(r,s,n,"axis")});e.setWithExplicit(n,i)}return e}function Upe(e,t,n,i,r){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(ue(n.labelAngle)?n.labelAngle:Hf(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===mD(i,r))return!0}return e===n[t]}const jpe=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function Hpe(e,t){var y,v;let n=t.axis(e);const i=new n9,r=Lt(t.encoding[e]),{mark:s,config:o}=t,a=(n==null?void 0:n.orient)||((y=o[e==="x"?"axisX":"axisY"])==null?void 0:y.orient)||((v=o.axis)==null?void 0:v.orient)||$he(e),u=t.getScaleComponent(e).get("type"),l=_he(e,u,a,t.config),c=n!==void 0?!n:e3("disable",o.style,n==null?void 0:n.style,l).configValue;if(i.set("disable",c,n!==void 0),c)return i;n=n||{};const f=She(r,n,e,o.style,l),d=DL(n.formatType,r,u),h=NL(r,r.type,n.format,n.formatType,o,!0),p={fieldOrDatumDef:r,axis:n,channel:e,model:t,scaleType:u,orient:a,labelAngle:f,format:h,formatType:d,mark:s,config:o};for(const b of KD){const x=b in hw?hw[b](p):N7(b)?n[b]:void 0,_=x!==void 0,E=Upe(x,b,n,t,e);if(_&&E)i.set(b,x,E);else{const{configValue:w=void 0,configFrom:S=void 0}=N7(b)&&b!=="values"?e3(b,o.style,n.style,l):{},$=w!==void 0;_&&!$?i.set(b,x,E):(S!=="vgAxisConfig"||jpe.has(b)&&$||Od(w)||ue(w))&&i.set(b,w,!1)}}const g=n.encoding??{},m=GL.reduce((b,x)=>{if(!i.hasAxisPart(x))return b;const _=wD(g[x]??{},t),E=x==="labels"?Rpe(t,e,_):_;return E!==void 0&&!et(E)&&(b[x]={update:E}),b},{});return et(m)||i.set("encode",m,!!n.encoding||n.labelAngle!==void 0),i}function qpe({encoding:e,size:t}){for(const n of Xs){const i=Qn(n);Vr(t[i])&&yo(e[n])&&(delete t[i],Y(iL(i)))}return t}const Vpe={vgMark:"arc",encodeEntry:e=>({...Oi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...Mn("x",e,{defaultPos:"mid"}),...Mn("y",e,{defaultPos:"mid"}),...Us(e,"radius"),...Us(e,"theta")})},Wpe={vgMark:"area",encodeEntry:e=>({...Oi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...Lp("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"}),...Lp("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"}),...z4(e)})},Gpe={vgMark:"rect",encodeEntry:e=>({...Oi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Us(e,"x"),...Us(e,"y")})},Ype={vgMark:"shape",encodeEntry:e=>({...Oi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[{type:"geoshape",projection:e.projectionName(),...n&&Z(n)&&n.type===Yl?{field:ee(n,{expr:"datum"})}:{}}]}},Zpe={vgMark:"image",encodeEntry:e=>({...Oi(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...Us(e,"x"),...Us(e,"y"),...I4(e,"url")})},Xpe={vgMark:"line",encodeEntry:e=>({...Oi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...Mn("x",e,{defaultPos:"mid"}),...Mn("y",e,{defaultPos:"mid"}),...Xt("size",e,{vgChannel:"strokeWidth"}),...z4(e)})},Kpe={vgMark:"trail",encodeEntry:e=>({...Oi(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...Mn("x",e,{defaultPos:"mid"}),...Mn("y",e,{defaultPos:"mid"}),...Xt("size",e),...z4(e)})};function i9(e,t){const{config:n}=e;return{...Oi(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...Mn("x",e,{defaultPos:"mid"}),...Mn("y",e,{defaultPos:"mid"}),...Xt("size",e),...Xt("angle",e),...Jpe(e,n,t)}}function Jpe(e,t,n){return n?{shape:{value:n}}:Xt("shape",e)}const Qpe={vgMark:"symbol",encodeEntry:e=>i9(e)},ege={vgMark:"symbol",encodeEntry:e=>i9(e,"circle")},tge={vgMark:"symbol",encodeEntry:e=>i9(e,"square")},nge={vgMark:"rect",encodeEntry:e=>({...Oi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Us(e,"x"),...Us(e,"y")})},ige={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:{...Oi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Lp("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"}),...Lp("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"}),...Xt("size",e,{vgChannel:"strokeWidth"})}}},rge={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return{...Oi(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...Mn("x",e,{defaultPos:"mid"}),...Mn("y",e,{defaultPos:"mid"}),...I4(e),...Xt("size",e,{vgChannel:"fontSize"}),...Xt("angle",e),...nw("align",sge(e.markDef,n,t)),...nw("baseline",oge(e.markDef,n,t)),...Mn("radius",e,{defaultPos:null}),...Mn("theta",e,{defaultPos:null})}}};function sge(e,t,n){if(Qe("align",e,n)===void 0)return"center"}function oge(e,t,n){if(Qe("baseline",e,n)===void 0)return"middle"}const age={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r=i==="horizontal"?"x":"y",s=i==="horizontal"?"y":"x",o=i==="horizontal"?"height":"width";return{...Oi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Us(e,r),...Mn(s,e,{defaultPos:"mid",vgChannel:s==="y"?"yc":"xc"}),[o]:ct(Qe("thickness",n,t))}}},$h={arc:Vpe,area:Wpe,bar:Gpe,circle:ege,geoshape:Ype,image:Zpe,line:Xpe,point:Qpe,rect:nge,rule:ige,square:tge,text:rge,tick:age,trail:Kpe};function uge(e){if(Ne([c1,u1,sle],e.mark)){const t=eN(e.mark,e.encoding);if(t.length>0)return lge(e,t)}else if(e.mark===l1){const t=Ov.some(n=>Qe(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return cge(e)}return r9(e)}const Mw="faceted_path_";function lge(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:Mw+e.requestDataName(vt.Main),data:e.requestDataName(vt.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:r9(e,{fromPrefix:Mw})}]}const Tw="stack_group_";function cge(e){var l;const[t]=r9(e,{fromPrefix:Tw}),n=e.scaleName(e.stack.fieldChannel),i=(c={})=>e.vgField(e.stack.fieldChannel,c),r=(c,f)=>{const d=[i({prefix:"min",suffix:"start",expr:f}),i({prefix:"max",suffix:"start",expr:f}),i({prefix:"min",suffix:"end",expr:f}),i({prefix:"max",suffix:"end",expr:f})];return`${c}(${d.map(h=>`scale('${n}',${h})`).join(",")})`};let s,o;e.stack.fieldChannel==="x"?(s={...vl(t.encode.update,["y","yc","y2","height",...Ov]),x:{signal:r("min","datum")},x2:{signal:r("max","datum")},clip:{value:!0}},o={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update={...Yn(t.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(s={...vl(t.encode.update,["x","xc","x2","width"]),y:{signal:r("min","datum")},y2:{signal:r("max","datum")},clip:{value:!0}},o={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update={...Yn(t.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const c of Ov){const f=Hr(c,e.markDef,e.config);t.encode.update[c]?(s[c]=t.encode.update[c],delete t.encode.update[c]):f&&(s[c]=ct(f)),f&&(t.encode.update[c]={value:0})}const a=[];if(((l=e.stack.groupbyChannels)==null?void 0:l.length)>0)for(const c of e.stack.groupbyChannels){const f=e.fieldDef(c),d=ee(f);d&&a.push(d),(f!=null&&f.bin||f!=null&&f.timeUnit)&&a.push(ee(f,{binSuffix:"end"}))}return s=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((c,f)=>{if(t.encode.update[f])return{...c,[f]:t.encode.update[f]};{const d=Hr(f,e.markDef,e.config);return d!==void 0?{...c,[f]:ct(d)}:c}},s),s.stroke&&(s.strokeForeground={value:!0},s.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(vt.Main),name:Tw+e.requestDataName(vt.Main),groupby:a,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:s},marks:[{type:"group",encode:{update:o},marks:[t]}]}]}function fge(e){const{encoding:t,stack:n,mark:i,markDef:r,config:s}=e,o=t.order;if(!(!V(o)&&nr(o)&&Dv(o.value)||!o&&Dv(Qe("order",r,s)))){if((V(o)||Z(o))&&!n)return ZF(o,{expr:"datum"});if(ea(i)){const a=r.orient==="horizontal"?"y":"x",u=t[a];if(Z(u))return{field:a}}}}function r9(e,t={fromPrefix:""}){const{mark:n,markDef:i,encoding:r,config:s}=e,o=At(i.clip,dge(e),hge(e)),a=GF(i),u=r.key,l=fge(e),c=pge(e),f=Qe("aria",i,s),d=$h[n].postEncodingTransform?$h[n].postEncodingTransform(e):null;return[{name:e.getName("marks"),type:$h[n].vgMark,...o?{clip:o}:{},...a?{style:a}:{},...u?{key:u.field}:{},...l?{sort:l}:{},...c||{},...f===!1?{aria:f}:{},from:{data:t.fromPrefix+e.requestDataName(vt.Main)},encode:{update:$h[n].encodeEntry(e)},...d?{transform:d}:{}}]}function dge(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t!=null&&t.get("selectionExtent")||n!=null&&n.get("selectionExtent")?!0:void 0}function hge(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function pge(e){if(!e.component.selection)return null;const t=W(e.component.selection).length;let n=t,i=e.parent;for(;i&&n===0;)n=W(i.component.selection).length,i=i.parent;return n?{interactive:t>0||e.mark==="geoshape"||!!e.encoding.tooltip||!!e.markDef.tooltip}:null}class JD extends GD{constructor(t,n,i,r={},s){super(t,"unit",n,i,s,void 0,R7(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[],this.correctDataNames=l=>{var c,f,d;return(c=l.from)!=null&&c.data&&(l.from.data=this.lookupDataSource(l.from.data),"time"in this.encoding&&(l.from.data=l.from.data+RN)),(d=(f=l.from)==null?void 0:f.facet)!=null&&d.data&&(l.from.facet.data=this.lookupDataSource(l.from.facet.data)),l};const o=qr(t.mark)?{...t.mark}:{type:t.mark},a=o.type;o.filled===void 0&&(o.filled=jce(o,s,{graticule:t.data&&R4(t.data)}));const u=this.encoding=Wle(t.encoding||{},a,o.filled,s);this.markDef=_N(o,u,s),this.size=qpe({encoding:u,size:R7(t)?{...r,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}}:r}),this.stack=xN(this.markDef,u),this.specifiedScales=this.initScales(a,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegends(u),this.specifiedProjection=t.projection,this.selection=(t.params??[]).filter(l=>T4(l))}get hasProjection(){const{encoding:t}=this,n=this.mark===kL,i=t&&Poe.some(r=>ke(t[r]));return n||i}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return Wx.reduce((i,r)=>{const s=Lt(n[r]);return s&&(i[r]=this.initScale(s.scale??{})),i},{})}initScale(t){const{domain:n,range:i}=t,r=Yt(t);return V(n)&&(r.domain=n.map(oi)),V(i)&&(r.range=i.map(oi)),r}initAxes(t){return Xs.reduce((n,i)=>{const r=t[i];if(ke(r)||i===gt&&ke(t.x2)||i===Wt&&ke(t.y2)){const s=ke(r)?r.axis:void 0;n[i]=s&&this.initAxis({...s})}return n},{})}initAxis(t){const n=W(t),i={};for(const r of n){const s=t[r];i[r]=Od(s)?WF(s):oi(s)}return i}initLegends(t){return Zoe.reduce((n,i)=>{const r=Lt(t[i]);if(r&&Koe(i)){const s=r.legend;n[i]=s&&Yt(s)}return n},{})}parseData(){this.component.data=j1(this)}parseLayoutSize(){Ape(this)}parseSelections(){this.component.selection=yhe(this,this.selection)}parseMarkGroup(){this.component.mark=uge(this)}parseAxesAndHeaders(){this.component.axes=Ope(this)}assembleSelectionTopLevelSignals(t){return Rfe(this,t)}assembleSignals(){return[...hD(this),...Nfe(this,[])]}assembleSelectionData(t){return Ofe(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return W4(this)}assembleMarks(){let t=this.component.mark??[];return(!this.parent||!Ql(this.parent))&&(t=zN(this,t)),t.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return t!==void 0?t:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return Ra(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return ir(n)}typedFieldDef(t){const n=this.fieldDef(t);return zn(n)?n:null}}class s9 extends e9{constructor(t,n,i,r,s){super(t,"layer",n,i,s,t.resolve,t.view);const o={...r,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}};this.children=t.layer.map((a,u)=>{if(x1(a))return new s9(a,this,this.getName(`layer_${u}`),o,s);if(Ks(a))return new JD(a,this,this.getName(`layer_${u}`),o,s);throw new Error(Yx(a))})}parseData(){this.component.data=j1(this);for(const t of this.children)t.parseData()}parseLayoutSize(){Spe(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of W(t.component.selection))this.component.selection[n]=t.component.selection[n]}Object.values(this.component.selection).some(t=>Dr(t))&&Kx(Xx)}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){Ppe(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),hD(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),W4(this))}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const i of this.children)for(const r of ce(i.assembleGroupStyle()))t.add(r);const n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return Ife(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),TD(this))}}function o9(e,t,n,i,r){if(h1(e))return new vf(e,t,n,r);if(x1(e))return new s9(e,t,n,i,r);if(Ks(e))return new JD(e,t,n,i,r);if(mce(e))return new Lpe(e,t,n,r);throw new Error(Yx(e))}function gge(e,t={}){t.logger&&bue(t.logger),t.fieldTitle&&qL(t.fieldTitle);try{const n=bN(cA(t.config,e.config)),i=$N(e,n),r=o9(i,null,"",void 0,n);return r.parse(),z0e(r.component.data,r),{spec:yge(r,mge(e,i.autosize,n,r),e.datasets,e.usermeta),normalized:i}}finally{t.logger&&xue(),t.fieldTitle&&Ile()}}function mge(e,t,n,i){const r=i.component.layoutSize.get("width"),s=i.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},i.hasAxisOrientSignalRef()&&(t.resize=!0)):le(t)&&(t={type:t}),r&&s&&Efe(t.type)){if(r==="step"&&s==="step")Y(b7()),t.type="pad";else if(r==="step"||s==="step"){const o=r==="step"?"width":"height";Y(b7(n1(o)));const a=o==="width"?"height":"width";t.type=Cfe(a)}}return{...W(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t},...G7(n,!1),...G7(e,!0)}}function yge(e,t,n={},i){const r=e.config?Tce(e.config):void 0,s=_pe(e.component.data,n),o=e.assembleSelectionData(s),a=e.assembleProjections(),u=e.assembleTitle(),l=e.assembleGroupStyle(),c=e.assembleGroupEncodeEntry(!0);let f=e.assembleLayoutSignals();f=f.filter(p=>(p.name==="width"||p.name==="height")&&p.value!==void 0?(t[p.name]=+p.value,!1):!0);const{params:d,...h}=t;return{$schema:"https://vega.github.io/schema/vega/v5.json",...e.description?{description:e.description}:{},...h,...u?{title:u}:{},...l?{style:l}:{},...c?{encode:{update:c}}:{},data:o,...a.length>0?{projections:a}:{},...e.assembleGroup([...f,...e.assembleSelectionTopLevelSignals([]),...gN(d)]),...r?{config:r}:{},...i?{usermeta:i}:{}}}const vge=Loe.version,bge=Object.freeze(Object.defineProperty({__proto__:null,accessPathDepth:xl,accessPathWithDatum:Px,accessWithDatumToUnescapedPath:Ye,compile:gge,contains:Ne,deepEqual:ci,deleteNestedProperty:wp,duplicate:Ce,entries:No,every:Rx,fieldIntersection:Ix,flatAccessWithDatum:AF,getFirstDefined:At,hasIntersection:Ox,hasProperty:G,hash:De,internalField:TF,isBoolean:jf,isEmpty:et,isEqual:Doe,isInternalField:FF,isNullOrFalse:Dv,isNumeric:Kg,keys:W,logicalExpr:gf,mergeDeep:SF,never:CF,normalize:$N,normalizeAngle:Hf,omit:Yn,pick:vl,prefixGenerator:Rv,removePathFromField:Vl,replaceAll:Ka,replacePathInField:Li,resetIdCounter:Ooe,setEqual:kF,some:bl,stringify:tt,titleCase:Sd,unique:Ar,uniqueId:MF,vals:Qt,varName:pt,version:vge},Symbol.toStringTag,{value:"Module"})),Cy='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',xge='IBM Plex Sans Condensed, system-ui, -apple-system, BlinkMacSystemFont, ".SFNSText-Regular", sans-serif',Sy=400,Mh={textPrimary:{g90:"#f4f4f4",g100:"#f4f4f4",white:"#161616",g10:"#161616"},textSecondary:{g90:"#c6c6c6",g100:"#c6c6c6",white:"#525252",g10:"#525252"},layerAccent01:{white:"#e0e0e0",g10:"#e0e0e0",g90:"#525252",g100:"#393939"},gridBg:{white:"#ffffff",g10:"#ffffff",g90:"#161616",g100:"#161616"}},_ge=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],wge=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function H1({theme:e,background:t}){const n=["white","g10"].includes(e)?"light":"dark",i=Mh.gridBg[e],r=Mh.textPrimary[e],s=Mh.textSecondary[e],o=n==="dark"?_ge:wge,a=n==="dark"?"#d4bbff":"#6929c4";return{background:t,arc:{fill:a},area:{fill:a},path:{stroke:a},rect:{fill:a},shape:{stroke:a},symbol:{stroke:a},circle:{fill:a},view:{fill:i,stroke:i},group:{fill:i},title:{color:r,anchor:"start",dy:-15,fontSize:16,font:Cy,fontWeight:600},axis:{labelColor:s,labelFontSize:12,labelFont:xge,labelFontWeight:Sy,titleColor:r,titleFontWeight:600,titleFontSize:12,grid:!0,gridColor:Mh.layerAccent01[e],labelAngle:0},axisX:{titlePadding:10},axisY:{titlePadding:2.5},style:{"guide-label":{font:Cy,fill:s,fontWeight:Sy},"guide-title":{font:Cy,fill:s,fontWeight:Sy}},range:{category:o,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}H1({theme:"white",background:"#ffffff"});H1({theme:"g10",background:"#f4f4f4"});H1({theme:"g90",background:"#262626"});H1({theme:"g100",background:"#161616"});var ky={};/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var Ege=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])},e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),Cge=Object.prototype.hasOwnProperty;function c3(e,t){return Cge.call(e,t)}function f3(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var i=[];for(var r in e)c3(e,r)&&i.push(r);return i}function fi(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function d3(e){for(var t=0,n=e.length,i;t<n;){if(i=e.charCodeAt(t),i>=48&&i<=57){t++;continue}return!1}return!0}function da(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function QD(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function h3(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(h3(e[t]))return!0}else if(typeof e=="object"){for(var i=f3(e),r=i.length,s=0;s<r;s++)if(h3(e[i[s]]))return!0}}return!1}function Fw(e,t){var n=[e];for(var i in t){var r=typeof t[i]=="object"?JSON.stringify(t[i],null,2):t[i];typeof r<"u"&&n.push(i+": "+r)}return n.join(`
`)}var eR=function(e){Ege(t,e);function t(n,i,r,s,o){var a=this.constructor,u=e.call(this,Fw(n,{name:i,index:r,operation:s,tree:o}))||this;return u.name=i,u.index=r,u.operation=s,u.tree=o,Object.setPrototypeOf(u,a.prototype),u.message=Fw(n,{name:i,index:r,operation:s,tree:o}),u}return t}(Error),wt=eR,Sge=fi,ju={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=Ip(n,this.path);i&&(i=fi(i));var r=Pa(n,{op:"remove",path:this.from}).removed;return Pa(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=Ip(n,this.from);return Pa(n,{op:"add",path:this.path,value:fi(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:Xf(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},kge={add:function(e,t,n){return d3(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var i=e.splice(t,1);return{newDocument:n,removed:i[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:ju.move,copy:ju.copy,test:ju.test,_get:ju._get};function Ip(e,t){if(t=="")return e;var n={op:"_get",path:t};return Pa(e,n),n.value}function Pa(e,t,n,i,r,s){if(n===void 0&&(n=!1),i===void 0&&(i=!0),r===void 0&&(r=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(t,0,e,t.path):Pp(t,0)),t.path===""){var o={newDocument:e};if(t.op==="add")return o.newDocument=t.value,o;if(t.op==="replace")return o.newDocument=t.value,o.removed=e,o;if(t.op==="move"||t.op==="copy")return o.newDocument=Ip(e,t.from),t.op==="move"&&(o.removed=e),o;if(t.op==="test"){if(o.test=Xf(e,t.value),o.test===!1)throw new wt("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o.newDocument=e,o}else{if(t.op==="remove")return o.removed=e,o.newDocument=null,o;if(t.op==="_get")return t.value=e,o;if(n)throw new wt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,t,e);return o}}else{i||(e=fi(e));var a=t.path||"",u=a.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,p=void 0;for(typeof n=="function"?p=n:p=Pp;;){if(h=u[c],h&&h.indexOf("~")!=-1&&(h=QD(h)),r&&(h=="__proto__"||h=="prototype"&&c>0&&u[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&p(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!d3(h))throw new wt("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,t,e);d3(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new wt("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,t,e);var o=kge[t.op].call(t,l,h,e);if(o.test===!1)throw new wt("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}}else if(c>=f){var o=ju[t.op].call(t,l,h,e);if(o.test===!1)throw new wt("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}if(l=l[h],n&&c<f&&(!l||typeof l!="object"))throw new wt("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,t,e)}}}function a9(e,t,n,i,r){if(i===void 0&&(i=!0),r===void 0&&(r=!0),n&&!Array.isArray(t))throw new wt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=fi(e));for(var s=new Array(t.length),o=0,a=t.length;o<a;o++)s[o]=Pa(e,t[o],n,!0,r,o),e=s[o].newDocument;return s.newDocument=e,s}function Age(e,t,n){var i=Pa(e,t);if(i.test===!1)throw new wt("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function Pp(e,t,n,i){if(typeof e!="object"||e===null||Array.isArray(e))throw new wt("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(ju[e.op]){if(typeof e.path!="string")throw new wt("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new wt('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new wt("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new wt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&h3(e.value))throw new wt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var r=e.path.split("/").length,s=i.split("/").length;if(r!==s+1&&r!==s)throw new wt("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==i)throw new wt("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:void 0},a=tR([o],n);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new wt("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new wt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function tR(e,t,n){try{if(!Array.isArray(e))throw new wt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)a9(fi(t),fi(e),n||!0);else{n=n||Pp;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(r){if(r instanceof wt)return r;throw r}}function Xf(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),i=Array.isArray(t),r,s,o;if(n&&i){if(s=e.length,s!=t.length)return!1;for(r=s;r--!==0;)if(!Xf(e[r],t[r]))return!1;return!0}if(n!=i)return!1;var a=Object.keys(e);if(s=a.length,s!==Object.keys(t).length)return!1;for(r=s;r--!==0;)if(!t.hasOwnProperty(a[r]))return!1;for(r=s;r--!==0;)if(o=a[r],!Xf(e[o],t[o]))return!1;return!0}return e!==e&&t!==t}var $ge=Object.freeze({__proto__:null,JsonPatchError:wt,_areEquals:Xf,applyOperation:Pa,applyPatch:a9,applyReducer:Age,deepClone:Sge,getValueByPointer:Ip,validate:tR,validator:Pp});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var u9=new WeakMap,Mge=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),Tge=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function Fge(e){return u9.get(e)}function Lge(e,t){return e.observers.get(t)}function Nge(e,t){e.observers.delete(t.callback)}function Dge(e,t){t.unobserve()}function Rge(e,t){var n=[],i,r=Fge(e);if(!r)r=new Mge(e),u9.set(e,r);else{var s=Lge(r,t);i=s&&s.observer}if(i)return i;if(i={},r.value=fi(e),t){i.callback=t,i.next=null;var o=function(){p3(i)},a=function(){clearTimeout(i.next),i.next=setTimeout(o)};typeof window<"u"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return i.patches=n,i.object=e,i.unobserve=function(){p3(i),clearTimeout(i.next),Nge(r,i),typeof window<"u"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},r.observers.set(t,new Tge(t,i)),i}function p3(e,t){t===void 0&&(t=!1);var n=u9.get(e.object);l9(n.value,e.object,e.patches,"",t),e.patches.length&&a9(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function l9(e,t,n,i,r){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var s=f3(t),o=f3(e),a=!1,u=o.length-1;u>=0;u--){var l=o[u],c=e[l];if(c3(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?l9(c,f,n,i+"/"+da(l),r):c!==f&&(r&&n.push({op:"test",path:i+"/"+da(l),value:fi(c)}),n.push({op:"replace",path:i+"/"+da(l),value:fi(f)}))}else Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+da(l),value:fi(c)}),n.push({op:"remove",path:i+"/"+da(l)}),a=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}))}if(!(!a&&s.length==o.length))for(var u=0;u<s.length;u++){var l=s[u];!c3(e,l)&&t[l]!==void 0&&n.push({op:"add",path:i+"/"+da(l),value:fi(t[l])})}}}function Oge(e,t,n){n===void 0&&(n=!1);var i=[];return l9(e,t,i,"",n),i}var Ige=Object.freeze({__proto__:null,compare:Oge,generate:p3,observe:Rge,unobserve:Dge});Object.assign({},$ge,Ige,{JsonPatchError:eR,deepClone:fi,escapePathComponent:da,unescapePathComponent:QD});var Ay,Lw;function Pge(){if(Lw)return Ay;Lw=1;class e{constructor(){this.max=1e3,this.map=new Map}get(n){const i=this.map.get(n);if(i!==void 0)return this.map.delete(n),this.map.set(n,i),i}delete(n){return this.map.delete(n)}set(n,i){if(!this.delete(n)&&i!==void 0){if(this.map.size>=this.max){const s=this.map.keys().next().value;this.delete(s)}this.map.set(n,i)}return this}}return Ay=e,Ay}var $y,Nw;function c9(){if(Nw)return $y;Nw=1;const e=Object.freeze({loose:!0}),t=Object.freeze({});return $y=i=>i?typeof i!="object"?e:i:t,$y}var Th={exports:{}},My,Dw;function f9(){if(Dw)return My;Dw=1;const e="2.0.0",t=256,n=Number.MAX_SAFE_INTEGER||9007199254740991,i=16,r=t-6;return My={MAX_LENGTH:t,MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:r,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:e,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},My}var Ty,Rw;function q1(){return Rw||(Rw=1,Ty=typeof process=="object"&&ky&&ky.NODE_DEBUG&&/\bsemver\b/i.test(ky.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{}),Ty}var Ow;function d9(){return Ow||(Ow=1,function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:r}=f9(),s=q1();t=e.exports={};const o=t.re=[],a=t.safeRe=[],u=t.src=[],l=t.t={};let c=0;const f="[a-zA-Z0-9-]",d=[["\\s",1],["\\d",r],[f,i]],h=g=>{for(const[m,y]of d)g=g.split(`${m}*`).join(`${m}{0,${y}}`).split(`${m}+`).join(`${m}{1,${y}}`);return g},p=(g,m,y)=>{const v=h(m),b=c++;s(g,b,m),l[g]=b,u[b]=m,o[b]=new RegExp(m,y?"g":void 0),a[b]=new RegExp(v,y?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),p("MAINVERSION",`(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${u[l.NUMERICIDENTIFIER]}|${u[l.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${u[l.NUMERICIDENTIFIERLOOSE]}|${u[l.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${u[l.PRERELEASEIDENTIFIER]}(?:\\.${u[l.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${u[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[l.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${f}+`),p("BUILD",`(?:\\+(${u[l.BUILDIDENTIFIER]}(?:\\.${u[l.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${u[l.MAINVERSION]}${u[l.PRERELEASE]}?${u[l.BUILD]}?`),p("FULL",`^${u[l.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${u[l.MAINVERSIONLOOSE]}${u[l.PRERELEASELOOSE]}?${u[l.BUILD]}?`),p("LOOSE",`^${u[l.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${u[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${u[l.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:${u[l.PRERELEASE]})?${u[l.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:${u[l.PRERELEASELOOSE]})?${u[l.BUILD]}?)?)?`),p("XRANGE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAINLOOSE]}$`),p("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),p("COERCE",`${u[l.COERCEPLAIN]}(?:$|[^\\d])`),p("COERCEFULL",u[l.COERCEPLAIN]+`(?:${u[l.PRERELEASE]})?(?:${u[l.BUILD]})?(?:$|[^\\d])`),p("COERCERTL",u[l.COERCE],!0),p("COERCERTLFULL",u[l.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${u[l.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",p("TILDE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${u[l.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",p("CARET",`^${u[l.LONECARET]}${u[l.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${u[l.LONECARET]}${u[l.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${u[l.GTLT]}\\s*(${u[l.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]}|${u[l.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${u[l.XRANGEPLAIN]})\\s+-\\s+(${u[l.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${u[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[l.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(Th,Th.exports)),Th.exports}var Fy,Iw;function zge(){if(Iw)return Fy;Iw=1;const e=/^[0-9]+$/,t=(i,r)=>{const s=e.test(i),o=e.test(r);return s&&o&&(i=+i,r=+r),i===r?0:s&&!o?-1:o&&!s?1:i<r?-1:1};return Fy={compareIdentifiers:t,rcompareIdentifiers:(i,r)=>t(r,i)},Fy}var Ly,Pw;function h9(){if(Pw)return Ly;Pw=1;const e=q1(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:n}=f9(),{safeRe:i,t:r}=d9(),s=c9(),{compareIdentifiers:o}=zge();class a{constructor(l,c){if(c=s(c),l instanceof a){if(l.loose===!!c.loose&&l.includePrerelease===!!c.includePrerelease)return l;l=l.version}else if(typeof l!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof l}".`);if(l.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",l,c),this.options=c,this.loose=!!c.loose,this.includePrerelease=!!c.includePrerelease;const f=l.trim().match(c.loose?i[r.LOOSE]:i[r.FULL]);if(!f)throw new TypeError(`Invalid Version: ${l}`);if(this.raw=l,this.major=+f[1],this.minor=+f[2],this.patch=+f[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");f[4]?this.prerelease=f[4].split(".").map(d=>{if(/^[0-9]+$/.test(d)){const h=+d;if(h>=0&&h<n)return h}return d}):this.prerelease=[],this.build=f[5]?f[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(l){if(e("SemVer.compare",this.version,this.options,l),!(l instanceof a)){if(typeof l=="string"&&l===this.version)return 0;l=new a(l,this.options)}return l.version===this.version?0:this.compareMain(l)||this.comparePre(l)}compareMain(l){return l instanceof a||(l=new a(l,this.options)),o(this.major,l.major)||o(this.minor,l.minor)||o(this.patch,l.patch)}comparePre(l){if(l instanceof a||(l=new a(l,this.options)),this.prerelease.length&&!l.prerelease.length)return-1;if(!this.prerelease.length&&l.prerelease.length)return 1;if(!this.prerelease.length&&!l.prerelease.length)return 0;let c=0;do{const f=this.prerelease[c],d=l.prerelease[c];if(e("prerelease compare",c,f,d),f===void 0&&d===void 0)return 0;if(d===void 0)return 1;if(f===void 0)return-1;if(f===d)continue;return o(f,d)}while(++c)}compareBuild(l){l instanceof a||(l=new a(l,this.options));let c=0;do{const f=this.build[c],d=l.build[c];if(e("build compare",c,f,d),f===void 0&&d===void 0)return 0;if(d===void 0)return 1;if(f===void 0)return-1;if(f===d)continue;return o(f,d)}while(++c)}inc(l,c,f){switch(l){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",c,f);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",c,f);break;case"prepatch":this.prerelease.length=0,this.inc("patch",c,f),this.inc("pre",c,f);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",c,f),this.inc("pre",c,f);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const d=Number(f)?1:0;if(!c&&f===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[d];else{let h=this.prerelease.length;for(;--h>=0;)typeof this.prerelease[h]=="number"&&(this.prerelease[h]++,h=-2);if(h===-1){if(c===this.prerelease.join(".")&&f===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(d)}}if(c){let h=[c,d];f===!1&&(h=[c]),o(this.prerelease[0],c)===0?isNaN(this.prerelease[1])&&(this.prerelease=h):this.prerelease=h}break}default:throw new Error(`invalid increment argument: ${l}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return Ly=a,Ly}var Ny,zw;function ec(){if(zw)return Ny;zw=1;const e=h9();return Ny=(n,i,r)=>new e(n,r).compare(new e(i,r)),Ny}var Dy,Bw;function Bge(){if(Bw)return Dy;Bw=1;const e=ec();return Dy=(n,i,r)=>e(n,i,r)===0,Dy}var Ry,Uw;function Uge(){if(Uw)return Ry;Uw=1;const e=ec();return Ry=(n,i,r)=>e(n,i,r)!==0,Ry}var Oy,jw;function jge(){if(jw)return Oy;jw=1;const e=ec();return Oy=(n,i,r)=>e(n,i,r)>0,Oy}var Iy,Hw;function Hge(){if(Hw)return Iy;Hw=1;const e=ec();return Iy=(n,i,r)=>e(n,i,r)>=0,Iy}var Py,qw;function qge(){if(qw)return Py;qw=1;const e=ec();return Py=(n,i,r)=>e(n,i,r)<0,Py}var zy,Vw;function Vge(){if(Vw)return zy;Vw=1;const e=ec();return zy=(n,i,r)=>e(n,i,r)<=0,zy}var By,Ww;function Wge(){if(Ww)return By;Ww=1;const e=Bge(),t=Uge(),n=jge(),i=Hge(),r=qge(),s=Vge();return By=(a,u,l,c)=>{switch(u){case"===":return typeof a=="object"&&(a=a.version),typeof l=="object"&&(l=l.version),a===l;case"!==":return typeof a=="object"&&(a=a.version),typeof l=="object"&&(l=l.version),a!==l;case"":case"=":case"==":return e(a,l,c);case"!=":return t(a,l,c);case">":return n(a,l,c);case">=":return i(a,l,c);case"<":return r(a,l,c);case"<=":return s(a,l,c);default:throw new TypeError(`Invalid operator: ${u}`)}},By}var Uy,Gw;function Gge(){if(Gw)return Uy;Gw=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(c,f){if(f=n(f),c instanceof t){if(c.loose===!!f.loose)return c;c=c.value}c=c.trim().split(/\s+/).join(" "),o("comparator",c,f),this.options=f,this.loose=!!f.loose,this.parse(c),this.semver===e?this.value="":this.value=this.operator+this.semver.version,o("comp",this)}parse(c){const f=this.options.loose?i[r.COMPARATORLOOSE]:i[r.COMPARATOR],d=c.match(f);if(!d)throw new TypeError(`Invalid comparator: ${c}`);this.operator=d[1]!==void 0?d[1]:"",this.operator==="="&&(this.operator=""),d[2]?this.semver=new a(d[2],this.options.loose):this.semver=e}toString(){return this.value}test(c){if(o("Comparator.test",c,this.options.loose),this.semver===e||c===e)return!0;if(typeof c=="string")try{c=new a(c,this.options)}catch{return!1}return s(c,this.operator,this.semver,this.options)}intersects(c,f){if(!(c instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new u(c.value,f).test(this.value):c.operator===""?c.value===""?!0:new u(this.value,f).test(c.semver):(f=n(f),f.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||s(this.semver,"<",c.semver,f)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||s(this.semver,">",c.semver,f)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}Uy=t;const n=c9(),{safeRe:i,t:r}=d9(),s=Wge(),o=q1(),a=h9(),u=nR();return Uy}var jy,Yw;function nR(){if(Yw)return jy;Yw=1;const e=/\s+/g;class t{constructor(A,M){if(M=r(M),A instanceof t)return A.loose===!!M.loose&&A.includePrerelease===!!M.includePrerelease?A:new t(A.raw,M);if(A instanceof s)return this.raw=A.value,this.set=[[A]],this.formatted=void 0,this;if(this.options=M,this.loose=!!M.loose,this.includePrerelease=!!M.includePrerelease,this.raw=A.trim().replace(e," "),this.set=this.raw.split("||").map(L=>this.parseRange(L.trim())).filter(L=>L.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const L=this.set[0];if(this.set=this.set.filter(D=>!g(D[0])),this.set.length===0)this.set=[L];else if(this.set.length>1){for(const D of this.set)if(D.length===1&&m(D[0])){this.set=[D];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let A=0;A<this.set.length;A++){A>0&&(this.formatted+="||");const M=this.set[A];for(let L=0;L<M.length;L++)L>0&&(this.formatted+=" "),this.formatted+=M[L].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(A){const L=((this.options.includePrerelease&&h)|(this.options.loose&&p))+":"+A,D=i.get(L);if(D)return D;const O=this.options.loose,j=O?u[l.HYPHENRANGELOOSE]:u[l.HYPHENRANGE];A=A.replace(j,P(this.options.includePrerelease)),o("hyphen replace",A),A=A.replace(u[l.COMPARATORTRIM],c),o("comparator trim",A),A=A.replace(u[l.TILDETRIM],f),o("tilde trim",A),A=A.replace(u[l.CARETTRIM],d),o("caret trim",A);let J=A.split(" ").map(de=>v(de,this.options)).join(" ").split(/\s+/).map(de=>T(de,this.options));O&&(J=J.filter(de=>(o("loose invalid filter",de,this.options),!!de.match(u[l.COMPARATORLOOSE])))),o("range list",J);const K=new Map,fe=J.map(de=>new s(de,this.options));for(const de of fe){if(g(de))return[de];K.set(de.value,de)}K.size>1&&K.has("")&&K.delete("");const we=[...K.values()];return i.set(L,we),we}intersects(A,M){if(!(A instanceof t))throw new TypeError("a Range is required");return this.set.some(L=>y(L,M)&&A.set.some(D=>y(D,M)&&L.every(O=>D.every(j=>O.intersects(j,M)))))}test(A){if(!A)return!1;if(typeof A=="string")try{A=new a(A,this.options)}catch{return!1}for(let M=0;M<this.set.length;M++)if(R(this.set[M],A,this.options))return!0;return!1}}jy=t;const n=Pge(),i=new n,r=c9(),s=Gge(),o=q1(),a=h9(),{safeRe:u,t:l,comparatorTrimReplace:c,tildeTrimReplace:f,caretTrimReplace:d}=d9(),{FLAG_INCLUDE_PRERELEASE:h,FLAG_LOOSE:p}=f9(),g=C=>C.value==="<0.0.0-0",m=C=>C.value==="",y=(C,A)=>{let M=!0;const L=C.slice();let D=L.pop();for(;M&&L.length;)M=L.every(O=>D.intersects(O,A)),D=L.pop();return M},v=(C,A)=>(o("comp",C,A),C=E(C,A),o("caret",C),C=x(C,A),o("tildes",C),C=S(C,A),o("xrange",C),C=F(C,A),o("stars",C),C),b=C=>!C||C.toLowerCase()==="x"||C==="*",x=(C,A)=>C.trim().split(/\s+/).map(M=>_(M,A)).join(" "),_=(C,A)=>{const M=A.loose?u[l.TILDELOOSE]:u[l.TILDE];return C.replace(M,(L,D,O,j,J)=>{o("tilde",C,L,D,O,j,J);let K;return b(D)?K="":b(O)?K=`>=${D}.0.0 <${+D+1}.0.0-0`:b(j)?K=`>=${D}.${O}.0 <${D}.${+O+1}.0-0`:J?(o("replaceTilde pr",J),K=`>=${D}.${O}.${j}-${J} <${D}.${+O+1}.0-0`):K=`>=${D}.${O}.${j} <${D}.${+O+1}.0-0`,o("tilde return",K),K})},E=(C,A)=>C.trim().split(/\s+/).map(M=>w(M,A)).join(" "),w=(C,A)=>{o("caret",C,A);const M=A.loose?u[l.CARETLOOSE]:u[l.CARET],L=A.includePrerelease?"-0":"";return C.replace(M,(D,O,j,J,K)=>{o("caret",C,D,O,j,J,K);let fe;return b(O)?fe="":b(j)?fe=`>=${O}.0.0${L} <${+O+1}.0.0-0`:b(J)?O==="0"?fe=`>=${O}.${j}.0${L} <${O}.${+j+1}.0-0`:fe=`>=${O}.${j}.0${L} <${+O+1}.0.0-0`:K?(o("replaceCaret pr",K),O==="0"?j==="0"?fe=`>=${O}.${j}.${J}-${K} <${O}.${j}.${+J+1}-0`:fe=`>=${O}.${j}.${J}-${K} <${O}.${+j+1}.0-0`:fe=`>=${O}.${j}.${J}-${K} <${+O+1}.0.0-0`):(o("no pr"),O==="0"?j==="0"?fe=`>=${O}.${j}.${J}${L} <${O}.${j}.${+J+1}-0`:fe=`>=${O}.${j}.${J}${L} <${O}.${+j+1}.0-0`:fe=`>=${O}.${j}.${J} <${+O+1}.0.0-0`),o("caret return",fe),fe})},S=(C,A)=>(o("replaceXRanges",C,A),C.split(/\s+/).map(M=>$(M,A)).join(" ")),$=(C,A)=>{C=C.trim();const M=A.loose?u[l.XRANGELOOSE]:u[l.XRANGE];return C.replace(M,(L,D,O,j,J,K)=>{o("xRange",C,L,D,O,j,J,K);const fe=b(O),we=fe||b(j),de=we||b(J),Pe=de;return D==="="&&Pe&&(D=""),K=A.includePrerelease?"-0":"",fe?D===">"||D==="<"?L="<0.0.0-0":L="*":D&&Pe?(we&&(j=0),J=0,D===">"?(D=">=",we?(O=+O+1,j=0,J=0):(j=+j+1,J=0)):D==="<="&&(D="<",we?O=+O+1:j=+j+1),D==="<"&&(K="-0"),L=`${D+O}.${j}.${J}${K}`):we?L=`>=${O}.0.0${K} <${+O+1}.0.0-0`:de&&(L=`>=${O}.${j}.0${K} <${O}.${+j+1}.0-0`),o("xRange return",L),L})},F=(C,A)=>(o("replaceStars",C,A),C.trim().replace(u[l.STAR],"")),T=(C,A)=>(o("replaceGTE0",C,A),C.trim().replace(u[A.includePrerelease?l.GTE0PRE:l.GTE0],"")),P=C=>(A,M,L,D,O,j,J,K,fe,we,de,Pe)=>(b(L)?M="":b(D)?M=`>=${L}.0.0${C?"-0":""}`:b(O)?M=`>=${L}.${D}.0${C?"-0":""}`:j?M=`>=${M}`:M=`>=${M}${C?"-0":""}`,b(fe)?K="":b(we)?K=`<${+fe+1}.0.0-0`:b(de)?K=`<${fe}.${+we+1}.0-0`:Pe?K=`<=${fe}.${we}.${de}-${Pe}`:C?K=`<${fe}.${we}.${+de+1}-0`:K=`<=${K}`,`${M} ${K}`.trim()),R=(C,A,M)=>{for(let L=0;L<C.length;L++)if(!C[L].test(A))return!1;if(A.prerelease.length&&!M.includePrerelease){for(let L=0;L<C.length;L++)if(o(C[L].semver),C[L].semver!==s.ANY&&C[L].semver.prerelease.length>0){const D=C[L].semver;if(D.major===A.major&&D.minor===A.minor&&D.patch===A.patch)return!0}return!1}return!0};return jy}var Hy,Zw;function Yge(){if(Zw)return Hy;Zw=1;const e=nR();return Hy=(n,i,r)=>{try{i=new e(i,r)}catch{return!1}return i.test(n)},Hy}Yge();let zp=bge;const Fh=typeof window<"u"?window:void 0;var Xw;zp===void 0&&((Xw=Fh==null?void 0:Fh.vl)!=null&&Xw.compile)&&(zp=Fh.vl);zp&&zp.version;const Zge={key:0},Xge={key:1,class:"areas"},Kge=["id","d","stroke","stroke-width","onMouseover","onClick"],Jge={key:2,class:"areas"},Qge=["id","d","stroke","stroke-width","onMouseover","onClick"],e1e={key:3,class:"paths"},t1e=["id","d","stroke","fill","stroke-width","onMouseover","onClick"],n1e={key:4,class:"paths"},i1e=["id","d","stroke","stroke-width","onMouseover","onClick"],r1e={key:5,class:"areas"},s1e=["id","d","stroke","fill","stroke-width","onMouseover","onClick"],o1e={__name:"SvgPlotter",props:{height:{type:Number,default:0},width:{type:Number,default:0},left:{type:Number,default:0},top:{type:Number,default:0}},setup(e){const t=e,n=_i(()=>t.height),i=_i(()=>t.width),r=_i(()=>t.left),s=_i(()=>t.top),o=fC(),a=N3(),u=je(window.innerWidth),l=je(window.innerHeight),c=je(.85768),f=je(23.2523),d=je(-300.932),h=je(T8()),p=je(null),g=je(null),m=(_,E,w)=>{const S=E[0]-w[0]*_.k,$=E[1]-w[1]*_.k;return S===_.x&&$===_.y?_:new Vi(_.k,S,$)},y=(_,E)=>E===_.k?_:new Vi(E,_.x,_.y),v=()=>{const _=Ui(g.value),E=V2(_.node()),w=[u.value/2,l.value/2],S=E.invert(w),$=E.k*1.5,F=m(y(E,$),w,S);_.transition().duration(500).call(h.value.transform,F)},b=()=>{const _=Ui(g.value),E=V2(_.node()),w=[u.value/2,l.value/2],S=E.invert(w),$=E.k/1.5,F=m(y(E,$),w,S);_.transition().duration(500).call(h.value.transform,F)},x=()=>{u.value=window.innerWidth,l.value=window.innerHeight};return NE(()=>{const _=Ui(g.value),E=Ui(p.value);h.value=T8().on("zoom",w=>{E.attr("transform",w.transform.toString())}),_.call(h.value).call(h.value.transform,_g.translate(f.value,d.value).scale(c.value)),window.addEventListener("resize",x)}),T3(()=>{window.removeEventListener("resize",x)}),(_,E)=>(nt(),st("div",{class:"svg-plotter-container",style:Kf({height:n.value+"px",width:i.value+"px",left:r.value+"px",top:s.value+"px"})},[at("div",{class:"control-container"},[at("div",{class:"ctrl-bottom-right"},[at("div",{class:"ctrl-group"},[at("button",{class:"ctrl-zoom-in",type:"button","aria-label":"Zoom in",onClick:v},E[5]||(E[5]=[at("span",{class:"icon","aria-hidden":"true",title:"放大"},null,-1)])),at("button",{class:"ctrl-zoom-out",type:"button","aria-label":"Zoom out",onClick:b},E[6]||(E[6]=[at("span",{class:"icon","aria-hidden":"true",title:"缩小"},null,-1)]))])]),E[7]||(E[7]=at("div",{class:"ctrl-top-right"},[at("span",{class:"compass-label"},"北"),at("span",{class:"compass-subtext"},"North"),at("img",{src:gG,alt:"compass",class:"compass-img"})],-1))]),(nt(),st("svg",{ref_key:"mapSvg",ref:g,class:"map-svg"},[E[9]||(E[9]=at("rect",{width:"100%",height:"100%",fill:"#e8e8e8"},null,-1)),at("g",{id:"map-container",ref_key:"map",ref:p},[Ie(o).baseMapVisible?(nt(),st("g",Zge,E[8]||(E[8]=[at("image",{class:"base-map",href:mG,x:"0",y:"0",width:"1039",height:"1239"},null,-1)]))):ro("",!0),Ie(o).areasVisible?(nt(),st("g",Xge,[(nt(!0),st(ln,null,ha(Ie(a).wall,(w,S)=>(nt(),st("path",{key:S,id:S,d:w.d,stroke:w.stroke,fill:"rgba(228,243,246,0.9)","stroke-width":w["stroke-width"],class:xi({highlight:Ie(o).hoveredElement===S}),onMouseover:$=>Ie(o).hoveredElement=S,onMouseout:E[0]||(E[0]=$=>Ie(o).hoveredElement=null),onClick:$=>Ie(o).focusedElementId=S},null,42,Kge))),128))])):ro("",!0),Ie(o).areasVisible?(nt(),st("g",Jge,[(nt(!0),st(ln,null,ha(Ie(a).building,(w,S)=>(nt(),st("path",{key:S,id:w.id,d:w.d,stroke:w.stroke,fill:"rgba(228,243,246,0.9)","stroke-width":w["stroke-width"],class:xi({highlight:Ie(o).hoveredElement===S}),onMouseover:$=>Ie(o).hoveredElement=S,onMouseout:E[1]||(E[1]=$=>Ie(o).hoveredElement=null),onClick:$=>Ie(o).focusedElementId=S},null,42,Qge))),128))])):ro("",!0),Ie(o).pathsVisible?(nt(),st("g",e1e,[(nt(!0),st(ln,null,ha(Ie(a).road,(w,S)=>(nt(),st("path",{id:w.id,d:w.d,stroke:w.stroke,fill:w.fill,"stroke-width":w["stroke-width"],"stroke-linecap":"round","stroke-linejoin":"round",class:xi({highlight:Ie(o).hoveredElement===S}),onMouseover:$=>Ie(o).hoveredElement=S,onMouseout:E[2]||(E[2]=$=>Ie(o).hoveredElement=null),onClick:$=>Ie(o).focusedElementId=S},null,42,t1e))),256))])):ro("",!0),Ie(o).pathsVisible?(nt(),st("g",n1e,[(nt(!0),st(ln,null,ha(Ie(a).water,(w,S)=>(nt(),st("path",{id:w.id,d:w.d,stroke:w.stroke,fill:"none","stroke-width":w["stroke-width"],"stroke-linecap":"round","stroke-linejoin":"round",class:xi({highlight:Ie(o).hoveredElement===S}),onMouseover:$=>Ie(o).hoveredElement=S,onMouseout:E[3]||(E[3]=$=>Ie(o).hoveredElement=null),onClick:$=>Ie(o).focusedElementId=S},null,42,i1e))),256))])):ro("",!0),Ie(o).areasVisible?(nt(),st("g",r1e,[(nt(!0),st(ln,null,ha(Ie(a).door,(w,S)=>(nt(),st("path",{key:S,id:w.id,d:w.d,stroke:w.stroke,fill:w.fill,"stroke-width":w["stroke-width"],class:xi({highlight:Ie(o).hoveredElement===S}),onMouseover:$=>Ie(o).hoveredElement=S,onMouseout:E[4]||(E[4]=$=>Ie(o).hoveredElement=null),onClick:$=>Ie(o).focusedElementId=S},null,42,s1e))),128))])):ro("",!0)],512)],512))],4))}},a1e=sA(o1e,[["__scopeId","data-v-801d68d4"]]),u1e={class:"layer-list"},l1e={class:"icon"},c1e=["onClick"],f1e={class:"layer-name"},d1e=["onClick"],h1e={key:0},p1e=["onMouseenter","onClick"],g1e={__name:"LayerManager",props:{height:{type:Number,default:0},width:{type:Number,default:0},left:{type:Number,default:0},top:{type:Number,default:0}},setup(e){const t=e,n=_i(()=>t.height),i=_i(()=>t.width),r=_i(()=>t.left),s=_i(()=>t.top),o=fC(),a=N3(),u=je(!0),l=je({areas:!1,paths:!1,points:!1}),c=_i(()=>({baseMap:{label:"底图",visibleKey:"baseMapVisible"},areas:{label:"区域",visibleKey:"areasVisible",children:a.areaCoordinates},paths:{label:"路径",visibleKey:"pathsVisible",children:a.pathData},points:{label:"地点",visibleKey:"pointsVisible",children:a.pointCoordinates}})),f=y=>o.hoveredElement=y,d=je({}),h=(y,v)=>{v&&(d.value[y]=v)},p=y=>o[y]?"fa fa-eye":"fa fa-eye-slash",g=y=>o[y]=!o[y],m=y=>l.value[y]=!l.value[y];return ef(()=>o.hoveredElement,async y=>{y&&(Object.keys(c.value).forEach(v=>{c.value[v].children&&y in c.value[v].children&&(l.value[v]=!0)}),await A3(),d.value[y]&&d.value[y].scrollIntoView({behavior:"smooth",block:"nearest"}))}),(y,v)=>(nt(),st("div",{class:"layer-manager",style:Kf({height:u.value?n.value+"px":"3em",width:i.value+"px",left:r.value+"px",top:s.value+"px"})},[v[2]||(v[2]=at("span",{class:"subtitle"},"地图图层列表",-1)),v[3]||(v[3]=at("hr",{style:{margin:"0",border:"none","border-top":"1px solid #ccc"}},null,-1)),at("button",{onClick:v[0]||(v[0]=b=>u.value=!u.value),class:"toggle-btn"},[at("i",{class:xi(u.value?"fa fa-angle-down":"fa fa-angle-up")},null,2)]),XR(at("div",u1e,[at("ul",null,[(nt(!0),st(ln,null,ha(c.value,(b,x)=>(nt(),st("li",{key:x},[at("span",l1e,[at("i",{class:xi(p(b.visibleKey)),onClick:_=>g(b.visibleKey)},null,10,c1e)]),at("span",f1e,[tC(qy(b.label)+" ",1),b.children?(nt(),st("i",{key:0,class:xi(l.value[x]?"fa fa-angle-down":"fa fa-angle-right"),onClick:_=>m(x)},null,10,d1e)):ro("",!0)]),b.children&&l.value[x]?(nt(),st("ul",h1e,[(nt(!0),st(ln,null,ha(b.children,(_,E)=>(nt(),st("li",{key:E,ref_for:!0,ref:w=>h(E,w),class:xi({hovered:Ie(o).hoveredElement===E}),onMouseenter:w=>f(E),onMouseleave:v[1]||(v[1]=w=>f(null)),onClick:w=>Ie(o).focusedElementId=E},qy(E),43,p1e))),128))])):ro("",!0)]))),128))])],512),[[oI,u.value]])],4))}},m1e={style:{width:"100vw",height:"100vh",overflow:"hidden"}},y1e={__name:"App",setup(e){const t=N3();t.pointCoordinates=nm.pointCoordinates,t.pathData=nm.pathCoordinates,t.areaCoordinates=nm.areaCoordinates,t.water=sc.水系,t.wall=sc.城墙,t.building=sc.城坊,t.door=sc.城门,t.road=sc.道路;const n=je(window.innerHeight),i=je(window.innerWidth);return window.addEventListener("resize",()=>{n.value=window.innerHeight,i.value=window.innerWidth}),(r,s)=>(nt(),st("div",m1e,[s[0]||(s[0]=at("span",{class:"title",style:{position:"absolute",top:"0",left:"0","z-index":"1"}}," 地图标注系统 ",-1)),Xi(a1e,{height:n.value,width:i.value/2,left:i.value/4,top:0},null,8,["height","width","left"]),Xi(g1e,{height:n.value*.85,width:i.value/5,left:i.value/100,top:n.value/10},null,8,["height","width","left","top"])]))}},v1e=sA(y1e,[["__scopeId","data-v-67d466c5"]]);EI(v1e).use(MI()).mount("#app");
